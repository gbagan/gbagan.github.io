(()=>{var Uf=function(n){return function(r){for(var t=r.length,e=new Array(t),a=0;a<t;a++)e[a]=n(r[a]);return e}};var ra={compose:function(n){return function(r){return function(t){return n(r(t))}}}},ta=function(n){return n.compose};var Z=function(n){return n.identity},en={identity:function(n){return n},Semigroupoid0:function(){return ra}};var sr=!0;var Cn=function(n){return function(r){return function(t){return n(t)(r)}}},Mn=function(n){return function(r){return n}};var Vn=function(){function n(){}return n.value=new n,n}();var m=function(n){return n.map},ar=function(n){var r=m(n);return function(t){return function(e){return r(e)(t)}}},Xn=function(n){return m(n)(Mn(void 0))};var jr={map:ta(ra)},zn={map:Uf};var qf=function(n){return function(r){return n.length===0?r:r.length===0?n:n.concat(r)}};var Mr=function(n){return n.reflectSymbol};var Vr=function(n){return function(r){return r[n]}},st=function(n){return function(r){return function(t){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e[n]=r,e}}};var pt={append:qf};var U=function(n){return n.append};var Hu={alt:U(pt),Functor0:function(){return zn}};var Bf=function(n){return function(r){for(var t=n.length,e=r.length,a=new Array(t*e),u=0,i=0;i<t;i++)for(var c=n[i],f=0;f<e;f++)a[u++]=c(r[f]);return a}};var Em=Z(en);var ea={apply:Bf,Functor0:function(){return zn}},hn=function(n){return n.apply};var ro=function(n){var r=hn(n),t=m(n.Functor0());return function(e){return function(a){return r(t(Mn(Em))(e))(a)}}};var E=function(n){return n.pure},ye=function(n){var r=E(n);return function(t){return function(e){if(!t)return e;if(t)return r(void 0);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[t.constructor.name,e.constructor.name])}}};var aa=function(n){var r=hn(n.Apply0()),t=E(n);return function(e){return function(a){return r(t(e))(a)}}};var he={pure:function(n){return[n]},Apply0:function(){return ea}};var zf=function(n){return function(r){for(var t=[],e=0,a=n.length;e<a;e++)Array.prototype.push.apply(t,r(n[e]));return t}};var Kr=function(n){return n.discard};var wt={bind:zf,Apply0:function(){return ea}},R=function(n){return n.bind},Lt=function(n){return Cn(R(n))};var Yr={discard:function(n){return R(n)}};var Lm=String.fromCharCode(65535),Im=String.fromCharCode(0),xm=Number.POSITIVE_INFINITY,Nm=Number.NEGATIVE_INFINITY;var Sm=function(n){return function(r){return function(t){return function(e){return function(a){return e<a?n:e===a?r:t}}}}};var kf=Sm;var Jf=function(n){return function(r){return n===r}},Gf=Jf,jf=Jf;var It={eq:jf};var eo={eq:Gf};var V=function(n){return n.eq},Wm=V(eo);var Jt=function(n){var r=V(n);return function(t){return function(e){return Wm(r(t)(e))(!1)}}};var q=function(){function n(){}return n.value=new n,n}(),J=function(){function n(){}return n.value=new n,n}(),G=function(){function n(){}return n.value=new n,n}();var Vf=function(n){return function(r){return n-r|0}};var Qf=function(n){return function(r){return n+r|0}},Kf=function(n){return function(r){return n*r|0}},Yf=function(n){return function(r){return n+r}},Xf=function(n){return function(r){return n*r}};var ao={add:Yf,zero:0,mul:Xf,one:1},ua={add:Qf,zero:0,mul:Kf,one:1};var Nr=function(n){return n.mul};var hr=function(n){return n.add};var Zf={sub:Vf,Semiring0:function(){return ua}};var gn=function(){return{compare:kf(q.value)(G.value)(J.value),Eq0:function(){return It}}}();var Q=function(n){return n.compare};var Gt=function(n){var r=Q(n);return function(t){return function(e){var a=r(t)(e);if(a instanceof q)return e;if(a instanceof G||a instanceof J)return t;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[a.constructor.name])}}},uo=function(n){var r=Q(n);return function(t){return function(e){var a=r(t)(e);if(a instanceof q||a instanceof G)return t;if(a instanceof J)return e;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[a.constructor.name])}}};var _t=function(n){return n.top};var ia={top:2147483647,bottom:-2147483648,Ord0:function(){return gn}};var Nt=function(n){return n.bottom};var tc=function(n){return n.toString()},ec=function(n){var r=n.toString();return isNaN(r+".0")?r:r+".0"};var fa={show:ec},dt={show:tc};var z=function(n){return n.show};var Ym=Z(en),D=function(){function n(){}return n.value=new n,n}(),d=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var Zn=function(n){return function(r){return function(t){if(t instanceof D)return n;if(t instanceof d)return r(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},jt=Zn(!0)(Mn(!1)),Ou=Zn(!1)(Mn(!0));var kn={map:function(n){return function(r){return r instanceof d?new d(n(r.value0)):D.value}}},Xm=m(kn);var Jn=function(n){return Zn(n)(Ym)},Ar=function(){return function(n){if(n instanceof d)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}};var Ce=function(n){var r=V(n);return{eq:function(t){return function(e){return t instanceof D&&e instanceof D?!0:t instanceof d&&e instanceof d?r(t.value0)(e.value0):!1}}}};var ca={apply:function(n){return function(r){if(n instanceof d)return Xm(n.value0)(r);if(n instanceof D)return D.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[n.constructor.name,r.constructor.name])}},Functor0:function(){return kn}};var Dt={bind:function(n){return function(r){if(n instanceof d)return r(n.value0);if(n instanceof D)return D.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[n.constructor.name,r.constructor.name])}},Apply0:function(){return ca}};var Vt=function(){return{pure:d.create,Apply0:function(){return ca}}}();var Nn=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),In=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var ac=function(n){return function(){return n}},oc=function(n){return function(r){return function(){return r(n())()}}};var _r=function(n){var r=R(n.Bind1()),t=E(n.Applicative0());return function(e){return function(a){return r(e)(function(u){return r(a)(function(i){return t(u(i))})})}}};var uc=function(n){return Math.min(Math.abs(n),2147483647)},ic=function(n){return function(r){return r===0?0:r>0?Math.floor(n/r):-Math.floor(n/-r)}},fc=function(n){return function(r){if(r===0)return 0;var t=Math.abs(r);return(n%t+t)%t}};var cc={Ring0:function(){return Zf}};var be=function(n){return n.mod};var Me={degree:uc,div:ic,mod:fc,CommutativeRing0:function(){return cc}},la=function(n){return n.div};var bn=function(n){return n.mempty};var lc=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}},pa={Applicative0:function(){return Xr},Bind1:function(){return io}},io={bind:oc,Apply0:function(){return pc(0)}},Xr={pure:ac,Apply0:function(){return pc(0)}},sc=lc("functorEffect","Effect",function(){return{map:aa(Xr)}}),pc=lc("applyEffect","Effect",function(){return{apply:_r(pa),Functor0:function(){return sc(0)}}}),tn=sc(20);var Zr=function(n){return n.ask};var yt=function(n){return n};var nt={map:function(n){return function(r){return n(r)}}};var Dc={apply:function(n){return function(r){return n(r)}},Functor0:function(){return nt}},c_={bind:function(n){return function(r){return r(n)}},Apply0:function(){return Dc}},yc={pure:yt,Apply0:function(){return Dc}},qr={Applicative0:function(){return yc},Bind1:function(){return c_}};var hc=function(n){return function(){return{value:n}}};var Pr=function(n){return function(){return n.value}},gc=function(n){return function(r){return function(){var t=n(r.value);return r.value=t.state,t.value}}},rt=function(n){return function(r){return function(){r.value=n}}};var s_=Xn(tn),tt=hc,p_=gc,m_=function(n){return p_(function(r){var t=n(r);return{state:t,value:t}})},Tc=function(n){return function(r){return s_(m_(n)(r))}};var $n=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Un=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),ur=function(n){return n.tailRecM};var v_=function(n){var r=function(t){var e=!1,a;function u(i){if(i instanceof $n){t=n(i.value0);return}if(i instanceof Un)return e=!0,i.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 103, column 3 - line 103, column 25): "+[i.constructor.name])}for(;!e;)a=u(t);return a};return function(t){return r(n(t))}};var Cc={tailRecM:function(n){var r=function(e){return e},t=v_(function(e){return r(n(e))});return function(e){return yt(t(e))}},Monad0:function(){return qr}};var C=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Fe=function(n){return function(r){return n(r.value0)(r.value1)}};var er=function(n){return n.value1};var Yt={map:function(n){return function(r){return new C(r.value0,n(r.value1))}}};var Or=function(n){return n.value0};var Mc=function(n){var r=V(n);return function(t){var e=V(t);return{eq:function(a){return function(u){return r(a.value0)(u.value0)&&e(a.value1)(u.value1)}}}}},so=function(n){var r=Q(n),t=Mc(n.Eq0());return function(e){var a=Q(e),u=t(e.Eq0());return{compare:function(i){return function(c){var f=r(i.value0)(c.value0);return f instanceof q?q.value:f instanceof J?J.value:a(i.value1)(c.value1)}},Eq0:function(){return u}}}};var Er=function(n){return n.state},va=function(n){var r=Er(n);return function(t){return r(function(e){return new C(void 0,t)})}},we=function(n){var r=Er(n);return function(t){return r(function(e){return new C(void 0,t(e))})}},da=function(n){var r=Er(n);return function(t){return r(function(e){var a=t(e);return new C(a,a)})}};var Da=function(n){return Er(n)(function(r){return new C(r,r)})};var Gn=function(n){return n.lift};var Ec={empty:[],Alt0:function(){return Hu}},Rr=function(n){return n.empty};var h=function(n){return n};var ju=function(){return h};var y_=ju();var Br=function(){return y_};var nr=function(n){return n.liftEffect};var Lc=function(n){return n};var Ic=function(n){return n};var Qu={lift:function(n){return function(r){return Lc(Mn(r))}}},T_=Gn(Qu),xc=function(n){return function(r){return function(t){return n(r(t))}}},C_=function(n){return{map:function(){var r=m(n);return function(t){return xc(r(t))}}()}};var Nc=function(n){var r=hn(n),t=C_(n.Functor0());return{apply:function(e){return function(a){return function(u){return r(e(u))(a(u))}}},Functor0:function(){return t}}},b_=function(n){var r=R(n),t=Nc(n.Apply0());return{bind:function(e){return function(a){return function(u){return r(e(u))(function(i){var c=a(i);return c(u)})}}},Apply0:function(){return t}}};var Ac=function(n){var r=Nc(n.Apply0());return{pure:function(){var t=E(n);return function(e){return Lc(Mn(t(e)))}}(),Apply0:function(){return r}}},Ku=function(n){var r=Ac(n.Applicative0()),t=b_(n.Bind1());return{Applicative0:function(){return r},Bind1:function(){return t}}},Sc=function(n){var r=Ku(n);return{ask:E(n.Applicative0()),Monad0:function(){return r}}};var Do=function(n){var r=n.Monad0(),t=Ku(r);return{liftEffect:function(){var e=T_(r),a=nr(n);return function(u){return e(a(u))}}(),Monad0:function(){return t}}};var Pc=function(n){return function(r){return function(t){for(var e=r,a=t.length,u=a-1;u>=0;u--)e=n(t[u])(e);return e}}},Rc=function(n){return function(r){return function(t){for(var e=r,a=t.length,u=0;u<a;u++)e=n(e)(t[u]);return e}}};var w_=Z(en),Le=function(n){return n.bimap},ho=function(n){var r=Le(n);return function(t){return r(t)(w_)}};var ga={bimap:function(n){return function(r){return function(t){return new C(n(t.value0),r(t.value1))}}}};var fr=function(n){return n.foldr};var Mo=function(n){var r=ro(n.Apply0()),t=E(n);return function(e){var a=fr(e);return function(u){return a(function(i){return r(u(i))})(t(void 0))}}},Eo=function(n){var r=Mo(n);return function(t){return Cn(r(t))}};var dr=function(n){return n.foldl};var Ca={foldr:function(n){return function(r){return function(t){if(t instanceof D)return r;if(t instanceof d)return n(t.value0)(r);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},foldl:function(n){return function(r){return function(t){if(t instanceof D)return r;if(t instanceof d)return n(r)(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},foldMap:function(n){var r=bn(n);return function(t){return function(e){if(e instanceof D)return r;if(e instanceof d)return t(e.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,e.constructor.name])}}}};var Oc=function(n){var r=fr(n);return function(t){var e=U(t.Semigroup0()),a=bn(t);return function(u){return r(function(i){return function(c){return e(u(i))(c)}})(a)}}},zr={foldr:Pc,foldl:Rc,foldMap:function(n){return Oc(zr)(n)}};var Bc=function(n){return function(r){for(var t=r.length,e=Array(t),a=0;a<t;a++)e[a]=n(a)(r[a]);return e}};var Rt=function(n){return n.mapWithIndex};var ba={mapWithIndex:Bc,Functor0:function(){return zn}};var pv=function(){function n(a){return[a]}function r(a){return function(u){return[a,u]}}function t(a){return function(u){return function(i){return[a,u,i]}}}function e(a){return function(u){return a.concat(u)}}return function(a){return function(u){return function(i){return function(c){return function(f){function l(_,v){switch(v-_){case 0:return i([]);case 1:return u(n)(c(f[_]));case 2:return a(u(r)(c(f[_])))(c(f[_+1]));case 3:return a(a(u(t)(c(f[_])))(c(f[_+1])))(c(f[_+2]));default:var b=_+Math.floor((v-_)/4)*2;return a(u(e)(l(_,b)))(l(b,v))}}return l(0,f.length)}}}}}}();var tl=function(n){return function(r){return function(t){return function(e){return function(a){return function(u){for(var i=[],c=u;;){var f=a(c);if(n(f))return i;var l=r(f);i.push(t(l)),c=e(l)}}}}}}};var el=function(n){return function(r){return function(t){return function(e){return function(a){return function(u){for(var i=[],c=u;;){var f=a(c);i.push(t(f));var l=e(f);if(n(l))return i;c=r(l)}}}}}}};var Nv=Ar();var li={unfoldr1:el(jt)(Nv)(Or)(er)};var Sv=Ar(),te=function(n){return n.unfoldr};var Ne={unfoldr:tl(jt)(Sv)(Or)(er),Unfoldable10:function(){return li}};var xn=function(){function n(){}return n.value=new n,n}(),j=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var ol=function(){var n=function(r){return function(t){var e=r,a=!1,u;function i(c,f){if(f instanceof xn)return a=!0,c;if(f instanceof j){e=new j(f.value0,c),t=f.value1;return}throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[c.constructor.name,f.constructor.name])}for(;!a;)u=i(e,t);return u}};return n(xn.value)}();var No=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var ul=function(n){var r=!1,t;function e(a){if(a.value0 instanceof xn&&a.value1 instanceof xn)return r=!0,D.value;if(a.value0 instanceof xn){n=new No(ol(a.value1),xn.value);return}if(a.value0 instanceof j)return r=!0,new d(new C(a.value0.value0,new No(a.value0.value1,a.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[a.constructor.name])}for(;!r;)t=e(n);return t},il=function(n){return function(r){return new No(n.value0,new j(r,n.value1))}};var fl=function(n){return n.value0 instanceof xn&&n.value1 instanceof xn};var cl=function(){return new No(xn.value,xn.value)}();var Se=function(){function n(){}return n.value=new n,n}(),Ao=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var ll=function(n){return function(r){if(n instanceof Se)return r;if(r instanceof Se)return n;if(n instanceof Ao)return new Ao(n.value0,il(n.value1)(r));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[n.constructor.name,r.constructor.name])}},ad=function(n){return function(r){return function(t){var e=function(u){return function(i){return function(c){var f=u,l=i,_=!1,v;function b(p,o,s){if(s instanceof xn)return _=!0,o;if(s instanceof j){f=p,l=p(o)(s.value0),c=s.value1;return}throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[p.constructor.name,o.constructor.name,s.constructor.name])}for(;!_;)v=b(f,l,c);return v}}},a=function(u){return function(i){var c=u,f=!1,l;function _(v,b){var p=ul(v);if(p instanceof D)return f=!0,e(function(o){return function(s){return s(o)}})(r)(b);if(p instanceof d){c=p.value0.value1,i=new j(n(p.value0.value0),b);return}throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[p.constructor.name])}for(;!f;)l=_(c,i);return l}};return a(t)(xn.value)}}},sl=function(n){if(n instanceof Se)return D.value;if(n instanceof Ao)return new d(new C(n.value0,function(){var r=fl(n.value1);return r?Se.value:ad(ll)(Se.value)(n.value1)}()));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[n.constructor.name])};var pl=function(){return Se.value}(),ml=ll;var _l={append:ml};var vl=function(n){return function(r){return ml(n)(new Ao(r,cl))}};var ud=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}},id=U(_l),fd=m(jr);var yi=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),La=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Ia=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),dl=function(n){var r=!1,t;function e(a){var u=function(f){return f},i=function(f){return function(l){return new yi(f.value0,id(f.value1)(l))}};if(a.value0 instanceof La){var c=sl(a.value1);if(c instanceof D)return r=!0,new La(a.value0.value0);if(c instanceof d){n=i(u(c.value0.value0)(a.value0.value0))(c.value0.value1);return}throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[c.constructor.name])}if(a.value0 instanceof Ia)return r=!0,new Ia(a.value0.value0,function(f){return i(a.value0.value1(f))(a.value1)});throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[a.value0.constructor.name])}for(;!r;)t=e(n);return t},Dl=function(n){var r=m(n);return function(t){var e=t.Monad0(),a=m(e.Bind1().Apply0().Functor0()),u=E(e.Applicative0()),i=ur(t);return function(c){var f=function(l){var _=dl(l);if(_ instanceof La)return a(Un.create)(u(_.value0));if(_ instanceof Ia)return a($n.create)(c(r(_.value1)(_.value0)));throw new Error("Failed pattern match at Control.Monad.Free (line 194, column 10 - line 196, column 37): "+[_.constructor.name])};return i(f)}}};var yl=function(n){return new yi(n,pl)};var So={Applicative0:function(){return Na},Bind1:function(){return xa}},hl={map:function(n){return function(r){return Lt(xa)(function(){var t=E(Na);return function(e){return t(n(e))}}())(r)}}},xa={bind:function(n){return function(r){return new yi(n.value0,vl(n.value1)(r))}},Apply0:function(){return gl(0)}},Na={pure:function(n){return yl(La.create(n))},Apply0:function(){return gl(0)}},gl=ud("freeApply","Control.Monad.Free",function(){return{apply:_r(So),Functor0:function(){return hl}}});var Tl=R(xa),hi=E(Na);var gi={tailRecM:function(n){return function(r){return Tl(n(r))(function(t){if(t instanceof $n)return ur(gi)(n)(t.value0);if(t instanceof Un)return hi(t.value0);throw new Error("Failed pattern match at Control.Monad.Free (line 86, column 26 - line 88, column 21): "+[t.constructor.name])})}},Monad0:function(){return So}},Pe=function(n){return yl(new Ia(n,function(r){return hi(r)}))};var cd=function(n){var r=function(t){var e=dl(t);if(e instanceof La)return hi(e.value0);if(e instanceof Ia)return Tl(n(e.value0))(fd(r)(e.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 168, column 10 - line 170, column 33): "+[e.constructor.name])};return r},Cl=function(n){return cd(function(r){return Pe(n(r))})};var ee=function(n){var r=null;return function(){return n===void 0||(r=n(),n=void 0),r}},ae=function(n){return n()};var Fl=function(n){return n()};var wl=function(n){throw new Error(n)};var Ll=function(){return wl};var Md=Ll(),Ed=Fl,oe=function(n){return Ed(function(){return Md(n)})};var I=function(){function n(){}return n.value=new n,n}(),W=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}(),sn=function(){function n(r,t,e,a,u,i,c){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i,this.value6=c}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return function(c){return new n(r,t,e,a,u,i,c)}}}}}}},n}(),Ht=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),bt=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),$t=function(){function n(r,t,e,a,u,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return new n(r,t,e,a,u,i)}}}}}},n}(),ot=function(){function n(r,t,e,a,u,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return new n(r,t,e,a,u,i)}}}}}},n}(),Ut=function(){function n(r,t,e,a,u,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return new n(r,t,e,a,u,i)}}}}}},n}(),Ro=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}();var Ti=function(n){return function(r){return new W(I.value,n,r,I.value)}},Wo=function(n){var r=te(n);return function(t){var e=function(a){var u=!1,i;function c(f){if(f instanceof xn)return u=!0,D.value;if(f instanceof j){if(f.value0 instanceof I){a=f.value1;return}if(f.value0 instanceof W&&f.value0.value0 instanceof I&&f.value0.value3 instanceof I)return u=!0,new d(new C(new C(f.value0.value1,f.value0.value2),f.value1));if(f.value0 instanceof W&&f.value0.value0 instanceof I)return u=!0,new d(new C(new C(f.value0.value1,f.value0.value2),new j(f.value0.value3,f.value1)));if(f.value0 instanceof W){a=new j(f.value0.value0,new j(Ti(f.value0.value1)(f.value0.value2),new j(f.value0.value3,f.value1)));return}if(f.value0 instanceof sn){a=new j(f.value0.value0,new j(Ti(f.value0.value1)(f.value0.value2),new j(f.value0.value3,new j(Ti(f.value0.value4)(f.value0.value5),new j(f.value0.value6,f.value1)))));return}throw new Error("Failed pattern match at Data.Map.Internal (line 624, column 18 - line 633, column 71): "+[f.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 623, column 3 - line 623, column 19): "+[f.constructor.name])}for(;!u;)i=c(a);return i};return r(e)(new j(t,xn.value))}};var qt=function(n){var r=Q(n);return function(t){var e=function(a){var u=!1,i;function c(f){if(f instanceof I)return u=!0,D.value;if(f instanceof W){var l=r(t)(f.value1);if(l instanceof G)return u=!0,new d(f.value2);if(l instanceof q){a=f.value0;return}a=f.value3;return}if(f instanceof sn){var _=r(t)(f.value1);if(_ instanceof G)return u=!0,new d(f.value2);var v=r(t)(f.value4);if(v instanceof G)return u=!0,new d(f.value5);if(_ instanceof q){a=f.value0;return}if(v instanceof J){a=f.value6;return}a=f.value3;return}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[f.constructor.name])}for(;!u;)i=c(a);return i};return e}};var ut={map:function(n){return function(r){if(r instanceof I)return I.value;if(r instanceof W)return new W(m(ut)(n)(r.value0),r.value1,n(r.value2),m(ut)(n)(r.value3));if(r instanceof sn)return new sn(m(ut)(n)(r.value0),r.value1,n(r.value2),m(ut)(n)(r.value3),r.value4,n(r.value5),m(ut)(n)(r.value6));throw new Error("Failed pattern match at Data.Map.Internal (line 116, column 1 - line 119, column 110): "+[n.constructor.name,r.constructor.name])}}};var xl=function(n){return function(r){return function(t){var e=n,a=r,u=!1,i;function c(f,l,_){if(l instanceof xn)return u=!0,_;if(l instanceof j){if(l.value0 instanceof Ht){e=f,a=l.value1,t=new W(_,l.value0.value0,l.value0.value1,l.value0.value2);return}if(l.value0 instanceof bt){e=f,a=l.value1,t=new W(l.value0.value0,l.value0.value1,l.value0.value2,_);return}if(l.value0 instanceof $t){e=f,a=l.value1,t=new sn(_,l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5);return}if(l.value0 instanceof ot){e=f,a=l.value1,t=new sn(l.value0.value0,l.value0.value1,l.value0.value2,_,l.value0.value3,l.value0.value4,l.value0.value5);return}if(l.value0 instanceof Ut){e=f,a=l.value1,t=new sn(l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5,_);return}throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[l.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[l.constructor.name,_.constructor.name])}for(;!u;)i=c(e,a,t);return i}}},Ho=function(n){var r=xl(n),t=Q(n);return function(e){return function(a){var u=function(c){return function(f){var l=c,_=!1,v;function b(p,o){if(p instanceof xn)return _=!0,new W(o.value0,o.value1,o.value2,o.value3);if(p instanceof j){if(p.value0 instanceof Ht)return _=!0,r(p.value1)(new sn(o.value0,o.value1,o.value2,o.value3,p.value0.value0,p.value0.value1,p.value0.value2));if(p.value0 instanceof bt)return _=!0,r(p.value1)(new sn(p.value0.value0,p.value0.value1,p.value0.value2,o.value0,o.value1,o.value2,o.value3));if(p.value0 instanceof $t){l=p.value1,f=new Ro(new W(o.value0,o.value1,o.value2,o.value3),p.value0.value0,p.value0.value1,new W(p.value0.value2,p.value0.value3,p.value0.value4,p.value0.value5));return}if(p.value0 instanceof ot){l=p.value1,f=new Ro(new W(p.value0.value0,p.value0.value1,p.value0.value2,o.value0),o.value1,o.value2,new W(o.value3,p.value0.value3,p.value0.value4,p.value0.value5));return}if(p.value0 instanceof Ut){l=p.value1,f=new Ro(new W(p.value0.value0,p.value0.value1,p.value0.value2,p.value0.value3),p.value0.value4,p.value0.value5,new W(o.value0,o.value1,o.value2,o.value3));return}throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[p.value0.constructor.name,o.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[p.constructor.name,o.constructor.name])}for(;!_;)v=b(l,f);return v}},i=function(c){return function(f){var l=c,_=!1,v;function b(p,o){if(o instanceof I)return _=!0,u(p)(new Ro(I.value,e,a,I.value));if(o instanceof W){var s=t(e)(o.value1);if(s instanceof G)return _=!0,r(p)(new W(o.value0,e,a,o.value3));if(s instanceof q){l=new j(new Ht(o.value1,o.value2,o.value3),p),f=o.value0;return}l=new j(new bt(o.value0,o.value1,o.value2),p),f=o.value3;return}if(o instanceof sn){var s=t(e)(o.value1);if(s instanceof G)return _=!0,r(p)(new sn(o.value0,e,a,o.value3,o.value4,o.value5,o.value6));var Ln=t(e)(o.value4);if(Ln instanceof G)return _=!0,r(p)(new sn(o.value0,o.value1,o.value2,o.value3,e,a,o.value6));if(s instanceof q){l=new j(new $t(o.value1,o.value2,o.value3,o.value4,o.value5,o.value6),p),f=o.value0;return}if(s instanceof J&&Ln instanceof q){l=new j(new ot(o.value0,o.value1,o.value2,o.value4,o.value5,o.value6),p),f=o.value3;return}l=new j(new Ut(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),p),f=o.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[p.constructor.name,o.constructor.name])}for(;!_;)v=b(l,f);return v}};return i(xn.value)}}},xd=function(n){var r=xl(n),t=Q(n);return function(e){var a=function(f){return function(l){var _=f,v=!1,b;function p(o,s){if(o instanceof xn)return v=!0,s;if(o instanceof j){if(o.value0 instanceof Ht&&o.value0.value2 instanceof I&&s instanceof I)return v=!0,r(o.value1)(new W(I.value,o.value0.value0,o.value0.value1,I.value));if(o.value0 instanceof bt&&o.value0.value0 instanceof I&&s instanceof I)return v=!0,r(o.value1)(new W(I.value,o.value0.value1,o.value0.value2,I.value));if(o.value0 instanceof Ht&&o.value0.value2 instanceof W){_=o.value1,l=new sn(s,o.value0.value0,o.value0.value1,o.value0.value2.value0,o.value0.value2.value1,o.value0.value2.value2,o.value0.value2.value3);return}if(o.value0 instanceof bt&&o.value0.value0 instanceof W){_=o.value1,l=new sn(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3,o.value0.value1,o.value0.value2,s);return}return o.value0 instanceof Ht&&o.value0.value2 instanceof sn?(v=!0,r(o.value1)(new W(new W(s,o.value0.value0,o.value0.value1,o.value0.value2.value0),o.value0.value2.value1,o.value0.value2.value2,new W(o.value0.value2.value3,o.value0.value2.value4,o.value0.value2.value5,o.value0.value2.value6)))):o.value0 instanceof bt&&o.value0.value0 instanceof sn?(v=!0,r(o.value1)(new W(new W(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3),o.value0.value0.value4,o.value0.value0.value5,new W(o.value0.value0.value6,o.value0.value1,o.value0.value2,s)))):o.value0 instanceof $t&&o.value0.value2 instanceof I&&o.value0.value5 instanceof I&&s instanceof I?(v=!0,r(o.value1)(new sn(I.value,o.value0.value0,o.value0.value1,I.value,o.value0.value3,o.value0.value4,I.value))):o.value0 instanceof ot&&o.value0.value0 instanceof I&&o.value0.value5 instanceof I&&s instanceof I?(v=!0,r(o.value1)(new sn(I.value,o.value0.value1,o.value0.value2,I.value,o.value0.value3,o.value0.value4,I.value))):o.value0 instanceof Ut&&o.value0.value0 instanceof I&&o.value0.value3 instanceof I&&s instanceof I?(v=!0,r(o.value1)(new sn(I.value,o.value0.value1,o.value0.value2,I.value,o.value0.value4,o.value0.value5,I.value))):o.value0 instanceof $t&&o.value0.value2 instanceof W?(v=!0,r(o.value1)(new W(new sn(s,o.value0.value0,o.value0.value1,o.value0.value2.value0,o.value0.value2.value1,o.value0.value2.value2,o.value0.value2.value3),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ot&&o.value0.value0 instanceof W?(v=!0,r(o.value1)(new W(new sn(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3,o.value0.value1,o.value0.value2,s),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ot&&o.value0.value5 instanceof W?(v=!0,r(o.value1)(new W(o.value0.value0,o.value0.value1,o.value0.value2,new sn(s,o.value0.value3,o.value0.value4,o.value0.value5.value0,o.value0.value5.value1,o.value0.value5.value2,o.value0.value5.value3)))):o.value0 instanceof Ut&&o.value0.value3 instanceof W?(v=!0,r(o.value1)(new W(o.value0.value0,o.value0.value1,o.value0.value2,new sn(o.value0.value3.value0,o.value0.value3.value1,o.value0.value3.value2,o.value0.value3.value3,o.value0.value4,o.value0.value5,s)))):o.value0 instanceof $t&&o.value0.value2 instanceof sn?(v=!0,r(o.value1)(new sn(new W(s,o.value0.value0,o.value0.value1,o.value0.value2.value0),o.value0.value2.value1,o.value0.value2.value2,new W(o.value0.value2.value3,o.value0.value2.value4,o.value0.value2.value5,o.value0.value2.value6),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ot&&o.value0.value0 instanceof sn?(v=!0,r(o.value1)(new sn(new W(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3),o.value0.value0.value4,o.value0.value0.value5,new W(o.value0.value0.value6,o.value0.value1,o.value0.value2,s),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ot&&o.value0.value5 instanceof sn?(v=!0,r(o.value1)(new sn(o.value0.value0,o.value0.value1,o.value0.value2,new W(s,o.value0.value3,o.value0.value4,o.value0.value5.value0),o.value0.value5.value1,o.value0.value5.value2,new W(o.value0.value5.value3,o.value0.value5.value4,o.value0.value5.value5,o.value0.value5.value6)))):o.value0 instanceof Ut&&o.value0.value3 instanceof sn?(v=!0,r(o.value1)(new sn(o.value0.value0,o.value0.value1,o.value0.value2,new W(o.value0.value3.value0,o.value0.value3.value1,o.value0.value3.value2,o.value0.value3.value3),o.value0.value3.value4,o.value0.value3.value5,new W(o.value0.value3.value6,o.value0.value4,o.value0.value5,s)))):(v=!0,oe("The impossible happened in partial function `up`."))}throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[o.constructor.name])}for(;!v;)b=p(_,l);return b}},u=function(f){return function(l){var _=f,v=!1,b;function p(o,s){if(s instanceof W&&s.value0 instanceof I&&s.value3 instanceof I)return v=!0,a(o)(I.value);if(s instanceof W){_=new j(new bt(s.value0,s.value1,s.value2),o),l=s.value3;return}if(s instanceof sn&&s.value0 instanceof I&&s.value3 instanceof I&&s.value6 instanceof I)return v=!0,a(new j(new bt(I.value,s.value1,s.value2),o))(I.value);if(s instanceof sn){_=new j(new Ut(s.value0,s.value1,s.value2,s.value3,s.value4,s.value5),o),l=s.value6;return}return v=!0,oe("The impossible happened in partial function `removeMaxNode`.")}for(;!v;)b=p(_,l);return b}},i=function(f){var l=!1,_;function v(b){if(b instanceof W&&b.value3 instanceof I)return l=!0,{key:b.value1,value:b.value2};if(b instanceof W){f=b.value3;return}if(b instanceof sn&&b.value6 instanceof I)return l=!0,{key:b.value4,value:b.value5};if(b instanceof sn){f=b.value6;return}return l=!0,oe("The impossible happened in partial function `maxNode`.")}for(;!l;)_=v(f);return _},c=function(f){return function(l){var _=f,v=!1,b;function p(o,s){if(s instanceof I)return v=!0,D.value;if(s instanceof W){var Ln=t(e)(s.value1);if(s.value3 instanceof I&&Ln instanceof G)return v=!0,new d(new C(s.value2,a(o)(I.value)));if(Ln instanceof G){var En=i(s.value0);return v=!0,new d(new C(s.value2,u(new j(new Ht(En.key,En.value,s.value3),o))(s.value0)))}if(Ln instanceof q){_=new j(new Ht(s.value1,s.value2,s.value3),o),l=s.value0;return}_=new j(new bt(s.value0,s.value1,s.value2),o),l=s.value3;return}if(s instanceof sn){var wr=function(){return s.value0 instanceof I&&s.value3 instanceof I&&s.value6 instanceof I}(),Ln=t(e)(s.value4),$r=t(e)(s.value1);if(wr&&$r instanceof G)return v=!0,new d(new C(s.value2,r(o)(new W(I.value,s.value4,s.value5,I.value))));if(wr&&Ln instanceof G)return v=!0,new d(new C(s.value5,r(o)(new W(I.value,s.value1,s.value2,I.value))));if($r instanceof G){var En=i(s.value0);return v=!0,new d(new C(s.value2,u(new j(new $t(En.key,En.value,s.value3,s.value4,s.value5,s.value6),o))(s.value0)))}if(Ln instanceof G){var En=i(s.value3);return v=!0,new d(new C(s.value5,u(new j(new ot(s.value0,s.value1,s.value2,En.key,En.value,s.value6),o))(s.value3)))}if($r instanceof q){_=new j(new $t(s.value1,s.value2,s.value3,s.value4,s.value5,s.value6),o),l=s.value0;return}if($r instanceof J&&Ln instanceof q){_=new j(new ot(s.value0,s.value1,s.value2,s.value4,s.value5,s.value6),o),l=s.value3;return}_=new j(new Ut(s.value0,s.value1,s.value2,s.value3,s.value4,s.value5),o),l=s.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[s.constructor.name])}for(;!v;)b=p(_,l);return b}};return c(xn.value)}};var Re=function(){return I.value}(),$o=function(n){var r=Ho(n);return function(t){return dr(t)(function(e){return function(a){return r(a.value0)(a.value1)(e)}})(Re)}};var Nd=function(n){var r=xd(n);return function(t){return function(e){return Zn(e)(er)(r(t)(e))}}};var Ad=function(n){var r=qt(n),t=Nd(n),e=Ho(n);return function(a){return function(u){return function(i){var c=a(r(u)(i));if(c instanceof D)return t(u)(i);if(c instanceof d)return e(u)(c.value0)(i);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[c.constructor.name])}}}};var Nl=function(n){var r=Ad(n);return function(t){return function(e){return function(a){return r(Zn(D.value)(t))(e)(a)}}}};var Fr=function(){var n={},r="Pure",t="Throw",e="Catch",a="Sync",u="Async",i="Bind",c="Bracket",f="Fork",l="Sequential",_="Map",v="Apply",b="Alt",p="Cons",o="Resume",s="Release",Ln="Finalizer",En="Finalized",wr="Forked",$r="Fiber",$f="Thunk";function x(L,_n,Rn,yn){this.tag=L,this._1=_n,this._2=Rn,this._3=yn}function Lr(L){var _n=function(Rn,yn,N){return new x(L,Rn,yn,N)};return _n.tag=L,_n}function Pu(L){return new x(r,void 0)}function mm(L){try{L()}catch(_n){setTimeout(function(){throw _n},0)}}function _m(L,_n,Rn){try{return _n(Rn())}catch(yn){return L(yn)}}function vm(L,_n,Rn){try{return _n(Rn)()}catch(yn){return Rn(L(yn))(),Pu}}var Ya=function(){var L=1024,_n=0,Rn=0,yn=new Array(L),N=!1;function T(){var dn;for(N=!0;_n!==0;)_n--,dn=yn[Rn],yn[Rn]=void 0,Rn=(Rn+1)%L,dn();N=!1}return{isDraining:function(){return N},enqueue:function(dn){var Y,Sn;_n===L&&(Sn=N,T(),N=Sn),yn[(Rn+_n)%L]=dn,_n++,N||T()}}}();function dm(L){var _n={},Rn=0,yn=0;return{register:function(N){var T=Rn++;N.onComplete({rethrow:!0,handler:function(dn){return function(){yn--,delete _n[T]}}})(),_n[T]=N,yn++},isEmpty:function(){return yn===0},killAll:function(N,T){return function(){if(yn===0)return T();var dn=0,Y={};function Sn(Tn){Y[Tn]=_n[Tn].kill(N,function(qn){return function(){delete Y[Tn],dn--,L.isLeft(qn)&&L.fromLeft(qn)&&setTimeout(function(){throw L.fromLeft(qn)},0),dn===0&&T()}})()}for(var Yn in _n)_n.hasOwnProperty(Yn)&&(dn++,Sn(Yn));return _n={},Rn=0,yn=0,function(Tn){return new x(a,function(){for(var qn in Y)Y.hasOwnProperty(qn)&&Y[qn]()})}}}}}var de=0,yr=1,Xa=2,Za=3,no=4,br=5,Ze=6;function Ru(L,_n,Rn){var yn=0,N=de,T=Rn,dn=null,Y=null,Sn=null,Yn=null,Tn=null,qn=0,kt=0,Ir=null,Et=!0;function Ft(A){for(var S,on,pn;;)switch(S=null,on=null,pn=null,N){case Xa:N=yr;try{T=Sn(T),Yn===null?Sn=null:(Sn=Yn._1,Yn=Yn._2)}catch(rr){N=br,dn=L.left(rr),T=null}break;case Za:L.isLeft(T)?(N=br,dn=T,T=null):Sn===null?N=br:(N=Xa,T=L.fromRight(T));break;case yr:switch(T.tag){case i:Sn&&(Yn=new x(p,Sn,Yn)),Sn=T._2,N=yr,T=T._1;break;case r:Sn===null?(N=br,T=L.right(T._1)):(N=Xa,T=T._1);break;case a:N=Za,T=_m(L.left,L.right,T._1);break;case u:N=no,T=vm(L.left,T._1,function(rr){return function(){yn===A&&(yn++,Ya.enqueue(function(){yn===A+1&&(N=Za,T=rr,Ft(yn))}))}});return;case t:N=br,dn=L.left(T._1),T=null;break;case e:Sn===null?Tn=new x(p,T,Tn,Y):Tn=new x(p,T,new x(p,new x(o,Sn,Yn),Tn,Y),Y),Sn=null,Yn=null,N=yr,T=T._1;break;case c:qn++,Sn===null?Tn=new x(p,T,Tn,Y):Tn=new x(p,T,new x(p,new x(o,Sn,Yn),Tn,Y),Y),Sn=null,Yn=null,N=yr,T=T._1;break;case f:N=Za,S=Ru(L,_n,T._2),_n&&_n.register(S),T._1&&S.run(),T=L.right(S);break;case l:N=yr,T=ym(L,_n,T._1);break}break;case br:if(Sn=null,Yn=null,Tn===null)N=Ze,T=Y||dn||T;else switch(S=Tn._3,pn=Tn._1,Tn=Tn._2,pn.tag){case e:Y&&Y!==S&&qn===0?N=br:dn&&(N=yr,T=pn._2(L.fromLeft(dn)),dn=null);break;case o:Y&&Y!==S&&qn===0||dn?N=br:(Sn=pn._1,Yn=pn._2,N=Xa,T=L.fromRight(T));break;case c:qn--,dn===null&&(on=L.fromRight(T),Tn=new x(p,new x(s,pn._2,on),Tn,S),(Y===S||qn>0)&&(N=yr,T=pn._3(on)));break;case s:Tn=new x(p,new x(En,T,dn),Tn,Y),N=yr,Y&&Y!==S&&qn===0?T=pn._1.killed(L.fromLeft(Y))(pn._2):dn?T=pn._1.failed(L.fromLeft(dn))(pn._2):T=pn._1.completed(L.fromRight(T))(pn._2),dn=null,qn++;break;case Ln:qn++,Tn=new x(p,new x(En,T,dn),Tn,Y),N=yr,T=pn._1;break;case En:qn--,N=br,T=pn._1,dn=pn._2;break}break;case Ze:for(var Hn in Ir)Ir.hasOwnProperty(Hn)&&(Et=Et&&Ir[Hn].rethrow,mm(Ir[Hn].handler(T)));Ir=null,Y&&dn?setTimeout(function(){throw L.fromLeft(dn)},0):L.isLeft(T)&&Et&&setTimeout(function(){if(Et)throw L.fromLeft(T)},0);return;case de:N=yr;break;case no:return}}function Wn(A){return function(){if(N===Ze)return Et=Et&&A.rethrow,A.handler(T)(),function(){};var S=kt++;return Ir=Ir||{},Ir[S]=A,function(){Ir!==null&&delete Ir[S]}}}function P(A,S){return function(){if(N===Ze)return S(L.right(void 0))(),function(){};var on=Wn({rethrow:!1,handler:function(){return S(L.right(void 0))}})();switch(N){case de:Y=L.left(A),N=Ze,T=Y,Ft(yn);break;case no:Y===null&&(Y=L.left(A)),qn===0&&(N===no&&(Tn=new x(p,new x(Ln,T(A)),Tn,Y)),N=br,T=null,dn=null,Ft(++yn));break;default:Y===null&&(Y=L.left(A)),qn===0&&(N=br,T=null,dn=null)}return on}}function X(A){return function(){var S=Wn({rethrow:!1,handler:A})();return N===de&&Ft(yn),S}}return{kill:P,join:X,onComplete:Wn,isSuspended:function(){return N===de},run:function(){N===de&&(Ya.isDraining()?Ft(yn):Ya.enqueue(function(){Ft(yn)}))}}}function Dm(L,_n,Rn,yn){var N=0,T={},dn=0,Y={},Sn=new Error("[ParAff] Early exit"),Yn=null,Tn=n;function qn(Wn,P,X){var A=P,S=null,on=null,pn=0,Hn={},rr,na;n:for(;;)switch(rr=null,A.tag){case wr:if(A._3===n&&(rr=T[A._1],Hn[pn++]=rr.kill(Wn,function(hm){return function(){pn--,pn===0&&X(hm)()}})),S===null)break n;A=S._2,on===null?S=null:(S=on._1,on=on._2);break;case _:A=A._2;break;case v:case b:S&&(on=new x(p,S,on)),S=A,A=A._1;break}if(pn===0)X(L.right(void 0))();else for(na=0,rr=pn;na<rr;na++)Hn[na]=Hn[na]();return Hn}function kt(Wn,P,X){var A,S,on,pn,Hn,rr;L.isLeft(Wn)?(A=Wn,S=null):(S=Wn,A=null);n:for(;;){if(on=null,pn=null,Hn=null,rr=null,Yn!==null)return;if(P===null){yn(A||S)();return}if(P._3!==n)return;switch(P.tag){case _:A===null?(P._3=L.right(P._1(L.fromRight(S))),S=P._3):P._3=A;break;case v:if(on=P._1._3,pn=P._2._3,A){if(P._3=A,Hn=!0,rr=dn++,Y[rr]=qn(Sn,A===on?P._2:P._1,function(){return function(){delete Y[rr],Hn?Hn=!1:X===null?kt(A,null,null):kt(A,X._1,X._2)}}),Hn){Hn=!1;return}}else{if(on===n||pn===n)return;S=L.right(L.fromRight(on)(L.fromRight(pn))),P._3=S}break;case b:if(on=P._1._3,pn=P._2._3,on===n&&L.isLeft(pn)||pn===n&&L.isLeft(on))return;if(on!==n&&L.isLeft(on)&&pn!==n&&L.isLeft(pn))A=S===on?pn:on,S=null,P._3=A;else if(P._3=S,Hn=!0,rr=dn++,Y[rr]=qn(Sn,S===on?P._2:P._1,function(){return function(){delete Y[rr],Hn?Hn=!1:X===null?kt(S,null,null):kt(S,X._1,X._2)}}),Hn){Hn=!1;return}break}X===null?P=null:(P=X._1,X=X._2)}}function Ir(Wn){return function(P){return function(){delete T[Wn._1],Wn._3=P,kt(P,Wn._2._1,Wn._2._2)}}}function Et(){var Wn=yr,P=Rn,X=null,A=null,S,on;n:for(;;)switch(S=null,on=null,Wn){case yr:switch(P.tag){case _:X&&(A=new x(p,X,A)),X=new x(_,P._1,n,n),P=P._2;break;case v:X&&(A=new x(p,X,A)),X=new x(v,n,P._2,n),P=P._1;break;case b:X&&(A=new x(p,X,A)),X=new x(b,n,P._2,n),P=P._1;break;default:on=N++,Wn=br,S=P,P=new x(wr,on,new x(p,X,A),n),S=Ru(L,_n,S),S.onComplete({rethrow:!1,handler:Ir(P)})(),T[on]=S,_n&&_n.register(S)}break;case br:if(X===null)break n;X._1===n?(X._1=P,Wn=yr,P=X._2,X._2=n):(X._2=P,P=X,A===null?X=null:(X=A._1,A=A._2))}for(Tn=P,on=0;on<N;on++)T[on].run()}function Ft(Wn,P){Yn=L.left(Wn);var X;for(var A in Y)if(Y.hasOwnProperty(A)){X=Y[A];for(A in X)X.hasOwnProperty(A)&&X[A]()}Y=null;var S=qn(Wn,Tn,P);return function(on){return new x(u,function(pn){return function(){for(var Hn in S)S.hasOwnProperty(Hn)&&S[Hn]();return Pu}})}}return Et(),function(Wn){return new x(u,function(P){return function(){return Ft(Wn,P)}})}}function ym(L,_n,Rn){return new x(u,function(yn){return function(){return Dm(L,_n,Rn,yn)}})}return x.EMPTY=n,x.Pure=Lr(r),x.Throw=Lr(t),x.Catch=Lr(e),x.Sync=Lr(a),x.Async=Lr(u),x.Bind=Lr(i),x.Bracket=Lr(c),x.Fork=Lr(f),x.Seq=Lr(l),x.ParMap=Lr(_),x.ParApply=Lr(v),x.ParAlt=Lr(b),x.Fiber=Ru,x.Supervisor=dm,x.Scheduler=Ya,x.nonCanceler=Pu,x}(),Al=Fr.Pure,Sd=Fr.Throw;function Sl(n){return function(r){return r.tag===Fr.Pure.tag?Fr.Pure(n(r._1)):Fr.Bind(r,function(t){return Fr.Pure(n(t))})}}function Pl(n){return function(r){return Fr.Bind(n,r)}}var Rl=Fr.Sync;var Wl=Fr.Async;function Hl(n,r){return function(){return Fr.Fiber(n,null,r)}}var $l=function(){function n(t,e){return t===0&&typeof setImmediate<"u"?setImmediate(e):setTimeout(e,t)}function r(t,e){return t===0&&typeof clearImmediate<"u"?clearImmediate(e):clearTimeout(e)}return function(t,e){return Fr.Async(function(a){return function(){var u=n(e,a(t()));return function(){return Fr.Sync(function(){return t(r(e,u))})}}})}}(),Pd=Fr.Seq;var Oo={dimap:function(n){return function(r){return function(t){return function(e){return r(t(n(e)))}}}}},We=function(n){return n.dimap};var Yd=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}};var Xd=Xn(tn);var bi={map:Sl};var Zd=function(){var n=function(e){if(e instanceof In)return e.value0;if(e instanceof Nn)return oe("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[e.constructor.name])},r=function(e){if(e instanceof Nn)return e.value0;if(e instanceof In)return oe("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[e.constructor.name])},t=function(e){if(e instanceof Nn)return!0;if(e instanceof In)return!1;throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[e.constructor.name])};return{isLeft:t,fromLeft:r,fromRight:n,left:Nn.create,right:In.create}}(),nD=function(n){return Hl(Zd,n)},rD=function(n){return function(){var t=nD(n)();return t.run(),t}},Mi=function(n){return Xd(rD(n))};var Ql=function(n){return $l(In.create,n)};var Aa={Applicative0:function(){return Pa},Bind1:function(){return Sa}},Sa={bind:Pl,Apply0:function(){return Kl(0)}},Pa={pure:Al,Apply0:function(){return Kl(0)}},Kl=Yd("applyAff","Effect.Aff",function(){return{apply:_r(Aa),Functor0:function(){return bi}}});var tD=E(Pa),eD=R(Sa);var $e={liftEffect:Rl,Monad0:function(){return Aa}};var Yl={tailRecM:function(n){var r=function(t){return eD(n(t))(function(e){if(e instanceof Un)return tD(e.value0);if(e instanceof $n)return r(e.value0);throw new Error("Failed pattern match at Effect.Aff (line 104, column 7 - line 106, column 23): "+[e.constructor.name])})};return r},Monad0:function(){return Aa}};var Xl=(n,r)=>({...n,...r}),Zl=(n,r)=>n&&r?t=>n(r(t)):n||r,ns=(n,r,t,e,a,u,i)=>{if(r==="style")for(let c in Xl(t,e))t=e==null||e[c]==null?"":e[c],c[0]==="-"?n[r].setProperty(c,t):n[r][c]=t;else if(r[0]==="o"&&r[1]==="n"){let c=r.slice(2);n.actions||(n.actions={}),n.actions[c]=i&&e?i(e):e,e?t||n.addEventListener(c,a):n.removeEventListener(c,a)}else!u&&r in n?n[r]=e:e==null||e===!1||r==="class"&&!e?n.removeAttribute(r):n.setAttribute(r,e)},zo=(n,r,t,e)=>{let a=n.type===3?document.createTextNode(n.tag):(t=t||n.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",n.tag):document.createElement(n.tag),u=n.props,i=Zl(e,n.mapf);for(let c in u)ns(a,c,null,u[c],r,t,i);for(let c=0,f=n.children.length;c<f;c++)a.appendChild(zo(ie(n.children[c]).html,r,t,i));return n.node=a,a},ue=(n,r,t,e,a,u,i)=>{if(t!==e)if(t!=null&&t.type===3&&e.type===3)t.tag!==e.tag&&(r.nodeValue=e.tag);else if(t==null||t.tag!==e.tag)r=n.insertBefore(zo(e,a,u,i),r),t&&n.removeChild(t.node);else{let c=t.props,f=e.props,l=t.children,_=e.children,v=l.length-1,b=_.length-1;i=Zl(i,e.mapf),u=u||e.tag==="svg";for(let p in Xl(c,f))(p==="value"||p==="selected"||p==="checked"?r[p]:c[p])!==f[p]&&ns(r,p,c[p],f[p],a,u,i);if(e.keyed){let p=0,o=0;for(;o<=b&&p<=v;){let{key:s,html:Ln}=l[p];if(s!==_[o].key)break;let En=ie(_[o],Ln);ue(r,Ln.node,Ln,En.html,a,u,i),o++,p++}for(;o<=b&&p<=v;){let{key:s,html:Ln}=l[v];if(s!==_[b].key)break;let En=ie(_[b],Ln);ue(r,Ln.node,Ln,En.html,a,u,i),b--,v--}if(p>v)for(;o<=b;){let s=ie(_[o]).html;r.insertBefore(zo(s,a,u,i),l[p]&&l[p].html.node),o++}else if(o>b)for(;p<=v;)r.removeChild(l[p].html.node),p++;else{let s={},Ln={};for(let En=p;En<=v;En++)s[l[En].key]=l[En].html;for(;o<=b;){let{key:En,html:wr}=l[p]||{key:null,html:null},{key:$r,html:$f}=ie(_[o],wr);if(Ln[En]||l[p+1]&&$r===l[p+1].key){p++;continue}if(En===$r)ue(r,wr.node,wr,$f,a,u,i),Ln[$r]=!0,p++;else{let x=s[$r];x!=null?(ue(r,r.insertBefore(x.node,wr.node),x,_[o].html,a,u,i),Ln[$r]=!0):ue(r,wr&&wr.node,null,_[o].html,a,u,i)}o++}for(let En in s)Ln[En]||r.removeChild(s[En].node)}}else{for(let p=0;p<=v&&p<=b;p++){let o=l[p].html,s=ie(_[p],o).html;ue(r,o.node,o,s,a,u,i)}for(let p=v+1;p<=b;p++){let o=ie(_[p],t).html;r.appendChild(zo(o,a,u,i))}for(let p=b+1;p<=v;p++)r.removeChild(l[p].html.node)}}return e.node=r,r},aD=(n,r)=>{for(let t=0;t<n.length;t++)if(n[t]!==r[t])return!0;return!1},oD=(n,r)=>r.reduce((t,e)=>t(e),n),ie=(n,r)=>(typeof n.html.type=="function"&&((!r||r.memo==null||aD(r.memo,n.html.memo))&&(r=Ra(oD(n.html.type,n.html.memo)),r.memo=n.html.memo),n.html=r),n),Ra=n=>({...n,children:n.children&&n.children.map(({key:r,html:t})=>({key:r,html:Ra(t)}))}),Ei=n=>r=>()=>n.actions[r],Fi=n=>r=>t=>e=>a=>()=>ue(n,r,t,e,u=>a(u)()),wi=n=>r=>(r.node=n,r);var iD=(n,r,t,e=!1)=>{let a={},u={style:a},i={tag:n,children:t,props:u,node:null,keyed:e},c=r.length;for(let f=0;f<c;f++){let[l,_,v]=r[f];l==1?u[_]=v:l===2?u.class=u.class?u.class+" "+_:_:l===3&&(a[_]=v)}return i},Kn=n=>r=>t=>iD(n,r,t.map(e=>({key:null,html:e})));var fD=n=>({tag:n,props:{},children:[],type:3});var Dr=n=>r=>[1,n,r],Dn=n=>[2,n];var ko=n=>r=>[1,"on"+n,r],Jo=n=>r=>[3,n,r],an=fD;function rs(n){return n.currentTarget}function Li(n){return n.type}var Ii=function(n){var r=E(n.Applicative0()),t=Rr(n.Plus1());return function(e){if(e)return r(void 0);if(!e)return t;throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): "+[e.constructor.name])}},ts={Applicative0:function(){return he},Plus1:function(){return Ec}};function as(n,r,t){return n==null?r:t(n)}var An=function(n){return as(n,D.value,d.create)};var Ue=function(n){return An(rs(n))};var DD=an("");var us=function(n){return function(r){if(n instanceof d)return r(n.value0);if(n instanceof D)return DD;throw new Error("Failed pattern match at Pha.Html.Core (line 82, column 1 - line 82, column 52): "+[n.constructor.name,r.constructor.name])}};var fe={first:function(n){return function(r){return new C(n(r.value0),r.value1)}},second:m(Yt),Profunctor0:function(){return Oo}};var Qo=function(n){return n.first};var xD=function(n){return n};var is=function(n){var r=Xn(n.Monad0().Bind1().Apply0().Functor0()),t=da(n);return function(e){return function(a){return r(t(xD(e)(a)))}}};var Pi=function(n){var r=m(n);return{map:function(t){return function(e){return function(a){return r(function(u){return new C(t(u.value0),u.value1)})(e(a))}}}}};var Ko=function(n){return{Applicative0:function(){return Wi(n)},Bind1:function(){return Ri(n)}}},Ri=function(n){var r=R(n.Bind1());return{bind:function(t){return function(e){return function(a){return r(t(a))(function(u){var i=e(u.value0);return i(u.value1)})}}},Apply0:function(){return Yo(n)}}},Yo=function(n){var r=Pi(n.Bind1().Apply0().Functor0());return{apply:_r(Ko(n)),Functor0:function(){return r}}},Wi=function(n){var r=E(n.Applicative0());return{pure:function(t){return function(e){return r(new C(t,e))}},Apply0:function(){return Yo(n)}}};var cs=function(n){var r=n.Monad0(),t=R(r.Bind1()),e=E(r.Applicative0()),a=ur(n),u=Ko(r);return{tailRecM:function(i){return function(c){var f=function(l){var _=i(l.value0);return t(_(l.value1))(function(v){return e(function(){if(v.value0 instanceof $n)return new $n(new C(v.value0.value0,v.value1));if(v.value0 instanceof Un)return new Un(new C(v.value0.value0,v.value1));throw new Error("Failed pattern match at Control.Monad.State.Trans (line 87, column 16 - line 89, column 40): "+[v.value0.constructor.name])}())})};return function(l){return a(f)(new C(c,l))}}},Monad0:function(){return u}}},ls=function(n){var r=E(n.Applicative0()),t=Ko(n);return{state:function(e){return function(a){return r(e(a))}},Monad0:function(){return t}}};var SD=Gn(Qu);var ss={liftAff:Z(en),MonadEffect0:function(){return $e}},Xo=function(n){return n.liftAff};var ps=function(n){var r=n.MonadEffect0(),t=Do(r);return{liftAff:function(){var e=SD(r.Monad0()),a=Xo(n);return function(u){return e(a(u))}}(),MonadEffect0:function(){return t}}};function $i(n){return function(r){return n===r}}var Ui=$i;var RD=ho(ga);var le=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Mt=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),qe=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Oe=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),qi=function(n){return n},Oi=gn,Bi=So;var Ha={state:function(n){return qi(Pe(le.create(n)))},Monad0:function(){return Bi}},vs=gi,zi=function(n){return{liftEffect:function(){var r=nr(n);return function(t){return qi(Pe(Mt.create(r(t))))}}(),Monad0:function(){return Bi}}},ds=function(n){return{ask:Pe(new Mt(Zr(n))),Monad0:function(){return Bi}}},WD=function(n){var r=zi(n.MonadEffect0());return{liftAff:function(){var t=Xo(n);return function(e){return qi(Pe(Mt.create(t(e))))}}(),MonadEffect0:function(){return r}}},Ds=function(n){var r=m(n);return{map:function(t){return function(e){if(e instanceof le)return new le(function(){var a=RD(t);return function(u){return a(e.value0(u))}}());if(e instanceof Mt)return new Mt(r(t)(e.value0));if(e instanceof qe)return new qe(e.value0,function(a){return t(e.value1(a))});if(e instanceof Oe)return new Oe(e.value0,t(e.value1));throw new Error("Failed pattern match at Pha.Update (line 43, column 1 - line 47, column 50): "+[t.constructor.name,e.constructor.name])}}}};var Zo=xa;var ys=Na;var hs=function(n){return function(r){return Cl(function(t){if(t instanceof le)return new le(t.value0);if(t instanceof Mt)return new Mt(n(t.value0));if(t instanceof qe)return new qe(t.value0,t.value1);if(t instanceof Oe)return new Oe(t.value0,t.value1);throw new Error("Failed pattern match at Pha.Update (line 105, column 45 - line 109, column 38): "+[t.constructor.name])})(r)}},gs=function(n){var r=Xo(WD(n));return function(t){return r(Ql(t))}};var se=function(n){return function(r){return function(){return r[n]}}},HD=se("URL"),$D=se("documentURI"),UD=se("origin"),qD=se("compatMode"),OD=se("characterSet"),BD=se("contentType");var zD=se("documentElement");function Ji(n){return function(r){return function(){return r.createTextNode(n)}}}function Ts(n,r,t,e){if(typeof window<"u"){var a=window[t];if(a!=null&&e instanceof a)return r(e)}for(var u=e;u!=null;){var i=Object.getPrototypeOf(u),c=i.constructor.name;if(c===t)return r(e);if(c==="Object")return n;u=i}return n}var M=function(n){return function(r){return Ts(D.value,d.create,n,r)}};var nu=function(n){return function(r){return r[n]}},jD=nu("namespaceURI"),VD=nu("prefix"),QD=nu("localName"),KD=nu("tagName");var ru=function(n){return function(r){return function(){return r[n]}}},XD=ru("children"),ZD=ru("firstElementChild"),ny=ru("lastElementChild"),ry=ru("childElementCount");function bs(n){return function(r){return function(){return r.querySelector(n)}}}var ey=m(tn);var Ms=function(n){var r=ey(An),t=bs(n);return function(e){return r(t(e))}};var Es=h;var Jr=function(n){return function(r){return function(){return r[n]}}};var fy=Jr("baseURI"),cy=Jr("ownerDocument"),Fs=Jr("parentNode"),ly=Jr("parentElement");var sy=Jr("childNodes"),py=Jr("firstChild"),my=Jr("lastChild"),_y=Jr("previousSibling"),vy=Jr("nextSibling"),dy=Jr("nodeValue");var Dy=Jr("textContent");function Gi(n){return function(r){return function(){r.appendChild(n)}}}var Ty=m(tn);var ws=function(){var n=Ty(An);return function(r){return n(Fs(r))}}();var Ls=h;var tu=function(){return window};var Is=h;var xs=h;function ji(n){return function(){return n.checked}}function Vi(n){return function(){return n.value}}var Qi=M("HTMLInputElement");function Ki(n){return function(){return n.value}}var Ps=M("HTMLSelectElement");function eu(n){return function(){return n.document}}var Yi=R(io),wh=Kr(Yr),$a=Eo(Xr)(Ca),Lh=ye(Xr),au=R(Sa),pe=nr($e),Xi=wh(Sa),Zi=E(Pa),Ih=Ho(Oi),xh=Eo(Pa)(Ca),Nh=qt(Oi),Ah=Dl(Ds(bi))(Yl),nf=ar(tn),Sh=m(tn),Ph=m(kn);var Rh=function(n){return Pr(n.state)},Wh=function(n){return function(){var t=Pr(n.freshId)();return rt(t+1|0)(n.freshId)(),t}},Rs=function(n){return n.update(n)},Hh=function(n){return function(r){return function(t){return function(){var a=t(r)();return $a(a)(Rs(n))()}}}},Ws=function(n){return function(r){var t=function(e){var a=Li(e);return $a(Ue(e))(function(u){return function(){var c=Ei(u)(a)();return Hh(n)(e)(c)()}})};return function(){var a=Pr(n.vdom)(),u=Pr(n.node)(),i=ws(u)();return $a(i)(function(c){var f=Ra(r);return function(){var _=Fi(c)(u)(a)(f)(t)();return rt(_)(n.node)(),rt(f)(n.vdom)()}})()}}},$h=function(n){return function(r){return function(){var e=Pr(n.state)();return Lh(Ui(e)(r))(function(){return rt(r)(n.state)(),Ws(n)(n.view(r))()})()}}},Hs=function(n){return function(r){return function(t){var e=function(a){if(a instanceof le)return au(pe(Rh(r)))(function(u){var i=a.value0(u);return Xi(pe($h(r)(i.value1)))(function(){return Zi(i.value0)})});if(a instanceof Mt)return a.value0;if(a instanceof qe)return au(pe(a.value0(function(u){return Mi(Hs(n)(r)(n(u)))})))(function(u){return au(pe(Wh(r)))(function(i){return Xi(pe(Tc(Ih(i)(u))(r.subscriptions)))(function(){return Zi(a.value1(i))})})});if(a instanceof Oe)return au(pe(Pr(r.subscriptions)))(function(u){return Xi(xh(Nh(a.value0)(u))(pe))(function(){return Zi(a.value1)})});throw new Error("Failed pattern match at Pha.App (line 114, column 3 - line 118, column 11): "+[a.constructor.name])};return Ah(e)(t)}}},Uh=function(n){return function(){var t=nf(Yi(tu)(eu))(Is)(),e=Sh(Ph(Es))(Ms(n.selector)(t))();return $a(e)(function(a){return function(){var i=tt(n.init.model)(),c=nf(Yi(nf(Yi(tu)(eu))(xs))(Ji("")))(Ls)();Gi(c)(a)();var f=tt(c)(),l=tt(wi(c)(an("")))(),_=tt(Re)(),v=tt(0)(),b={view:n.view,update:n.update,state:i,node:f,vdom:l,subscriptions:_,freshId:v};return Ws(b)(n.view(n.init.model))(),$a(n.init.msg)(Rs(b))()}})()}};var $s=function(n){var r=function(t){return function(e){return Mi(Hs(n.update)(t)(n.update(e)))}};return Uh({init:n.init,view:n.view,selector:n.selector,update:r})};var Us=function(n){return function(r){return function(t){return(t|0)===t?n(t):r}}},wn=function(n){return n},qs=function(n){return function(r){return function(t){var e;t<11?e="[0-"+(t-1).toString()+"]":t===11?e="[0-9a]":e="[0-9a-"+String.fromCharCode(86+t)+"]";var a=new RegExp("^[\\+\\-]?"+e+"+$","i");return function(u){if(a.test(u)){var i=parseInt(u,t);return(i|0)===i?n(i):r}else return r}}}};var ou=isFinite;var Ua=Math.floor;var qa=function(n){return function(r){return n%r}};var rf=Math.sin;var Os=_t(ia),Bs=Nt(ia);var Gh=function(){return qs(d.create)(D.value)}(),me=Gh(10),tf=function(){return Us(d.create)(D.value)}(),jh=function(n){if(!ou(n))return 0;if(n>=wn(Os))return Os;if(n<=wn(Bs))return Bs;if(sr)return Jn(0)(tf(n));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[n.constructor.name])};var iu=function(n){return jh(Ua(n))};var ef=Math.random;var zs=function(n){return function(r){return function(){var e=ef(),a=(wn(r)-wn(n)+1)*e+wn(n);return iu(a)}}};var Kh=be(Me),Yh=Ar();var ks=function(n){return n};var Js=1,af=2147483647,Gs=function(){return af-1|0}(),Xh=function(n){var r=function(t){return function(e){return function(a){var u=e-t|0,i=Kh(a)(u),c=i<t;return c?i+e|0:i}}};return r(Js)(Gs)(n)},of=m(tn)(Xh)(zs(Js)(Gs)),Zh=0,ng=48271,js=function(n){return function(r){return Yh(tf(qa(wn(ng)*wn(r)+wn(n))(wn(af))))}},Vs=js(Zh);var og=Br();var Xs=function(n){return function(r){return og(n(r))}};var Wr=function(n){return function(r){for(var t=n>r?-1:1,e=new Array(t*(r-n)+1),a=n,u=0;a!==r;)e[u++]=a,a+=t;return e[u]=a,e}},ig=function(n){return function(r){if(n<1)return[];var t=new Array(n);return t.fill(r)}},fg=function(n){return function(r){for(var t=[],e=0,a=0;a<n;a++)t[e++]=r;return t}},ze=typeof Array.prototype.fill=="function"?ig:fg,cg=function(){function n(a,u){this.head=a,this.tail=u}var r={};function t(a){return function(u){return new n(a,u)}}function e(a){for(var u=[],i=0,c=a;c!==r;)u[i++]=c.head,c=c.tail;return u}return function(a){return function(u){return e(a(t)(r)(u))}}}(),Ot=function(n){return n.length};var Zs=function(n){return function(r){return function(t){return function(e){return e<0||e>=t.length?r:n(t[e])}}}};var np=function(n){return function(r){return function(t){return function(e){for(var a=0,u=e.length;a<u;a++)if(t(e[a]))return n(a);return r}}}};var fu=function(n){if(n.length<=1e4)return Array.prototype.concat.apply([],n);for(var r=[],t=0,e=n.length;t<e;t++)for(var a=n[t],u=0,i=a.length;u<i;u++)r.push(a[u]);return r},_e=function(n){return function(r){return r.filter(n)}};var rp=function(){function n(r,t,e,a,u,i){var c,f,l,_,v,b,p;for(c=u+(i-u>>1),c-u>1&&n(r,t,a,e,u,c),i-c>1&&n(r,t,a,e,c,i),f=u,l=c,_=u;f<c&&l<i;)v=a[f],b=a[l],p=t(r(v)(b)),p>0?(e[_++]=b,++l):(e[_++]=v,++f);for(;f<c;)e[_++]=a[f++];for(;l<i;)e[_++]=a[l++]}return function(r){return function(t){return function(e){var a;return e.length<2?e:(a=e.slice(0),n(r,t,a,e.slice(0),0,e.length),a)}}}}();var ke=function(n){return function(r){for(var t=r.length,e=0;e<t;e++)if(!n(r[e]))return!1;return!0}},tp=function(n){return function(r){return n[r]}};var uf=function(n){return function(r){return function(){return r.push.apply(r,n)}}};var cu=function(n){return function(){return n}};function sg(n){return function(){return n.slice()}}var ff=sg,pg=function(){function n(r,t,e,a,u,i){var c,f,l,_,v,b,p;for(c=u+(i-u>>1),c-u>1&&n(r,t,a,e,u,c),i-c>1&&n(r,t,a,e,c,i),f=u,l=c,_=u;f<c&&l<i;)v=a[f],b=a[l],p=t(r(v)(b)),p>0?(e[_++]=b,++l):(e[_++]=v,++f);for(;f<c;)e[_++]=a[f++];for(;l<i;)e[_++]=a[l++]}return function(r){return function(t){return function(e){return function(){return e.length<2||n(r,t,e,e.slice(0),0,e.length),e}}}}}();var op=function(n){return function(r){return function(){var e=ff(r)();return n(e)(),cu(e)()}}};var cf=function(n){return uf([n])};var bg=m(kn);var Mg=U(pt);var cp=function(){return tp},Eg=cp();var sf=function(n){return rp(n)(function(r){if(r instanceof J)return 1;if(r instanceof G)return 0;if(r instanceof q)return-1;throw new Error("Failed pattern match at Data.Array (line 870, column 31 - line 873, column 11): "+[r.constructor.name])})};var pf=function(n){var r=Q(n);return function(t){return sf(r)(t)}},mf=function(n){return function(r){return op(cf(r))(n)()}};var _f=Rt(ba);var Oa=function(){return Zs(d.create)(D.value)}();var lp=fr(zr);var vf=function(){return np(d.create)(D.value)}();var df=function(n){return function(r){return bg(Eg(r))(vf(n)(r))}};var sp=function(n){var r=V(n);return function(t){return vf(function(e){return r(e)(t)})}};var Ba=function(n){var r=sp(n);return function(t){return function(e){return Ou(r(t)(e))}}};var lu=function(n){return function(r){return Mg([n])(r)}};var Fg=function(){function n(i){this.fn=i}var r={},t=function(i,c){this.head=i,this.tail=c};function e(i){return new t(i,r)}function a(i){return function(c){return new t(i,c)}}function u(i){for(var c=[],f=i;f!==r;)c.push(f.head),f=f.tail;return c}return function(i){return function(c){return function(f){var l=function(v,b){return i(c(a)(f(v)))(b)},_=function(v,b,p){if(b===0)return v;var o=p[b-1];return new n(function(){var s=_(l(o,v),b-1,p);return s})};return function(v){for(var b=c(e)(f(v[v.length-1])),p=_(b,v.length-1,v);p instanceof n;)p=p.fn();return c(u)(p)}}}}}();var Ag=hr(ao),Sg=Nr(ao);var mp=function(n){return cs(n)};var ve=function(n){return Pi(n)},_p=function(n){return Ri(n)},Pg=function(n){return Yo(n)},Ge=function(n){return Wi(n)};var Rg=function(n){return n};var vp=function(n){return Xs(Rg(n))};var Wg=function(n){var r=function(t){return new C(ks(t.newSeed),function(){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.newSeed=Vs(t.newSeed),e}())};return Er(ls(n))(r)};var Hg=function(n){var r=m(ve(n.Bind1().Apply0().Functor0())),t=Wg(n),e=hn(Pg(n));return function(a){return function(u){var i=wn(u),c=wn(a),f=function(v){return c+qa(v)(i-c+1)},l=r(wn)(t),_=e(r(Ag)(l))(r(Sg(2))(l));return r(function(v){return iu(f(v))})(_)}}},dp=function(n){var r=Hg(n);return function(t){return function(e){var a=t<=e;return a?r(t)(e):r(e)(t)}}};var $g=E(Ge(qr)),Ug=m(ve(nt)),qg=dp(qr);var Df=function(n){return n.length===0?$g(D.value):Ug(function(r){return Oa(n)(r)})(qg(0)(Ot(n)-1|0))};var Bg=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}},pu=R(wt),zg=Kr(Yr)(wt),kg=Ii(ts),hp=E(he),Jg=$o(gn)(zr),mu=ar(zn),Gg=z(dt),gp=E(Ge(qr)),jg=ar(ve(nt)),Vg=m(kn),Qg=Wo(Ne),Tp=ar(ut),Kg=m(ut),Yg=$o(so(gn)(gn))(zr),Xg=Gt(gn),Zg=be(Me),nT=la(Me),Dp=V(Ce(eo)),yp=R(Dt),rT=E(Vt),tT=m(zn),yf=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Cp=function(n){return function(r){var t=function(e){return pu(r)(function(a){return zg(kg((e-a|0)>=0))(function(){return hp({edge:a,dest:e-a|0})})})};return new yf(Jg(mu(Wr(0)(n))(function(e){return new C(e,t(e))})),n)}},bp=function(n){return{width:800,height:400,position:function(r){var t=r===0;if(t)return D.value;var e=r<=8;return e?new d({x:wn(r-1|0)*100,y:0}):new d({x:wn(r-9|0)*100,y:200})},edgeNames:mu(n)(function(r){return{edge:r,name:Gg(r)}})}},Mp=function(n){return n.value1},hf=function(n){var r=qt(n);return function(t){return function(e){var a=r(e)(t);if(a instanceof D)return gp(D.value);if(a instanceof d)return jg(Df(a.value0))(Vg(function(u){return{edge:u.edge,dest:u.dest}}));throw new Error("Failed pattern match at SM.Graph (line 104, column 3 - line 106, column 72): "+[a.constructor.name])}}},eT=function(n){var r=$o(n)(zr);return function(t){return function(e){var a=Qg(e.value0),u=mu(a)(function(i){return new C(t(i.value0),mu(i.value1)(function(c){return{edge:c.edge,dest:t(c.dest)}}))});return new yf(r(u),t(e.value1))}}},aT=eT(gn),Ep=function(n){var r=qt(n);return function(t){return function(e){var a=Jn([])(r(e)(t));return Df(pu(a)(function(u){return ze(u.nbBalls)({dest:u.dest,edge:u.edge})}))}}},Fp=function(n){var r=qt(n);return function(t){var e=Bg("t","SM.Graph",function(){return Tp(t.value0)(function(u){return ee(function(i){return ke(function(c){return Zn(!0)(function(f){return!ae(f)})(r(c.dest)(e(99)))})(u)})})}),a=e(98);return Kg(ae)(a)}},oT=function(n){return function(r){var t=function(a){return function(u){return _e(function(i){return i.dest.value0>=0&&i.dest.value1>=0})([{edge:0,dest:new C(a-1|0,u)},{edge:1,dest:new C(a-1|0,u-1|0)},{edge:2,dest:new C(a,u-1|0)}])}},e=Yg(pu(Wr(0)(n-1|0))(function(a){return pu(Wr(0)(r-1|0))(function(u){return hp(new C(new C(a,u),t(a)(u)))})}));return new yf(e,new C(n-1|0,r-1|0))}},wp=function(n){return function(r){return aT(function(t){return t.value0+(t.value1*n|0)|0})(oT(n)(r))}},Lp=function(n){return function(r){var t=Xg(n)(r);return{width:200*t|0,height:200*t|0,position:function(e){var a=e===0;return a?D.value:new d({x:50+200*wn(Zg(e)(n)),y:10+200*wn((r-nT(e)(n)|0)-1|0)})},edgeNames:[{edge:0,name:""}]}}},Ip=function(n){var r=qt(n),t=hf(n);return function(e){return function(a){return function(u){if(Dp(r(u)(a))(new d(!0)))return t(e)(u);if(sr)return gp(yp(r(u)(e))(function(i){return yp(df(function(c){return Dp(r(c.dest)(a))(new d(!0))})(i))(function(c){return rT({edge:c.edge,dest:c.dest})})}));throw new Error("Failed pattern match at SM.Graph (line 108, column 1 - line 109, column 92): "+[e.constructor.name,a.constructor.name,u.constructor.name])}}}},xp=function(n){return function(r){return function(t){return Tp(t.value0)(tT(function(e){return{edge:e.edge,dest:e.dest,nbBalls:r}}))}}};var uT=Ba(It),iT=pf(gn),Sp=Ep(gn),fT=xp(gn),cT=Fp(gn),lT=hf(gn),sT=Ip(gn),pT=R(_p(qr)),Ap=E(Ge(qr)),mT=ur(mp(Cc)),_T=Gt(gn),vT=ar(ut),dT=Nl(gn),DT=m(zn),yT=ar(zn),hT=ar(ve(nt)),za=function(){function n(){}return n.value=new n,n}(),_u=function(){function n(){}return n.value=new n,n}(),Bt=function(){function n(){}return n.value=new n,n}(),Hr=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Gr=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),je=function(){function n(){}return n.value=new n,n}(),ka=function(){function n(){}return n.value=new n,n}(),Ve=function(){function n(){}return n.value=new n,n}(),vu={eq:function(n){return function(r){return n instanceof za&&r instanceof za||n instanceof _u&&r instanceof _u||n instanceof Bt&&r instanceof Bt}}},gT={eq:function(n){return function(r){return n instanceof je&&r instanceof je||n instanceof ka&&r instanceof ka||n instanceof Ve&&r instanceof Ve}}},TT=Jt(gT),Pp=function(n){return function(r){if(uT(n)(r))return _e(function(t){return t!==n})(r);if(sr)return iT(lu(n)(r));throw new Error("Failed pattern match at SM.Model (line 68, column 1 - line 68, column 50): "+[n.constructor.name,r.constructor.name])}},CT=function(n){return Sp(n.graphWithBalls)},gf=function(n){var r=function(){if(n.config.graphType instanceof Hr)return Cp(n.config.graphType.value0)(n.config.graphType.value1);if(n.config.graphType instanceof Gr)return wp(n.config.graphType.value0)(n.config.graphType.value1);throw new Error("Failed pattern match at SM.Model (line 137, column 13 - line 139, column 32): "+[n.config.graphType.constructor.name])}(),t=fT(n.config.ballsPerColor)(r),e=cT(r);return{config:n.config,rawConfig:n.rawConfig,source:Mp(r),nbVictories:0,nbLosses:0,graphWithBalls:t,losingPositions:e,status:Bt.value,gameResult:D.value}},Rp=function(){var n={graphType:new Hr(8,[1,2]),adversary:je.value,ballsPerColor:6,reward:3,penalty:-1,machineStarts:!0};return gf({config:n,rawConfig:n,source:0,nbVictories:0,nbLosses:0,graphWithBalls:Re,losingPositions:Re,status:Bt.value,gameResult:D.value})}(),Wp=function(n){if(n instanceof ka)return"expert";if(n instanceof Ve)return"machine";if(n instanceof je)return"random";throw new Error("Failed pattern match at SM.Model (line 63, column 1 - line 63, column 39): "+[n.constructor.name])},bT=function(n){return function(r){if(n.config.adversary instanceof je)return lT(n.graphWithBalls)(r);if(n.config.adversary instanceof ka)return sT(n.graphWithBalls)(n.losingPositions)(r);if(n.config.adversary instanceof Ve)return Sp(n.graphWithBalls)(r);throw new Error("Failed pattern match at SM.Model (line 75, column 3 - line 78, column 52): "+[n.config.adversary.constructor.name])}},MT=function(n){var r=function(t){return pT(function(){return t.isMachineTurn?CT:bT}()(n)(t.pos))(function(e){if(e instanceof D)return Ap(new Un({moves:t.moves,win:!t.isMachineTurn}));if(e instanceof d)return Ap(new $n({moves:mf(t.moves)({pos:t.pos,edge:e.value0.edge,isMachineTurn:t.isMachineTurn}),isMachineTurn:!t.isMachineTurn,pos:e.value0.dest}));throw new Error("Failed pattern match at SM.Model (line 88, column 5 - line 94, column 10): "+[e.constructor.name])})};return mT(r)({moves:[],pos:n.source,isMachineTurn:n.config.machineStarts})},Hp=function(n){return n==="expert"?ka.value:n==="machine"?Ve.value:je.value},ET=function(n){return function(r){var t=function(a){return function(u){return _T(0)(u+function(){var i=!a&&TT(n.config.adversary)(Ve.value);if(i)return 0;var c=r.win===a;return c?n.config.reward:n.config.penalty}()|0)}},e=vT(lp(function(a){return Cn(dT)(a.pos)(function(){var u=DT(function(i){var c=a.edge!==i.edge;return c?i:{nbBalls:t(a.isMachineTurn)(i.nbBalls),edge:i.edge,dest:i.dest}});return function(i){return d.create(u(i))}}())})(n.graphWithBalls)(r.moves))(function(a){var u=ke(function(i){return function(c){return c===0}(function(c){return c.nbBalls}(i))})(a);return u?yT(a)(function(i){return{nbBalls:n.config.ballsPerColor,dest:i.dest,edge:i.edge}}):a});return{config:n.config,rawConfig:n.rawConfig,source:n.source,nbVictories:n.nbVictories+function(){return r.win?1:0}()|0,nbLosses:n.nbLosses+function(){return r.win?0:1}()|0,graphWithBalls:e,losingPositions:n.losingPositions,status:n.status,gameResult:new d({moves:r.moves,win:r.win})}}},$p=function(n){return hT(MT(n))(ET(n))};var FT=function(n){return function(r){var t=We(r.Profunctor0()),e=Qo(r);return function(a){return t(n)(function(u){return u.value1(u.value0)})(e(a))}}},Up=function(n){return function(r){return function(t){return FT(function(e){return new C(n(e),function(a){return r(e)(a)})})(t)}}};var Op=function(n){var r=Mr(n);return function(){return function(){return function(t){return function(e){return function(a){return st(r(t))(e)(a)}}}}}};var Bp=function(n){var r=Mr(n);return function(){return function(t){return function(e){return Vr(r(t))(e)}}}};var Cf=function(n){var r=Bp(n)(),t=Op(n)()();return function(){return function(){return function(e){return function(a){return Up(r(e))(Cn(t(e)))(a)}}}}};var du=function(){function n(){}return n.value=new n,n}(),Ja=function(){function n(){}return n.value=new n,n}(),Du=function(){function n(){}return n.value=new n,n}(),yu=function(){function n(){}return n.value=new n,n}(),hu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),gu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Tu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Cu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),bu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Mu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Eu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Fu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),wu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Lu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var xu=R(Zo),PT=Zr(ds(Sc(Aa))),kp=nr(zi(Do($e))),Ga=Kr(Yr)(Zo),Mf=E(ys),RT=Cf({reflectSymbol:function(){return"rawConfig"}})()(),WT=Cf({reflectSymbol:function(){return"graphType"}})()(),bf=we(Ha),Jp=Da(Ha),HT=Jt(vu),Gp=va(Ha),$T=gs(ps(ss)),UT=ur(vs),qT=Lt(Zo),ft=is(Ha),OT=function(n){return xu(PT)(function(r){return xu(kp(Pr(r.genModel)))(function(t){var e=vp(n)(t);return Ga(kp(rt(e.value1)(r.genModel)))(function(){return Mf(e.value0)})})})},BT=function(n){return RT(Vn.value)(n)},ct=BT(fe),zT=function(n){return WT(Vn.value)(n)},Iu=zT(fe),Ef=function(n){if(n instanceof du)return bf(function(t){return gf({config:t.rawConfig,rawConfig:t.rawConfig,source:t.source,nbVictories:t.nbVictories,nbLosses:t.nbLosses,graphWithBalls:t.graphWithBalls,losingPositions:t.losingPositions,status:t.status,gameResult:t.gameResult})});if(n instanceof Du){var r=function(t){return xu(Jp)(function(e){var a=HT(e.status)(za.value);return a?Ga(Gp(function(){var u={};for(var i in e)({}).hasOwnProperty.call(e,i)&&(u[i]=e[i]);return u.status=Bt.value,u}()))(function(){return Mf(new Un(void 0))}):Ga(Ef(Ja.value))(function(){return Ga($T(500))(function(){return Mf(new $n(void 0))})})})};return Ga(bf(function(t){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.status=za.value,e}))(function(){return UT(r)(void 0)})}if(n instanceof yu)return bf(function(t){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.status=_u.value,e});if(n instanceof Ja)return xu(Jp)(function(t){return qT(Gp)(OT($p(t)))});if(n instanceof hu)return ft(ct)(function(t){return{graphType:function(){var e=n.value0==="sub";return e?new Hr(8,[1,2]):new Gr(3,3)}(),adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof gu)return ft(function(t){return ct(Iu(t))})(function(t){return t instanceof Hr?new Hr(Jn(8)(me(n.value0)),t.value1):t});if(n instanceof Tu)return ft(function(t){return ct(Iu(t))})(function(t){return t instanceof Hr?new Hr(t.value0,Pp(n.value0)(t.value1)):t});if(n instanceof Cu)return ft(function(t){return ct(Iu(t))})(function(t){return t instanceof Gr?new Gr(Jn(3)(me(n.value0)),t.value1):t});if(n instanceof bu)return ft(function(t){return ct(Iu(t))})(function(t){return t instanceof Gr?new Gr(t.value0,Jn(3)(me(n.value0))):t});if(n instanceof Eu)return ft(ct)(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:Jn(3)(me(n.value0)),penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof Fu)return ft(ct)(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:Jn(-1)(me(n.value0)),machineStarts:t.machineStarts}});if(n instanceof Mu)return ft(ct)(function(t){return{graphType:t.graphType,adversary:Hp(n.value0),ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof wu)return ft(ct)(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:Jn(6)(me(n.value0)),reward:t.reward,penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof Lu)return ft(ct)(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:t.penalty,machineStarts:n.value0==="y"}});throw new Error("Failed pattern match at SM.Update (line 44, column 1 - line 44, column 38): "+[n.constructor.name])};var Nu=z(fa),Qe=z(dt);var jp=function(n){return function(r){return function(t){return function(e){return Dr("viewBox")(Qe(n)+(" "+(Qe(r)+(" "+(Qe(t)+(" "+Qe(e)))))))}}}},jn=Dr("value"),ja=Dr("type");var Vp=function(){var n=Dr("stroke-width");return function(r){return n(Nu(r))}}();var Qp=Dr("stroke");var Kp=function(){var n=Dr("r");return function(r){return n(Nu(r))}}();var Ff=function(){var n=Dr("min");return function(r){return n(Qe(r))}}();var wf=function(){var n=Dr("max");return function(r){return n(Qe(r))}}();var Lf=Dr("fill");var Yp=Dr("d"),Xp=function(){var n=Dr("cy");return function(r){return n(Nu(r))}}(),Zp=function(){var n=Dr("cx");return function(r){return n(Nu(r))}}();var nm=function(n){return Dr("checked")(n)};var rm=Kn("svg"),Au=Kn("span"),Ke=Kn("select");var tm=function(n){return Kn("path")(n)([])};var zt=Kn("option");var em=Kn("label"),Va=function(n){return Kn("input")(n)([])};var If=Kn("g");var Pn=Kn("div"),am=function(n){return Kn("circle")(n)([])},Qa=Kn("button"),om=Kn("br")([])([]);var Sf=E(Xr),xf=R(Dt),Nf=m(tn),Af=m(jr);var Pf=ko;var um=function(n){var r=function(t){var e=xf(Ue(t))(Qi);if(e instanceof D)return Sf(D.value);if(e instanceof d)return Nf(Af(d.create)(n))(ji(e.value0));throw new Error("Failed pattern match at Pha.Html.Events (line 75, column 9 - line 77, column 66): "+[e.constructor.name])};return Pf("change")(r)},Ka=function(n){return Pf("click")(function(r){return Sf(d.create(n(r)))})};var lt=function(n){var r=function(t){var e=xf(Ue(t))(Qi);if(e instanceof d)return Nf(Af(d.create)(n))(Vi(e.value0));if(e instanceof D){var a=xf(Ue(t))(Ps);if(a instanceof D)return Sf(D.value);if(a instanceof d)return Nf(Af(d.create)(n))(Ki(a.value0));throw new Error("Failed pattern match at Pha.Html.Events (line 67, column 17 - line 69, column 73): "+[a.constructor.name])}throw new Error("Failed pattern match at Pha.Html.Events (line 64, column 9 - line 69, column 73): "+[e.constructor.name])};return Pf("change")(r)};var im=z(fa),fm=function(n){return function(r){return"translate("+(n+(","+(r+")")))}};var Rf=function(n){return im(n)+"px"},cm=function(n){return im(n*100)+"%"};var Hf=U(pt),QT=R(wt),lr=z(dt),Xe=ar(zn),KT=uo(gn),YT=Wo(Ne),XT=Ba(It),ZT=V(vu),nC=function(n){return Hf(QT(n.moves)(function(r){return[an(function(){return r.isMachineTurn?"la machine":"l'adversaire"}()+(" prend "+(lr(r.edge)+(" jeton"+function(){var t=r.edge>1;return t?"s":""}())))),om]}))([an(function(){return n.win?"la machine":"l'adversaire"}()+" gagne")])},Ye="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",rC=function(n){return function(r){return Pn([Dn("flex flex-row justify-between mt-4 mb-2")])([Au([Dn("text-blue-600 font-bold")])([an("Victoires: "+lr(n))]),Pn([Dn("w-full bg-red-600 rounded-full h-6")])([Pn([Dn("h-6 bg-blue-600 rounded-l-full"),Jo("width")(cm(function(){var t=n+r|0,e=t===0;return e?.5:wn(n)/wn(t)}()))])([])]),Au([Dn("text-red-600 font-bold")])([an("D\xE9faites: "+lr(r))])])}},lm=function(n){var r=100*rf(wn(n+1|0));return r-Ua(r)},Wf="block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",tC=["yellow","red","cyan","lightgreen","magenta"],eC=function(n){return function(r){return function(t){return us(n.position(r))(function(e){return If([Jo("transform")(fm(Rf(e.x))(Rf(e.y)))])([tm([Yp("M1 1 L10 149 L90 149 L99 1"),Vp(3),Qp("#000"),Lf("transparent")]),If([])(function(){var a=fu(Xe(t)(function(i){return ze(i.nbBalls)(i.edge)})),u=KT(135)(Ot(a));return _f(function(i){return function(c){return am([Zp(15+lm(r+i|0)*71),Xp(140-lm((10+r|0)+i|0)*wn(u)),Kp(5),Lf(Jn("black")(Oa(tC)(c)))])}})(a)}())])})}}},aC=function(n){return function(r){return Pn([Dn("w-[50vw]")])([rm([jp(0)(0)(n.width)(n.height)])(Xe(YT(r))(Fe(eC(n))))])}},oC="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",Su="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",uC=function(n){return function(r){return Pn([Dn("max-w rounded overflow-hidden shadow-lg p-4")])([Pn([Dn("font-bold text-xl mb-2")])([an("Choix des param\xE8tres")]),Pn([Dn("grid grid-cols-2 gap-4")])(Hf([Pn([])([an("type de jeu")]),Ke([Dn(Ye),jn(function(){if(n.graphType instanceof Hr)return"sub";if(n.graphType instanceof Gr)return"king";throw new Error("Failed pattern match at SM.View (line 127, column 25 - line 129, column 35): "+[n.graphType.constructor.name])}()),lt(hu.create)])([zt([jn("sub")])([an("Soustraction")]),zt([jn("king")])([an("Roi")])])])(Hf(function(){if(n.graphType instanceof Hr)return[Pn([])([an("Nombre de casiers")]),Ke([Dn(Ye),jn(lr(n.graphType.value0)),lt(gu.create)])(Xe(Wr(8)(16))(function(t){return zt([jn(lr(t))])([an(lr(t))])})),Pn([])([an("Coups possibles")]),Pn([Dn("flex flex-row justify-between")])(Xe(Wr(1)(5))(function(t){return em([])([Va([ja("checkbox"),nm(XT(t)(n.graphType.value1)),Dn(oC),um(function(e){return new Tu(t)})]),Au([Dn("ml-2 text-sm font-medium text-gray-900")])([an(lr(t))])])}))];if(n.graphType instanceof Gr)return[Pn([])([an("Hauteur de la grille")]),Ke([Dn(Ye),jn(lr(n.graphType.value1)),lt(bu.create)])(Xe(Wr(3)(6))(function(t){return zt([jn(lr(t))])([an(lr(t))])})),Pn([])([an("Largeur de la grille")]),Ke([Dn(Ye),jn(lr(n.graphType.value0)),lt(Cu.create)])(Xe(Wr(3)(6))(function(t){return zt([jn(lr(t))])([an(lr(t))])}))];throw new Error("Failed pattern match at SM.View (line 136, column 12 - line 174, column 16): "+[n.graphType.constructor.name])}())([Pn([])([an("Adversaire")]),Kn("select")([Dn(Ye),jn(Wp(n.adversary)),lt(Mu.create)])([Kn("option")([jn("random")])([an("Al\xE9atoire")]),Kn("option")([jn("expert")])([an("Expert")]),Kn("option")([jn("machine")])([an("Machine")])]),Pn([])([an("Billes par couleur")]),Va([ja("number"),Dn(Wf),Ff(2),wf(10),jn(lr(n.ballsPerColor)),lt(wu.create)]),Pn([])([an("R\xE9compense")]),Va([ja("number"),Dn(Wf),Ff(1),jn(lr(n.reward)),lt(Eu.create)]),Pn([])([an("P\xE9nalit\xE9")]),Va([ja("number"),Dn(Wf),wf(0),jn(lr(n.penalty)),lt(Fu.create)]),Pn([])([an("La machine commence")]),Ke([Dn(Ye),jn(function(){return n.machineStarts?"y":"n"}()),lt(Lu.create)])([zt([jn("y")])([an("Oui")]),zt([jn("n")])([an("Non")])]),Qa([Dn(Su),Ka(function(t){return du.value})])([an("Pr\xE9parer la machine")]),function(){var t=ZT(r)(Bt.value);return t?Qa([Dn(Su),Ka(function(e){return Du.value})])([an("Lancer la machine")]):Qa([Dn(Su),Ka(function(e){return yu.value})])([an("Arr\xEAter la machine")])}(),Qa([Dn(Su),Ka(function(t){return Ja.value})])([an("Pas \xE0 pas")])])))])}},sm=function(n){var r=function(){if(n.config.graphType instanceof Hr)return bp(n.config.graphType.value1);if(n.config.graphType instanceof Gr)return Lp(n.config.graphType.value0)(n.config.graphType.value1);throw new Error("Failed pattern match at SM.View (line 243, column 15 - line 245, column 34): "+[n.config.graphType.constructor.name])}();return Pn([Dn("flex flex-row")])([Pn([Dn("max-w rounded overflow-hidden shadow-lg p-4 mr-4")])([Pn([Dn("font-bold text-xl mb-2")])([an("Visualisation de la machine")]),Pn([Dn("flex flex-col")])([aC(r)(n.graphWithBalls),rC(n.nbVictories)(n.nbLosses),Pn([])(Zn([])(nC)(n.gameResult))])]),uC(n.rawConfig)(n.status)])};var pm=function(){var r=of(),t=tt({newSeed:r,size:0})();return $s({init:{model:Rp,msg:D.value},view:sm,update:function(){var e=hs(Cn(Ic)({genModel:t}));return function(a){return e(Ef(a))}}(),selector:"#root"})()};pm();})();
