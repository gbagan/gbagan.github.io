(()=>{function Ne(t){let e=0,n;return()=>{if(e===2)return n;if(e===1)throw new Error("Binding demanded before initialized");return e=1,n=t(),e=2,n}}function $(){throw new Error("Failed pattern match")}var Ie=function(t){return function(e){return e[t]}},Ke=function(t){return function(e){return function(n){var a={};for(var o in n)({}).hasOwnProperty.call(n,o)&&(a[o]=n[o]);return a[t]=e,a}}};var ci=()=>({tag:"Proxy"}),Pt=ci();var at=function(t){return t.toString()},se=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var pr=t=>({tag:t}),vt=pr("LT"),zt=pr("GT"),ge=pr("EQ");var b=(t,e)=>({tag:t,_1:e}),m=b("Nothing"),H=t=>b("Just",t);var Tn=t=>{if(t.tag==="Nothing")return!0;if(t.tag==="Just")return!1;$()};var $r={compose:t=>e=>n=>t(e(n))};var $t=function(t){return function(e){for(var n=e.length,a=new Array(n),o=0;o<n;o++)a[o]=t(e[o]);return a}};var Mn=t=>t;var ie=function(t){return function(e){for(var n=[],a=0,o=t.length;a<o;a++)Array.prototype.push.apply(n,e(t[a]));return n}};var nt=(t,e)=>({tag:t,_1:e}),dn=t=>nt("Left",t),Kt=t=>nt("Right",t);var cn={map:t=>e=>{if(e.tag==="Left")return nt("Left",e._1);if(e.tag==="Right")return nt("Right",t(e._1));$()}};var Ln=t=>t;var _e={map:t=>e=>t(e)};var xa={apply:t=>e=>t(e),Functor0:()=>_e},_i={bind:t=>e=>e(t),Apply0:()=>xa},yi={pure:Ln,Apply0:()=>xa},te={Applicative0:()=>yi,Bind1:()=>_i};var Na=function(t){return function(){return t}};var hi={apply:t=>e=>()=>{let n=t(),a=e();return fr.pure(n(a))()},Functor0:()=>Di},fr={pure:Na,Apply0:()=>hi},Di={map:t=>e=>()=>{let n=e();return t(n)}};var It=(t,e)=>({tag:t,_1:e}),_r=t=>It("Loop",t),Ia=t=>It("Done",t);var Ea={tailRecM:t=>{let e=n=>{let a=n,o=!0,s;for(;o;){let d=a;if(d.tag==="Loop"){a=t(d._1);continue}if(d.tag==="Done"){o=!1,s=d._1;continue}$()}return s};return n=>e(t(n))},Monad0:()=>te};var qe=function(t){return function(e){return function(n){for(var a=e,o=n.length,s=o-1;s>=0;s--)a=t(n[s])(a);return a}}},en=function(t){return function(e){return function(n){for(var a=e,o=n.length,s=0;s<o;s++)a=t(a)(n[s]);return a}}};var yr=t=>{let e=t.Apply0(),n=e.Functor0().map;return a=>o=>a.foldr(s=>{let d=o(s);return u=>e.apply(n(f=>Mn)(d))(u)})(t.pure())},xn=t=>{let e=yr(t);return n=>{let a=e(n);return o=>s=>a(s)(o)}};var ln={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);$()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);$()},foldMap:t=>{let e=t.mempty;return n=>a=>{if(a.tag==="Nothing")return e;if(a.tag==="Just")return n(a._1);$()}}};var ue={foldr:qe,foldl:en,foldMap:t=>{let e=t.Semigroup0().append,n=t.mempty;return a=>ue.foldr(o=>s=>e(a(o))(s))(n)}};var _=(t,e)=>({tag:"Tuple",_1:t,_2:e});var ee=t=>t._2;var In={map:t=>e=>_(e._1,t(e._2))};var Se=t=>t._1;var En=t=>{let e=t.Eq0();return n=>{let a=n.Eq0(),o={eq:s=>d=>e.eq(s._1)(d._1)&&a.eq(s._2)(d._2)};return{compare:s=>d=>{let u=t.compare(s._1)(d._1);return u.tag==="LT"?vt:u.tag==="GT"?zt:n.compare(s._2)(d._2)},Eq0:()=>o}}};var S=(t,e,n)=>({tag:t,_1:e,_2:n});var P=S("Nil");var Ra=(()=>(e=>n=>{let a=e,o=n,s=!0,d;for(;s;){let u=a,f=o;if(f.tag==="Nil"){s=!1,d=u;continue}if(f.tag==="Cons"){a=S("Cons",f._1,u),o=f._2;continue}$()}return d})(P))();var Ui=function(){function t(o){return[o]}function e(o){return function(s){return[o,s]}}function n(o){return function(s){return function(d){return[o,s,d]}}}function a(o){return function(s){return o.concat(s)}}return function(o){return function(s){return function(d){return function(u){return function(f){function c(p,l){switch(l-p){case 0:return d([]);case 1:return s(t)(u(f[p]));case 2:return o(s(e)(u(f[p])))(u(f[p+1]));case 3:return o(o(s(n)(u(f[p])))(u(f[p+1])))(u(f[p+2]));default:var r=p+Math.floor((l-p)/4)*2;return o(s(a)(c(p,r)))(c(r,l))}}return c(0,f.length)}}}}}}();var Lt=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var Oa=t=>{let e=t,n=!0,a;for(;n;){let o=e;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){n=!1,a=m;continue}e=Lt(Ra(o._2),P);continue}if(o._1.tag==="Cons"){n=!1,a=b("Just",_(o._1._1,Lt(o._1._2,o._2)));continue}$()}return a};var Rt=(t,e,n)=>({tag:t,_1:e,_2:n}),K=Rt("CatNil");var Et=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return Rt("CatCons",t._1,Lt(t._2._1,S("Cons",e,t._2._2)));$()},yu=t=>e=>n=>{let a=s=>d=>u=>{let f=s,c=d,p=u,l=!0,r;for(;l;){let i=f,T=c,W=p;if(W.tag==="Nil"){l=!1,r=T;continue}if(W.tag==="Cons"){f=i,c=i(T)(W._1),p=W._2;continue}$()}return r};return(s=>d=>{let u=s,f=d,c=!0,p;for(;c;){let l=u,r=f,i=Oa(l);if(i.tag==="Nothing"){c=!1,p=a(T=>W=>W(T))(e)(r);continue}if(i.tag==="Just"){u=i._1._2,f=S("Cons",t(i._1._1),r);continue}$()}return p})(n)(P)},Qa=t=>{if(t.tag==="CatNil")return m;if(t.tag==="CatCons")return b("Just",_(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?K:yu(Et)(K)(t._2)));$()};var w=(t,e)=>({tag:"Free",_1:t,_2:e}),Z=(t,e,n)=>({tag:t,_1:e,_2:n});var ja=t=>{let e=t,n=!0,a;for(;n;){let o=e;if(o._1.tag==="Return"){let s=Qa(o._2);if(s.tag==="Nothing"){n=!1,a=Z("Return",o._1._1);continue}if(s.tag==="Just"){e=(()=>{let d=s._1._1(o._1._1);return w(d._1,Et(d._2)(s._1._2))})();continue}$()}if(o._1.tag==="Bind"){n=!1,a=Z("Bind",o._1._1,s=>{let d=o._1._2(s);return w(d._1,Et(d._2)(o._2))});continue}$()}return a},Va=t=>e=>{let n=e.Monad0(),a=n.Bind1().Apply0().Functor0().map,o=n.Applicative0().pure;return s=>e.tailRecM(d=>{let u=ja(d);if(u.tag==="Return")return a(Ia)(o(u._1));if(u.tag==="Bind")return a(_r)(s(t.map(u._2)(u._1)));$()})};var Nr={Applicative0:()=>An,Bind1:()=>Ir},Ka={map:t=>e=>Ir.bind(e)(n=>An.pure(t(n)))},Ir={bind:t=>e=>w(t._1,Et(t._2)(Rt("CatCons",e,Lt(P,P)))),Apply0:()=>Er},Er={apply:t=>e=>w(t._1,Et(t._2)(Rt("CatCons",n=>w(e._1,Et(e._2)(Rt("CatCons",a=>An.pure(n(a)),Lt(P,P)))),Lt(P,P)))),Functor0:()=>Ka},An={pure:t=>w(Z("Return",t),K),Apply0:()=>Er};var hu=t=>{let e=n=>{let a=ja(n);if(a.tag==="Return")return w(Z("Return",a._1),K);if(a.tag==="Bind"){let o=t(a._1);return w(o._1,Et(o._2)(Rt("CatCons",s=>e(a._2(s)),Lt(P,P))))}$()};return e},Ya=t=>hu(e=>w(Z("Bind",t(e),n=>w(Z("Return",n),K)),K));var Za=function(t){return function(e){return t===e}};var Xa=Za,to=Za;var eo={eq:to},ve={eq:Xa};var nn=function(t){var e=null;return function(){return t===void 0||(e=t(),t=void 0),e}},ze=function(t){return t()};var ro=function(t){return function(e){return function(n){return function(a){return function(o){return a<o?t:a===o?e:n}}}}};var ao=ro,oo=ro;var Ar={compare:oo(vt)(ge)(zt),Eq0:()=>eo},et={compare:ao(vt)(ge)(zt),Eq0:()=>ve};var io=function(t){return function(e){return function(n){return function(a){return function(o){return function(s){for(var d=[],u=s;;){var f=o(u);d.push(n(f));var c=a(f);if(t(c))return d;u=e(c)}}}}}}};var Mu=t=>{if(t.tag==="Just")return t._1;$()};var wr={unfoldr1:io(Tn)(Mu)(Se)(ee)};var co=function(t){return function(e){return function(n){return function(a){return function(o){return function(s){for(var d=[],u=s;;){var f=o(u);if(t(f))return d;var c=e(f);d.push(n(c)),u=a(c)}}}}}}};var Lu=t=>{if(t.tag==="Just")return t._1;$()};var Je={unfoldr:co(Tn)(Lu)(Se)(ee),Unfoldable10:()=>wr};var Dt=function(t){throw new Error(t)};var Rn=(t,e,n,a)=>({tag:"KickUp",_1:t,_2:e,_3:n,_4:a}),C=(t,e,n,a,o,s,d,u)=>({tag:t,_1:e,_2:n,_3:a,_4:o,_5:s,_6:d,_7:u}),st=(t,e,n,a,o,s,d)=>({tag:t,_1:e,_2:n,_3:a,_4:o,_5:s,_6:d});var z=C("Leaf");var Pn=t=>e=>{let n=a=>{let o=a,s=!0,d;for(;s;){let u=o;if(u.tag==="Nil"){s=!1,d=m;continue}if(u.tag==="Cons"){if(u._1.tag==="Leaf"){o=u._2;continue}if(u._1.tag==="Two"){if(u._1._1.tag==="Leaf"){if(u._1._4.tag==="Leaf"){s=!1,d=b("Just",_(_(u._1._2,u._1._3),u._2));continue}s=!1,d=b("Just",_(_(u._1._2,u._1._3),S("Cons",u._1._4,u._2)));continue}o=S("Cons",u._1._1,S("Cons",C("Two",z,u._1._2,u._1._3,z),S("Cons",u._1._4,u._2)));continue}if(u._1.tag==="Three"){o=S("Cons",u._1._1,S("Cons",C("Two",z,u._1._2,u._1._3,z),S("Cons",u._1._4,S("Cons",C("Two",z,u._1._5,u._1._6,z),S("Cons",u._1._7,u._2)))));continue}$()}$()}return d};return t.unfoldr(n)(S("Cons",e,P))};var re=t=>e=>a=>{let o=a,s=!0,d;for(;s;){let u=o;if(u.tag==="Leaf"){s=!1,d=m;continue}if(u.tag==="Two"){let f=t.compare(e)(u._2);if(f.tag==="EQ"){s=!1,d=b("Just",u._3);continue}if(f.tag==="LT"){o=u._1;continue}o=u._4;continue}if(u.tag==="Three"){let f=t.compare(e)(u._2);if(f.tag==="EQ"){s=!1,d=b("Just",u._3);continue}let c=t.compare(e)(u._5);if(c.tag==="EQ"){s=!1,d=b("Just",u._6);continue}if(f.tag==="LT"){o=u._1;continue}if(c.tag==="GT"){o=u._7;continue}o=u._4;continue}$()}return d};var ne={map:t=>e=>{if(e.tag==="Leaf")return z;if(e.tag==="Two")return C("Two",ne.map(t)(e._1),e._2,t(e._3),ne.map(t)(e._4));if(e.tag==="Three")return C("Three",ne.map(t)(e._1),e._2,t(e._3),ne.map(t)(e._4),e._5,t(e._6),ne.map(t)(e._7));$()}};var bt=t=>e=>n=>{let a=t,o=e,s=n,d=!0,u;for(;d;){let f=a,c=o,p=s;if(c.tag==="Nil"){d=!1,u=p;continue}if(c.tag==="Cons"){if(c._1.tag==="TwoLeft"){a=f,o=c._2,s=C("Two",p,c._1._1,c._1._2,c._1._3);continue}if(c._1.tag==="TwoRight"){a=f,o=c._2,s=C("Two",c._1._1,c._1._2,c._1._3,p);continue}if(c._1.tag==="ThreeLeft"){a=f,o=c._2,s=C("Three",p,c._1._1,c._1._2,c._1._3,c._1._4,c._1._5,c._1._6);continue}if(c._1.tag==="ThreeMiddle"){a=f,o=c._2,s=C("Three",c._1._1,c._1._2,c._1._3,p,c._1._4,c._1._5,c._1._6);continue}if(c._1.tag==="ThreeRight"){a=f,o=c._2,s=C("Three",c._1._1,c._1._2,c._1._3,c._1._4,c._1._5,c._1._6,p);continue}$()}$()}return u},Wn=t=>e=>n=>{let a=s=>d=>{let u=s,f=d,c=!0,p;for(;c;){let l=u,r=f;if(l.tag==="Nil"){c=!1,p=C("Two",r._1,r._2,r._3,r._4);continue}if(l.tag==="Cons"){if(l._1.tag==="TwoLeft"){c=!1,p=bt(t)(l._2)(C("Three",r._1,r._2,r._3,r._4,l._1._1,l._1._2,l._1._3));continue}if(l._1.tag==="TwoRight"){c=!1,p=bt(t)(l._2)(C("Three",l._1._1,l._1._2,l._1._3,r._1,r._2,r._3,r._4));continue}if(l._1.tag==="ThreeLeft"){u=l._2,f=Rn(C("Two",r._1,r._2,r._3,r._4),l._1._1,l._1._2,C("Two",l._1._3,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeMiddle"){u=l._2,f=Rn(C("Two",l._1._1,l._1._2,l._1._3,r._1),r._2,r._3,C("Two",r._4,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeRight"){u=l._2,f=Rn(C("Two",l._1._1,l._1._2,l._1._3,l._1._4),l._1._5,l._1._6,C("Two",r._1,r._2,r._3,r._4));continue}$()}$()}return p};return(s=>d=>{let u=s,f=d,c=!0,p;for(;c;){let l=u,r=f;if(r.tag==="Leaf"){c=!1,p=a(l)(Rn(z,e,n,z));continue}if(r.tag==="Two"){let i=t.compare(e)(r._2);if(i.tag==="EQ"){c=!1,p=bt(t)(l)(C("Two",r._1,e,n,r._4));continue}if(i.tag==="LT"){u=S("Cons",st("TwoLeft",r._2,r._3,r._4),l),f=r._1;continue}u=S("Cons",st("TwoRight",r._1,r._2,r._3),l),f=r._4;continue}if(r.tag==="Three"){let i=t.compare(e)(r._2);if(i.tag==="EQ"){c=!1,p=bt(t)(l)(C("Three",r._1,e,n,r._4,r._5,r._6,r._7));continue}let T=t.compare(e)(r._5);if(T.tag==="EQ"){c=!1,p=bt(t)(l)(C("Three",r._1,r._2,r._3,r._4,e,n,r._7));continue}if(i.tag==="LT"){u=S("Cons",st("ThreeLeft",r._2,r._3,r._4,r._5,r._6,r._7),l),f=r._1;continue}if(i.tag==="GT"){if(T.tag==="LT"){u=S("Cons",st("ThreeMiddle",r._1,r._2,r._3,r._5,r._6,r._7),l),f=r._4;continue}u=S("Cons",st("ThreeRight",r._1,r._2,r._3,r._4,r._5,r._6),l),f=r._7;continue}u=S("Cons",st("ThreeRight",r._1,r._2,r._3,r._4,r._5,r._6),l),f=r._7;continue}$()}return p})(P)},xu=t=>e=>{let n=d=>u=>{let f=d,c=u,p=!0,l;for(;p;){let r=f,i=c;if(r.tag==="Nil"){p=!1,l=i;continue}if(r.tag==="Cons"){let T=r._2,W=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G)=>bt(t)(T)(C("Two",C("Two",ot,rt,ct,Tt),B,lt,C("Two",ut,dt,G,Ct))),it=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G)=>bt(t)(T)(C("Two",C("Two",ot,rt,ct,Tt),B,lt,C("Two",ut,dt,G,Ct))),L=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G)=>bt(t)(T)(C("Two",C("Three",ot,rt,ct,Tt,B,lt,ut),dt,G,Ct)),V=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G)=>bt(t)(T)(C("Two",C("Three",ot,rt,ct,Tt,B,lt,ut),dt,G,Ct)),St=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G)=>bt(t)(T)(C("Two",ot,rt,ct,C("Three",Tt,B,lt,ut,dt,G,Ct))),At=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G)=>bt(t)(T)(C("Two",ot,rt,ct,C("Three",Tt,B,lt,ut,dt,G,Ct))),y=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G,Ht,Zt,me)=>bt(t)(T)(C("Three",C("Two",ot,B,G,Tt),dt,Ht,C("Two",ut,ct,Zt,Ct),lt,me,rt)),yt=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G,Ht,Zt,me)=>bt(t)(T)(C("Three",C("Two",ot,B,G,Tt),dt,Ht,C("Two",ut,ct,Zt,Ct),lt,me,rt)),kt=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G,Ht,Zt,me)=>bt(t)(T)(C("Three",ot,B,G,C("Two",Tt,dt,Ht,ut),ct,Zt,C("Two",Ct,lt,me,rt))),Pe=(ot,Tt,ut,Ct,rt,B,dt,ct,lt,G,Ht,Zt,me)=>bt(t)(T)(C("Three",ot,B,G,C("Two",Tt,dt,Ht,ut),ct,Zt,C("Two",Ct,lt,me,rt)));if(i.tag==="Leaf"){if(r._1.tag==="TwoLeft"){if(r._1._3.tag==="Leaf"){p=!1,l=bt(t)(T)(C("Two",z,r._1._1,r._1._2,z));continue}if(r._1._3.tag==="Two"){f=T,c=C("Three",i,r._1._1,r._1._2,r._1._3._1,r._1._3._2,r._1._3._3,r._1._3._4);continue}if(r._1._3.tag==="Three"){p=!1,l=W(i,r._1._3._1,r._1._3._4,r._1._3._7,r._1._1,r._1._3._2,r._1._3._5,r._1._2,r._1._3._3,r._1._3._6);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="TwoRight"){if(r._1._1.tag==="Leaf"){p=!1,l=bt(t)(T)(C("Two",z,r._1._2,r._1._3,z));continue}if(r._1._1.tag==="Two"){f=T,c=C("Three",r._1._1._1,r._1._1._2,r._1._1._3,r._1._1._4,r._1._2,r._1._3,i);continue}if(r._1._1.tag==="Three"){p=!1,l=it(r._1._1._1,r._1._1._4,r._1._1._7,i,r._1._1._2,r._1._1._5,r._1._2,r._1._1._3,r._1._1._6,r._1._3);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeLeft"){if(r._1._6.tag==="Leaf"){if(r._1._3.tag==="Leaf"){p=!1,l=bt(t)(T)(C("Three",z,r._1._1,r._1._2,z,r._1._4,r._1._5,z));continue}if(r._1._3.tag==="Two"){p=!1,l=L(i,r._1._3._1,r._1._3._4,r._1._6,r._1._1,r._1._3._2,r._1._4,r._1._2,r._1._3._3,r._1._5);continue}if(r._1._3.tag==="Three"){p=!1,l=y(i,r._1._3._1,r._1._3._4,r._1._3._7,r._1._6,r._1._1,r._1._3._2,r._1._3._5,r._1._4,r._1._2,r._1._3._3,r._1._3._6,r._1._5);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1._3.tag==="Two"){p=!1,l=L(i,r._1._3._1,r._1._3._4,r._1._6,r._1._1,r._1._3._2,r._1._4,r._1._2,r._1._3._3,r._1._5);continue}if(r._1._3.tag==="Three"){p=!1,l=y(i,r._1._3._1,r._1._3._4,r._1._3._7,r._1._6,r._1._1,r._1._3._2,r._1._3._5,r._1._4,r._1._2,r._1._3._3,r._1._3._6,r._1._5);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeMiddle"){if(r._1._1.tag==="Leaf"){if(r._1._6.tag==="Leaf"){p=!1,l=bt(t)(T)(C("Three",z,r._1._2,r._1._3,z,r._1._4,r._1._5,z));continue}if(r._1._6.tag==="Two"){p=!1,l=St(r._1._1,i,r._1._6._1,r._1._6._4,r._1._2,r._1._4,r._1._6._2,r._1._3,r._1._5,r._1._6._3);continue}if(r._1._6.tag==="Three"){p=!1,l=kt(r._1._1,i,r._1._6._1,r._1._6._4,r._1._6._7,r._1._2,r._1._4,r._1._6._2,r._1._6._5,r._1._3,r._1._5,r._1._6._3,r._1._6._6);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1._1.tag==="Two"){p=!1,l=V(r._1._1._1,r._1._1._4,i,r._1._6,r._1._1._2,r._1._2,r._1._4,r._1._1._3,r._1._3,r._1._5);continue}if(r._1._6.tag==="Two"){p=!1,l=St(r._1._1,i,r._1._6._1,r._1._6._4,r._1._2,r._1._4,r._1._6._2,r._1._3,r._1._5,r._1._6._3);continue}if(r._1._1.tag==="Three"){p=!1,l=yt(r._1._1._1,r._1._1._4,r._1._1._7,i,r._1._6,r._1._1._2,r._1._1._5,r._1._2,r._1._4,r._1._1._3,r._1._1._6,r._1._3,r._1._5);continue}if(r._1._6.tag==="Three"){p=!1,l=kt(r._1._1,i,r._1._6._1,r._1._6._4,r._1._6._7,r._1._2,r._1._4,r._1._6._2,r._1._6._5,r._1._3,r._1._5,r._1._6._3,r._1._6._6);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeRight"){if(r._1._1.tag==="Leaf"){if(r._1._4.tag==="Leaf"){p=!1,l=bt(t)(T)(C("Three",z,r._1._2,r._1._3,z,r._1._5,r._1._6,z));continue}if(r._1._4.tag==="Two"){p=!1,l=At(r._1._1,r._1._4._1,r._1._4._4,i,r._1._2,r._1._4._2,r._1._5,r._1._3,r._1._4._3,r._1._6);continue}if(r._1._4.tag==="Three"){p=!1,l=Pe(r._1._1,r._1._4._1,r._1._4._4,r._1._4._7,i,r._1._2,r._1._4._2,r._1._4._5,r._1._5,r._1._3,r._1._4._3,r._1._4._6,r._1._6);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1._4.tag==="Two"){p=!1,l=At(r._1._1,r._1._4._1,r._1._4._4,i,r._1._2,r._1._4._2,r._1._5,r._1._3,r._1._4._3,r._1._6);continue}if(r._1._4.tag==="Three"){p=!1,l=Pe(r._1._1,r._1._4._1,r._1._4._4,r._1._4._7,i,r._1._2,r._1._4._2,r._1._4._5,r._1._5,r._1._3,r._1._4._3,r._1._4._6,r._1._6);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="TwoLeft"){if(r._1._3.tag==="Two"){f=T,c=C("Three",i,r._1._1,r._1._2,r._1._3._1,r._1._3._2,r._1._3._3,r._1._3._4);continue}if(r._1._3.tag==="Three"){p=!1,l=W(i,r._1._3._1,r._1._3._4,r._1._3._7,r._1._1,r._1._3._2,r._1._3._5,r._1._2,r._1._3._3,r._1._3._6);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="TwoRight"){if(r._1._1.tag==="Two"){f=T,c=C("Three",r._1._1._1,r._1._1._2,r._1._1._3,r._1._1._4,r._1._2,r._1._3,i);continue}if(r._1._1.tag==="Three"){p=!1,l=it(r._1._1._1,r._1._1._4,r._1._1._7,i,r._1._1._2,r._1._1._5,r._1._2,r._1._1._3,r._1._1._6,r._1._3);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeLeft"){if(r._1._3.tag==="Two"){p=!1,l=L(i,r._1._3._1,r._1._3._4,r._1._6,r._1._1,r._1._3._2,r._1._4,r._1._2,r._1._3._3,r._1._5);continue}if(r._1._3.tag==="Three"){p=!1,l=y(i,r._1._3._1,r._1._3._4,r._1._3._7,r._1._6,r._1._1,r._1._3._2,r._1._3._5,r._1._4,r._1._2,r._1._3._3,r._1._3._6,r._1._5);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeMiddle"){if(r._1._1.tag==="Two"){p=!1,l=V(r._1._1._1,r._1._1._4,i,r._1._6,r._1._1._2,r._1._2,r._1._4,r._1._1._3,r._1._3,r._1._5);continue}if(r._1._6.tag==="Two"){p=!1,l=St(r._1._1,i,r._1._6._1,r._1._6._4,r._1._2,r._1._4,r._1._6._2,r._1._3,r._1._5,r._1._6._3);continue}if(r._1._1.tag==="Three"){p=!1,l=yt(r._1._1._1,r._1._1._4,r._1._1._7,i,r._1._6,r._1._1._2,r._1._1._5,r._1._2,r._1._4,r._1._1._3,r._1._1._6,r._1._3,r._1._5);continue}if(r._1._6.tag==="Three"){p=!1,l=kt(r._1._1,i,r._1._6._1,r._1._6._4,r._1._6._7,r._1._2,r._1._4,r._1._6._2,r._1._6._5,r._1._3,r._1._5,r._1._6._3,r._1._6._6);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeRight"){if(r._1._4.tag==="Two"){p=!1,l=At(r._1._1,r._1._4._1,r._1._4._4,i,r._1._2,r._1._4._2,r._1._5,r._1._3,r._1._4._3,r._1._6);continue}if(r._1._4.tag==="Three"){p=!1,l=Pe(r._1._1,r._1._4._1,r._1._4._4,r._1._4._7,i,r._1._2,r._1._4._2,r._1._4._5,r._1._5,r._1._3,r._1._4._3,r._1._4._6,r._1._6);continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}p=!1,l=Dt("The impossible happened in partial function `up`.");continue}$()}return l},a=d=>u=>{let f=d,c=u,p=!0,l;for(;p;){let r=f,i=c;if(i.tag==="Two"){if(i._1.tag==="Leaf"){if(i._4.tag==="Leaf"){p=!1,l=n(r)(z);continue}f=S("Cons",st("TwoRight",i._1,i._2,i._3),r),c=i._4;continue}f=S("Cons",st("TwoRight",i._1,i._2,i._3),r),c=i._4;continue}if(i.tag==="Three"){if(i._1.tag==="Leaf"){if(i._4.tag==="Leaf"){if(i._7.tag==="Leaf"){p=!1,l=n(S("Cons",st("TwoRight",z,i._2,i._3),r))(z);continue}f=S("Cons",st("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),r),c=i._7;continue}f=S("Cons",st("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),r),c=i._7;continue}f=S("Cons",st("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),r),c=i._7;continue}p=!1,l=Dt("The impossible happened in partial function `removeMaxNode`.")}return l},o=d=>{let u=d,f=!0,c;for(;f;){let p=u;if(p.tag==="Two"){if(p._4.tag==="Leaf"){f=!1,c={key:p._2,value:p._3};continue}u=p._4;continue}if(p.tag==="Three"){if(p._7.tag==="Leaf"){f=!1,c={key:p._5,value:p._6};continue}u=p._7;continue}f=!1,c=Dt("The impossible happened in partial function `maxNode`.")}return c};return(d=>u=>{let f=d,c=u,p=!0,l;for(;p;){let r=f,i=c;if(i.tag==="Leaf"){p=!1,l=m;continue}if(i.tag==="Two"){let T=t.compare(e)(i._2);if(T.tag==="EQ"){if(i._4.tag==="Leaf"){p=!1,l=b("Just",_(i._3,n(r)(z)));continue}let W=o(i._1);p=!1,l=b("Just",_(i._3,a(S("Cons",st("TwoLeft",W.key,W.value,i._4),r))(i._1)));continue}if(T.tag==="LT"){f=S("Cons",st("TwoLeft",i._2,i._3,i._4),r),c=i._1;continue}f=S("Cons",st("TwoRight",i._1,i._2,i._3),r),c=i._4;continue}if(i.tag==="Three"){let T=t.compare(e)(i._5),W=t.compare(e)(i._2);if((()=>i._1.tag==="Leaf"&&i._4.tag==="Leaf"?i._7.tag==="Leaf":!1)()){if(W.tag==="EQ"){p=!1,l=b("Just",_(i._3,bt(t)(r)(C("Two",z,i._5,i._6,z))));continue}if(T.tag==="EQ"){p=!1,l=b("Just",_(i._6,bt(t)(r)(C("Two",z,i._2,i._3,z))));continue}if(W.tag==="LT"){f=S("Cons",st("ThreeLeft",i._2,i._3,i._4,i._5,i._6,i._7),r),c=i._1;continue}if(W.tag==="GT"){if(T.tag==="LT"){f=S("Cons",st("ThreeMiddle",i._1,i._2,i._3,i._5,i._6,i._7),r),c=i._4;continue}f=S("Cons",st("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),r),c=i._7;continue}f=S("Cons",st("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),r),c=i._7;continue}if(W.tag==="EQ"){let it=o(i._1);p=!1,l=b("Just",_(i._3,a(S("Cons",st("ThreeLeft",it.key,it.value,i._4,i._5,i._6,i._7),r))(i._1)));continue}if(T.tag==="EQ"){let it=o(i._4);p=!1,l=b("Just",_(i._6,a(S("Cons",st("ThreeMiddle",i._1,i._2,i._3,it.key,it.value,i._7),r))(i._4)));continue}if(W.tag==="LT"){f=S("Cons",st("ThreeLeft",i._2,i._3,i._4,i._5,i._6,i._7),r),c=i._1;continue}if(W.tag==="GT"){if(T.tag==="LT"){f=S("Cons",st("ThreeMiddle",i._1,i._2,i._3,i._5,i._6,i._7),r),c=i._4;continue}f=S("Cons",st("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),r),c=i._7;continue}f=S("Cons",st("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),r),c=i._7;continue}$()}return l})(P)};var qn=t=>e=>e.foldl(n=>a=>Wn(t)(a._1)(a._2)(n))(z);var Nu=t=>e=>n=>{let a=xu(t)(e)(n);if(a.tag==="Nothing")return n;if(a.tag==="Just")return a._1._2;$()};var Iu=t=>e=>n=>a=>{let o=e(re(t)(n)(a));if(o.tag==="Nothing")return Nu(t)(n)(a);if(o.tag==="Just")return Wn(t)(n)(o._1)(a);$()};var Rr=t=>e=>n=>a=>Iu(t)(o=>{if(o.tag==="Nothing")return m;if(o.tag==="Just")return e(o._1);$()})(n)(a);function qt(t,e,n){return t==null?e:n(t)}var Ot=function(){var t={},e="Pure",n="Throw",a="Catch",o="Sync",s="Async",d="Bind",u="Bracket",f="Fork",c="Sequential",p="Map",l="Apply",r="Alt",i="Cons",T="Resume",W="Release",it="Finalizer",L="Finalized",V="Forked",St="Fiber",At="Thunk";function y(D,k,mt,Q){this.tag=D,this._1=k,this._2=mt,this._3=Q}function yt(D){var k=function(mt,Q,x){return new y(D,mt,Q,x)};return k.tag=D,k}function kt(D){return new y(e,void 0)}function Pe(D){try{D()}catch(k){setTimeout(function(){throw k},0)}}function ot(D,k,mt){try{return k(mt())}catch(Q){return D(Q)}}function Tt(D,k,mt){try{return k(mt)()}catch(Q){return mt(D(Q))(),kt}}var ut=function(){var D=1024,k=0,mt=0,Q=new Array(D),x=!1;function g(){var O;for(x=!0;k!==0;)k--,O=Q[mt],Q[mt]=void 0,mt=(mt+1)%D,O();x=!1}return{isDraining:function(){return x},enqueue:function(O){var A,pt;k===D&&(pt=x,g(),x=pt),Q[(mt+k)%D]=O,k++,x||g()}}}();function Ct(D){var k={},mt=0,Q=0;return{register:function(x){var g=mt++;x.onComplete({rethrow:!0,handler:function(O){return function(){Q--,delete k[g]}}})(),k[g]=x,Q++},isEmpty:function(){return Q===0},killAll:function(x,g){return function(){if(Q===0)return g();var O=0,A={};function pt(Y){A[Y]=k[Y].kill(x,function(ht){return function(){delete A[Y],O--,D.isLeft(ht)&&D.fromLeft(ht)&&setTimeout(function(){throw D.fromLeft(ht)},0),O===0&&g()}})()}for(var Nt in k)k.hasOwnProperty(Nt)&&(O++,pt(Nt));return k={},mt=0,Q=0,function(Y){return new y(o,function(){for(var ht in A)A.hasOwnProperty(ht)&&A[ht]()})}}}}}var rt=0,B=1,dt=2,ct=3,lt=4,G=5,Ht=6;function Zt(D,k,mt){var Q=0,x=rt,g=mt,O=null,A=null,pt=null,Nt=null,Y=null,ht=0,We=0,jt=null,Le=!0;function xe(N){for(var I,q,J;;)switch(I=null,q=null,J=null,x){case dt:x=B;try{g=pt(g),Nt===null?pt=null:(pt=Nt._1,Nt=Nt._2)}catch(wt){x=G,O=D.left(wt),g=null}break;case ct:D.isLeft(g)?(x=G,O=g,g=null):pt===null?x=G:(x=dt,g=D.fromRight(g));break;case B:switch(g.tag){case d:pt&&(Nt=new y(i,pt,Nt)),pt=g._2,x=B,g=g._1;break;case e:pt===null?(x=G,g=D.right(g._1)):(x=dt,g=g._1);break;case o:x=ct,g=ot(D.left,D.right,g._1);break;case s:x=lt,g=Tt(D.left,g._1,function(wt){return function(){Q===N&&(Q++,ut.enqueue(function(){Q===N+1&&(x=ct,g=wt,xe(Q))}))}});return;case n:x=G,O=D.left(g._1),g=null;break;case a:pt===null?Y=new y(i,g,Y,A):Y=new y(i,g,new y(i,new y(T,pt,Nt),Y,A),A),pt=null,Nt=null,x=B,g=g._1;break;case u:ht++,pt===null?Y=new y(i,g,Y,A):Y=new y(i,g,new y(i,new y(T,pt,Nt),Y,A),A),pt=null,Nt=null,x=B,g=g._1;break;case f:x=ct,I=Zt(D,k,g._2),k&&k.register(I),g._1&&I.run(),g=D.right(I);break;case c:x=B,g=ui(D,k,g._1);break}break;case G:if(pt=null,Nt=null,Y===null)x=Ht,g=A||O||g;else switch(I=Y._3,J=Y._1,Y=Y._2,J.tag){case a:A&&A!==I&&ht===0?x=G:O&&(x=B,g=J._2(D.fromLeft(O)),O=null);break;case T:A&&A!==I&&ht===0||O?x=G:(pt=J._1,Nt=J._2,x=dt,g=D.fromRight(g));break;case u:ht--,O===null&&(q=D.fromRight(g),Y=new y(i,new y(W,J._2,q),Y,I),(A===I||ht>0)&&(x=B,g=J._3(q)));break;case W:Y=new y(i,new y(L,g,O),Y,A),x=B,A&&A!==I&&ht===0?g=J._1.killed(D.fromLeft(A))(J._2):O?g=J._1.failed(D.fromLeft(O))(J._2):g=J._1.completed(D.fromRight(g))(J._2),O=null,ht++;break;case it:ht++,Y=new y(i,new y(L,g,O),Y,A),x=B,g=J._1;break;case L:ht--,x=G,g=J._1,O=J._2;break}break;case Ht:for(var _t in jt)jt.hasOwnProperty(_t)&&(Le=Le&&jt[_t].rethrow,Pe(jt[_t].handler(g)));jt=null,A&&O?setTimeout(function(){throw D.fromLeft(O)},0):D.isLeft(g)&&Le&&setTimeout(function(){if(Le)throw D.fromLeft(g)},0);return;case rt:x=B;break;case lt:return}}function gt(N){return function(){if(x===Ht)return Le=Le&&N.rethrow,N.handler(g)(),function(){};var I=We++;return jt=jt||{},jt[I]=N,function(){jt!==null&&delete jt[I]}}}function E(N,I){return function(){if(x===Ht)return I(D.right(void 0))(),function(){};var q=gt({rethrow:!1,handler:function(){return I(D.right(void 0))}})();switch(x){case rt:A=D.left(N),x=Ht,g=A,xe(Q);break;case lt:A===null&&(A=D.left(N)),ht===0&&(x===lt&&(Y=new y(i,new y(it,g(N)),Y,A)),x=G,g=null,O=null,xe(++Q));break;default:A===null&&(A=D.left(N)),ht===0&&(x=G,g=null,O=null)}return q}}function R(N){return function(){var I=gt({rethrow:!1,handler:N})();return x===rt&&xe(Q),I}}return{kill:E,join:R,onComplete:gt,isSuspended:function(){return x===rt},run:function(){x===rt&&(ut.isDraining()?xe(Q):ut.enqueue(function(){xe(Q)}))}}}function me(D,k,mt,Q){var x=0,g={},O=0,A={},pt=new Error("[ParAff] Early exit"),Nt=null,Y=t;function ht(gt,E,R){var N=E,I=null,q=null,J=0,_t={},wt,un;t:for(;;)switch(wt=null,N.tag){case V:if(N._3===t&&(wt=g[N._1],_t[J++]=wt.kill(gt,function(di){return function(){J--,J===0&&R(di)()}})),I===null)break t;N=I._2,q===null?I=null:(I=q._1,q=q._2);break;case p:N=N._2;break;case l:case r:I&&(q=new y(i,I,q)),I=N,N=N._1;break}if(J===0)R(D.right(void 0))();else for(un=0,wt=J;un<wt;un++)_t[un]=_t[un]();return _t}function We(gt,E,R){var N,I,q,J,_t,wt;D.isLeft(gt)?(N=gt,I=null):(I=gt,N=null);t:for(;;){if(q=null,J=null,_t=null,wt=null,Nt!==null)return;if(E===null){Q(N||I)();return}if(E._3!==t)return;switch(E.tag){case p:N===null?(E._3=D.right(E._1(D.fromRight(I))),I=E._3):E._3=N;break;case l:if(q=E._1._3,J=E._2._3,N){if(E._3=N,_t=!0,wt=O++,A[wt]=ht(pt,N===q?E._2:E._1,function(){return function(){delete A[wt],_t?_t=!1:R===null?We(N,null,null):We(N,R._1,R._2)}}),_t){_t=!1;return}}else{if(q===t||J===t)return;I=D.right(D.fromRight(q)(D.fromRight(J))),E._3=I}break;case r:if(q=E._1._3,J=E._2._3,q===t&&D.isLeft(J)||J===t&&D.isLeft(q))return;if(q!==t&&D.isLeft(q)&&J!==t&&D.isLeft(J))N=I===q?J:q,I=null,E._3=N;else if(E._3=I,_t=!0,wt=O++,A[wt]=ht(pt,I===q?E._2:E._1,function(){return function(){delete A[wt],_t?_t=!1:R===null?We(I,null,null):We(I,R._1,R._2)}}),_t){_t=!1;return}break}R===null?E=null:(E=R._1,R=R._2)}}function jt(gt){return function(E){return function(){delete g[gt._1],gt._3=E,We(E,gt._2._1,gt._2._2)}}}function Le(){var gt=B,E=mt,R=null,N=null,I,q;t:for(;;)switch(I=null,q=null,gt){case B:switch(E.tag){case p:R&&(N=new y(i,R,N)),R=new y(p,E._1,t,t),E=E._2;break;case l:R&&(N=new y(i,R,N)),R=new y(l,t,E._2,t),E=E._1;break;case r:R&&(N=new y(i,R,N)),R=new y(r,t,E._2,t),E=E._1;break;default:q=x++,gt=G,I=E,E=new y(V,q,new y(i,R,N),t),I=Zt(D,k,I),I.onComplete({rethrow:!1,handler:jt(E)})(),g[q]=I,k&&k.register(I)}break;case G:if(R===null)break t;R._1===t?(R._1=E,gt=B,E=R._2,R._2=t):(R._2=E,E=R,N===null?R=null:(R=N._1,N=N._2))}for(Y=E,q=0;q<x;q++)g[q].run()}function xe(gt,E){Nt=D.left(gt);var R;for(var N in A)if(A.hasOwnProperty(N)){R=A[N];for(N in R)R.hasOwnProperty(N)&&R[N]()}A=null;var I=ht(gt,Y,E);return function(q){return new y(s,function(J){return function(){for(var _t in I)I.hasOwnProperty(_t)&&I[_t]();return kt}})}}return Le(),function(gt){return new y(s,function(E){return function(){return xe(gt,E)}})}}function ui(D,k,mt){return new y(s,function(Q){return function(){return me(D,k,mt,Q)}})}return y.EMPTY=t,y.Pure=yt(e),y.Throw=yt(n),y.Catch=yt(a),y.Sync=yt(o),y.Async=yt(s),y.Bind=yt(d),y.Bracket=yt(u),y.Fork=yt(f),y.Seq=yt(c),y.ParMap=yt(p),y.ParApply=yt(l),y.ParAlt=yt(r),y.Fiber=Zt,y.Supervisor=Ct,y.Scheduler=ut,y.nonCanceler=kt,y}(),be=Ot.Pure,Wu=Ot.Throw;function fo(t){return function(e){return e.tag===Ot.Pure.tag?Ot.Pure(t(e._1)):Ot.Bind(e,function(n){return Ot.Pure(t(n))})}}function Qt(t){return function(e){return Ot.Bind(t,e)}}var de=Ot.Sync;var qu=Ot.Async;function vn(t,e){return function(){return Ot.Fiber(t,null,e)}}var Pr=function(){function t(n,a){return n===0&&typeof setImmediate<"u"?setImmediate(a):setTimeout(a,n)}function e(n,a){return n===0&&typeof clearImmediate<"u"?clearImmediate(a):clearTimeout(a)}return function(n,a){return Ot.Async(function(o){return function(){var s=t(a,o(n()));return function(){return Ot.Sync(function(){return n(e(a,s))})}}})}}(),vu=Ot.Seq;var Wr={map:fo};var qr={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;$()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return Dt("unsafeFromLeft: Right");$()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return Dt("unsafeFromRight: Left");$()},left:dn,right:Kt};var mo={Applicative0:()=>zn,Bind1:()=>zu},zu={bind:Qt,Apply0:()=>go},go={apply:t=>e=>Qt(t)(n=>Qt(e)(a=>zn.pure(n(a)))),Functor0:()=>Wr},zn={pure:be,Apply0:()=>go};var Jn={liftEffect:de,Monad0:()=>mo};var _o={tailRecM:t=>{let e=n=>Qt(t(n))(a=>{if(a.tag==="Done")return be(a._1);if(a.tag==="Loop")return e(a._1);$()});return e},Monad0:()=>mo};var yo=(t,e)=>t&&e?n=>t(e(n)):t||e,ho=(t,e,n)=>{t[e]=n},Do=(t,e,n)=>{n==null||e==="class"&&!n?t.removeAttribute(e):t.setAttribute(e,n)},bo=(t,e,n,a,o,s)=>{t.actions||(t.actions={}),t.actions[e]=s&&a?s(a):a,a?n||t.addEventListener(e,o):t.removeEventListener(e,o)},Bn=(t,e,n,a)=>{let o=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),s=t.props,d=t.attrs,u=t.events,f=yo(a,t.mapf);for(let c in s)ho(o,c,s[c]);for(let c in d)Do(o,c,d[c]);for(let c in u)bo(o,c,null,u[c],e,f);for(let c=0,p=t.children.length;c<p;c++)o.appendChild(Bn(ke(t.children[c]).html,e,n,f));return t.node=o,o},Be=(t,e,n,a,o,s,d)=>{if(n!==a){if(n!=null&&n.type===3&&a.type===3)n.tag!==a.tag&&(e.nodeValue=a.tag);else if(n==null||n.tag!==a.tag)e=t.insertBefore(Bn(a,o,s,d),e),n&&n.node.remove();else{let u=n.props,f=a.props;for(let L in{...u,...f})u[L]!==f[L]&&ho(e,L,f[L]);let c=n.attrs,p=a.attrs;for(let L in{...c,...p})c[L]!==p[L]&&Do(e,L,p[L]);let l=n.events,r=a.events;for(let L in{...l,...r})l[L]!==r[L]&&bo(e,L,l[L],r[L],o,d);let i=n.children,T=a.children,W=i.length-1,it=T.length-1;if(d=yo(d,a.mapf),s=s||a.tag==="svg",a.keyed){let L=0,V=0;for(;V<=it&&L<=W;){let{key:St,html:At}=i[L];if(St!==T[V].key)break;let y=ke(T[V],At);Be(e,At.node,At,y.html,o,s,d),V++,L++}for(;V<=it&&L<=W;){let{key:St,html:At}=i[W];if(St!==T[it].key)break;let y=ke(T[it],At);Be(e,At.node,At,y.html,o,s,d),it--,W--}if(L>W)for(;V<=it;){let St=ke(T[V]).html;e.insertBefore(Bn(St,o,s,d),i[L]&&i[L].html.node),V++}else if(V>it)for(;L<=W;)i[L].html.node.remove(),L++;else{let St={},At={};for(let y=L;y<=W;y++)St[i[y].key]=i[y].html;for(;V<=it;){let{key:y,html:yt}=i[L]||{key:null,html:null},{key:kt,html:Pe}=ke(T[V],yt);if(At[y]||i[L+1]&&kt===i[L+1].key){L++;continue}if(y===kt)Be(e,yt.node,yt,Pe,o,s,d),At[kt]=!0,L++;else{let ot=St[kt];ot!=null?(Be(e,e.insertBefore(ot.node,yt.node),ot,T[V].html,o,s,d),At[kt]=!0):Be(e,yt&&yt.node,null,T[V].html,o,s,d)}V++}for(let y in St)At[y]||St[y].node.remove()}}else{for(let L=0;L<=W&&L<=it;L++){let V=i[L].html,St=ke(T[L],V).html;Be(e,V.node,V,St,o,s,d)}for(let L=W+1;L<=it;L++){let V=ke(T[L],n).html;e.appendChild(Bn(V,o,s,d))}for(let L=it+1;L<=W;L++)i[L].html.node.remove()}}return a.node=e,e}},Ju=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},ke=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||Ju(e.memo,t.html.memo))&&(e=kn(t.html.type(...t.html.memo)),e.memo=t.html.memo),t.html=e),t),kn=t=>({...t,children:t.children&&t.children.map(({key:e,html:n})=>({key:e,html:kn(n)}))}),To=(t,e)=>t.actions[e],Co=Be,Mo=t=>e=>(e.node=t,e);var ku=(t,e,n,a=!1)=>{let o=[],s={},d={},u={},f={tag:t,children:n,props:s,attrs:d,events:u,node:null,keyed:a},c=e.length;for(let l=0;l<c;l++){let[r,i,T]=e[l];r===0?s[i]=T:r===1?d[i]=T:r===2?u[i]=T:r===3?d.class=d.class?d.class+" "+i:i:r===4&&o.push(i+":"+T)}let p=o.join(";");return p&&(d.style=p),f},M=(t,e,n)=>ku(t,e,n.map(a=>({key:null,html:a})));var Hu=t=>({tag:t,props:{},children:[],type:3});var ft=(t,e)=>[0,t,e],X=(t,e)=>[1,t,e],ce=(t,e)=>[2,t,e],j=t=>[3,t];var Hn=(t,e)=>[4,t,e],U=Hu;var Un=(t,e,n)=>({memo:[e,n],type:t});var zr=U("");var Jr={identity:t=>t,Semigroupoid0:()=>$r};var On={dimap:t=>e=>n=>a=>e(n(t(a)))};var Uu=t=>t,Te=(()=>({first:t=>e=>_(t(e._1),e._2),second:In.map,Profunctor0:()=>On}))();var Br=t=>{let e=t.identity,n=t.Semigroupoid0(),a=t.Semigroupoid0();return o=>{let s=o.Profunctor0().dimap;return d=>u=>n.compose(a.compose(o.second(u))(o.first(d)))(s(Uu)(f=>_(f,f))(e))}};function Vn(t){return function(e){return t===e}}var xt=(t,e,n)=>({tag:t,_1:e,_2:n});var kr={state:t=>w(Z("Bind",xt("State",t),e=>w(Z("Return",e),K)),K),Monad0:()=>Nr};var Hr=t=>({liftEffect:e=>w(Z("Bind",xt("Lift",t.liftEffect(e)),n=>w(Z("Return",n),K)),K),Monad0:()=>Nr});var No=t=>{let e=Hr(t.MonadEffect0());return{liftAff:n=>w(Z("Bind",xt("Lift",t.liftAff(n)),a=>w(Z("Return",a),K)),K),MonadEffect0:()=>e}},Io=t=>({map:e=>n=>{if(n.tag==="State")return xt("State",a=>{let o=n._1(a);return _(e(o._1),o._2)});if(n.tag==="Lift")return xt("Lift",t.map(e)(n._1));if(n.tag==="Subscribe")return xt("Subscribe",n._1,a=>e(n._2(a)));if(n.tag==="Unsubscribe")return xt("Unsubscribe",n._1,e(n._2));$()}});var Eo=t=>e=>Ya(n=>{if(n.tag==="State")return xt("State",n._1);if(n.tag==="Lift")return xt("Lift",t(n._1));if(n.tag==="Subscribe")return xt("Subscribe",n._1,n._2);if(n.tag==="Unsubscribe")return xt("Unsubscribe",n._1,n._2);$()})(e);function mn(t,e,n,a){if(typeof window<"u"){var o=window[n];if(o!=null&&a instanceof o)return e(a)}for(var s=a;s!=null;){var d=Object.getPrototypeOf(s),u=d.constructor.name;if(u===n)return e(a);if(u==="Object")return t;s=d}return t}var He=function(t){return function(e){return function(){return e[t]}}},sf=He("URL"),uf=He("documentURI"),df=He("origin"),cf=He("compatMode"),lf=He("characterSet"),pf=He("contentType");var Qu=He("documentElement");function Fo(t){return function(e){return function(){return e.createTextNode(t)}}}var ae=function(t){return function(e){return function(){return e[t]}}};var Rf=ae("baseURI"),Ku=ae("ownerDocument"),Gr=ae("parentNode"),Yu=ae("parentElement");var Pf=ae("childNodes"),Zu=ae("firstChild"),Xu=ae("lastChild"),td=ae("previousSibling"),ed=ae("nextSibling"),nd=ae("nodeValue");var Wf=ae("textContent");function So(t){return function(e){return function(){e.appendChild(t)}}}var Yn=function(t){return function(e){return function(){return e[t]}}},um=Yn("children"),ad=Yn("firstElementChild"),od=Yn("lastElementChild"),dm=Yn("childElementCount");function Ao(t){return function(e){return function(){return e.querySelector(t)}}}var Ro=t=>{let e=Ao(t);return n=>{let a=e(n);return()=>{let o=a();return qt(o,m,H)}}};function Ue(t){return t.currentTarget}function Po(t){return t.type}var Or=function(){return window};function Qr(t){return function(){return t.document}}var gn=xn(fr)(ln),cd=xn(zn)(ln),ld=Va(Io(Wr))(_o),pd=t=>e=>n=>{let a=n(e);return()=>{let o=a();return gn(o)(t.update(t))()}},qo=t=>e=>{let n=t.node,a=t.vdom;return()=>{let o=a.value,s=n.value,d=Gr(s)();return gn(qt(d,m,H))(u=>{let f=kn(e);return()=>{let c=Co(u,s,o,f,p=>{let l=Po(p);return gn(qt(Ue(p),m,H))(r=>()=>{let i=To(r,l);return pd(t)(p)(i)()})()});return n.value=c,a.value=f}})()}},$d=t=>e=>{let n=t.state;return()=>{let a=n.value,o=Vn(a)(e);if(!o)return n.value=e,qo(t)(t.view(e))();o||$()}},vo=t=>e=>n=>{let a=e.subscriptions;return ld(o=>{if(o.tag==="State")return Qt(de((()=>{let s=e.state;return()=>s.value})()))(s=>{let d=o._1(s),u=d._1;return Qt(de($d(e)(d._2)))(()=>be(u))});if(o.tag==="Lift")return o._1;if(o.tag==="Subscribe")return Qt(de(o._1(s=>{let d=vn(qr,vo(t)(e)(t(s)));return()=>{d().run()}})))(s=>Qt(de((()=>{let d=e.freshId;return()=>{let u=d.value;return d.value=u+1|0,u}})()))(d=>Qt(de((()=>{let u=Wn(et)(d)(s);return()=>{let f=a.value;a.value=u(f)}})()))(()=>be(o._2(d)))));if(o.tag==="Unsubscribe"){let s=o._2,d=o._1;return Qt(de(()=>a.value))(u=>Qt(cd(re(et)(d)(u))(de))(()=>be(s)))}$()})(n)},fd=t=>{let e=t.init.model,n=t.init.msg,a=t.selector,o=t.update,s=t.view;return()=>{let d=Or(),u=Qr(d)(),f=Ro(a)(u)();return gn(f.tag==="Just"?b("Just",f._1):m)(c=>()=>{let p={value:e},l=Or(),r=Qr(l)(),i=Fo("")(r)();So(i)(c)();let T={value:i},W={value:Mo(i)(U(""))},V={view:s,update:o,state:p,node:T,vdom:W,subscriptions:{value:z},freshId:{value:0}};return qo(V)(s(e))(),gn(n)(V.update(V))()})()}};var zo=t=>{let e=t.update;return fd({init:t.init,view:t.view,selector:t.selector,update:n=>a=>{let o=vn(qr,vo(e)(n)(e(a)));return()=>{o().run()}}})};var jr=function(t){return function(e){return t+e|0}};var Vr=function(t){return function(e){return t+e}};var Yr=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},_n=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var Zr=isFinite;var Ge=Math.floor;var Zn=function(t){return function(e){return t%e}};var Bo=Math.sin;var ko=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},tt=function(t){return t},Ho=function(t){return function(e){return function(n){var a;n<11?a="[0-"+(n-1).toString()+"]":n===11?a="[0-9a]":a="[0-9a-"+String.fromCharCode(86+n)+"]";var o=new RegExp("^[\\+\\-]?"+a+"+$","i");return function(s){if(o.test(s)){var d=parseInt(s,n);return(d|0)===d?t(d):e}else return e}}}};var yd=Ho(H)(m),Oe=yd(10),Xr=ko(H)(m),Xn=t=>{if(!Zr(t))return 0;if(t>=tt(2147483647))return 2147483647;if(t<=tt(-2147483648))return-2147483648;let e=Xr(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;$()};var Uo=Math.random;var Go=t=>e=>()=>{let n=Uo();return Xn(Ge((tt(e)-tt(t)+1)*n+tt(t)))};var ta=(()=>{let t=Go(1)(2147483646);return()=>{let e=t();return(()=>{let n=_n(e)(2147483645);return n<1?n+2147483646|0:n})()}})();var Oo=t=>e=>{let n=Xr(Zn(tt(48271)*tt(e)+tt(t))(tt(2147483647)));if(n.tag==="Just")return n._1;$()};var Ce=t=>({map:e=>n=>a=>t.map(o=>_(e(o._1),o._2))(n(a))});var an=t=>{let e=t.Bind1().bind;return{bind:n=>a=>o=>e(n(o))(s=>a(s._1)(s._2)),Apply0:()=>tr(t)}},tr=t=>{let e=Ce(t.Bind1().Apply0().Functor0());return{apply:(()=>{let n=an(t).bind,a=le(t).pure;return o=>s=>n(o)(d=>n(s)(u=>a(d(u))))})(),Functor0:()=>e}},le=t=>{let e=t.Applicative0().pure;return{pure:n=>a=>e(_(n,a)),Apply0:()=>tr(t)}};var ea=t=>{let e=t.Monad0(),n=e.Bind1().bind,a=e.Applicative0().pure,o={Applicative0:()=>le(e),Bind1:()=>an(e)};return{tailRecM:s=>d=>u=>t.tailRecM(f=>n(s(f._1)(f._2))(c=>a((()=>{if(c._1.tag==="Loop")return It("Loop",_(c._1._1,c._2));if(c._1.tag==="Done")return It("Done",_(c._1._1,c._2));$()})())))(_(d,u)),Monad0:()=>o}},jo=t=>{let e=t.Applicative0().pure,n={Applicative0:()=>le(t),Bind1:()=>an(t)};return{state:a=>o=>e(a(o)),Monad0:()=>n}};function Dd(t){return function(){return t.slice()}}var na=Dd,bd=function(){function t(e,n,a,o,s,d){var u,f,c,p,l,r,i;for(u=s+(d-s>>1),u-s>1&&t(e,n,o,a,s,u),d-u>1&&t(e,n,o,a,u,d),f=s,c=u,p=s;f<u&&c<d;)l=o[f],r=o[c],i=n(e(l)(r)),i>0?(a[p++]=r,++c):(a[p++]=l,++f);for(;f<u;)a[p++]=o[f++];for(;c<d;)a[p++]=o[c++]}return function(e){return function(n){return function(a){return function(){return a.length<2||t(e,n,a,a.slice(0),0,a.length),a}}}}}();var je=function(t){return function(e){for(var n=e.length,a=Array(n),o=0;o<n;o++)a[o]=t(o)(e[o]);return a}};var pe=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var $e=function(t){return function(e){for(var n=t>e?-1:1,a=new Array(n*(e-t)+1),o=t,s=0;o!==e;)a[s++]=o,o+=n;return a[s]=o,a}},Ld=function(t){return function(e){if(t<1)return[];var n=new Array(t);return n.fill(e)}},xd=function(t){return function(e){for(var n=[],a=0,o=0;o<t;o++)n[a++]=e;return n}},er=typeof Array.prototype.fill=="function"?Ld:xd,Ko=function(){function t(o,s){this.head=o,this.tail=s}var e={};function n(o){return function(s){return new t(o,s)}}function a(o){for(var s=[],d=0,u=o;u!==e;)s[d++]=u.head,u=u.tail;return s}return function(o){return function(s){return a(o(n)(e)(s))}}}();var Yo=function(t){return function(e){return function(n){return function(a){return a<0||a>=n.length?e:t(n[a])}}}};var Zo=function(t){return function(e){return function(n){return function(a){for(var o=0,s=a.length;o<s;o++)if(n(a[o]))return t(o);return e}}}};var Xo=function(t){return function(e){return function(n){return function(a){return function(o){if(n<0||n>=o.length)return e;var s=o.slice();return s[n]=a,t(s)}}}}};var ts=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],n=0,a=t.length;n<a;n++)for(var o=t[n],s=0,d=o.length;s<d;s++)e.push(o[s]);return e},Dn=function(t){return function(e){return e.filter(t)}};var es=function(t){return function(e){return function(n){for(var a=n.length,o=e,s=new Array(a),d=0;d<a;d++)o=t(o)(n[d]),s[d]=o;return s}}};var ns=function(){function t(e,n,a,o,s,d){var u,f,c,p,l,r,i;for(u=s+(d-s>>1),u-s>1&&t(e,n,o,a,s,u),d-u>1&&t(e,n,o,a,u,d),f=s,c=u,p=s;f<u&&c<d;)l=o[f],r=o[c],i=n(e(l)(r)),i>0?(a[p++]=r,++c):(a[p++]=l,++f);for(;f<u;)a[p++]=o[f++];for(;c<d;)a[p++]=o[c++]}return function(e){return function(n){return function(a){var o;return a.length<2?a:(o=a.slice(0),t(e,n,o,a.slice(0),0,a.length),o)}}}}();var nr=function(t){return function(e){for(var n=e.length,a=0;a<n;a++)if(!t(e[a]))return!1;return!0}};var as=Xo(H)(m);var bn=t=>ns(t)(e=>{if(e.tag==="GT")return 1;if(e.tag==="EQ")return 0;if(e.tag==="LT")return-1;$()});var os=t=>e=>(()=>{let n=na(t);return()=>{let a=n();return a.push(e),a}})()();var Me=Yo(H)(m);var aa=Zo(H)(m);var rr=t=>e=>n=>{let a=aa(o=>t.eq(o)(e))(n);if(a.tag==="Nothing")return!1;if(a.tag==="Just")return!0;$()};var ss=t=>e=>t.state(n=>_(void 0,e));var zd=function(){function t(d){this.fn=d}var e={},n=function(d,u){this.head=d,this.tail=u};function a(d){return new n(d,e)}function o(d){return function(u){return new n(d,u)}}function s(d){for(var u=[],f=d;f!==e;)u.push(f.head),f=f.tail;return u}return function(d){return function(u){return function(f){var c=function(l,r){return d(u(o)(f(l)))(r)},p=function(l,r,i){if(r===0)return l;var T=i[r-1];return new t(function(){var W=p(c(T,l),r-1,i);return W})};return function(l){for(var r=u(a)(f(l[l.length-1])),i=p(r,l.length-1,l);i instanceof t;)i=i.fn();return u(s)(i)}}}}}();var Bd=t=>jo(t).state(e=>_(e.newSeed,{...e,newSeed:Oo(0)(e.newSeed)}));var kd=t=>{let e=Ce(t.Bind1().Apply0().Functor0()).map,n=Bd(t),a=tr(t).apply;return o=>s=>{let d=tt(s),u=tt(o),f=e(tt)(n);return e(c=>Xn(Ge(u+Zn(c)(d-u+1))))(a(e(Vr)(f))(e(c=>2*c)(f)))}},us=t=>{let e=kd(t);return n=>a=>n<=a?e(n)(a):e(a)(n)};var Ud=(()=>le(te).pure)(),Gd=(()=>Ce(_e).map)(),Od=us(te);var sa=t=>t.length===0?Ud(m):Gd(e=>Me(t)(e))(Od(0)(t.length-1|0)),ar=t=>{let e=100*Bo(tt(t+1|0));return e-Ge(e)},ds=(()=>{let t=je(a=>o=>_(ar(a),o)),e=bn(a=>o=>Ar.compare(a._1)(o._1)),n=$t(ee);return a=>n(e(t(a)))})();var ia=(t,e)=>({tag:"Graph",_1:t,_2:e}),ls=(()=>le(te).pure)(),Qd=qn(et)(ue),jd=qn(En(et)(et))(ue),Vd=t=>e=>{let n=et.compare(t)(e);if(n.tag==="LT")return e;if(n.tag==="EQ"||n.tag==="GT")return t;$()};var ua=t=>e=>n=>{let a=re(t)(n)(e);if(a.tag==="Nothing")return ls(m);if(a.tag==="Just")return Ce(_e).map(o=>o.tag==="Just"?b("Just",{edge:o._1.edge,dest:o._1.dest}):m)(sa(a._1));$()},ps=t=>e=>ia(Qd($t(n=>_(n,ie(e)(a=>ie((n-a|0)>=0?[void 0]:[])(()=>[{edge:a-1|0,dest:n-a|0}]))))($e(0)(t))),t),$s=t=>({width:800,height:400,position:e=>e===0?m:e<=8?b("Just",{x:tt(e-1|0)*100,y:0}):b("Just",{x:tt(e-9|0)*100,y:200}),legend:$t(e=>({edge:e-1|0,name:at(e)}))(t),vertexLabel:e=>b("Just",at(e))}),Kd=t=>{let e=qn(t)(ue);return n=>a=>ia(e($t(o=>_(n(o._1),$t(s=>({edge:s.edge,dest:n(s.dest)}))(o._2)))(Pn(Je)(a._1))),n(a._2))},Yd=Kd(et),da=t=>e=>n=>sa(ie((()=>{let a=re(t)(n)(e);if(a.tag==="Nothing")return[];if(a.tag==="Just")return a._1;$()})())(a=>er(a.nbBalls)({dest:a.dest,edge:a.edge}))),fs=t=>e=>{let n=Ne(()=>ne.map(o=>nn(s=>nr(d=>{let u=re(t)(d.dest)(n());if(u.tag==="Nothing")return!0;if(u.tag==="Just")return!ze(u._1);$()})(o)))(e._1)),a=n();return ne.map(ze)(a)},Zd=t=>e=>ia(jd(ie($e(0)(t-1|0))(n=>ie($e(0)(e-1|0))(a=>[_(_(n,a),Dn(o=>o.dest._1>=0&&o.dest._2>=0)([{edge:0,dest:_(n-1|0,a)},{edge:1,dest:_(n-1|0,a-1|0)},{edge:2,dest:_(n,a-1|0)}]))]))),_(t-1|0,e-1|0)),ms=t=>e=>Yd(n=>n._1+(n._2*t|0)|0)(Zd(t)(e)),gs=t=>e=>{let n=Vd(t)(e);return{width:180*n|0,height:180*n|0,position:a=>a===0?m:b("Just",{x:50+180*tt(_n(a)(t)),y:10+180*tt((e-Yr(a)(t)|0)-1|0)}),legend:[{edge:0,name:"\u21D0"},{edge:1,name:"\u21D9"},{edge:2,name:"\u21D3"}],vertexLabel:a=>m}},_s=t=>e=>n=>ne.map($t(a=>({edge:a.edge,dest:a.dest,nbBalls:e})))(n._1),ys=t=>e=>n=>a=>(()=>{let o=re(t)(a)(n);return o.tag==="Nothing"?!1:o.tag==="Just"?o._1:!1})()?ua(t)(e)(a):ls((()=>{let o=re(t)(a)(e);if(o.tag==="Just"){let s=aa(d=>{let u=re(t)(d.dest)(n);return u.tag==="Nothing"?!1:u.tag==="Just"?u._1:!1})(o._1);return s.tag==="Just"?b("Just",{edge:o._1[s._1].edge,dest:o._1[s._1].dest}):m}if(o.tag==="Nothing")return m;$()})()),hs={width:0,height:0,position:t=>m,legend:[],vertexLabel:t=>m};var ca=t=>({tag:t}),Re=(t,e,n)=>({tag:t,_1:e,_2:n}),la=t=>({tag:t}),tc=(()=>an(te).bind)(),Ds=(()=>le(te).pure)(),ec=(()=>ea(Ea).tailRecM)(),nc=t=>e=>{let n=et.compare(t)(e);if(n.tag==="LT")return e;if(n.tag==="EQ"||n.tag==="GT")return t;$()},bs=la("Running"),Ts=la("IsStopping"),or=la("Stopped");var pa=ca("Random"),Cs=ca("Expert"),Ms=ca("Machine");var Ls=t=>e=>rr(ve)(t)(e)?Dn(n=>n!==t)(e):bn(et.compare)(pe([t])(e));var $a=t=>{let e=(()=>{if(t.config.graphType.tag==="Substract")return ps(t.config.graphType._1)(t.config.graphType._2);if(t.config.graphType.tag==="King")return ms(t.config.graphType._1)(t.config.graphType._2);$()})();return{config:t.config,source:e._2,nbVictories:0,nbLosses:0,machine:_s(et)(t.config.ballsPerColor)(e),losingPositions:fs(et)(e),status:or,gameResult:m,displayer:(()=>{if(t.config.graphType.tag==="Substract")return $s(t.config.graphType._2);if(t.config.graphType.tag==="King")return gs(t.config.graphType._1)(t.config.graphType._2);$()})(),colors:t.colors,fastMode:t.fastMode}},rc=["#f6b73c","#ff0000","#00ffff","#90ee90","#900090"],xs=$a({config:{graphType:Re("Substract",8,[1,2]),adversary:pa,ballsPerColor:6,reward:3,penalty:-1,machineStarts:!0},source:0,nbVictories:0,nbLosses:0,machine:z,losingPositions:z,status:or,gameResult:m,displayer:hs,colors:rc,fastMode:!1});var ac=t=>e=>{if(t.config.adversary.tag==="Random")return ua(et)(t.machine)(e);if(t.config.adversary.tag==="Expert")return ys(et)(t.machine)(t.losingPositions)(e);if(t.config.adversary.tag==="Machine")return da(et)(t.machine)(e);$()},oc=t=>ec(e=>{let n=e.isMachineTurn,a=e.moves,o=e.pos;return tc(n?da(et)(t.machine)(o):ac(t)(o))(s=>{if(s.tag==="Nothing")return Ds(It("Done",{moves:a,win:!n}));if(s.tag==="Just")return Ds(It("Loop",{moves:os(a)({pos:o,edge:s._1.edge,isMachineTurn:n}),isMachineTurn:!n,pos:s._1.dest}));$()})})({moves:[],pos:t.source,isMachineTurn:t.config.machineStarts});var sc=t=>e=>{let n=e.win;return{config:t.config,source:t.source,nbVictories:n?t.nbVictories+1|0:t.nbVictories+0|0,nbLosses:n?t.nbLosses+0|0:t.nbLosses+1|0,machine:ne.map(a=>nr(o=>o.nbBalls===0)(a)?$t(o=>({nbBalls:t.config.ballsPerColor,dest:o.dest,edge:o.edge}))(a):a)(qe(a=>{let o=a.edge,s=a.isMachineTurn,d=$t(u=>o!==u.edge?u:{nbBalls:nc(0)((()=>!s&&(t.config.adversary.tag==="Random"||t.config.adversary.tag==="Expert"||t.config.adversary.tag!=="Machine")?u.nbBalls+0|0:n===s?u.nbBalls+t.config.reward|0:u.nbBalls+t.config.penalty|0)()),edge:u.edge,dest:u.dest});return Rr(et)(u=>b("Just",d(u)))(a.pos)})(t.machine)(e.moves)),losingPositions:t.losingPositions,status:t.status,gameResult:b("Just",{moves:e.moves,win:n}),displayer:t.displayer,colors:t.colors,fastMode:t.fastMode}},Ns=t=>Ce(_e).map(sc(t))(oc(t));var ic=t=>{let e=t.Apply0(),n=e.Functor0(),a={map:s=>{let d=n.map(s);return u=>f=>d(u(f))}},o={apply:s=>d=>u=>e.apply(s(u))(d(u)),Functor0:()=>a};return{bind:s=>d=>u=>t.bind(s(u))(f=>d(f)(u)),Apply0:()=>o}};var uc=t=>{let e=t.Applicative0(),n=e.Apply0(),a=n.Functor0(),o={map:f=>{let c=a.map(f);return p=>l=>c(p(l))}},s={apply:f=>c=>p=>n.apply(f(p))(c(p)),Functor0:()=>o},d={pure:f=>{let c=e.pure(f);return p=>c},Apply0:()=>s},u=ic(t.Bind1());return{Applicative0:()=>d,Bind1:()=>u}};var sr=t=>{let e=uc(t.Monad0());return{liftEffect:n=>{let a=t.liftEffect(n);return o=>a},Monad0:()=>e}};var lc=Br(Jr)(Te);var Fs=t=>e=>n=>a=>{let o=lc(t)(e),s=a.Profunctor0().dimap;return d=>s(o)(u=>{if(u._2.tag==="Left")return u._2._1;if(u._2.tag==="Right")return u._1(u._2._1);$()})(n.second(a.right(d)))};var fa=t=>e=>n=>{let a=n.Profunctor0().dimap;return o=>a(s=>_(t(s),d=>e(s)(d)))(s=>s._2(s._1))(n.first(o))};function As(t){return function(e){var n=[];for(var a in e)hasOwnProperty.call(e,a)&&n.push(t(a)(e[a]));return n}}var ph=Object.keys||As(function(t){return function(){return t}});var ws={ix:t=>e=>n=>Fs(a=>o=>{let s=as(t)(o)(a);if(s.tag==="Nothing")return a;if(s.tag==="Just")return s._1;$()})(a=>{let o=Me(a)(t);if(o.tag==="Nothing")return nt("Left",a);if(o.tag==="Just")return nt("Right",o._1);$()})(e)(n)};var Rs=t=>()=>e=>n=>Ie(t.reflectSymbol(e))(n);var ir=t=>()=>()=>e=>n=>fa(Rs(t)()(e))(a=>o=>Ke(t.reflectSymbol(e))(o)(a))(n);var Ps=t=>{let e=t.Monad0().Bind1().Apply0().Functor0().map(n=>{});return n=>a=>e((()=>{let o=n(s=>a);return t.state(s=>{let d=o(s);return _(d,d)})})())};var Ws=(()=>({left:t=>e=>{if(e.tag==="Left")return nt("Left",t(e._1));if(e.tag==="Right")return nt("Right",e._1);$()},right:cn.map,Profunctor0:()=>On}))();var qs={liftAff:t=>t,MonadEffect0:()=>Jn};var vs=t=>{let e=sr(t.MonadEffect0());return{liftAff:n=>{let a=t.liftAff(n);return o=>a},MonadEffect0:()=>e}};var Ft=(t,e,n)=>({tag:t,_1:e,_2:n}),zs=Ft("NextGame"),Js=Ft("RunMachine"),Bs=Ft("StopMachine"),ks=t=>Ft("SetGraphType",t),Hs=t=>Ft("SetNbPigeonholes",t);var Us=t=>Ft("SetKingWidth",t),Gs=t=>Ft("SetKingHeight",t),Os=t=>Ft("SetAdversary",t),Qs=t=>Ft("SetReward",t),js=t=>Ft("SetPenalty",t),Vs=t=>Ft("SetBallsPerColor",t),Ks=t=>Ft("SetMachineStarts",t),Ys=t=>e=>Ft("ColorChange",t,e);var Xs=w(Z("Bind",xt("Lift",be),t=>w(Z("Return",t),K)),K),ti=(()=>Hr(sr(Jn)).liftEffect)(),ur=w(Z("Bind",xt("State",t=>_(t,t)),t=>w(Z("Return",t),K)),K),qc=(()=>{let t=No(vs(qs)).liftAff;return e=>t(Pr(Kt,e))})(),vc=Ps(kr),zc=t=>w(Xs._1,Et(Xs._2)(Rt("CatCons",e=>{let n=e.genModel,a=ti(()=>n.value);return w(a._1,Et(a._2)(Rt("CatCons",o=>{let s=t(o),d=s._2,u=s._1,f=ti(()=>n.value=d);return w(f._1,Et(f._2)(Rt("CatCons",()=>w(Z("Return",u),K),Lt(P,P))))},Lt(P,P))))},Lt(P,P)))),dr=ir({reflectSymbol:()=>"graphType"})()()(Pt)(Te),Jc=ir({reflectSymbol:()=>"config"})()()(Pt)(Te),fe=t=>{let e=Jc(t);return w(Z("Bind",xt("State",n=>_(void 0,$a(e(n)))),n=>w(Z("Return",n),K)),K)},Bc=ir({reflectSymbol:()=>"colors"})()()(Pt)(Te),ma=t=>{if(t.tag==="RunMachine"){let e=Ne(()=>w(ur._1,Et(ur._2)(Rt("CatCons",a=>{if(a.status.tag!=="Running"){let s={...a,status:or};return w(Z("Bind",xt("State",d=>_(void 0,s)),d=>w(Z("Return",d),K)),K)}let o=ma(zs);return w(o._1,Et(o._2)(Rt("CatCons",()=>{let s=qc(a.fastMode?100:500);return w(s._1,Et(s._2)(Rt("CatCons",()=>e(),Lt(P,P))))},Lt(P,P))))},Lt(P,P))))),n=e();return w(Z("Bind",xt("State",a=>_(void 0,{...a,status:bs})),a=>w(Z("Return",a),K)),Et(K)(Rt("CatCons",()=>n,Lt(P,P))))}if(t.tag==="StopMachine")return w(Z("Bind",xt("State",e=>_(void 0,{...e,status:Ts})),e=>w(Z("Return",e),K)),K);if(t.tag==="NextGame")return w(ur._1,Et(ur._2)(Rt("CatCons",e=>{let n=zc(Ns(e));return w(n._1,Et(n._2)(Rt("CatCons",ss(kr),Lt(P,P))))},Lt(P,P))));if(t.tag==="SetGraphType"){let e=t._1;return fe(n=>({graphType:e==="sub"?Re("Substract",8,[1,2]):Re("King",3,3),adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetNbPigeonholes"){let e=t._1;return fe(dr(n=>n.tag==="Substract"?Re("Substract",(()=>{let a=Oe(e);if(a.tag==="Nothing")return 8;if(a.tag==="Just")return a._1;$()})(),n._2):n))}if(t.tag==="TogglePossibleMove"){let e=t._1;return fe(dr(n=>n.tag==="Substract"?Re("Substract",n._1,Ls(e)(n._2)):n))}if(t.tag==="SetKingWidth"){let e=t._1;return fe(dr(n=>n.tag==="King"?Re("King",(()=>{let a=Oe(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;$()})(),n._2):n))}if(t.tag==="SetKingHeight"){let e=t._1;return fe(dr(n=>n.tag==="King"?Re("King",n._1,(()=>{let a=Oe(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;$()})()):n))}if(t.tag==="SetReward"){let e=t._1;return fe(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:(()=>{let a=Oe(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;$()})(),penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetPenalty"){let e=t._1;return fe(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:(()=>{let a=Oe(e);if(a.tag==="Nothing")return-1;if(a.tag==="Just")return a._1;$()})(),machineStarts:n.machineStarts}))}if(t.tag==="SetAdversary"){let e=t._1;return fe(n=>({graphType:n.graphType,adversary:(()=>e==="expert"?Cs:e==="machine"?Ms:pa)(),ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetBallsPerColor"){let e=t._1;return fe(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:(()=>{let a=Oe(e);if(a.tag==="Nothing")return 6;if(a.tag==="Just")return a._1;$()})(),reward:n.reward,penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetMachineStarts"){let e=t._1;return fe(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:n.penalty,machineStarts:e==="y"}))}if(t.tag==="ColorChange")return vc((()=>{let e=ws.ix(t._1)(Te)(Ws);return n=>Bc(e(n))})())(t._2);if(t.tag==="SetFastMode"){let e=t._1;return w(Z("Bind",xt("State",n=>_(void 0,{...n,fastMode:e})),n=>w(Z("Return",n),K)),K)}$()};var ei=t=>e=>n=>a=>X("viewBox",at(t)+" "+at(e)+" "+at(n)+" "+at(a));function ni(t){return function(){return t.checked}}function ri(t){return function(){return t.value}}function ai(t){return function(){return t.value}}var oi=t=>ce("change",e=>{let n=qt(Ue(e),m,H),a=(()=>{if(n.tag==="Just")return mn(m,H,"HTMLInputElement",n._1);if(n.tag==="Nothing")return m;$()})();if(a.tag==="Nothing")return()=>m;if(a.tag==="Just"){let o=ni(a._1);return()=>{let s=o();return b("Just",t(s))}}$()});var oe=t=>ce("change",e=>{let n=qt(Ue(e),m,H),a=(()=>{if(n.tag==="Just")return mn(m,H,"HTMLInputElement",n._1);if(n.tag==="Nothing")return m;$()})();if(a.tag==="Just"){let o=ri(a._1);return()=>{let s=o();return b("Just",t(s))}}if(a.tag==="Nothing"){let o=qt(Ue(e),m,H),s=(()=>{if(o.tag==="Just")return mn(m,H,"HTMLSelectElement",o._1);if(o.tag==="Nothing")return m;$()})();if(s.tag==="Nothing")return()=>m;if(s.tag==="Just"){let d=ai(s._1);return()=>{let u=d();return b("Just",t(u))}}$()}$()});var Qc=t=>e=>{let n=et.compare(t)(e);if(n.tag==="LT"||n.tag==="EQ")return t;if(n.tag==="GT")return e;$()},jc=en(jr)(0),Vc=t=>e=>M("div",[j("flex flex-row justify-between mt-4 mb-2")],[M("span",[j("text-blue-600 font-bold")],[U("Victoires: "+at(t))]),M("div",[j("w-full bg-red-600 rounded-full h-6")],[M("div",[j("h-6 bg-blue-600 rounded-l-full"),(()=>{let n=t+e|0;return Hn("width",se(n===0?50:100*(tt(t)/tt(n)))+"%")})()],[])]),M("span",[j("text-red-600 font-bold")],[U("D\xE9faites: "+at(e))])]),ga="block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",Kc=t=>e=>n=>a=>{let o=t.position(n);if(o.tag==="Just")return M("g",[Hn("transform","translate("+se(o._1.x)+"px,"+se(o._1.y)+"px)")],[M("path",[X("d","M1 1 L10 109 L90 109 L99 1"),X("stroke-width","3.0"),X("stroke","#000"),X("fill","transparent")],[]),(()=>{let s=ts($t(u=>er(u.nbBalls)(u.edge))(a)),d=tt(Qc(95)(s.length));return M("g",[],ds(je(u=>f=>M("circle",[X("cx",se(15+ar(n+u|0)*71)),X("cy",se(100-ar((10+n|0)+u|0)*d)),X("r","5.0"),X("fill",(()=>{let c=Me(e)(f);if(c.tag==="Nothing")return"black";if(c.tag==="Just")return c._1;$()})())],[]))(s)))})(),(()=>{let s=tt(jc($t(d=>d.nbBalls)(a)));return M("g",[],$t(d=>M("rect",[X("x",se(3+94*d.begin)),X("y","115.0"),X("width",se(94*(d.end-d.begin))),X("height","20"),X("stroke","black"),X("fill",(()=>{let u=Me(e)(d.edge);if(u.tag==="Nothing")return"black";if(u.tag==="Just")return u._1;$()})())],[]))(es(d=>{let u=d.end;return f=>({begin:u,end:u+tt(f.nbBalls)/s,edge:f.edge})})({begin:0,end:0,edge:-1})(a)))})(),(()=>{let s=t.vertexLabel(n);if(s.tag==="Just")return M("text",[X("x","50"),X("y","150")],[U(s._1)]);if(s.tag==="Nothing")return zr;$()})()]);if(o.tag==="Nothing")return zr;$()},Yc=t=>e=>n=>M("div",[j("w-[42vw]")],[M("svg",[ei(0)(0)(t.width)(t.height)],$t(a=>Kc(t)(e)(a._1)(a._2))(Pn(Je)(n)))]),ya=t=>e=>M("div",[j("rounded overflow-hidden shadow-lg p-4")],pe([M("div",[j("font-bold text-xl mb-2")],[U(t)])])(e)),Zc=t=>e=>ya("L\xE9gende")([M("div",[j("grid grid-cols-2 gap-4")],ie(t)(n=>[M("input",[X("type","color"),j("inline w-12 h-12"),ft("value",(()=>{let a=Me(e)(n.edge);if(a.tag==="Nothing")return"#000000";if(a.tag==="Just")return a._1;$()})()),oe(Ys(n.edge))],[]),M("span",[j("text-2xl")],[U(" : "+n.name)])]))]),_a="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",Xc=t=>e=>ya("Choix des param\xE8tres")([M("div",[j("grid grid-cols-2 gap-4")],pe([M("div",[],[U("type de jeu")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),ft("value",(()=>{if(t.graphType.tag==="Substract")return"sub";if(t.graphType.tag==="King")return"king";$()})()),oe(ks)],[M("option",[ft("value","sub")],[U("Soustraction")]),M("option",[ft("value","king")],[U("Roi")])])])(pe((()=>{if(t.graphType.tag==="Substract"){let n=t.graphType._2;return[M("div",[],[U("Nombre de casiers")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),ft("value",at(t.graphType._1)),oe(Hs)],$t(a=>M("option",[ft("value",at(a))],[U(at(a))]))($e(8)(16))),M("div",[],[U("Coups possibles")]),M("div",[j("flex flex-row justify-between")],$t(a=>M("label",[],[M("input",[X("type","checkbox"),ft("checked",rr(ve)(a)(n)),j("w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"),oi(o=>Ft("TogglePossibleMove",a))],[]),M("span",[j("ml-2 text-sm font-medium text-gray-900")],[U(at(a))])]))($e(1)(5)))]}if(t.graphType.tag==="King")return[M("div",[],[U("Hauteur de la grille")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),ft("value",at(t.graphType._2)),oe(Gs)],$t(n=>M("option",[ft("value",at(n))],[U(at(n))]))($e(3)(6))),M("div",[],[U("Largeur de la grille")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),ft("value",at(t.graphType._1)),oe(Us)],$t(n=>M("option",[ft("value",at(n))],[U(at(n))]))($e(3)(6)))];$()})())([M("div",[],[U("Adversaire")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),ft("value",(()=>{if(t.adversary.tag==="Expert")return"expert";if(t.adversary.tag==="Machine")return"machine";if(t.adversary.tag==="Random")return"random";$()})()),oe(Os)],[M("option",[ft("value","random")],[U("Al\xE9atoire")]),M("option",[ft("value","expert")],[U("Expert")]),M("option",[ft("value","machine")],[U("Machine")])]),M("div",[],[U("Billes par couleur")]),M("input",[X("type","number"),j(ga),X("min","2"),X("max","10"),ft("value",at(t.ballsPerColor)),oe(Vs)],[]),M("div",[],[U("R\xE9compense")]),M("input",[X("type","number"),j(ga),X("min","1"),ft("value",at(t.reward)),oe(Qs)],[]),M("div",[],[U("P\xE9nalit\xE9")]),M("input",[X("type","number"),j(ga),X("max","0"),ft("value",at(t.penalty)),oe(js)],[]),M("div",[],[U("La machine commence")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),ft("value",t.machineStarts?"y":"n"),oe(Ks)],[M("option",[ft("value","y")],[U("Oui")]),M("option",[ft("value","n")],[U("Non")])]),e.tag==="Stopped"?M("button",[j(_a),ce("click",n=>()=>b("Just",Js))],[U("Lancer la machine")]):M("button",[j(_a),ce("click",n=>()=>b("Just",Bs))],[U("Arr\xEAter la machine")]),M("button",[j(_a),ce("pointerdown",n=>()=>b("Just",Ft("SetFastMode",!0))),ce("pointerup",n=>()=>b("Just",Ft("SetFastMode",!1))),ce("pointerleave",n=>()=>b("Just",Ft("SetFastMode",!1)))],[U("Acc\xE9lerer")])])))]),si=t=>M("div",[j("w-screen flex flex-row justify-around items-start")],[ya("Visualisation de la machine")([M("div",[j("flex flex-col")],[Yc(t.displayer)(t.colors)(t.machine),Vc(t.nbVictories)(t.nbLosses)])]),Un((e,n)=>Zc(e)(n),t.displayer.legend,t.colors),Un((e,n)=>Xc(e)(n),t.config,t.status)]);var ii=()=>{let e={value:{newSeed:ta(),size:0}};return zo({init:{model:xs,msg:m},view:si,update:(()=>{let n=Eo(a=>a({genModel:e}));return a=>n(ma(a))})(),selector:"#root"})()};ii();})();
