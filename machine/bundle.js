(()=>{var Vf=function(n){return function(r){for(var t=r.length,e=new Array(t),a=0;a<t;a++)e[a]=n(r[a]);return e}};var oa={compose:function(n){return function(r){return function(t){return n(r(t))}}}},ua=function(n){return n.compose};var Z=function(n){return n.identity},en={identity:function(n){return n},Semigroupoid0:function(){return oa}};var mr=!0;var Cn=function(n){return function(r){return function(t){return n(t)(r)}}},En=function(n){return function(r){return n}};var Qn=function(){function n(){}return n.value=new n,n}();var m=function(n){return n.map},ar=function(n){var r=m(n);return function(t){return function(e){return r(e)(t)}}},er=function(n){return m(n)(En(void 0))};var Vr={map:ua(oa)},Hn={map:Vf};var Qf=function(n){return function(r){return n.length===0?r:r.length===0?n:n.concat(r)}};var Mr=function(n){return n.reflectSymbol};var Qr=function(n){return function(r){return r[n]}},st=function(n){return function(r){return function(t){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e[n]=r,e}}};var pt={append:Qf};var q=function(n){return n.append};var Bu={alt:q(pt),Functor0:function(){return Hn}};var Yf=function(n){return function(r){for(var t=n.length,e=r.length,a=new Array(t*e),u=0,i=0;i<t;i++)for(var c=n[i],f=0;f<e;f++)a[u++]=c(r[f]);return a}};var Hm=Z(en);var ia={apply:Yf,Functor0:function(){return Hn}},hn=function(n){return n.apply};var ao=function(n){var r=hn(n),t=m(n.Functor0());return function(e){return function(a){return r(t(En(Hm))(e))(a)}}};var E=function(n){return n.pure},be=function(n){var r=E(n);return function(t){return function(e){if(!t)return e;if(t)return r(void 0);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[t.constructor.name,e.constructor.name])}}};var fa=function(n){var r=hn(n.Apply0()),t=E(n);return function(e){return function(a){return r(t(e))(a)}}};var Ce={pure:function(n){return[n]},Apply0:function(){return ia}};var Xf=function(n){return function(r){for(var t=[],e=0,a=n.length;e<a;e++)Array.prototype.push.apply(t,r(n[e]));return t}};var Yr=function(n){return n.discard};var Ft={bind:Xf,Apply0:function(){return ia}},R=function(n){return n.bind},wt=function(n){return Cn(R(n))};var Xr={discard:function(n){return R(n)}};var qm=String.fromCharCode(65535),Om=String.fromCharCode(0),Bm=Number.POSITIVE_INFINITY,zm=Number.NEGATIVE_INFINITY;var Zf=function(n){return function(r){return function(t){return function(e){return function(a){return e<a?n:e===a?r:t}}}}};var nc=Zf,rc=Zf;var ku=function(n){return function(r){return n===r}},tc=ku,ec=ku,ac=ku;var Ju={eq:ac},Lt={eq:ec};var uo={eq:tc};var K=function(n){return n.eq},jm=K(uo);var kt=function(n){var r=K(n);return function(t){return function(e){return jm(r(t)(e))(!1)}}};var $=function(){function n(){}return n.value=new n,n}(),k=function(){function n(){}return n.value=new n,n}(),J=function(){function n(){}return n.value=new n,n}();var oc=function(n){return function(r){return n-r|0}};var uc=function(n){return function(r){return n+r|0}},ic=function(n){return function(r){return n*r|0}},fc=function(n){return function(r){return n+r}},cc=function(n){return function(r){return n*r}};var Br=function(n){return n.zero};var io={add:fc,zero:0,mul:cc,one:1},Jt={add:uc,zero:0,mul:ic,one:1};var Ar=function(n){return n.mul};var vr=function(n){return n.add};var lc={sub:oc,Semiring0:function(){return Jt}};var la=function(){return{compare:rc($.value)(J.value)(k.value),Eq0:function(){return Ju}}}(),gn=function(){return{compare:nc($.value)(J.value)(k.value),Eq0:function(){return Lt}}}();var j=function(n){return n.compare};var sa=function(n){var r=j(n);return function(t){return function(e){return function(a){return r(t(e))(t(a))}}}};var Gt=function(n){var r=j(n);return function(t){return function(e){var a=r(t)(e);if(a instanceof $)return e;if(a instanceof J||a instanceof k)return t;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[a.constructor.name])}}},co=function(n){var r=j(n);return function(t){return function(e){var a=r(t)(e);if(a instanceof $||a instanceof J)return t;if(a instanceof k)return e;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[a.constructor.name])}}};var mt=function(n){return n.top};var pa={top:2147483647,bottom:-2147483648,Ord0:function(){return gn}};var xt=function(n){return n.bottom};var pc=function(n){return n.toString()},mc=function(n){var r=n.toString();return isNaN(r+".0")?r:r+".0"};var jt={show:mc},vt={show:pc};var z=function(n){return n.show};var i_=Z(en),D=function(){function n(){}return n.value=new n,n}(),d=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var ur=function(n){return function(r){return function(t){if(t instanceof D)return n;if(t instanceof d)return r(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},Vt=ur(!0)(En(!1)),Vu=ur(!1)(En(!0));var Jn={map:function(n){return function(r){return r instanceof d?new d(n(r.value0)):D.value}}},f_=m(Jn);var Bn=function(n){return ur(n)(i_)},Sr=function(){return function(n){if(n instanceof d)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}};var Fe=function(n){var r=K(n);return{eq:function(t){return function(e){return t instanceof D&&e instanceof D?!0:t instanceof d&&e instanceof d?r(t.value0)(e.value0):!1}}}};var ma={apply:function(n){return function(r){if(n instanceof d)return f_(n.value0)(r);if(n instanceof D)return D.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[n.constructor.name,r.constructor.name])}},Functor0:function(){return Jn}};var dt={bind:function(n){return function(r){if(n instanceof d)return r(n.value0);if(n instanceof D)return D.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[n.constructor.name,r.constructor.name])}},Apply0:function(){return ma}};var Qt=function(){return{pure:d.create,Apply0:function(){return ma}}}();var Nn=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),In=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var _c=function(n){return function(){return n}},vc=function(n){return function(r){return function(){return r(n())()}}};var dr=function(n){var r=R(n.Bind1()),t=E(n.Applicative0());return function(e){return function(a){return r(e)(function(u){return r(a)(function(i){return t(u(i))})})}}};var dc=function(n){return Math.min(Math.abs(n),2147483647)},Dc=function(n){return function(r){return r===0?0:r>0?Math.floor(n/r):-Math.floor(n/-r)}},yc=function(n){return function(r){if(r===0)return 0;var t=Math.abs(r);return(n%t+t)%t}};var hc={Ring0:function(){return lc}};var we=function(n){return n.mod};var Le={degree:dc,div:Dc,mod:yc,CommutativeRing0:function(){return hc}},_a=function(n){return n.div};var Mn=function(n){return n.mempty};var gc=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}},da={Applicative0:function(){return Zr},Bind1:function(){return lo}},lo={bind:vc,Apply0:function(){return bc(0)}},Zr={pure:_c,Apply0:function(){return bc(0)}},Tc=gc("functorEffect","Effect",function(){return{map:fa(Zr)}}),bc=gc("applyEffect","Effect",function(){return{apply:dr(da),Functor0:function(){return Tc(0)}}}),tn=Tc(20);var nt=function(n){return n.ask};var Dt=function(n){return n};var rt={map:function(n){return function(r){return n(r)}}};var wc={apply:function(n){return function(r){return n(r)}},Functor0:function(){return rt}},h_={bind:function(n){return function(r){return r(n)}},Apply0:function(){return wc}},Lc={pure:Dt,Apply0:function(){return wc}},zr={Applicative0:function(){return Lc},Bind1:function(){return h_}};var Ic=function(n){return function(){return{value:n}}};var Rr=function(n){return function(){return n.value}},xc=function(n){return function(r){return function(){var t=n(r.value);return r.value=t.state,t.value}}},tt=function(n){return function(r){return function(){r.value=n}}};var T_=er(tn),et=Ic,b_=xc,C_=function(n){return b_(function(r){var t=n(r);return{state:t,value:t}})},Nc=function(n){return function(r){return T_(C_(n)(r))}};var $n=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Un=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),fr=function(n){return n.tailRecM};var E_=function(n){var r=function(t){var e=!1,a;function u(i){if(i instanceof $n){t=n(i.value0);return}if(i instanceof Un)return e=!0,i.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 103, column 3 - line 103, column 25): "+[i.constructor.name])}for(;!e;)a=u(t);return a};return function(t){return r(n(t))}};var Ac={tailRecM:function(n){var r=function(e){return e},t=E_(function(e){return r(n(e))});return function(e){return Dt(t(e))}},Monad0:function(){return zr}};var b=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),xe=function(n){return function(r){return n(r.value0)(r.value1)}};var Kn=function(n){return n.value1};var Xt={map:function(n){return function(r){return new b(r.value0,n(r.value1))}}};var Er=function(n){return n.value0};var Pc=function(n){var r=K(n);return function(t){var e=K(t);return{eq:function(a){return function(u){return r(a.value0)(u.value0)&&e(a.value1)(u.value1)}}}}},_o=function(n){var r=j(n),t=Pc(n.Eq0());return function(e){var a=j(e),u=t(e.Eq0());return{compare:function(i){return function(c){var f=r(i.value0)(c.value0);return f instanceof $?$.value:f instanceof k?k.value:a(i.value1)(c.value1)}},Eq0:function(){return u}}}};var Wr=function(n){return n.state},ha=function(n){var r=Wr(n);return function(t){return r(function(e){return new b(void 0,t)})}},Ne=function(n){var r=Wr(n);return function(t){return r(function(e){return new b(void 0,t(e))})}};var ga=function(n){return Wr(n)(function(r){return new b(r,r)})};var Gn=function(n){return n.lift};var Rc={empty:[],Alt0:function(){return Bu}},Hr=function(n){return n.empty};var h=function(n){return n};var ni=function(){return h};var L_=ni();var kr=function(){return L_};var nr=function(n){return n.liftEffect};var $c=function(n){return n};var Uc=function(n){return n};var ti={lift:function(n){return function(r){return $c(En(r))}}},N_=Gn(ti),qc=function(n){return function(r){return function(t){return n(r(t))}}},A_=function(n){return{map:function(){var r=m(n);return function(t){return qc(r(t))}}()}};var Oc=function(n){var r=hn(n),t=A_(n.Functor0());return{apply:function(e){return function(a){return function(u){return r(e(u))(a(u))}}},Functor0:function(){return t}}},S_=function(n){var r=R(n),t=Oc(n.Apply0());return{bind:function(e){return function(a){return function(u){return r(e(u))(function(i){var c=a(i);return c(u)})}}},Apply0:function(){return t}}};var Bc=function(n){var r=Oc(n.Apply0());return{pure:function(){var t=E(n);return function(e){return $c(En(t(e)))}}(),Apply0:function(){return r}}},ei=function(n){var r=Bc(n.Applicative0()),t=S_(n.Bind1());return{Applicative0:function(){return r},Bind1:function(){return t}}},zc=function(n){var r=ei(n);return{ask:E(n.Applicative0()),Monad0:function(){return r}}};var go=function(n){var r=n.Monad0(),t=ei(r);return{liftEffect:function(){var e=N_(r),a=nr(n);return function(u){return e(a(u))}}(),Monad0:function(){return t}}};var kc=function(n){return function(r){return function(t){for(var e=r,a=t.length,u=a-1;u>=0;u--)e=n(t[u])(e);return e}}},Jc=function(n){return function(r){return function(t){for(var e=r,a=t.length,u=0;u<a;u++)e=n(e)(t[u]);return e}}};var H_=Z(en),Ae=function(n){return n.bimap},bo=function(n){var r=Ae(n);return function(t){return r(t)(H_)}};var Ca={bimap:function(n){return function(r){return function(t){return new b(n(t.value0),r(t.value1))}}}};var lr=function(n){return n.foldr};var wo=function(n){var r=ao(n.Apply0()),t=E(n);return function(e){var a=lr(e);return function(u){return a(function(i){return r(u(i))})(t(void 0))}}},Lo=function(n){var r=wo(n);return function(t){return Cn(r(t))}};var sr=function(n){return n.foldl};var ci=function(n){var r=sr(n);return function(t){return r(vr(t))(Br(t))}};var Ea={foldr:function(n){return function(r){return function(t){if(t instanceof D)return r;if(t instanceof d)return n(t.value0)(r);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},foldl:function(n){return function(r){return function(t){if(t instanceof D)return r;if(t instanceof d)return n(r)(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},foldMap:function(n){var r=Mn(n);return function(t){return function(e){if(e instanceof D)return r;if(e instanceof d)return t(e.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,e.constructor.name])}}}};var Yc=function(n){var r=lr(n);return function(t){var e=q(t.Semigroup0()),a=Mn(t);return function(u){return r(function(i){return function(c){return e(u(i))(c)}})(a)}}},Fr={foldr:kc,foldl:Jc,foldMap:function(n){return Yc(Fr)(n)}};var Xc=function(n){return function(r){for(var t=r.length,e=Array(t),a=0;a<t;a++)e[a]=n(a)(r[a]);return e}};var Pt=function(n){return n.mapWithIndex};var Fa={mapWithIndex:Xc,Functor0:function(){return Hn}};var bv=function(){function n(a){return[a]}function r(a){return function(u){return[a,u]}}function t(a){return function(u){return function(i){return[a,u,i]}}}function e(a){return function(u){return a.concat(u)}}return function(a){return function(u){return function(i){return function(c){return function(f){function l(_,v){switch(v-_){case 0:return i([]);case 1:return u(n)(c(f[_]));case 2:return a(u(r)(c(f[_])))(c(f[_+1]));case 3:return a(a(u(t)(c(f[_])))(c(f[_+1])))(c(f[_+2]));default:var C=_+Math.floor((v-_)/4)*2;return a(u(e)(l(_,C)))(l(C,v))}}return l(0,f.length)}}}}}}();var pl=function(n){return function(r){return function(t){return function(e){return function(a){return function(u){for(var i=[],c=u;;){var f=a(c);if(n(f))return i;var l=r(f);i.push(t(l)),c=e(l)}}}}}}};var ml=function(n){return function(r){return function(t){return function(e){return function(a){return function(u){for(var i=[],c=u;;){var f=a(c);i.push(t(f));var l=e(f);if(n(l))return i;c=r(l)}}}}}}};var Ov=Sr();var yi={unfoldr1:ml(Vt)(Ov)(Er)(Kn)};var zv=Sr(),ee=function(n){return n.unfoldr};var Re={unfoldr:pl(Vt)(zv)(Er)(Kn),Unfoldable10:function(){return yi}};var xn=function(){function n(){}return n.value=new n,n}(),Q=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var vl=function(){var n=function(r){return function(t){var e=r,a=!1,u;function i(c,f){if(f instanceof xn)return a=!0,c;if(f instanceof Q){e=new Q(f.value0,c),t=f.value1;return}throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[c.constructor.name,f.constructor.name])}for(;!a;)u=i(e,t);return u}};return n(xn.value)}();var Po=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var dl=function(n){var r=!1,t;function e(a){if(a.value0 instanceof xn&&a.value1 instanceof xn)return r=!0,D.value;if(a.value0 instanceof xn){n=new Po(vl(a.value1),xn.value);return}if(a.value0 instanceof Q)return r=!0,new d(new b(a.value0.value0,new Po(a.value0.value1,a.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[a.constructor.name])}for(;!r;)t=e(n);return t},Dl=function(n){return function(r){return new Po(n.value0,new Q(r,n.value1))}};var yl=function(n){return n.value0 instanceof xn&&n.value1 instanceof xn};var hl=function(){return new Po(xn.value,xn.value)}();var He=function(){function n(){}return n.value=new n,n}(),Ro=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var gl=function(n){return function(r){if(n instanceof He)return r;if(r instanceof He)return n;if(n instanceof Ro)return new Ro(n.value0,Dl(n.value1)(r));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[n.constructor.name,r.constructor.name])}},_d=function(n){return function(r){return function(t){var e=function(u){return function(i){return function(c){var f=u,l=i,_=!1,v;function C(p,o,s){if(s instanceof xn)return _=!0,o;if(s instanceof Q){f=p,l=p(o)(s.value0),c=s.value1;return}throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[p.constructor.name,o.constructor.name,s.constructor.name])}for(;!_;)v=C(f,l,c);return v}}},a=function(u){return function(i){var c=u,f=!1,l;function _(v,C){var p=dl(v);if(p instanceof D)return f=!0,e(function(o){return function(s){return s(o)}})(r)(C);if(p instanceof d){c=p.value0.value1,i=new Q(n(p.value0.value0),C);return}throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[p.constructor.name])}for(;!f;)l=_(c,i);return l}};return a(t)(xn.value)}}},Tl=function(n){if(n instanceof He)return D.value;if(n instanceof Ro)return new d(new b(n.value0,function(){var r=yl(n.value1);return r?He.value:_d(gl)(He.value)(n.value1)}()));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[n.constructor.name])};var bl=function(){return He.value}(),Cl=gl;var Ml={append:Cl};var El=function(n){return function(r){return Cl(n)(new Ro(r,hl))}};var dd=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}},Dd=q(Ml),yd=m(Vr);var Fi=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Na=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Aa=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Fl=function(n){var r=!1,t;function e(a){var u=function(f){return f},i=function(f){return function(l){return new Fi(f.value0,Dd(f.value1)(l))}};if(a.value0 instanceof Na){var c=Tl(a.value1);if(c instanceof D)return r=!0,new Na(a.value0.value0);if(c instanceof d){n=i(u(c.value0.value0)(a.value0.value0))(c.value0.value1);return}throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[c.constructor.name])}if(a.value0 instanceof Aa)return r=!0,new Aa(a.value0.value0,function(f){return i(a.value0.value1(f))(a.value1)});throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[a.value0.constructor.name])}for(;!r;)t=e(n);return t},wl=function(n){var r=m(n);return function(t){var e=t.Monad0(),a=m(e.Bind1().Apply0().Functor0()),u=E(e.Applicative0()),i=fr(t);return function(c){var f=function(l){var _=Fl(l);if(_ instanceof Na)return a(Un.create)(u(_.value0));if(_ instanceof Aa)return a($n.create)(c(r(_.value1)(_.value0)));throw new Error("Failed pattern match at Control.Monad.Free (line 194, column 10 - line 196, column 37): "+[_.constructor.name])};return i(f)}}};var Ll=function(n){return new Fi(n,bl)};var Wo={Applicative0:function(){return Pa},Bind1:function(){return Sa}},Il={map:function(n){return function(r){return wt(Sa)(function(){var t=E(Pa);return function(e){return t(n(e))}}())(r)}}},Sa={bind:function(n){return function(r){return new Fi(n.value0,El(n.value1)(r))}},Apply0:function(){return xl(0)}},Pa={pure:function(n){return Ll(Na.create(n))},Apply0:function(){return xl(0)}},xl=dd("freeApply","Control.Monad.Free",function(){return{apply:dr(Wo),Functor0:function(){return Il}}});var Nl=R(Sa),wi=E(Pa);var Li={tailRecM:function(n){return function(r){return Nl(n(r))(function(t){if(t instanceof $n)return fr(Li)(n)(t.value0);if(t instanceof Un)return wi(t.value0);throw new Error("Failed pattern match at Control.Monad.Free (line 86, column 26 - line 88, column 21): "+[t.constructor.name])})}},Monad0:function(){return Wo}},$e=function(n){return Ll(new Aa(n,function(r){return wi(r)}))};var hd=function(n){var r=function(t){var e=Fl(t);if(e instanceof Na)return wi(e.value0);if(e instanceof Aa)return Nl(n(e.value0))(yd(r)(e.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 168, column 10 - line 170, column 33): "+[e.constructor.name])};return r},Al=function(n){return hd(function(r){return $e(n(r))})};var ae=function(n){var r=null;return function(){return n===void 0||(r=n(),n=void 0),r}},oe=function(n){return n()};var Wl=function(n){return n()};var Hl=function(n){throw new Error(n)};var $l=function(){return Hl};var Pd=$l(),Rd=Wl,ue=function(n){return Rd(function(){return Pd(n)})};var I=function(){function n(){}return n.value=new n,n}(),W=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}(),ln=function(){function n(r,t,e,a,u,i,c){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i,this.value6=c}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return function(c){return new n(r,t,e,a,u,i,c)}}}}}}},n}(),Wt=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),bt=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),Ht=function(){function n(r,t,e,a,u,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return new n(r,t,e,a,u,i)}}}}}},n}(),ut=function(){function n(r,t,e,a,u,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return new n(r,t,e,a,u,i)}}}}}},n}(),$t=function(){function n(r,t,e,a,u,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return new n(r,t,e,a,u,i)}}}}}},n}(),$o=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}();var Ii=function(n){return function(r){return new W(I.value,n,r,I.value)}},Uo=function(n){var r=ee(n);return function(t){var e=function(a){var u=!1,i;function c(f){if(f instanceof xn)return u=!0,D.value;if(f instanceof Q){if(f.value0 instanceof I){a=f.value1;return}if(f.value0 instanceof W&&f.value0.value0 instanceof I&&f.value0.value3 instanceof I)return u=!0,new d(new b(new b(f.value0.value1,f.value0.value2),f.value1));if(f.value0 instanceof W&&f.value0.value0 instanceof I)return u=!0,new d(new b(new b(f.value0.value1,f.value0.value2),new Q(f.value0.value3,f.value1)));if(f.value0 instanceof W){a=new Q(f.value0.value0,new Q(Ii(f.value0.value1)(f.value0.value2),new Q(f.value0.value3,f.value1)));return}if(f.value0 instanceof ln){a=new Q(f.value0.value0,new Q(Ii(f.value0.value1)(f.value0.value2),new Q(f.value0.value3,new Q(Ii(f.value0.value4)(f.value0.value5),new Q(f.value0.value6,f.value1)))));return}throw new Error("Failed pattern match at Data.Map.Internal (line 624, column 18 - line 633, column 71): "+[f.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 623, column 3 - line 623, column 19): "+[f.constructor.name])}for(;!u;)i=c(a);return i};return r(e)(new Q(t,xn.value))}};var Ut=function(n){var r=j(n);return function(t){var e=function(a){var u=!1,i;function c(f){if(f instanceof I)return u=!0,D.value;if(f instanceof W){var l=r(t)(f.value1);if(l instanceof J)return u=!0,new d(f.value2);if(l instanceof $){a=f.value0;return}a=f.value3;return}if(f instanceof ln){var _=r(t)(f.value1);if(_ instanceof J)return u=!0,new d(f.value2);var v=r(t)(f.value4);if(v instanceof J)return u=!0,new d(f.value5);if(_ instanceof $){a=f.value0;return}if(v instanceof k){a=f.value6;return}a=f.value3;return}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[f.constructor.name])}for(;!u;)i=c(a);return i};return e}};var it={map:function(n){return function(r){if(r instanceof I)return I.value;if(r instanceof W)return new W(m(it)(n)(r.value0),r.value1,n(r.value2),m(it)(n)(r.value3));if(r instanceof ln)return new ln(m(it)(n)(r.value0),r.value1,n(r.value2),m(it)(n)(r.value3),r.value4,n(r.value5),m(it)(n)(r.value6));throw new Error("Failed pattern match at Data.Map.Internal (line 116, column 1 - line 119, column 110): "+[n.constructor.name,r.constructor.name])}}};var ql=function(n){return function(r){return function(t){var e=n,a=r,u=!1,i;function c(f,l,_){if(l instanceof xn)return u=!0,_;if(l instanceof Q){if(l.value0 instanceof Wt){e=f,a=l.value1,t=new W(_,l.value0.value0,l.value0.value1,l.value0.value2);return}if(l.value0 instanceof bt){e=f,a=l.value1,t=new W(l.value0.value0,l.value0.value1,l.value0.value2,_);return}if(l.value0 instanceof Ht){e=f,a=l.value1,t=new ln(_,l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5);return}if(l.value0 instanceof ut){e=f,a=l.value1,t=new ln(l.value0.value0,l.value0.value1,l.value0.value2,_,l.value0.value3,l.value0.value4,l.value0.value5);return}if(l.value0 instanceof $t){e=f,a=l.value1,t=new ln(l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5,_);return}throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[l.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[l.constructor.name,_.constructor.name])}for(;!u;)i=c(e,a,t);return i}}},qo=function(n){var r=ql(n),t=j(n);return function(e){return function(a){var u=function(c){return function(f){var l=c,_=!1,v;function C(p,o){if(p instanceof xn)return _=!0,new W(o.value0,o.value1,o.value2,o.value3);if(p instanceof Q){if(p.value0 instanceof Wt)return _=!0,r(p.value1)(new ln(o.value0,o.value1,o.value2,o.value3,p.value0.value0,p.value0.value1,p.value0.value2));if(p.value0 instanceof bt)return _=!0,r(p.value1)(new ln(p.value0.value0,p.value0.value1,p.value0.value2,o.value0,o.value1,o.value2,o.value3));if(p.value0 instanceof Ht){l=p.value1,f=new $o(new W(o.value0,o.value1,o.value2,o.value3),p.value0.value0,p.value0.value1,new W(p.value0.value2,p.value0.value3,p.value0.value4,p.value0.value5));return}if(p.value0 instanceof ut){l=p.value1,f=new $o(new W(p.value0.value0,p.value0.value1,p.value0.value2,o.value0),o.value1,o.value2,new W(o.value3,p.value0.value3,p.value0.value4,p.value0.value5));return}if(p.value0 instanceof $t){l=p.value1,f=new $o(new W(p.value0.value0,p.value0.value1,p.value0.value2,p.value0.value3),p.value0.value4,p.value0.value5,new W(o.value0,o.value1,o.value2,o.value3));return}throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[p.value0.constructor.name,o.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[p.constructor.name,o.constructor.name])}for(;!_;)v=C(l,f);return v}},i=function(c){return function(f){var l=c,_=!1,v;function C(p,o){if(o instanceof I)return _=!0,u(p)(new $o(I.value,e,a,I.value));if(o instanceof W){var s=t(e)(o.value1);if(s instanceof J)return _=!0,r(p)(new W(o.value0,e,a,o.value3));if(s instanceof $){l=new Q(new Wt(o.value1,o.value2,o.value3),p),f=o.value0;return}l=new Q(new bt(o.value0,o.value1,o.value2),p),f=o.value3;return}if(o instanceof ln){var s=t(e)(o.value1);if(s instanceof J)return _=!0,r(p)(new ln(o.value0,e,a,o.value3,o.value4,o.value5,o.value6));var Ln=t(e)(o.value4);if(Ln instanceof J)return _=!0,r(p)(new ln(o.value0,o.value1,o.value2,o.value3,e,a,o.value6));if(s instanceof $){l=new Q(new Ht(o.value1,o.value2,o.value3,o.value4,o.value5,o.value6),p),f=o.value0;return}if(s instanceof k&&Ln instanceof $){l=new Q(new ut(o.value0,o.value1,o.value2,o.value4,o.value5,o.value6),p),f=o.value3;return}l=new Q(new $t(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),p),f=o.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[p.constructor.name,o.constructor.name])}for(;!_;)v=C(l,f);return v}};return i(xn.value)}}},qd=function(n){var r=ql(n),t=j(n);return function(e){var a=function(f){return function(l){var _=f,v=!1,C;function p(o,s){if(o instanceof xn)return v=!0,s;if(o instanceof Q){if(o.value0 instanceof Wt&&o.value0.value2 instanceof I&&s instanceof I)return v=!0,r(o.value1)(new W(I.value,o.value0.value0,o.value0.value1,I.value));if(o.value0 instanceof bt&&o.value0.value0 instanceof I&&s instanceof I)return v=!0,r(o.value1)(new W(I.value,o.value0.value1,o.value0.value2,I.value));if(o.value0 instanceof Wt&&o.value0.value2 instanceof W){_=o.value1,l=new ln(s,o.value0.value0,o.value0.value1,o.value0.value2.value0,o.value0.value2.value1,o.value0.value2.value2,o.value0.value2.value3);return}if(o.value0 instanceof bt&&o.value0.value0 instanceof W){_=o.value1,l=new ln(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3,o.value0.value1,o.value0.value2,s);return}return o.value0 instanceof Wt&&o.value0.value2 instanceof ln?(v=!0,r(o.value1)(new W(new W(s,o.value0.value0,o.value0.value1,o.value0.value2.value0),o.value0.value2.value1,o.value0.value2.value2,new W(o.value0.value2.value3,o.value0.value2.value4,o.value0.value2.value5,o.value0.value2.value6)))):o.value0 instanceof bt&&o.value0.value0 instanceof ln?(v=!0,r(o.value1)(new W(new W(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3),o.value0.value0.value4,o.value0.value0.value5,new W(o.value0.value0.value6,o.value0.value1,o.value0.value2,s)))):o.value0 instanceof Ht&&o.value0.value2 instanceof I&&o.value0.value5 instanceof I&&s instanceof I?(v=!0,r(o.value1)(new ln(I.value,o.value0.value0,o.value0.value1,I.value,o.value0.value3,o.value0.value4,I.value))):o.value0 instanceof ut&&o.value0.value0 instanceof I&&o.value0.value5 instanceof I&&s instanceof I?(v=!0,r(o.value1)(new ln(I.value,o.value0.value1,o.value0.value2,I.value,o.value0.value3,o.value0.value4,I.value))):o.value0 instanceof $t&&o.value0.value0 instanceof I&&o.value0.value3 instanceof I&&s instanceof I?(v=!0,r(o.value1)(new ln(I.value,o.value0.value1,o.value0.value2,I.value,o.value0.value4,o.value0.value5,I.value))):o.value0 instanceof Ht&&o.value0.value2 instanceof W?(v=!0,r(o.value1)(new W(new ln(s,o.value0.value0,o.value0.value1,o.value0.value2.value0,o.value0.value2.value1,o.value0.value2.value2,o.value0.value2.value3),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ut&&o.value0.value0 instanceof W?(v=!0,r(o.value1)(new W(new ln(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3,o.value0.value1,o.value0.value2,s),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ut&&o.value0.value5 instanceof W?(v=!0,r(o.value1)(new W(o.value0.value0,o.value0.value1,o.value0.value2,new ln(s,o.value0.value3,o.value0.value4,o.value0.value5.value0,o.value0.value5.value1,o.value0.value5.value2,o.value0.value5.value3)))):o.value0 instanceof $t&&o.value0.value3 instanceof W?(v=!0,r(o.value1)(new W(o.value0.value0,o.value0.value1,o.value0.value2,new ln(o.value0.value3.value0,o.value0.value3.value1,o.value0.value3.value2,o.value0.value3.value3,o.value0.value4,o.value0.value5,s)))):o.value0 instanceof Ht&&o.value0.value2 instanceof ln?(v=!0,r(o.value1)(new ln(new W(s,o.value0.value0,o.value0.value1,o.value0.value2.value0),o.value0.value2.value1,o.value0.value2.value2,new W(o.value0.value2.value3,o.value0.value2.value4,o.value0.value2.value5,o.value0.value2.value6),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ut&&o.value0.value0 instanceof ln?(v=!0,r(o.value1)(new ln(new W(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3),o.value0.value0.value4,o.value0.value0.value5,new W(o.value0.value0.value6,o.value0.value1,o.value0.value2,s),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ut&&o.value0.value5 instanceof ln?(v=!0,r(o.value1)(new ln(o.value0.value0,o.value0.value1,o.value0.value2,new W(s,o.value0.value3,o.value0.value4,o.value0.value5.value0),o.value0.value5.value1,o.value0.value5.value2,new W(o.value0.value5.value3,o.value0.value5.value4,o.value0.value5.value5,o.value0.value5.value6)))):o.value0 instanceof $t&&o.value0.value3 instanceof ln?(v=!0,r(o.value1)(new ln(o.value0.value0,o.value0.value1,o.value0.value2,new W(o.value0.value3.value0,o.value0.value3.value1,o.value0.value3.value2,o.value0.value3.value3),o.value0.value3.value4,o.value0.value3.value5,new W(o.value0.value3.value6,o.value0.value4,o.value0.value5,s)))):(v=!0,ue("The impossible happened in partial function `up`."))}throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[o.constructor.name])}for(;!v;)C=p(_,l);return C}},u=function(f){return function(l){var _=f,v=!1,C;function p(o,s){if(s instanceof W&&s.value0 instanceof I&&s.value3 instanceof I)return v=!0,a(o)(I.value);if(s instanceof W){_=new Q(new bt(s.value0,s.value1,s.value2),o),l=s.value3;return}if(s instanceof ln&&s.value0 instanceof I&&s.value3 instanceof I&&s.value6 instanceof I)return v=!0,a(new Q(new bt(I.value,s.value1,s.value2),o))(I.value);if(s instanceof ln){_=new Q(new $t(s.value0,s.value1,s.value2,s.value3,s.value4,s.value5),o),l=s.value6;return}return v=!0,ue("The impossible happened in partial function `removeMaxNode`.")}for(;!v;)C=p(_,l);return C}},i=function(f){var l=!1,_;function v(C){if(C instanceof W&&C.value3 instanceof I)return l=!0,{key:C.value1,value:C.value2};if(C instanceof W){f=C.value3;return}if(C instanceof ln&&C.value6 instanceof I)return l=!0,{key:C.value4,value:C.value5};if(C instanceof ln){f=C.value6;return}return l=!0,ue("The impossible happened in partial function `maxNode`.")}for(;!l;)_=v(f);return _},c=function(f){return function(l){var _=f,v=!1,C;function p(o,s){if(s instanceof I)return v=!0,D.value;if(s instanceof W){var Ln=t(e)(s.value1);if(s.value3 instanceof I&&Ln instanceof J)return v=!0,new d(new b(s.value2,a(o)(I.value)));if(Ln instanceof J){var Fn=i(s.value0);return v=!0,new d(new b(s.value2,u(new Q(new Wt(Fn.key,Fn.value,s.value3),o))(s.value0)))}if(Ln instanceof $){_=new Q(new Wt(s.value1,s.value2,s.value3),o),l=s.value0;return}_=new Q(new bt(s.value0,s.value1,s.value2),o),l=s.value3;return}if(s instanceof ln){var Lr=function(){return s.value0 instanceof I&&s.value3 instanceof I&&s.value6 instanceof I}(),Ln=t(e)(s.value4),qr=t(e)(s.value1);if(Lr&&qr instanceof J)return v=!0,new d(new b(s.value2,r(o)(new W(I.value,s.value4,s.value5,I.value))));if(Lr&&Ln instanceof J)return v=!0,new d(new b(s.value5,r(o)(new W(I.value,s.value1,s.value2,I.value))));if(qr instanceof J){var Fn=i(s.value0);return v=!0,new d(new b(s.value2,u(new Q(new Ht(Fn.key,Fn.value,s.value3,s.value4,s.value5,s.value6),o))(s.value0)))}if(Ln instanceof J){var Fn=i(s.value3);return v=!0,new d(new b(s.value5,u(new Q(new ut(s.value0,s.value1,s.value2,Fn.key,Fn.value,s.value6),o))(s.value3)))}if(qr instanceof $){_=new Q(new Ht(s.value1,s.value2,s.value3,s.value4,s.value5,s.value6),o),l=s.value0;return}if(qr instanceof k&&Ln instanceof $){_=new Q(new ut(s.value0,s.value1,s.value2,s.value4,s.value5,s.value6),o),l=s.value3;return}_=new Q(new $t(s.value0,s.value1,s.value2,s.value3,s.value4,s.value5),o),l=s.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[s.constructor.name])}for(;!v;)C=p(_,l);return C}};return c(xn.value)}};var Ue=function(){return I.value}(),Oo=function(n){var r=qo(n);return function(t){return sr(t)(function(e){return function(a){return r(a.value0)(a.value1)(e)}})(Ue)}};var Od=function(n){var r=qd(n);return function(t){return function(e){return ur(e)(Kn)(r(t)(e))}}};var Bd=function(n){var r=Ut(n),t=Od(n),e=qo(n);return function(a){return function(u){return function(i){var c=a(r(u)(i));if(c instanceof D)return t(u)(i);if(c instanceof d)return e(u)(c.value0)(i);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[c.constructor.name])}}}};var Ol=function(n){var r=Bd(n);return function(t){return function(e){return function(a){return r(ur(D.value)(t))(e)(a)}}}};var wr=function(){var n={},r="Pure",t="Throw",e="Catch",a="Sync",u="Async",i="Bind",c="Bracket",f="Fork",l="Sequential",_="Map",v="Apply",C="Alt",p="Cons",o="Resume",s="Release",Ln="Finalizer",Fn="Finalized",Lr="Forked",qr="Fiber",jf="Thunk";function x(L,_n,Pn,yn){this.tag=L,this._1=_n,this._2=Pn,this._3=yn}function Ir(L){var _n=function(Pn,yn,N){return new x(L,Pn,yn,N)};return _n.tag=L,_n}function Uu(L){return new x(r,void 0)}function Em(L){try{L()}catch(_n){setTimeout(function(){throw _n},0)}}function Fm(L,_n,Pn){try{return _n(Pn())}catch(yn){return L(yn)}}function wm(L,_n,Pn){try{return _n(Pn)()}catch(yn){return Pn(L(yn))(),Uu}}var no=function(){var L=1024,_n=0,Pn=0,yn=new Array(L),N=!1;function T(){var dn;for(N=!0;_n!==0;)_n--,dn=yn[Pn],yn[Pn]=void 0,Pn=(Pn+1)%L,dn();N=!1}return{isDraining:function(){return N},enqueue:function(dn){var Y,Sn;_n===L&&(Sn=N,T(),N=Sn),yn[(Pn+_n)%L]=dn,_n++,N||T()}}}();function Lm(L){var _n={},Pn=0,yn=0;return{register:function(N){var T=Pn++;N.onComplete({rethrow:!0,handler:function(dn){return function(){yn--,delete _n[T]}}})(),_n[T]=N,yn++},isEmpty:function(){return yn===0},killAll:function(N,T){return function(){if(yn===0)return T();var dn=0,Y={};function Sn(bn){Y[bn]=_n[bn].kill(N,function(On){return function(){delete Y[bn],dn--,L.isLeft(On)&&L.fromLeft(On)&&setTimeout(function(){throw L.fromLeft(On)},0),dn===0&&T()}})()}for(var Zn in _n)_n.hasOwnProperty(Zn)&&(dn++,Sn(Zn));return _n={},Pn=0,yn=0,function(bn){return new x(a,function(){for(var On in Y)Y.hasOwnProperty(On)&&Y[On]()})}}}}}var ge=0,hr=1,ro=2,to=3,eo=4,Cr=5,ea=6;function qu(L,_n,Pn){var yn=0,N=ge,T=Pn,dn=null,Y=null,Sn=null,Zn=null,bn=null,On=0,zt=0,xr=null,Mt=!0;function Et(A){for(var S,an,sn;;)switch(S=null,an=null,sn=null,N){case ro:N=hr;try{T=Sn(T),Zn===null?Sn=null:(Sn=Zn._1,Zn=Zn._2)}catch(rr){N=Cr,dn=L.left(rr),T=null}break;case to:L.isLeft(T)?(N=Cr,dn=T,T=null):Sn===null?N=Cr:(N=ro,T=L.fromRight(T));break;case hr:switch(T.tag){case i:Sn&&(Zn=new x(p,Sn,Zn)),Sn=T._2,N=hr,T=T._1;break;case r:Sn===null?(N=Cr,T=L.right(T._1)):(N=ro,T=T._1);break;case a:N=to,T=Fm(L.left,L.right,T._1);break;case u:N=eo,T=wm(L.left,T._1,function(rr){return function(){yn===A&&(yn++,no.enqueue(function(){yn===A+1&&(N=to,T=rr,Et(yn))}))}});return;case t:N=Cr,dn=L.left(T._1),T=null;break;case e:Sn===null?bn=new x(p,T,bn,Y):bn=new x(p,T,new x(p,new x(o,Sn,Zn),bn,Y),Y),Sn=null,Zn=null,N=hr,T=T._1;break;case c:On++,Sn===null?bn=new x(p,T,bn,Y):bn=new x(p,T,new x(p,new x(o,Sn,Zn),bn,Y),Y),Sn=null,Zn=null,N=hr,T=T._1;break;case f:N=to,S=qu(L,_n,T._2),_n&&_n.register(S),T._1&&S.run(),T=L.right(S);break;case l:N=hr,T=xm(L,_n,T._1);break}break;case Cr:if(Sn=null,Zn=null,bn===null)N=ea,T=Y||dn||T;else switch(S=bn._3,sn=bn._1,bn=bn._2,sn.tag){case e:Y&&Y!==S&&On===0?N=Cr:dn&&(N=hr,T=sn._2(L.fromLeft(dn)),dn=null);break;case o:Y&&Y!==S&&On===0||dn?N=Cr:(Sn=sn._1,Zn=sn._2,N=ro,T=L.fromRight(T));break;case c:On--,dn===null&&(an=L.fromRight(T),bn=new x(p,new x(s,sn._2,an),bn,S),(Y===S||On>0)&&(N=hr,T=sn._3(an)));break;case s:bn=new x(p,new x(Fn,T,dn),bn,Y),N=hr,Y&&Y!==S&&On===0?T=sn._1.killed(L.fromLeft(Y))(sn._2):dn?T=sn._1.failed(L.fromLeft(dn))(sn._2):T=sn._1.completed(L.fromRight(T))(sn._2),dn=null,On++;break;case Ln:On++,bn=new x(p,new x(Fn,T,dn),bn,Y),N=hr,T=sn._1;break;case Fn:On--,N=Cr,T=sn._1,dn=sn._2;break}break;case ea:for(var Wn in xr)xr.hasOwnProperty(Wn)&&(Mt=Mt&&xr[Wn].rethrow,Em(xr[Wn].handler(T)));xr=null,Y&&dn?setTimeout(function(){throw L.fromLeft(dn)},0):L.isLeft(T)&&Mt&&setTimeout(function(){if(Mt)throw L.fromLeft(T)},0);return;case ge:N=hr;break;case eo:return}}function Rn(A){return function(){if(N===ea)return Mt=Mt&&A.rethrow,A.handler(T)(),function(){};var S=zt++;return xr=xr||{},xr[S]=A,function(){xr!==null&&delete xr[S]}}}function P(A,S){return function(){if(N===ea)return S(L.right(void 0))(),function(){};var an=Rn({rethrow:!1,handler:function(){return S(L.right(void 0))}})();switch(N){case ge:Y=L.left(A),N=ea,T=Y,Et(yn);break;case eo:Y===null&&(Y=L.left(A)),On===0&&(N===eo&&(bn=new x(p,new x(Ln,T(A)),bn,Y)),N=Cr,T=null,dn=null,Et(++yn));break;default:Y===null&&(Y=L.left(A)),On===0&&(N=Cr,T=null,dn=null)}return an}}function X(A){return function(){var S=Rn({rethrow:!1,handler:A})();return N===ge&&Et(yn),S}}return{kill:P,join:X,onComplete:Rn,isSuspended:function(){return N===ge},run:function(){N===ge&&(no.isDraining()?Et(yn):no.enqueue(function(){Et(yn)}))}}}function Im(L,_n,Pn,yn){var N=0,T={},dn=0,Y={},Sn=new Error("[ParAff] Early exit"),Zn=null,bn=n;function On(Rn,P,X){var A=P,S=null,an=null,sn=0,Wn={},rr,aa;n:for(;;)switch(rr=null,A.tag){case Lr:if(A._3===n&&(rr=T[A._1],Wn[sn++]=rr.kill(Rn,function(Nm){return function(){sn--,sn===0&&X(Nm)()}})),S===null)break n;A=S._2,an===null?S=null:(S=an._1,an=an._2);break;case _:A=A._2;break;case v:case C:S&&(an=new x(p,S,an)),S=A,A=A._1;break}if(sn===0)X(L.right(void 0))();else for(aa=0,rr=sn;aa<rr;aa++)Wn[aa]=Wn[aa]();return Wn}function zt(Rn,P,X){var A,S,an,sn,Wn,rr;L.isLeft(Rn)?(A=Rn,S=null):(S=Rn,A=null);n:for(;;){if(an=null,sn=null,Wn=null,rr=null,Zn!==null)return;if(P===null){yn(A||S)();return}if(P._3!==n)return;switch(P.tag){case _:A===null?(P._3=L.right(P._1(L.fromRight(S))),S=P._3):P._3=A;break;case v:if(an=P._1._3,sn=P._2._3,A){if(P._3=A,Wn=!0,rr=dn++,Y[rr]=On(Sn,A===an?P._2:P._1,function(){return function(){delete Y[rr],Wn?Wn=!1:X===null?zt(A,null,null):zt(A,X._1,X._2)}}),Wn){Wn=!1;return}}else{if(an===n||sn===n)return;S=L.right(L.fromRight(an)(L.fromRight(sn))),P._3=S}break;case C:if(an=P._1._3,sn=P._2._3,an===n&&L.isLeft(sn)||sn===n&&L.isLeft(an))return;if(an!==n&&L.isLeft(an)&&sn!==n&&L.isLeft(sn))A=S===an?sn:an,S=null,P._3=A;else if(P._3=S,Wn=!0,rr=dn++,Y[rr]=On(Sn,S===an?P._2:P._1,function(){return function(){delete Y[rr],Wn?Wn=!1:X===null?zt(S,null,null):zt(S,X._1,X._2)}}),Wn){Wn=!1;return}break}X===null?P=null:(P=X._1,X=X._2)}}function xr(Rn){return function(P){return function(){delete T[Rn._1],Rn._3=P,zt(P,Rn._2._1,Rn._2._2)}}}function Mt(){var Rn=hr,P=Pn,X=null,A=null,S,an;n:for(;;)switch(S=null,an=null,Rn){case hr:switch(P.tag){case _:X&&(A=new x(p,X,A)),X=new x(_,P._1,n,n),P=P._2;break;case v:X&&(A=new x(p,X,A)),X=new x(v,n,P._2,n),P=P._1;break;case C:X&&(A=new x(p,X,A)),X=new x(C,n,P._2,n),P=P._1;break;default:an=N++,Rn=Cr,S=P,P=new x(Lr,an,new x(p,X,A),n),S=qu(L,_n,S),S.onComplete({rethrow:!1,handler:xr(P)})(),T[an]=S,_n&&_n.register(S)}break;case Cr:if(X===null)break n;X._1===n?(X._1=P,Rn=hr,P=X._2,X._2=n):(X._2=P,P=X,A===null?X=null:(X=A._1,A=A._2))}for(bn=P,an=0;an<N;an++)T[an].run()}function Et(Rn,P){Zn=L.left(Rn);var X;for(var A in Y)if(Y.hasOwnProperty(A)){X=Y[A];for(A in X)X.hasOwnProperty(A)&&X[A]()}Y=null;var S=On(Rn,bn,P);return function(an){return new x(u,function(sn){return function(){for(var Wn in S)S.hasOwnProperty(Wn)&&S[Wn]();return Uu}})}}return Mt(),function(Rn){return new x(u,function(P){return function(){return Et(Rn,P)}})}}function xm(L,_n,Pn){return new x(u,function(yn){return function(){return Im(L,_n,Pn,yn)}})}return x.EMPTY=n,x.Pure=Ir(r),x.Throw=Ir(t),x.Catch=Ir(e),x.Sync=Ir(a),x.Async=Ir(u),x.Bind=Ir(i),x.Bracket=Ir(c),x.Fork=Ir(f),x.Seq=Ir(l),x.ParMap=Ir(_),x.ParApply=Ir(v),x.ParAlt=Ir(C),x.Fiber=qu,x.Supervisor=Lm,x.Scheduler=no,x.nonCanceler=Uu,x}(),Bl=wr.Pure,zd=wr.Throw;function zl(n){return function(r){return r.tag===wr.Pure.tag?wr.Pure(n(r._1)):wr.Bind(r,function(t){return wr.Pure(n(t))})}}function kl(n){return function(r){return wr.Bind(n,r)}}var Jl=wr.Sync;var Gl=wr.Async;function jl(n,r){return function(){return wr.Fiber(n,null,r)}}var Vl=function(){function n(t,e){return t===0&&typeof setImmediate<"u"?setImmediate(e):setTimeout(e,t)}function r(t,e){return t===0&&typeof clearImmediate<"u"?clearImmediate(e):clearTimeout(e)}return function(t,e){return wr.Async(function(a){return function(){var u=n(e,a(t()));return function(){return wr.Sync(function(){return t(r(e,u))})}}})}}(),kd=wr.Seq;var ko={dimap:function(n){return function(r){return function(t){return function(e){return r(t(n(e)))}}}}},qe=function(n){return n.dimap};var iD=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}};var fD=er(tn);var Ni={map:zl};var cD=function(){var n=function(e){if(e instanceof In)return e.value0;if(e instanceof Nn)return ue("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[e.constructor.name])},r=function(e){if(e instanceof Nn)return e.value0;if(e instanceof In)return ue("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[e.constructor.name])},t=function(e){if(e instanceof Nn)return!0;if(e instanceof In)return!1;throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[e.constructor.name])};return{isLeft:t,fromLeft:r,fromRight:n,left:Nn.create,right:In.create}}(),lD=function(n){return jl(cD,n)},sD=function(n){return function(){var t=lD(n)();return t.run(),t}},Ai=function(n){return fD(sD(n))};var os=function(n){return Vl(In.create,n)};var Ra={Applicative0:function(){return Ha},Bind1:function(){return Wa}},Wa={bind:kl,Apply0:function(){return us(0)}},Ha={pure:Bl,Apply0:function(){return us(0)}},us=iD("applyAff","Effect.Aff",function(){return{apply:dr(Ra),Functor0:function(){return Ni}}});var pD=E(Ha),mD=R(Wa);var Be={liftEffect:Jl,Monad0:function(){return Ra}};var is={tailRecM:function(n){var r=function(t){return mD(n(t))(function(e){if(e instanceof Un)return pD(e.value0);if(e instanceof $n)return r(e.value0);throw new Error("Failed pattern match at Effect.Aff (line 104, column 7 - line 106, column 23): "+[e.constructor.name])})};return r},Monad0:function(){return Ra}};var fs=(n,r)=>({...n,...r}),cs=(n,r)=>n&&r?t=>n(r(t)):n||r,ls=(n,r,t,e,a,u,i)=>{if(r==="style")for(let c in fs(t,e))t=e==null||e[c]==null?"":e[c],c[0]==="-"?n[r].setProperty(c,t):n[r][c]=t;else if(r[0]==="o"&&r[1]==="n"){let c=r.slice(2);n.actions||(n.actions={}),n.actions[c]=i&&e?i(e):e,e?t||n.addEventListener(c,a):n.removeEventListener(c,a)}else!u&&r in n?n[r]=e:e==null||e===!1||r==="class"&&!e?n.removeAttribute(r):n.setAttribute(r,e)},Go=(n,r,t,e)=>{let a=n.type===3?document.createTextNode(n.tag):(t=t||n.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",n.tag):document.createElement(n.tag),u=n.props,i=cs(e,n.mapf);for(let c in u)ls(a,c,null,u[c],r,t,i);for(let c=0,f=n.children.length;c<f;c++)a.appendChild(Go(fe(n.children[c]).html,r,t,i));return n.node=a,a},ie=(n,r,t,e,a,u,i)=>{if(t!==e)if(t!=null&&t.type===3&&e.type===3)t.tag!==e.tag&&(r.nodeValue=e.tag);else if(t==null||t.tag!==e.tag)r=n.insertBefore(Go(e,a,u,i),r),t&&n.removeChild(t.node);else{let c=t.props,f=e.props,l=t.children,_=e.children,v=l.length-1,C=_.length-1;i=cs(i,e.mapf),u=u||e.tag==="svg";for(let p in fs(c,f))(p==="value"||p==="selected"||p==="checked"?r[p]:c[p])!==f[p]&&ls(r,p,c[p],f[p],a,u,i);if(e.keyed){let p=0,o=0;for(;o<=C&&p<=v;){let{key:s,html:Ln}=l[p];if(s!==_[o].key)break;let Fn=fe(_[o],Ln);ie(r,Ln.node,Ln,Fn.html,a,u,i),o++,p++}for(;o<=C&&p<=v;){let{key:s,html:Ln}=l[v];if(s!==_[C].key)break;let Fn=fe(_[C],Ln);ie(r,Ln.node,Ln,Fn.html,a,u,i),C--,v--}if(p>v)for(;o<=C;){let s=fe(_[o]).html;r.insertBefore(Go(s,a,u,i),l[p]&&l[p].html.node),o++}else if(o>C)for(;p<=v;)r.removeChild(l[p].html.node),p++;else{let s={},Ln={};for(let Fn=p;Fn<=v;Fn++)s[l[Fn].key]=l[Fn].html;for(;o<=C;){let{key:Fn,html:Lr}=l[p]||{key:null,html:null},{key:qr,html:jf}=fe(_[o],Lr);if(Ln[Fn]||l[p+1]&&qr===l[p+1].key){p++;continue}if(Fn===qr)ie(r,Lr.node,Lr,jf,a,u,i),Ln[qr]=!0,p++;else{let x=s[qr];x!=null?(ie(r,r.insertBefore(x.node,Lr.node),x,_[o].html,a,u,i),Ln[qr]=!0):ie(r,Lr&&Lr.node,null,_[o].html,a,u,i)}o++}for(let Fn in s)Ln[Fn]||r.removeChild(s[Fn].node)}}else{for(let p=0;p<=v&&p<=C;p++){let o=l[p].html,s=fe(_[p],o).html;ie(r,o.node,o,s,a,u,i)}for(let p=v+1;p<=C;p++){let o=fe(_[p],t).html;r.appendChild(Go(o,a,u,i))}for(let p=C+1;p<=v;p++)r.removeChild(l[p].html.node)}}return e.node=r,r},_D=(n,r)=>{for(let t=0;t<n.length;t++)if(n[t]!==r[t])return!0;return!1},vD=(n,r)=>r.reduce((t,e)=>t(e),n),fe=(n,r)=>(typeof n.html.type=="function"&&((!r||r.memo==null||_D(r.memo,n.html.memo))&&(r=$a(vD(n.html.type,n.html.memo)),r.memo=n.html.memo),n.html=r),n),$a=n=>({...n,children:n.children&&n.children.map(({key:r,html:t})=>({key:r,html:$a(t)}))}),Si=n=>r=>()=>n.actions[r],Pi=n=>r=>t=>e=>a=>()=>ie(n,r,t,e,u=>a(u)()),Ri=n=>r=>(r.node=n,r);var DD=(n,r,t,e=!1)=>{let a={},u={style:a},i={tag:n,children:t,props:u,node:null,keyed:e},c=r.length;for(let f=0;f<c;f++){let[l,_,v]=r[f];l==1?u[_]=v:l===2?u.class=u.class?u.class+" "+_:_:l===3&&(a[_]=v)}return i},Yn=n=>r=>t=>DD(n,r,t.map(e=>({key:null,html:e})));var yD=n=>({tag:n,props:{},children:[],type:3});var Xn=n=>r=>[1,n,r],Dn=n=>[2,n];var jo=n=>r=>[1,"on"+n,r],Ua=n=>r=>[3,n,r],mn=yD;function ss(n){return n.currentTarget}function Wi(n){return n.type}var Hi=function(n){var r=E(n.Applicative0()),t=Hr(n.Plus1());return function(e){if(e)return r(void 0);if(!e)return t;throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): "+[e.constructor.name])}},ps={Applicative0:function(){return Ce},Plus1:function(){return Rc}};function _s(n,r,t){return n==null?r:t(n)}var An=function(n){return _s(n,D.value,d.create)};var ze=function(n){return An(ss(n))};var wD=mn("");var ds=function(n){return function(r){if(n instanceof d)return r(n.value0);if(n instanceof D)return wD;throw new Error("Failed pattern match at Pha.Html.Core (line 82, column 1 - line 82, column 52): "+[n.constructor.name,r.constructor.name])}};var ce={first:function(n){return function(r){return new b(n(r.value0),r.value1)}},second:m(Xt),Profunctor0:function(){return ko}};var Yo=function(n){return n.first};var ke=function(n){return n};var zi=function(n){var r=m(n);return{map:function(t){return function(e){return function(a){return r(function(u){return new b(t(u.value0),u.value1)})(e(a))}}}}};var Xo=function(n){return{Applicative0:function(){return Ji(n)},Bind1:function(){return ki(n)}}},ki=function(n){var r=R(n.Bind1());return{bind:function(t){return function(e){return function(a){return r(t(a))(function(u){var i=e(u.value0);return i(u.value1)})}}},Apply0:function(){return Zo(n)}}},Zo=function(n){var r=zi(n.Bind1().Apply0().Functor0());return{apply:dr(Xo(n)),Functor0:function(){return r}}},Ji=function(n){var r=E(n.Applicative0());return{pure:function(t){return function(e){return r(new b(t,e))}},Apply0:function(){return Zo(n)}}};var ys=function(n){var r=n.Monad0(),t=R(r.Bind1()),e=E(r.Applicative0()),a=fr(n),u=Xo(r);return{tailRecM:function(i){return function(c){var f=function(l){var _=i(l.value0);return t(_(l.value1))(function(v){return e(function(){if(v.value0 instanceof $n)return new $n(new b(v.value0.value0,v.value1));if(v.value0 instanceof Un)return new Un(new b(v.value0.value0,v.value1));throw new Error("Failed pattern match at Control.Monad.State.Trans (line 87, column 16 - line 89, column 40): "+[v.value0.constructor.name])}())})};return function(l){return a(f)(new b(c,l))}}},Monad0:function(){return u}}},hs=function(n){var r=E(n.Applicative0()),t=Xo(n);return{state:function(e){return function(a){return r(e(a))}},Monad0:function(){return t}}};var BD=Gn(ti);var gs={liftAff:Z(en),MonadEffect0:function(){return Be}},nu=function(n){return n.liftAff};var Ts=function(n){var r=n.MonadEffect0(),t=go(r);return{liftAff:function(){var e=BD(r.Monad0()),a=nu(n);return function(u){return e(a(u))}}(),MonadEffect0:function(){return t}}};function ji(n){return function(r){return n===r}}var Vi=ji;var kD=bo(Ca);var se=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Ct=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Je=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Ge=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Qi=function(n){return n},Ki=gn,Yi=Wo;var ru={state:function(n){return Qi($e(se.create(n)))},Monad0:function(){return Yi}},Ms=Li,Xi=function(n){return{liftEffect:function(){var r=nr(n);return function(t){return Qi($e(Ct.create(r(t))))}}(),Monad0:function(){return Yi}}},Es=function(n){return{ask:$e(new Ct(nt(n))),Monad0:function(){return Yi}}},JD=function(n){var r=Xi(n.MonadEffect0());return{liftAff:function(){var t=nu(n);return function(e){return Qi($e(Ct.create(t(e))))}}(),MonadEffect0:function(){return r}}},Fs=function(n){var r=m(n);return{map:function(t){return function(e){if(e instanceof se)return new se(function(){var a=kD(t);return function(u){return a(e.value0(u))}}());if(e instanceof Ct)return new Ct(r(t)(e.value0));if(e instanceof Je)return new Je(e.value0,function(a){return t(e.value1(a))});if(e instanceof Ge)return new Ge(e.value0,t(e.value1));throw new Error("Failed pattern match at Pha.Update (line 43, column 1 - line 47, column 50): "+[t.constructor.name,e.constructor.name])}}}};var tu=Sa;var ws=Pa;var Ls=function(n){return function(r){return Al(function(t){if(t instanceof se)return new se(t.value0);if(t instanceof Ct)return new Ct(n(t.value0));if(t instanceof Je)return new Je(t.value0,t.value1);if(t instanceof Ge)return new Ge(t.value0,t.value1);throw new Error("Failed pattern match at Pha.Update (line 105, column 45 - line 109, column 38): "+[t.constructor.name])})(r)}},Is=function(n){var r=nu(JD(n));return function(t){return r(os(t))}};var pe=function(n){return function(r){return function(){return r[n]}}},GD=pe("URL"),jD=pe("documentURI"),VD=pe("origin"),QD=pe("compatMode"),KD=pe("characterSet"),YD=pe("contentType");var XD=pe("documentElement");function nf(n){return function(r){return function(){return r.createTextNode(n)}}}function xs(n,r,t,e){if(typeof window<"u"){var a=window[t];if(a!=null&&e instanceof a)return r(e)}for(var u=e;u!=null;){var i=Object.getPrototypeOf(u),c=i.constructor.name;if(c===t)return r(e);if(c==="Object")return n;u=i}return n}var M=function(n){return function(r){return xs(D.value,d.create,n,r)}};var eu=function(n){return function(r){return r[n]}},ty=eu("namespaceURI"),ey=eu("prefix"),ay=eu("localName"),oy=eu("tagName");var au=function(n){return function(r){return function(){return r[n]}}},iy=au("children"),fy=au("firstElementChild"),cy=au("lastElementChild"),ly=au("childElementCount");function As(n){return function(r){return function(){return r.querySelector(n)}}}var py=m(tn);var Ss=function(n){var r=py(An),t=As(n);return function(e){return r(t(e))}};var Ps=h;var Gr=function(n){return function(r){return function(){return r[n]}}};var Dy=Gr("baseURI"),yy=Gr("ownerDocument"),Rs=Gr("parentNode"),hy=Gr("parentElement");var gy=Gr("childNodes"),Ty=Gr("firstChild"),by=Gr("lastChild"),Cy=Gr("previousSibling"),My=Gr("nextSibling"),Ey=Gr("nodeValue");var Fy=Gr("textContent");function rf(n){return function(r){return function(){r.appendChild(n)}}}var xy=m(tn);var Ws=function(){var n=xy(An);return function(r){return n(Rs(r))}}();var Hs=h;var ou=function(){return window};var $s=h;var Us=h;function tf(n){return function(){return n.checked}}function ef(n){return function(){return n.value}}var af=M("HTMLInputElement");function of(n){return function(){return n.value}}var zs=M("HTMLSelectElement");function uu(n){return function(){return n.document}}var uf=R(lo),Wh=Yr(Xr),Oa=Lo(Zr)(Ea),Hh=be(Zr),iu=R(Wa),me=nr(Be),ff=Wh(Wa),cf=E(Ha),$h=qo(Ki),Uh=Lo(Ha)(Ea),qh=Ut(Ki),Oh=wl(Fs(Ni))(is),lf=ar(tn),Bh=m(tn),zh=m(Jn);var kh=function(n){return Rr(n.state)},Jh=function(n){return function(){var t=Rr(n.freshId)();return tt(t+1|0)(n.freshId)(),t}},ks=function(n){return n.update(n)},Gh=function(n){return function(r){return function(t){return function(){var a=t(r)();return Oa(a)(ks(n))()}}}},Js=function(n){return function(r){var t=function(e){var a=Wi(e);return Oa(ze(e))(function(u){return function(){var c=Si(u)(a)();return Gh(n)(e)(c)()}})};return function(){var a=Rr(n.vdom)(),u=Rr(n.node)(),i=Ws(u)();return Oa(i)(function(c){var f=$a(r);return function(){var _=Pi(c)(u)(a)(f)(t)();return tt(_)(n.node)(),tt(f)(n.vdom)()}})()}}},jh=function(n){return function(r){return function(){var e=Rr(n.state)();return Hh(Vi(e)(r))(function(){return tt(r)(n.state)(),Js(n)(n.view(r))()})()}}},Gs=function(n){return function(r){return function(t){var e=function(a){if(a instanceof se)return iu(me(kh(r)))(function(u){var i=a.value0(u);return ff(me(jh(r)(i.value1)))(function(){return cf(i.value0)})});if(a instanceof Ct)return a.value0;if(a instanceof Je)return iu(me(a.value0(function(u){return Ai(Gs(n)(r)(n(u)))})))(function(u){return iu(me(Jh(r)))(function(i){return ff(me(Nc($h(i)(u))(r.subscriptions)))(function(){return cf(a.value1(i))})})});if(a instanceof Ge)return iu(me(Rr(r.subscriptions)))(function(u){return ff(Uh(qh(a.value0)(u))(me))(function(){return cf(a.value1)})});throw new Error("Failed pattern match at Pha.App (line 114, column 3 - line 118, column 11): "+[a.constructor.name])};return Oh(e)(t)}}},Vh=function(n){return function(){var t=lf(uf(ou)(uu))($s)(),e=Bh(zh(Ps))(Ss(n.selector)(t))();return Oa(e)(function(a){return function(){var i=et(n.init.model)(),c=lf(uf(lf(uf(ou)(uu))(Us))(nf("")))(Hs)();rf(c)(a)();var f=et(c)(),l=et(Ri(c)(mn("")))(),_=et(Ue)(),v=et(0)(),C={view:n.view,update:n.update,state:i,node:f,vdom:l,subscriptions:_,freshId:v};return Js(C)(n.view(n.init.model))(),Oa(n.init.msg)(ks(C))()}})()}};var js=function(n){var r=function(t){return function(e){return Ai(Gs(n.update)(t)(n.update(e)))}};return Vh({init:n.init,view:n.view,selector:n.selector,update:r})};var Vs=function(n){return function(r){return function(t){return(t|0)===t?n(t):r}}},Tn=function(n){return n},Qs=function(n){return function(r){return function(t){var e;t<11?e="[0-"+(t-1).toString()+"]":t===11?e="[0-9a]":e="[0-9a-"+String.fromCharCode(86+t)+"]";var a=new RegExp("^[\\+\\-]?"+e+"+$","i");return function(u){if(a.test(u)){var i=parseInt(u,t);return(i|0)===i?n(i):r}else return r}}}};var fu=isFinite;var Ba=Math.floor;var za=function(n){return function(r){return n%r}};var sf=Math.sin;var Ks=mt(pa),Ys=xt(pa);var rg=function(){return Qs(d.create)(D.value)}(),_e=rg(10),pf=function(){return Vs(d.create)(D.value)}(),tg=function(n){if(!fu(n))return 0;if(n>=Tn(Ks))return Ks;if(n<=Tn(Ys))return Ys;if(mr)return Bn(0)(pf(n));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[n.constructor.name])};var lu=function(n){return tg(Ba(n))};var mf=Math.random;var Xs=function(n){return function(r){return function(){var e=mf(),a=(Tn(r)-Tn(n)+1)*e+Tn(n);return lu(a)}}};var og=we(Le),ug=Sr();var Zs=function(n){return n};var np=1,_f=2147483647,rp=function(){return _f-1|0}(),ig=function(n){var r=function(t){return function(e){return function(a){var u=e-t|0,i=og(a)(u),c=i<t;return c?i+e|0:i}}};return r(np)(rp)(n)},vf=m(tn)(ig)(Xs(np)(rp)),fg=0,cg=48271,tp=function(n){return function(r){return ug(pf(za(Tn(cg)*Tn(r)+Tn(n))(Tn(_f))))}},ep=tp(fg);var _g=kr();var ip=function(n){return function(r){return _g(n(r))}};var $r=function(n){return function(r){for(var t=n>r?-1:1,e=new Array(t*(r-n)+1),a=n,u=0;a!==r;)e[u++]=a,a+=t;return e[u]=a,e}},dg=function(n){return function(r){if(n<1)return[];var t=new Array(n);return t.fill(r)}},Dg=function(n){return function(r){for(var t=[],e=0,a=0;a<n;a++)t[e++]=r;return t}},je=typeof Array.prototype.fill=="function"?dg:Dg,yg=function(){function n(a,u){this.head=a,this.tail=u}var r={};function t(a){return function(u){return new n(a,u)}}function e(a){for(var u=[],i=0,c=a;c!==r;)u[i++]=c.head,c=c.tail;return u}return function(a){return function(u){return e(a(t)(r)(u))}}}(),qt=function(n){return n.length};var fp=function(n){return function(r){return function(t){return function(e){return e<0||e>=t.length?r:n(t[e])}}}};var cp=function(n){return function(r){return function(t){return function(e){for(var a=0,u=e.length;a<u;a++)if(t(e[a]))return n(a);return r}}}};var su=function(n){if(n.length<=1e4)return Array.prototype.concat.apply([],n);for(var r=[],t=0,e=n.length;t<e;t++)for(var a=n[t],u=0,i=a.length;u<i;u++)r.push(a[u]);return r},de=function(n){return function(r){return r.filter(n)}};var pu=function(n){return function(r){return function(t){for(var e=t.length,a=r,u=new Array(e),i=0;i<e;i++)a=n(a)(t[i]),u[i]=a;return u}}};var lp=function(){function n(r,t,e,a,u,i){var c,f,l,_,v,C,p;for(c=u+(i-u>>1),c-u>1&&n(r,t,a,e,u,c),i-c>1&&n(r,t,a,e,c,i),f=u,l=c,_=u;f<c&&l<i;)v=a[f],C=a[l],p=t(r(v)(C)),p>0?(e[_++]=C,++l):(e[_++]=v,++f);for(;f<c;)e[_++]=a[f++];for(;l<i;)e[_++]=a[l++]}return function(r){return function(t){return function(e){var a;return e.length<2?e:(a=e.slice(0),n(r,t,a,e.slice(0),0,e.length),a)}}}}();var Ve=function(n){return function(r){for(var t=r.length,e=0;e<t;e++)if(!n(r[e]))return!1;return!0}},sp=function(n){return function(r){return n[r]}};var df=function(n){return function(r){return function(){return r.push.apply(r,n)}}};var mu=function(n){return function(){return n}};function gg(n){return function(){return n.slice()}}var Df=gg,Tg=function(){function n(r,t,e,a,u,i){var c,f,l,_,v,C,p;for(c=u+(i-u>>1),c-u>1&&n(r,t,a,e,u,c),i-c>1&&n(r,t,a,e,c,i),f=u,l=c,_=u;f<c&&l<i;)v=a[f],C=a[l],p=t(r(v)(C)),p>0?(e[_++]=C,++l):(e[_++]=v,++f);for(;f<c;)e[_++]=a[f++];for(;l<i;)e[_++]=a[l++]}return function(r){return function(t){return function(e){return function(){return e.length<2||n(r,t,e,e.slice(0),0,e.length),e}}}}}();var mp=function(n){return function(r){return function(){var e=Df(r)();return n(e)(),mu(e)()}}};var yf=function(n){return df([n])};var Ng=m(Jn);var Ag=q(pt);var Dp=function(){return sp},Sg=Dp();var ka=function(n){return lp(n)(function(r){if(r instanceof k)return 1;if(r instanceof J)return 0;if(r instanceof $)return-1;throw new Error("Failed pattern match at Data.Array (line 870, column 31 - line 873, column 11): "+[r.constructor.name])})};var gf=function(n){var r=j(n);return function(t){return ka(r)(t)}},Tf=function(n){return function(r){return mp(yf(r))(n)()}};var Ja=Pt(Fa);var De=function(){return fp(d.create)(D.value)}();var yp=lr(Fr);var bf=function(){return cp(d.create)(D.value)}();var Cf=function(n){return function(r){return Ng(Sg(r))(bf(n)(r))}};var hp=function(n){var r=K(n);return function(t){return bf(function(e){return r(e)(t)})}};var Ga=function(n){var r=hp(n);return function(t){return function(e){return Vu(r(t)(e))}}};var _u=function(n){return function(r){return Ag([n])(r)}};var Pg=function(){function n(i){this.fn=i}var r={},t=function(i,c){this.head=i,this.tail=c};function e(i){return new t(i,r)}function a(i){return function(c){return new t(i,c)}}function u(i){for(var c=[],f=i;f!==r;)c.push(f.head),f=f.tail;return c}return function(i){return function(c){return function(f){var l=function(v,C){return i(c(a)(f(v)))(C)},_=function(v,C,p){if(C===0)return v;var o=p[C-1];return new n(function(){var s=_(l(o,v),C-1,p);return s})};return function(v){for(var C=c(e)(f(v[v.length-1])),p=_(C,v.length-1,v);p instanceof n;)p=p.fn();return c(u)(p)}}}}}();var qg=vr(io),Og=Ar(io);var Tp=function(n){return ys(n)};var ye=function(n){return zi(n)},bp=function(n){return ki(n)},Bg=function(n){return Zo(n)},Ke=function(n){return Ji(n)};var zg=function(n){return n};var Cp=function(n){return ip(zg(n))};var kg=function(n){var r=function(t){return new b(Zs(t.newSeed),function(){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.newSeed=ep(t.newSeed),e}())};return Wr(hs(n))(r)};var Jg=function(n){var r=m(ye(n.Bind1().Apply0().Functor0())),t=kg(n),e=hn(Bg(n));return function(a){return function(u){var i=Tn(u),c=Tn(a),f=function(v){return c+za(v)(i-c+1)},l=r(Tn)(t),_=e(r(qg)(l))(r(Og(2))(l));return r(function(v){return lu(f(v))})(_)}}},Mp=function(n){var r=Jg(n);return function(t){return function(e){var a=t<=e;return a?r(t)(e):r(e)(t)}}};var Gg=m(Hn),jg=E(Ke(zr)),Vg=m(ye(rt)),Qg=Mp(zr);var Mf=function(n){return n.length===0?jg(D.value):Vg(function(r){return De(n)(r)})(Qg(0)(qt(n)-1|0))},du=function(n){var r=100*sf(Tn(n+1|0));return r-Ba(r)},Ep=function(){var n=Gg(Kn),r=ka(sa(la)(Er)),t=Ja(function(e){return function(a){return new b(du(e),a)}});return function(e){return n(r(t(e)))}}();var Kg=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}},Du=R(Ft),Yg=Yr(Xr)(Ft),Xg=Hi(ps),Ip=E(Ce),Zg=Oo(gn)(Fr),yu=ar(Hn),nT=z(vt),xp=E(Ke(zr)),rT=ar(ye(rt)),tT=m(Jn),eT=Uo(Re),Np=ar(it),aT=m(it),oT=Oo(_o(gn)(gn))(Fr),uT=Gt(gn),iT=we(Le),fT=_a(Le),wp=K(Fe(uo)),Lp=R(dt),cT=E(Qt),lT=m(Hn),Ef=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Ap=function(n){return function(r){var t=function(e){return Du(r)(function(a){return Yg(Xg((e-a|0)>=0))(function(){return Ip({edge:a-1|0,dest:e-a|0})})})};return new Ef(Zg(yu($r(0)(n))(function(e){return new b(e,t(e))})),n)}},Sp=function(n){return{width:800,height:400,position:function(r){var t=r===0;if(t)return D.value;var e=r<=8;return e?new d({x:Tn(r-1|0)*100,y:0}):new d({x:Tn(r-9|0)*100,y:200})},legend:yu(n)(function(r){return{edge:r-1|0,name:nT(r)}})}},Pp=function(n){return n.value1},Ff=function(n){var r=Ut(n);return function(t){return function(e){var a=r(e)(t);if(a instanceof D)return xp(D.value);if(a instanceof d)return rT(Mf(a.value0))(tT(function(u){return{edge:u.edge,dest:u.dest}}));throw new Error("Failed pattern match at SM.Graph (line 105, column 3 - line 107, column 72): "+[a.constructor.name])}}},sT=function(n){var r=Oo(n)(Fr);return function(t){return function(e){var a=eT(e.value0),u=yu(a)(function(i){return new b(t(i.value0),yu(i.value1)(function(c){return{edge:c.edge,dest:t(c.dest)}}))});return new Ef(r(u),t(e.value1))}}},pT=sT(gn),Rp=function(n){var r=Ut(n);return function(t){return function(e){var a=Bn([])(r(e)(t));return Mf(Du(a)(function(u){return je(u.nbBalls)({dest:u.dest,edge:u.edge})}))}}},Wp=function(n){var r=Ut(n);return function(t){var e=Kg("t","SM.Graph",function(){return Np(t.value0)(function(u){return ae(function(i){return Ve(function(c){return ur(!0)(function(f){return!oe(f)})(r(c.dest)(e(100)))})(u)})})}),a=e(99);return aT(oe)(a)}},mT=function(n){return function(r){var t=function(a){return function(u){return de(function(i){return i.dest.value0>=0&&i.dest.value1>=0})([{edge:0,dest:new b(a-1|0,u)},{edge:1,dest:new b(a-1|0,u-1|0)},{edge:2,dest:new b(a,u-1|0)}])}},e=oT(Du($r(0)(n-1|0))(function(a){return Du($r(0)(r-1|0))(function(u){return Ip(new b(new b(a,u),t(a)(u)))})}));return new Ef(e,new b(n-1|0,r-1|0))}},Hp=function(n){return function(r){return pT(function(t){return t.value0+(t.value1*n|0)|0})(mT(n)(r))}},$p=function(n){return function(r){var t=uT(n)(r);return{width:180*t|0,height:180*t|0,position:function(e){var a=e===0;return a?D.value:new d({x:50+180*Tn(iT(e)(n)),y:10+180*Tn((r-fT(e)(n)|0)-1|0)})},legend:[{edge:0,name:"\u21D0"},{edge:1,name:"\u21D9"},{edge:2,name:"\u21D3"}]}}},Up=function(n){var r=Ut(n),t=Ff(n);return function(e){return function(a){return function(u){if(wp(r(u)(a))(new d(!0)))return t(e)(u);if(mr)return xp(Lp(r(u)(e))(function(i){return Lp(Cf(function(c){return wp(r(c.dest)(a))(new d(!0))})(i))(function(c){return cT({edge:c.edge,dest:c.dest})})}));throw new Error("Failed pattern match at SM.Graph (line 109, column 1 - line 110, column 92): "+[e.constructor.name,a.constructor.name,u.constructor.name])}}}},qp=function(n){return function(r){return function(t){return Np(t.value0)(lT(function(e){return{edge:e.edge,dest:e.dest,nbBalls:r}}))}}};var _T=Ga(Lt),vT=gf(gn),zp=Rp(gn),dT=qp(gn),DT=Wp(gn),yT=Ff(gn),hT=Up(gn),gT=R(bp(zr)),Bp=E(Ke(zr)),TT=fr(Tp(Ac)),bT=Gt(gn),CT=ar(it),MT=Ol(gn),ET=m(Hn),FT=ar(Hn),wT=ar(ye(rt)),ja=function(){function n(){}return n.value=new n,n}(),hu=function(){function n(){}return n.value=new n,n}(),Ot=function(){function n(){}return n.value=new n,n}(),Ur=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),jr=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Ye=function(){function n(){}return n.value=new n,n}(),Va=function(){function n(){}return n.value=new n,n}(),Xe=function(){function n(){}return n.value=new n,n}(),gu={eq:function(n){return function(r){return n instanceof ja&&r instanceof ja||n instanceof hu&&r instanceof hu||n instanceof Ot&&r instanceof Ot}}},LT={eq:function(n){return function(r){return n instanceof Ye&&r instanceof Ye||n instanceof Va&&r instanceof Va||n instanceof Xe&&r instanceof Xe}}},IT=kt(LT),kp=function(n){return function(r){if(_T(n)(r))return de(function(t){return t!==n})(r);if(mr)return vT(_u(n)(r));throw new Error("Failed pattern match at SM.Model (line 67, column 1 - line 67, column 50): "+[n.constructor.name,r.constructor.name])}},xT=function(n){return zp(n.graphWithBalls)},wf=function(n){var r=function(){if(n.config.graphType instanceof Ur)return Ap(n.config.graphType.value0)(n.config.graphType.value1);if(n.config.graphType instanceof jr)return Hp(n.config.graphType.value0)(n.config.graphType.value1);throw new Error("Failed pattern match at SM.Model (line 136, column 13 - line 138, column 32): "+[n.config.graphType.constructor.name])}(),t=dT(n.config.ballsPerColor)(r),e=DT(r);return{config:n.config,source:Pp(r),nbVictories:0,nbLosses:0,graphWithBalls:t,losingPositions:e,status:Ot.value,gameResult:D.value}},Jp=function(){var n={graphType:new Ur(8,[1,2]),adversary:Ye.value,ballsPerColor:6,reward:3,penalty:-1,machineStarts:!0};return wf({config:n,source:0,nbVictories:0,nbLosses:0,graphWithBalls:Ue,losingPositions:Ue,status:Ot.value,gameResult:D.value})}(),Gp=function(n){if(n instanceof Va)return"expert";if(n instanceof Xe)return"machine";if(n instanceof Ye)return"random";throw new Error("Failed pattern match at SM.Model (line 62, column 1 - line 62, column 39): "+[n.constructor.name])},NT=function(n){return function(r){if(n.config.adversary instanceof Ye)return yT(n.graphWithBalls)(r);if(n.config.adversary instanceof Va)return hT(n.graphWithBalls)(n.losingPositions)(r);if(n.config.adversary instanceof Xe)return zp(n.graphWithBalls)(r);throw new Error("Failed pattern match at SM.Model (line 74, column 3 - line 77, column 52): "+[n.config.adversary.constructor.name])}},AT=function(n){var r=function(t){return gT(function(){return t.isMachineTurn?xT:NT}()(n)(t.pos))(function(e){if(e instanceof D)return Bp(new Un({moves:t.moves,win:!t.isMachineTurn}));if(e instanceof d)return Bp(new $n({moves:Tf(t.moves)({pos:t.pos,edge:e.value0.edge,isMachineTurn:t.isMachineTurn}),isMachineTurn:!t.isMachineTurn,pos:e.value0.dest}));throw new Error("Failed pattern match at SM.Model (line 87, column 5 - line 93, column 10): "+[e.constructor.name])})};return TT(r)({moves:[],pos:n.source,isMachineTurn:n.config.machineStarts})},jp=function(n){return n==="expert"?Va.value:n==="machine"?Xe.value:Ye.value},ST=function(n){return function(r){var t=function(a){return function(u){return bT(0)(u+function(){var i=!a&&IT(n.config.adversary)(Xe.value);if(i)return 0;var c=r.win===a;return c?n.config.reward:n.config.penalty}()|0)}},e=CT(yp(function(a){return Cn(MT)(a.pos)(function(){var u=ET(function(i){var c=a.edge!==i.edge;return c?i:{nbBalls:t(a.isMachineTurn)(i.nbBalls),edge:i.edge,dest:i.dest}});return function(i){return d.create(u(i))}}())})(n.graphWithBalls)(r.moves))(function(a){var u=Ve(function(i){return function(c){return c===0}(function(c){return c.nbBalls}(i))})(a);return u?FT(a)(function(i){return{nbBalls:n.config.ballsPerColor,dest:i.dest,edge:i.edge}}):a});return{config:n.config,source:n.source,nbVictories:n.nbVictories+function(){return r.win?1:0}()|0,nbLosses:n.nbLosses+function(){return r.win?0:1}()|0,graphWithBalls:e,losingPositions:n.losingPositions,status:n.status,gameResult:new d({moves:r.moves,win:r.win})}}},Vp=function(n){return wT(AT(n))(ST(n))};var PT=function(n){return function(r){var t=qe(r.Profunctor0()),e=Yo(r);return function(a){return t(n)(function(u){return u.value1(u.value0)})(e(a))}}},Qp=function(n){return function(r){return function(t){return PT(function(e){return new b(n(e),function(a){return r(e)(a)})})(t)}}};var Yp=function(n){var r=Mr(n);return function(){return function(){return function(t){return function(e){return function(a){return st(r(t))(e)(a)}}}}}};var Xp=function(n){var r=Mr(n);return function(){return function(t){return function(e){return Qr(r(t))(e)}}}};var If=function(n){var r=Xp(n)(),t=Yp(n)()();return function(){return function(){return function(e){return function(a){return Qp(r(e))(Cn(t(e)))(a)}}}}};var Qa=function(){function n(){}return n.value=new n,n}(),Tu=function(){function n(){}return n.value=new n,n}(),bu=function(){function n(){}return n.value=new n,n}(),Cu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Mu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Eu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Fu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),wu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Lu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Iu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),xu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Nu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Au=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var Pu=R(tu),BT=nt(Es(zc(Ra))),nm=nr(Xi(go(Be))),Ka=Yr(Xr)(tu),xf=E(ws),zT=If({reflectSymbol:function(){return"graphType"}})()(),kT=If({reflectSymbol:function(){return"config"}})()(),Nf=Ne(ru),rm=ga(ru),JT=kt(gu),tm=ha(ru),GT=Is(Ts(gs)),jT=fr(Ms),VT=wt(tu),QT=function(n){return Pu(BT)(function(r){return Pu(nm(Rr(r.genModel)))(function(t){var e=Cp(n)(t);return Ka(nm(tt(e.value1)(r.genModel)))(function(){return xf(e.value0)})})})},KT=function(n){return zT(Qn.value)(n)},Su=KT(ce),YT=function(n){return kT(Qn.value)(n)},XT=YT(ce),ct=function(n){return Nf(function(){var r=ke(XT)(n);return function(t){return wf(r(t))}}())},Af=function(n){if(n instanceof Tu){var r=function(t){return Pu(rm)(function(e){var a=JT(e.status)(ja.value);return a?Ka(tm(function(){var u={};for(var i in e)({}).hasOwnProperty.call(e,i)&&(u[i]=e[i]);return u.status=Ot.value,u}()))(function(){return xf(new Un(void 0))}):Ka(Af(Qa.value))(function(){return Ka(GT(500))(function(){return xf(new $n(void 0))})})})};return Ka(Nf(function(t){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.status=ja.value,e}))(function(){return jT(r)(void 0)})}if(n instanceof bu)return Nf(function(t){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.status=hu.value,e});if(n instanceof Qa)return Pu(rm)(function(t){return VT(tm)(QT(Vp(t)))});if(n instanceof Cu)return ct(function(t){return{graphType:function(){var e=n.value0==="sub";return e?new Ur(8,[1,2]):new jr(3,3)}(),adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof Mu)return ct(ke(Su)(function(t){return t instanceof Ur?new Ur(Bn(8)(_e(n.value0)),t.value1):t}));if(n instanceof Eu)return ct(ke(Su)(function(t){return t instanceof Ur?new Ur(t.value0,kp(n.value0)(t.value1)):t}));if(n instanceof Fu)return ct(ke(Su)(function(t){return t instanceof jr?new jr(Bn(3)(_e(n.value0)),t.value1):t}));if(n instanceof wu)return ct(ke(Su)(function(t){return t instanceof jr?new jr(t.value0,Bn(3)(_e(n.value0))):t}));if(n instanceof Iu)return ct(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:Bn(3)(_e(n.value0)),penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof xu)return ct(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:Bn(-1)(_e(n.value0)),machineStarts:t.machineStarts}});if(n instanceof Lu)return ct(function(t){return{graphType:t.graphType,adversary:jp(n.value0),ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof Nu)return ct(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:Bn(6)(_e(n.value0)),reward:t.reward,penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof Au)return ct(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:t.penalty,machineStarts:n.value0==="y"}});throw new Error("Failed pattern match at SM.Update (line 47, column 1 - line 47, column 38): "+[n.constructor.name])};var na=z(jt),Ze=z(vt);var em=function(){var n=Xn("y");return function(r){return n(na(r))}}();var am=function(){var n=Xn("x");return function(r){return n(na(r))}}(),om=Xn("width"),um=function(n){return function(r){return function(t){return function(e){return Xn("viewBox")(Ze(n)+(" "+(Ze(r)+(" "+(Ze(t)+(" "+Ze(e)))))))}}}},Vn=Xn("value"),Ya=Xn("type");var im=function(){var n=Xn("stroke-width");return function(r){return n(na(r))}}();var Sf=Xn("stroke");var fm=function(){var n=Xn("r");return function(r){return n(na(r))}}();var Pf=function(){var n=Xn("min");return function(r){return n(Ze(r))}}();var Rf=function(){var n=Xn("max");return function(r){return n(Ze(r))}}();var cm=Xn("height"),Ru=Xn("fill");var lm=Xn("d"),sm=function(){var n=Xn("cy");return function(r){return n(na(r))}}(),pm=function(){var n=Xn("cx");return function(r){return n(na(r))}}();var mm=function(n){return Xn("checked")(n)};var _m=Yn("svg"),Xa=Yn("span"),ra=Yn("select");var vm=function(n){return Yn("rect")(n)([])},dm=function(n){return Yn("path")(n)([])};var Bt=Yn("option");var Dm=Yn("label"),Za=function(n){return Yn("input")(n)([])};var Wu=Yn("g");var qn=Yn("div"),ym=function(n){return Yn("circle")(n)([])},Hu=Yn("button");var Uf=E(Zr),Wf=R(dt),Hf=m(tn),$f=m(Vr);var qf=jo;var hm=function(n){var r=function(t){var e=Wf(ze(t))(af);if(e instanceof D)return Uf(D.value);if(e instanceof d)return Hf($f(d.create)(n))(tf(e.value0));throw new Error("Failed pattern match at Pha.Html.Events (line 75, column 9 - line 77, column 66): "+[e.constructor.name])};return qf("change")(r)},$u=function(n){return qf("click")(function(r){return Uf(d.create(n(r)))})};var lt=function(n){var r=function(t){var e=Wf(ze(t))(af);if(e instanceof d)return Hf($f(d.create)(n))(ef(e.value0));if(e instanceof D){var a=Wf(ze(t))(zs);if(a instanceof D)return Uf(D.value);if(a instanceof d)return Hf($f(d.create)(n))(of(a.value0));throw new Error("Failed pattern match at Pha.Html.Events (line 67, column 17 - line 69, column 73): "+[a.constructor.name])}throw new Error("Failed pattern match at Pha.Html.Events (line 64, column 9 - line 69, column 73): "+[e.constructor.name])};return qf("change")(r)};var gm=z(jt),Tm=function(n){return function(r){return"translate("+(n+(","+(r+")")))}};var Of=function(n){return gm(n)+"px"},bm=function(n){return gm(n*100)+"%"};var yr=z(vt),he=ar(Hn),ab=co(gn),ob=ci(Fr)(Jt),ub=m(Hn),ib=z(jt),fb=Uo(Re),kf=q(pt),cb=R(Ft),lb=Ga(Lt),sb=K(gu),ta="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",pb=function(n){return function(r){return qn([Dn("flex flex-row justify-between mt-4 mb-2")])([Xa([Dn("text-blue-600 font-bold")])([mn("Victoires: "+yr(n))]),qn([Dn("w-full bg-red-600 rounded-full h-6")])([qn([Dn("h-6 bg-blue-600 rounded-l-full"),Ua("width")(bm(function(){var t=n+r|0,e=t===0;return e?.5:Tn(n)/Tn(t)}()))])([])]),Xa([Dn("text-red-600 font-bold")])([mn("D\xE9faites: "+yr(r))])])}},Bf="block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",Jf=["yellow","red","cyan","lightgreen","magenta"],mb=function(n){return function(r){return function(t){return ds(n.position(r))(function(e){return Wu([Ua("transform")(Tm(Of(e.x))(Of(e.y)))])([dm([lm("M1 1 L10 109 L90 109 L99 1"),im(3),Sf("#000"),Ru("transparent")]),Wu([])(function(){var a=su(he(t)(function(i){return je(i.nbBalls)(i.edge)})),u=ab(105)(qt(a));return Ep(Ja(function(i){return function(c){return ym([pm(15+du(r+i|0)*71),sm(100-du((10+r|0)+i|0)*Tn(u)),fm(5),Ru(Bn("black")(De(Jf)(c)))])}})(a))}()),Wu([])(function(){var a=Tn(ob(ub(function(u){return u.nbBalls})(t)));return he(pu(function(u){return function(i){return{begin:u.end,end:u.end+Tn(i.nbBalls)/a,edge:i.edge}}})({begin:0,end:0,edge:-1})(t))(function(u){return vm([am(3+94*u.begin),em(115),om(ib(94*(u.end-u.begin))),cm("20"),Sf("black"),Ru(Bn("black")(De(Jf)(u.edge)))])})}())])})}}},_b=function(n){return function(r){return qn([Dn("w-[42vw]")])([_m([um(0)(0)(n.width)(n.height)])(he(fb(r))(xe(mb(n))))])}},vb="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",db="rounded overflow-hidden shadow-lg p-4",Gf=function(n){return function(r){return qn([Dn(db)])(kf([qn([Dn("font-bold text-xl mb-2")])([mn(n)])])(r))}},Db=function(n){return Gf("L\xE9gende")([qn([Dn("grid grid-cols-2 gap-4")])(cb(n)(function(r){return[qn([Dn("inline w-12 h-12"),Ua("background-color")(Bn("black")(De(Jf)(r.edge)))])([]),Xa([Dn("text-2xl")])([mn(" : "+r.name)])]}))])},zf="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",yb=function(n){return function(r){return Gf("Choix des param\xE8tres")([qn([Dn("grid grid-cols-2 gap-4")])(kf([qn([])([mn("type de jeu")]),ra([Dn(ta),Vn(function(){if(n.graphType instanceof Ur)return"sub";if(n.graphType instanceof jr)return"king";throw new Error("Failed pattern match at SM.View (line 140, column 25 - line 142, column 35): "+[n.graphType.constructor.name])}()),lt(Cu.create)])([Bt([Vn("sub")])([mn("Soustraction")]),Bt([Vn("king")])([mn("Roi")])])])(kf(function(){if(n.graphType instanceof Ur)return[qn([])([mn("Nombre de casiers")]),ra([Dn(ta),Vn(yr(n.graphType.value0)),lt(Mu.create)])(he($r(8)(16))(function(t){return Bt([Vn(yr(t))])([mn(yr(t))])})),qn([])([mn("Coups possibles")]),qn([Dn("flex flex-row justify-between")])(he($r(1)(5))(function(t){return Dm([])([Za([Ya("checkbox"),mm(lb(t)(n.graphType.value1)),Dn(vb),hm(function(e){return new Eu(t)})]),Xa([Dn("ml-2 text-sm font-medium text-gray-900")])([mn(yr(t))])])}))];if(n.graphType instanceof jr)return[qn([])([mn("Hauteur de la grille")]),ra([Dn(ta),Vn(yr(n.graphType.value1)),lt(wu.create)])(he($r(3)(6))(function(t){return Bt([Vn(yr(t))])([mn(yr(t))])})),qn([])([mn("Largeur de la grille")]),ra([Dn(ta),Vn(yr(n.graphType.value0)),lt(Fu.create)])(he($r(3)(6))(function(t){return Bt([Vn(yr(t))])([mn(yr(t))])}))];throw new Error("Failed pattern match at SM.View (line 150, column 15 - line 188, column 20): "+[n.graphType.constructor.name])}())([qn([])([mn("Adversaire")]),Yn("select")([Dn(ta),Vn(Gp(n.adversary)),lt(Lu.create)])([Yn("option")([Vn("random")])([mn("Al\xE9atoire")]),Yn("option")([Vn("expert")])([mn("Expert")]),Yn("option")([Vn("machine")])([mn("Machine")])]),qn([])([mn("Billes par couleur")]),Za([Ya("number"),Dn(Bf),Pf(2),Rf(10),Vn(yr(n.ballsPerColor)),lt(Nu.create)]),qn([])([mn("R\xE9compense")]),Za([Ya("number"),Dn(Bf),Pf(1),Vn(yr(n.reward)),lt(Iu.create)]),qn([])([mn("P\xE9nalit\xE9")]),Za([Ya("number"),Dn(Bf),Rf(0),Vn(yr(n.penalty)),lt(xu.create)]),qn([])([mn("La machine commence")]),ra([Dn(ta),Vn(function(){return n.machineStarts?"y":"n"}()),lt(Au.create)])([Bt([Vn("y")])([mn("Oui")]),Bt([Vn("n")])([mn("Non")])]),function(){var t=sb(r)(Ot.value);return t?Hu([Dn(zf),$u(function(e){return Tu.value})])([mn("Lancer la machine")]):Hu([Dn(zf),$u(function(e){return bu.value})])([mn("Arr\xEAter la machine")])}(),Hu([Dn(zf),$u(function(t){return Qa.value})])([mn("Pas \xE0 pas")])])))])}},Cm=function(n){var r=function(){if(n.config.graphType instanceof Ur)return Sp(n.config.graphType.value1);if(n.config.graphType instanceof jr)return $p(n.config.graphType.value0)(n.config.graphType.value1);throw new Error("Failed pattern match at SM.View (line 256, column 15 - line 258, column 34): "+[n.config.graphType.constructor.name])}();return qn([Dn("w-screen flex flex-row justify-around items-start")])([Gf("Visualisation de la machine")([qn([Dn("flex flex-col")])([_b(r)(n.graphWithBalls),pb(n.nbVictories)(n.nbLosses)])]),Db(r.legend),yb(n.config)(n.status)])};var Mm=function(){var r=vf(),t=et({newSeed:r,size:0})();return js({init:{model:Jp,msg:D.value},view:Cm,update:function(){var e=Ls(Cn(Uc)({genModel:t}));return function(a){return e(Af(a))}}(),selector:"#root"})()};Mm();})();
