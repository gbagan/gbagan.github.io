(()=>{function Qe(t){let e=0,n;return()=>{if(e===2)return n;if(e===1)throw new Error("Binding demanded before initialized");return e=1,n=t(),e=2,n}}function f(){throw new Error("Failed pattern match")}var Me=function(t){return function(e){return e[t]}},je=function(t){return function(e){return function(n){var a={};for(var o in n)({}).hasOwnProperty.call(n,o)&&(a[o]=n[o]);return a[t]=e,a}}};var ui=()=>({tag:"Proxy"}),St=ui();var rt=function(t){return t.toString()},re=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var $r=t=>({tag:t}),Wt=$r("LT"),Pt=$r("GT"),$e=$r("EQ");var b=(t,e)=>({tag:t,_1:e}),m=b("Nothing"),H=t=>b("Just",t);var bn=t=>{if(t.tag==="Nothing")return!0;if(t.tag==="Just")return!1;f()};var fr={compose:t=>e=>n=>t(e(n))};var ct=function(t){return function(e){for(var n=e.length,a=new Array(n),o=0;o<n;o++)a[o]=t(e[o]);return a}};var Cn=t=>t;var ae=function(t){return function(e){for(var n=[],a=0,o=t.length;a<o;a++)Array.prototype.push.apply(n,e(t[a]));return n}};var tt=(t,e)=>({tag:t,_1:e}),un=t=>tt("Left",t),Qt=t=>tt("Right",t);var dn={map:t=>e=>{if(e.tag==="Left")return tt("Left",e._1);if(e.tag==="Right")return tt("Right",t(e._1));f()}};var Mn=t=>t;var fe={map:t=>e=>t(e)};var La={apply:t=>e=>t(e),Functor0:()=>fe},mi={bind:t=>e=>e(t),Apply0:()=>La},gi={pure:Mn,Apply0:()=>La},Kt={Applicative0:()=>gi,Bind1:()=>mi};var xa=function(t){return function(){return t}};var _i={apply:t=>e=>()=>{let n=t(),a=e();return mr.pure(n(a))()},Functor0:()=>yi},mr={pure:xa,Apply0:()=>_i},yi={map:t=>e=>()=>{let n=e();return t(n)}};var Tt=(t,e)=>({tag:t,_1:e}),yr=t=>Tt("Loop",t),Na=t=>Tt("Done",t);var Ia={tailRecM:t=>{let e=n=>{let a=n,o=!0,i;for(;o;){let d=a;if(d.tag==="Loop"){a=t(d._1);continue}if(d.tag==="Done"){o=!1,i=d._1;continue}f()}return i};return n=>e(t(n))},Monad0:()=>Kt};var we=function(t){return function(e){return function(n){for(var a=e,o=n.length,i=o-1;i>=0;i--)a=t(n[i])(a);return a}}},Xe=function(t){return function(e){return function(n){for(var a=e,o=n.length,i=0;i<o;i++)a=t(a)(n[i]);return a}}};var hr=t=>{let e=t.Apply0(),n=e.Functor0().map;return a=>o=>a.foldr(i=>{let d=o(i);return u=>e.apply(n($=>Cn)(d))(u)})(t.pure())},Ln=t=>{let e=hr(t);return n=>{let a=e(n);return o=>i=>a(i)(o)}};var cn={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);f()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);f()},foldMap:t=>{let e=t.mempty;return n=>a=>{if(a.tag==="Nothing")return e;if(a.tag==="Just")return n(a._1);f()}}};var oe={foldr:we,foldl:Xe,foldMap:t=>{let e=t.Semigroup0().append,n=t.mempty;return a=>oe.foldr(o=>i=>e(a(o))(i))(n)}};var _=(t,e)=>({tag:"Tuple",_1:t,_2:e});var Yt=t=>t._2;var Nn={map:t=>e=>_(e._1,t(e._2))};var Ne=t=>t._1;var In=t=>{let e=t.Eq0();return n=>{let a=n.Eq0(),o={eq:i=>d=>e.eq(i._1)(d._1)&&a.eq(i._2)(d._2)};return{compare:i=>d=>{let u=t.compare(i._1)(d._1);return u.tag==="LT"?Wt:u.tag==="GT"?Pt:n.compare(i._2)(d._2)},Eq0:()=>o}}};var S=(t,e,n)=>({tag:t,_1:e,_2:n});var w=S("Nil");var wa=(()=>(e=>n=>{let a=e,o=n,i=!0,d;for(;i;){let u=a,$=o;if($.tag==="Nil"){i=!1,d=u;continue}if($.tag==="Cons"){a=S("Cons",$._1,u),o=$._2;continue}f()}return d})(w))();var ki=function(){function t(o){return[o]}function e(o){return function(i){return[o,i]}}function n(o){return function(i){return function(d){return[o,i,d]}}}function a(o){return function(i){return o.concat(i)}}return function(o){return function(i){return function(d){return function(u){return function($){function l(p,c){switch(c-p){case 0:return d([]);case 1:return i(t)(u($[p]));case 2:return o(i(e)(u($[p])))(u($[p+1]));case 3:return o(o(i(n)(u($[p])))(u($[p+1])))(u($[p+2]));default:var r=p+Math.floor((c-p)/4)*2;return o(i(a)(l(p,r)))(l(r,c))}}return l(0,$.length)}}}}}}();var Ct=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var Ga=t=>{let e=t,n=!0,a;for(;n;){let o=e;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){n=!1,a=m;continue}e=Ct(wa(o._2),w);continue}if(o._1.tag==="Cons"){n=!1,a=b("Just",_(o._1._1,Ct(o._1._2,o._2)));continue}f()}return a};var Lt=(t,e,n)=>({tag:t,_1:e,_2:n}),G=Lt("CatNil");var Mt=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return Lt("CatCons",t._1,Ct(t._2._1,S("Cons",e,t._2._2)));f()},gu=t=>e=>n=>{let a=i=>d=>u=>{let $=i,l=d,p=u,c=!0,r;for(;c;){let s=$,h=l,P=p;if(P.tag==="Nil"){c=!1,r=h;continue}if(P.tag==="Cons"){$=s,l=s(h)(P._1),p=P._2;continue}f()}return r};return(i=>d=>{let u=i,$=d,l=!0,p;for(;l;){let c=u,r=$,s=Ga(c);if(s.tag==="Nothing"){l=!1,p=a(h=>P=>P(h))(e)(r);continue}if(s.tag==="Just"){u=s._1._2,$=S("Cons",t(s._1._1),r);continue}f()}return p})(n)(w)},Oa=t=>{if(t.tag==="CatNil")return m;if(t.tag==="CatCons")return b("Just",_(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?G:gu(Mt)(G)(t._2)));f()};var A=(t,e)=>({tag:"Free",_1:t,_2:e}),j=(t,e,n)=>({tag:t,_1:e,_2:n});var Qa=t=>{let e=t,n=!0,a;for(;n;){let o=e;if(o._1.tag==="Return"){let i=Oa(o._2);if(i.tag==="Nothing"){n=!1,a=j("Return",o._1._1);continue}if(i.tag==="Just"){e=(()=>{let d=i._1._1(o._1._1);return A(d._1,Mt(d._2)(i._1._2))})();continue}f()}if(o._1.tag==="Bind"){n=!1,a=j("Bind",o._1._1,i=>{let d=o._1._2(i);return A(d._1,Mt(d._2)(o._2))});continue}f()}return a},ja=t=>e=>{let n=e.Monad0(),a=n.Bind1().Apply0().Functor0().map,o=n.Applicative0().pure;return i=>e.tailRecM(d=>{let u=Qa(d);if(u.tag==="Return")return a(Na)(o(u._1));if(u.tag==="Bind")return a(yr)(i(t.map(u._2)(u._1)));f()})};var Sn={Applicative0:()=>An,Bind1:()=>Ir},Va={map:t=>e=>Ir.bind(e)(n=>An.pure(t(n)))},Ir={bind:t=>e=>A(t._1,Mt(t._2)(Lt("CatCons",e,Ct(w,w)))),Apply0:()=>Er},Er={apply:t=>e=>A(t._1,Mt(t._2)(Lt("CatCons",n=>A(e._1,Mt(e._2)(Lt("CatCons",a=>An.pure(n(a)),Ct(w,w)))),Ct(w,w)))),Functor0:()=>Va},An={pure:t=>A(j("Return",t),G),Apply0:()=>Er};var wn={tailRecM:t=>e=>{let n=t(e);return A(n._1,Mt(n._2)(Lt("CatCons",a=>{if(a.tag==="Loop")return wn.tailRecM(t)(a._1);if(a.tag==="Done")return A(j("Return",a._1),G);f()},Ct(w,w))))},Monad0:()=>Sn};var _u=t=>{let e=n=>{let a=Qa(n);if(a.tag==="Return")return A(j("Return",a._1),G);if(a.tag==="Bind"){let o=t(a._1);return A(o._1,Mt(o._2)(Lt("CatCons",i=>e(a._2(i)),Ct(w,w))))}f()};return e},Ka=t=>_u(e=>A(j("Bind",t(e),n=>A(j("Return",n),G)),G));var Ya=function(t){return function(e){return t===e}};var Za=Ya,Xa=Ya;var to={eq:Xa},Re={eq:Za};var tn=function(t){var e=null;return function(){return t===void 0||(e=t(),t=void 0),e}},We=function(t){return t()};var no=function(t){return function(e){return function(n){return function(a){return function(o){return a<o?t:a===o?e:n}}}}};var ro=no,ao=no;var Ar={compare:ao(Wt)($e)(Pt),Eq0:()=>to},X={compare:ro(Wt)($e)(Pt),Eq0:()=>Re};var so=function(t){return function(e){return function(n){return function(a){return function(o){return function(i){for(var d=[],u=i;;){var $=o(u);d.push(n($));var l=a($);if(t(l))return d;u=e(l)}}}}}}};var Tu=t=>{if(t.tag==="Just")return t._1;f()};var wr={unfoldr1:so(bn)(Tu)(Ne)(Yt)};var uo=function(t){return function(e){return function(n){return function(a){return function(o){return function(i){for(var d=[],u=i;;){var $=o(u);if(t($))return d;var l=e($);d.push(n(l)),u=a(l)}}}}}}};var Cu=t=>{if(t.tag==="Just")return t._1;f()};var Pe={unfoldr:uo(bn)(Cu)(Ne)(Yt),Unfoldable10:()=>wr};var gt=function(t){throw new Error(t)};var Wn=(t,e,n,a)=>({tag:"KickUp",_1:t,_2:e,_3:n,_4:a}),T=(t,e,n,a,o,i,d,u)=>({tag:t,_1:e,_2:n,_3:a,_4:o,_5:i,_6:d,_7:u}),at=(t,e,n,a,o,i,d)=>({tag:t,_1:e,_2:n,_3:a,_4:o,_5:i,_6:d});var z=T("Leaf");var Pn=t=>e=>{let n=a=>{let o=a,i=!0,d;for(;i;){let u=o;if(u.tag==="Nil"){i=!1,d=m;continue}if(u.tag==="Cons"){if(u._1.tag==="Leaf"){o=u._2;continue}if(u._1.tag==="Two"){if(u._1._1.tag==="Leaf"){if(u._1._4.tag==="Leaf"){i=!1,d=b("Just",_(_(u._1._2,u._1._3),u._2));continue}i=!1,d=b("Just",_(_(u._1._2,u._1._3),S("Cons",u._1._4,u._2)));continue}o=S("Cons",u._1._1,S("Cons",T("Two",z,u._1._2,u._1._3,z),S("Cons",u._1._4,u._2)));continue}if(u._1.tag==="Three"){o=S("Cons",u._1._1,S("Cons",T("Two",z,u._1._2,u._1._3,z),S("Cons",u._1._4,S("Cons",T("Two",z,u._1._5,u._1._6,z),S("Cons",u._1._7,u._2)))));continue}f()}f()}return d};return t.unfoldr(n)(S("Cons",e,w))};var Xt=t=>e=>a=>{let o=a,i=!0,d;for(;i;){let u=o;if(u.tag==="Leaf"){i=!1,d=m;continue}if(u.tag==="Two"){let $=t.compare(e)(u._2);if($.tag==="EQ"){i=!1,d=b("Just",u._3);continue}if($.tag==="LT"){o=u._1;continue}o=u._4;continue}if(u.tag==="Three"){let $=t.compare(e)(u._2);if($.tag==="EQ"){i=!1,d=b("Just",u._3);continue}let l=t.compare(e)(u._5);if(l.tag==="EQ"){i=!1,d=b("Just",u._6);continue}if($.tag==="LT"){o=u._1;continue}if(l.tag==="GT"){o=u._7;continue}o=u._4;continue}f()}return d};var Zt={map:t=>e=>{if(e.tag==="Leaf")return z;if(e.tag==="Two")return T("Two",Zt.map(t)(e._1),e._2,t(e._3),Zt.map(t)(e._4));if(e.tag==="Three")return T("Three",Zt.map(t)(e._1),e._2,t(e._3),Zt.map(t)(e._4),e._5,t(e._6),Zt.map(t)(e._7));f()}};var _t=t=>e=>n=>{let a=t,o=e,i=n,d=!0,u;for(;d;){let $=a,l=o,p=i;if(l.tag==="Nil"){d=!1,u=p;continue}if(l.tag==="Cons"){if(l._1.tag==="TwoLeft"){a=$,o=l._2,i=T("Two",p,l._1._1,l._1._2,l._1._3);continue}if(l._1.tag==="TwoRight"){a=$,o=l._2,i=T("Two",l._1._1,l._1._2,l._1._3,p);continue}if(l._1.tag==="ThreeLeft"){a=$,o=l._2,i=T("Three",p,l._1._1,l._1._2,l._1._3,l._1._4,l._1._5,l._1._6);continue}if(l._1.tag==="ThreeMiddle"){a=$,o=l._2,i=T("Three",l._1._1,l._1._2,l._1._3,p,l._1._4,l._1._5,l._1._6);continue}if(l._1.tag==="ThreeRight"){a=$,o=l._2,i=T("Three",l._1._1,l._1._2,l._1._3,l._1._4,l._1._5,l._1._6,p);continue}f()}f()}return u},qn=t=>e=>n=>{let a=i=>d=>{let u=i,$=d,l=!0,p;for(;l;){let c=u,r=$;if(c.tag==="Nil"){l=!1,p=T("Two",r._1,r._2,r._3,r._4);continue}if(c.tag==="Cons"){if(c._1.tag==="TwoLeft"){l=!1,p=_t(t)(c._2)(T("Three",r._1,r._2,r._3,r._4,c._1._1,c._1._2,c._1._3));continue}if(c._1.tag==="TwoRight"){l=!1,p=_t(t)(c._2)(T("Three",c._1._1,c._1._2,c._1._3,r._1,r._2,r._3,r._4));continue}if(c._1.tag==="ThreeLeft"){u=c._2,$=Wn(T("Two",r._1,r._2,r._3,r._4),c._1._1,c._1._2,T("Two",c._1._3,c._1._4,c._1._5,c._1._6));continue}if(c._1.tag==="ThreeMiddle"){u=c._2,$=Wn(T("Two",c._1._1,c._1._2,c._1._3,r._1),r._2,r._3,T("Two",r._4,c._1._4,c._1._5,c._1._6));continue}if(c._1.tag==="ThreeRight"){u=c._2,$=Wn(T("Two",c._1._1,c._1._2,c._1._3,c._1._4),c._1._5,c._1._6,T("Two",r._1,r._2,r._3,r._4));continue}f()}f()}return p};return(i=>d=>{let u=i,$=d,l=!0,p;for(;l;){let c=u,r=$;if(r.tag==="Leaf"){l=!1,p=a(c)(Wn(z,e,n,z));continue}if(r.tag==="Two"){let s=t.compare(e)(r._2);if(s.tag==="EQ"){l=!1,p=_t(t)(c)(T("Two",r._1,e,n,r._4));continue}if(s.tag==="LT"){u=S("Cons",at("TwoLeft",r._2,r._3,r._4),c),$=r._1;continue}u=S("Cons",at("TwoRight",r._1,r._2,r._3),c),$=r._4;continue}if(r.tag==="Three"){let s=t.compare(e)(r._2);if(s.tag==="EQ"){l=!1,p=_t(t)(c)(T("Three",r._1,e,n,r._4,r._5,r._6,r._7));continue}let h=t.compare(e)(r._5);if(h.tag==="EQ"){l=!1,p=_t(t)(c)(T("Three",r._1,r._2,r._3,r._4,e,n,r._7));continue}if(s.tag==="LT"){u=S("Cons",at("ThreeLeft",r._2,r._3,r._4,r._5,r._6,r._7),c),$=r._1;continue}if(s.tag==="GT"){if(h.tag==="LT"){u=S("Cons",at("ThreeMiddle",r._1,r._2,r._3,r._5,r._6,r._7),c),$=r._4;continue}u=S("Cons",at("ThreeRight",r._1,r._2,r._3,r._4,r._5,r._6),c),$=r._7;continue}u=S("Cons",at("ThreeRight",r._1,r._2,r._3,r._4,r._5,r._6),c),$=r._7;continue}f()}return p})(w)},Mu=t=>e=>{let n=d=>u=>{let $=d,l=u,p=!0,c;for(;p;){let r=$,s=l;if(r.tag==="Nil"){p=!1,c=s;continue}if(r.tag==="Cons"){let h=r._2,P=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",T("Two",yt,et,it,ht),B,ut,T("Two",ot,st,U,Dt))),nt=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",T("Two",yt,et,it,ht),B,ut,T("Two",ot,st,U,Dt))),lt=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",T("Three",yt,et,it,ht,B,ut,ot),st,U,Dt)),Ft=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",T("Three",yt,et,it,ht,B,ut,ot),st,U,Dt)),ne=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",yt,et,it,T("Three",ht,B,ut,ot,st,U,Dt))),Oe=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",yt,et,it,T("Three",ht,B,ut,ot,st,U,Dt))),M=(yt,ht,ot,Dt,et,B,st,it,ut,U,zt,jt,pe)=>_t(t)(h)(T("Three",T("Two",yt,B,U,ht),st,zt,T("Two",ot,it,jt,Dt),ut,pe,et)),Rt=(yt,ht,ot,Dt,et,B,st,it,ut,U,zt,jt,pe)=>_t(t)(h)(T("Three",T("Two",yt,B,U,ht),st,zt,T("Two",ot,it,jt,Dt),ut,pe,et)),Se=(yt,ht,ot,Dt,et,B,st,it,ut,U,zt,jt,pe)=>_t(t)(h)(T("Three",yt,B,U,T("Two",ht,st,zt,ot),it,jt,T("Two",Dt,ut,pe,et))),on=(yt,ht,ot,Dt,et,B,st,it,ut,U,zt,jt,pe)=>_t(t)(h)(T("Three",yt,B,U,T("Two",ht,st,zt,ot),it,jt,T("Two",Dt,ut,pe,et)));if(s.tag==="Leaf"){if(r._1.tag==="TwoLeft"){if(r._1._3.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Two",z,r._1._1,r._1._2,z));continue}if(r._1._3.tag==="Two"){$=h,l=T("Three",s,r._1._1,r._1._2,r._1._3._1,r._1._3._2,r._1._3._3,r._1._3._4);continue}if(r._1._3.tag==="Three"){p=!1,c=P(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._1,r._1._3._2,r._1._3._5,r._1._2,r._1._3._3,r._1._3._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="TwoRight"){if(r._1._1.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Two",z,r._1._2,r._1._3,z));continue}if(r._1._1.tag==="Two"){$=h,l=T("Three",r._1._1._1,r._1._1._2,r._1._1._3,r._1._1._4,r._1._2,r._1._3,s);continue}if(r._1._1.tag==="Three"){p=!1,c=nt(r._1._1._1,r._1._1._4,r._1._1._7,s,r._1._1._2,r._1._1._5,r._1._2,r._1._1._3,r._1._1._6,r._1._3);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeLeft"){if(r._1._6.tag==="Leaf"){if(r._1._3.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Three",z,r._1._1,r._1._2,z,r._1._4,r._1._5,z));continue}if(r._1._3.tag==="Two"){p=!1,c=lt(s,r._1._3._1,r._1._3._4,r._1._6,r._1._1,r._1._3._2,r._1._4,r._1._2,r._1._3._3,r._1._5);continue}if(r._1._3.tag==="Three"){p=!1,c=M(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._6,r._1._1,r._1._3._2,r._1._3._5,r._1._4,r._1._2,r._1._3._3,r._1._3._6,r._1._5);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1._3.tag==="Two"){p=!1,c=lt(s,r._1._3._1,r._1._3._4,r._1._6,r._1._1,r._1._3._2,r._1._4,r._1._2,r._1._3._3,r._1._5);continue}if(r._1._3.tag==="Three"){p=!1,c=M(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._6,r._1._1,r._1._3._2,r._1._3._5,r._1._4,r._1._2,r._1._3._3,r._1._3._6,r._1._5);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeMiddle"){if(r._1._1.tag==="Leaf"){if(r._1._6.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Three",z,r._1._2,r._1._3,z,r._1._4,r._1._5,z));continue}if(r._1._6.tag==="Two"){p=!1,c=ne(r._1._1,s,r._1._6._1,r._1._6._4,r._1._2,r._1._4,r._1._6._2,r._1._3,r._1._5,r._1._6._3);continue}if(r._1._6.tag==="Three"){p=!1,c=Se(r._1._1,s,r._1._6._1,r._1._6._4,r._1._6._7,r._1._2,r._1._4,r._1._6._2,r._1._6._5,r._1._3,r._1._5,r._1._6._3,r._1._6._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1._1.tag==="Two"){p=!1,c=Ft(r._1._1._1,r._1._1._4,s,r._1._6,r._1._1._2,r._1._2,r._1._4,r._1._1._3,r._1._3,r._1._5);continue}if(r._1._6.tag==="Two"){p=!1,c=ne(r._1._1,s,r._1._6._1,r._1._6._4,r._1._2,r._1._4,r._1._6._2,r._1._3,r._1._5,r._1._6._3);continue}if(r._1._1.tag==="Three"){p=!1,c=Rt(r._1._1._1,r._1._1._4,r._1._1._7,s,r._1._6,r._1._1._2,r._1._1._5,r._1._2,r._1._4,r._1._1._3,r._1._1._6,r._1._3,r._1._5);continue}if(r._1._6.tag==="Three"){p=!1,c=Se(r._1._1,s,r._1._6._1,r._1._6._4,r._1._6._7,r._1._2,r._1._4,r._1._6._2,r._1._6._5,r._1._3,r._1._5,r._1._6._3,r._1._6._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeRight"){if(r._1._1.tag==="Leaf"){if(r._1._4.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Three",z,r._1._2,r._1._3,z,r._1._5,r._1._6,z));continue}if(r._1._4.tag==="Two"){p=!1,c=Oe(r._1._1,r._1._4._1,r._1._4._4,s,r._1._2,r._1._4._2,r._1._5,r._1._3,r._1._4._3,r._1._6);continue}if(r._1._4.tag==="Three"){p=!1,c=on(r._1._1,r._1._4._1,r._1._4._4,r._1._4._7,s,r._1._2,r._1._4._2,r._1._4._5,r._1._5,r._1._3,r._1._4._3,r._1._4._6,r._1._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1._4.tag==="Two"){p=!1,c=Oe(r._1._1,r._1._4._1,r._1._4._4,s,r._1._2,r._1._4._2,r._1._5,r._1._3,r._1._4._3,r._1._6);continue}if(r._1._4.tag==="Three"){p=!1,c=on(r._1._1,r._1._4._1,r._1._4._4,r._1._4._7,s,r._1._2,r._1._4._2,r._1._4._5,r._1._5,r._1._3,r._1._4._3,r._1._4._6,r._1._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="TwoLeft"){if(r._1._3.tag==="Two"){$=h,l=T("Three",s,r._1._1,r._1._2,r._1._3._1,r._1._3._2,r._1._3._3,r._1._3._4);continue}if(r._1._3.tag==="Three"){p=!1,c=P(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._1,r._1._3._2,r._1._3._5,r._1._2,r._1._3._3,r._1._3._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="TwoRight"){if(r._1._1.tag==="Two"){$=h,l=T("Three",r._1._1._1,r._1._1._2,r._1._1._3,r._1._1._4,r._1._2,r._1._3,s);continue}if(r._1._1.tag==="Three"){p=!1,c=nt(r._1._1._1,r._1._1._4,r._1._1._7,s,r._1._1._2,r._1._1._5,r._1._2,r._1._1._3,r._1._1._6,r._1._3);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeLeft"){if(r._1._3.tag==="Two"){p=!1,c=lt(s,r._1._3._1,r._1._3._4,r._1._6,r._1._1,r._1._3._2,r._1._4,r._1._2,r._1._3._3,r._1._5);continue}if(r._1._3.tag==="Three"){p=!1,c=M(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._6,r._1._1,r._1._3._2,r._1._3._5,r._1._4,r._1._2,r._1._3._3,r._1._3._6,r._1._5);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeMiddle"){if(r._1._1.tag==="Two"){p=!1,c=Ft(r._1._1._1,r._1._1._4,s,r._1._6,r._1._1._2,r._1._2,r._1._4,r._1._1._3,r._1._3,r._1._5);continue}if(r._1._6.tag==="Two"){p=!1,c=ne(r._1._1,s,r._1._6._1,r._1._6._4,r._1._2,r._1._4,r._1._6._2,r._1._3,r._1._5,r._1._6._3);continue}if(r._1._1.tag==="Three"){p=!1,c=Rt(r._1._1._1,r._1._1._4,r._1._1._7,s,r._1._6,r._1._1._2,r._1._1._5,r._1._2,r._1._4,r._1._1._3,r._1._1._6,r._1._3,r._1._5);continue}if(r._1._6.tag==="Three"){p=!1,c=Se(r._1._1,s,r._1._6._1,r._1._6._4,r._1._6._7,r._1._2,r._1._4,r._1._6._2,r._1._6._5,r._1._3,r._1._5,r._1._6._3,r._1._6._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeRight"){if(r._1._4.tag==="Two"){p=!1,c=Oe(r._1._1,r._1._4._1,r._1._4._4,s,r._1._2,r._1._4._2,r._1._5,r._1._3,r._1._4._3,r._1._6);continue}if(r._1._4.tag==="Three"){p=!1,c=on(r._1._1,r._1._4._1,r._1._4._4,r._1._4._7,s,r._1._2,r._1._4._2,r._1._4._5,r._1._5,r._1._3,r._1._4._3,r._1._4._6,r._1._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}f()}return c},a=d=>u=>{let $=d,l=u,p=!0,c;for(;p;){let r=$,s=l;if(s.tag==="Two"){if(s._1.tag==="Leaf"){if(s._4.tag==="Leaf"){p=!1,c=n(r)(z);continue}$=S("Cons",at("TwoRight",s._1,s._2,s._3),r),l=s._4;continue}$=S("Cons",at("TwoRight",s._1,s._2,s._3),r),l=s._4;continue}if(s.tag==="Three"){if(s._1.tag==="Leaf"){if(s._4.tag==="Leaf"){if(s._7.tag==="Leaf"){p=!1,c=n(S("Cons",at("TwoRight",z,s._2,s._3),r))(z);continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}p=!1,c=gt("The impossible happened in partial function `removeMaxNode`.")}return c},o=d=>{let u=d,$=!0,l;for(;$;){let p=u;if(p.tag==="Two"){if(p._4.tag==="Leaf"){$=!1,l={key:p._2,value:p._3};continue}u=p._4;continue}if(p.tag==="Three"){if(p._7.tag==="Leaf"){$=!1,l={key:p._5,value:p._6};continue}u=p._7;continue}$=!1,l=gt("The impossible happened in partial function `maxNode`.")}return l};return(d=>u=>{let $=d,l=u,p=!0,c;for(;p;){let r=$,s=l;if(s.tag==="Leaf"){p=!1,c=m;continue}if(s.tag==="Two"){let h=t.compare(e)(s._2);if(h.tag==="EQ"){if(s._4.tag==="Leaf"){p=!1,c=b("Just",_(s._3,n(r)(z)));continue}let P=o(s._1);p=!1,c=b("Just",_(s._3,a(S("Cons",at("TwoLeft",P.key,P.value,s._4),r))(s._1)));continue}if(h.tag==="LT"){$=S("Cons",at("TwoLeft",s._2,s._3,s._4),r),l=s._1;continue}$=S("Cons",at("TwoRight",s._1,s._2,s._3),r),l=s._4;continue}if(s.tag==="Three"){let h=t.compare(e)(s._5),P=t.compare(e)(s._2);if((()=>s._1.tag==="Leaf"&&s._4.tag==="Leaf"?s._7.tag==="Leaf":!1)()){if(P.tag==="EQ"){p=!1,c=b("Just",_(s._3,_t(t)(r)(T("Two",z,s._5,s._6,z))));continue}if(h.tag==="EQ"){p=!1,c=b("Just",_(s._6,_t(t)(r)(T("Two",z,s._2,s._3,z))));continue}if(P.tag==="LT"){$=S("Cons",at("ThreeLeft",s._2,s._3,s._4,s._5,s._6,s._7),r),l=s._1;continue}if(P.tag==="GT"){if(h.tag==="LT"){$=S("Cons",at("ThreeMiddle",s._1,s._2,s._3,s._5,s._6,s._7),r),l=s._4;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}if(P.tag==="EQ"){let nt=o(s._1);p=!1,c=b("Just",_(s._3,a(S("Cons",at("ThreeLeft",nt.key,nt.value,s._4,s._5,s._6,s._7),r))(s._1)));continue}if(h.tag==="EQ"){let nt=o(s._4);p=!1,c=b("Just",_(s._6,a(S("Cons",at("ThreeMiddle",s._1,s._2,s._3,nt.key,nt.value,s._7),r))(s._4)));continue}if(P.tag==="LT"){$=S("Cons",at("ThreeLeft",s._2,s._3,s._4,s._5,s._6,s._7),r),l=s._1;continue}if(P.tag==="GT"){if(h.tag==="LT"){$=S("Cons",at("ThreeMiddle",s._1,s._2,s._3,s._5,s._6,s._7),r),l=s._4;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}f()}return c})(w)};var vn=t=>e=>e.foldl(n=>a=>qn(t)(a._1)(a._2)(n))(z);var Lu=t=>e=>n=>{let a=Mu(t)(e)(n);if(a.tag==="Nothing")return n;if(a.tag==="Just")return a._1._2;f()};var xu=t=>e=>n=>a=>{let o=e(Xt(t)(n)(a));if(o.tag==="Nothing")return Lu(t)(n)(a);if(o.tag==="Just")return qn(t)(n)(o._1)(a);f()};var Rr=t=>e=>n=>a=>xu(t)(o=>{if(o.tag==="Nothing")return m;if(o.tag==="Just")return e(o._1);f()})(n)(a);function wt(t,e,n){return t==null?e:n(t)}var Ht=function(){var t={},e="Pure",n="Throw",a="Catch",o="Sync",i="Async",d="Bind",u="Bracket",$="Fork",l="Sequential",p="Map",c="Apply",r="Alt",s="Cons",h="Resume",P="Release",nt="Finalizer",lt="Finalized",Ft="Forked",ne="Fiber",Oe="Thunk";function M(D,k,pt,V){this.tag=D,this._1=k,this._2=pt,this._3=V}function Rt(D){var k=function(pt,V,L){return new M(D,pt,V,L)};return k.tag=D,k}function Se(D){return new M(e,void 0)}function on(D){try{D()}catch(k){setTimeout(function(){throw k},0)}}function yt(D,k,pt){try{return k(pt())}catch(V){return D(V)}}function ht(D,k,pt){try{return k(pt)()}catch(V){return pt(D(V))(),Se}}var ot=function(){var D=1024,k=0,pt=0,V=new Array(D),L=!1;function g(){var Q;for(L=!0;k!==0;)k--,Q=V[pt],V[pt]=void 0,pt=(pt+1)%D,Q();L=!1}return{isDraining:function(){return L},enqueue:function(Q){var R,dt;k===D&&(dt=L,g(),L=dt),V[(pt+k)%D]=Q,k++,L||g()}}}();function Dt(D){var k={},pt=0,V=0;return{register:function(L){var g=pt++;L.onComplete({rethrow:!0,handler:function(Q){return function(){V--,delete k[g]}}})(),k[g]=L,V++},isEmpty:function(){return V===0},killAll:function(L,g){return function(){if(V===0)return g();var Q=0,R={};function dt(Y){R[Y]=k[Y].kill(L,function(mt){return function(){delete R[Y],Q--,D.isLeft(mt)&&D.fromLeft(mt)&&setTimeout(function(){throw D.fromLeft(mt)},0),Q===0&&g()}})()}for(var Nt in k)k.hasOwnProperty(Nt)&&(Q++,dt(Nt));return k={},pt=0,V=0,function(Y){return new M(o,function(){for(var mt in R)R.hasOwnProperty(mt)&&R[mt]()})}}}}}var et=0,B=1,st=2,it=3,ut=4,U=5,zt=6;function jt(D,k,pt){var V=0,L=et,g=pt,Q=null,R=null,dt=null,Nt=null,Y=null,mt=0,Ae=0,Gt=null,Te=!0;function Ce(x){for(var N,q,J;;)switch(N=null,q=null,J=null,L){case st:L=B;try{g=dt(g),Nt===null?dt=null:(dt=Nt._1,Nt=Nt._2)}catch(Et){L=U,Q=D.left(Et),g=null}break;case it:D.isLeft(g)?(L=U,Q=g,g=null):dt===null?L=U:(L=st,g=D.fromRight(g));break;case B:switch(g.tag){case d:dt&&(Nt=new M(s,dt,Nt)),dt=g._2,L=B,g=g._1;break;case e:dt===null?(L=U,g=D.right(g._1)):(L=st,g=g._1);break;case o:L=it,g=yt(D.left,D.right,g._1);break;case i:L=ut,g=ht(D.left,g._1,function(Et){return function(){V===x&&(V++,ot.enqueue(function(){V===x+1&&(L=it,g=Et,Ce(V))}))}});return;case n:L=U,Q=D.left(g._1),g=null;break;case a:dt===null?Y=new M(s,g,Y,R):Y=new M(s,g,new M(s,new M(h,dt,Nt),Y,R),R),dt=null,Nt=null,L=B,g=g._1;break;case u:mt++,dt===null?Y=new M(s,g,Y,R):Y=new M(s,g,new M(s,new M(h,dt,Nt),Y,R),R),dt=null,Nt=null,L=B,g=g._1;break;case $:L=it,N=jt(D,k,g._2),k&&k.register(N),g._1&&N.run(),g=D.right(N);break;case l:L=B,g=si(D,k,g._1);break}break;case U:if(dt=null,Nt=null,Y===null)L=zt,g=R||Q||g;else switch(N=Y._3,J=Y._1,Y=Y._2,J.tag){case a:R&&R!==N&&mt===0?L=U:Q&&(L=B,g=J._2(D.fromLeft(Q)),Q=null);break;case h:R&&R!==N&&mt===0||Q?L=U:(dt=J._1,Nt=J._2,L=st,g=D.fromRight(g));break;case u:mt--,Q===null&&(q=D.fromRight(g),Y=new M(s,new M(P,J._2,q),Y,N),(R===N||mt>0)&&(L=B,g=J._3(q)));break;case P:Y=new M(s,new M(lt,g,Q),Y,R),L=B,R&&R!==N&&mt===0?g=J._1.killed(D.fromLeft(R))(J._2):Q?g=J._1.failed(D.fromLeft(Q))(J._2):g=J._1.completed(D.fromRight(g))(J._2),Q=null,mt++;break;case nt:mt++,Y=new M(s,new M(lt,g,Q),Y,R),L=B,g=J._1;break;case lt:mt--,L=U,g=J._1,Q=J._2;break}break;case zt:for(var ft in Gt)Gt.hasOwnProperty(ft)&&(Te=Te&&Gt[ft].rethrow,on(Gt[ft].handler(g)));Gt=null,R&&Q?setTimeout(function(){throw D.fromLeft(Q)},0):D.isLeft(g)&&Te&&setTimeout(function(){if(Te)throw D.fromLeft(g)},0);return;case et:L=B;break;case ut:return}}function $t(x){return function(){if(L===zt)return Te=Te&&x.rethrow,x.handler(g)(),function(){};var N=Ae++;return Gt=Gt||{},Gt[N]=x,function(){Gt!==null&&delete Gt[N]}}}function I(x,N){return function(){if(L===zt)return N(D.right(void 0))(),function(){};var q=$t({rethrow:!1,handler:function(){return N(D.right(void 0))}})();switch(L){case et:R=D.left(x),L=zt,g=R,Ce(V);break;case ut:R===null&&(R=D.left(x)),mt===0&&(L===ut&&(Y=new M(s,new M(nt,g(x)),Y,R)),L=U,g=null,Q=null,Ce(++V));break;default:R===null&&(R=D.left(x)),mt===0&&(L=U,g=null,Q=null)}return q}}function W(x){return function(){var N=$t({rethrow:!1,handler:x})();return L===et&&Ce(V),N}}return{kill:I,join:W,onComplete:$t,isSuspended:function(){return L===et},run:function(){L===et&&(ot.isDraining()?Ce(V):ot.enqueue(function(){Ce(V)}))}}}function pe(D,k,pt,V){var L=0,g={},Q=0,R={},dt=new Error("[ParAff] Early exit"),Nt=null,Y=t;function mt($t,I,W){var x=I,N=null,q=null,J=0,ft={},Et,sn;t:for(;;)switch(Et=null,x.tag){case Ft:if(x._3===t&&(Et=g[x._1],ft[J++]=Et.kill($t,function(ii){return function(){J--,J===0&&W(ii)()}})),N===null)break t;x=N._2,q===null?N=null:(N=q._1,q=q._2);break;case p:x=x._2;break;case c:case r:N&&(q=new M(s,N,q)),N=x,x=x._1;break}if(J===0)W(D.right(void 0))();else for(sn=0,Et=J;sn<Et;sn++)ft[sn]=ft[sn]();return ft}function Ae($t,I,W){var x,N,q,J,ft,Et;D.isLeft($t)?(x=$t,N=null):(N=$t,x=null);t:for(;;){if(q=null,J=null,ft=null,Et=null,Nt!==null)return;if(I===null){V(x||N)();return}if(I._3!==t)return;switch(I.tag){case p:x===null?(I._3=D.right(I._1(D.fromRight(N))),N=I._3):I._3=x;break;case c:if(q=I._1._3,J=I._2._3,x){if(I._3=x,ft=!0,Et=Q++,R[Et]=mt(dt,x===q?I._2:I._1,function(){return function(){delete R[Et],ft?ft=!1:W===null?Ae(x,null,null):Ae(x,W._1,W._2)}}),ft){ft=!1;return}}else{if(q===t||J===t)return;N=D.right(D.fromRight(q)(D.fromRight(J))),I._3=N}break;case r:if(q=I._1._3,J=I._2._3,q===t&&D.isLeft(J)||J===t&&D.isLeft(q))return;if(q!==t&&D.isLeft(q)&&J!==t&&D.isLeft(J))x=N===q?J:q,N=null,I._3=x;else if(I._3=N,ft=!0,Et=Q++,R[Et]=mt(dt,N===q?I._2:I._1,function(){return function(){delete R[Et],ft?ft=!1:W===null?Ae(N,null,null):Ae(N,W._1,W._2)}}),ft){ft=!1;return}break}W===null?I=null:(I=W._1,W=W._2)}}function Gt($t){return function(I){return function(){delete g[$t._1],$t._3=I,Ae(I,$t._2._1,$t._2._2)}}}function Te(){var $t=B,I=pt,W=null,x=null,N,q;t:for(;;)switch(N=null,q=null,$t){case B:switch(I.tag){case p:W&&(x=new M(s,W,x)),W=new M(p,I._1,t,t),I=I._2;break;case c:W&&(x=new M(s,W,x)),W=new M(c,t,I._2,t),I=I._1;break;case r:W&&(x=new M(s,W,x)),W=new M(r,t,I._2,t),I=I._1;break;default:q=L++,$t=U,N=I,I=new M(Ft,q,new M(s,W,x),t),N=jt(D,k,N),N.onComplete({rethrow:!1,handler:Gt(I)})(),g[q]=N,k&&k.register(N)}break;case U:if(W===null)break t;W._1===t?(W._1=I,$t=B,I=W._2,W._2=t):(W._2=I,I=W,x===null?W=null:(W=x._1,x=x._2))}for(Y=I,q=0;q<L;q++)g[q].run()}function Ce($t,I){Nt=D.left($t);var W;for(var x in R)if(R.hasOwnProperty(x)){W=R[x];for(x in W)W.hasOwnProperty(x)&&W[x]()}R=null;var N=mt($t,Y,I);return function(q){return new M(i,function(J){return function(){for(var ft in N)N.hasOwnProperty(ft)&&N[ft]();return Se}})}}return Te(),function($t){return new M(i,function(I){return function(){return Ce($t,I)}})}}function si(D,k,pt){return new M(i,function(V){return function(){return pe(D,k,pt,V)}})}return M.EMPTY=t,M.Pure=Rt(e),M.Throw=Rt(n),M.Catch=Rt(a),M.Sync=Rt(o),M.Async=Rt(i),M.Bind=Rt(d),M.Bracket=Rt(u),M.Fork=Rt($),M.Seq=Rt(l),M.ParMap=Rt(p),M.ParApply=Rt(c),M.ParAlt=Rt(r),M.Fiber=jt,M.Supervisor=Dt,M.Scheduler=ot,M.nonCanceler=Se,M}(),ye=Ht.Pure,Ru=Ht.Throw;function $o(t){return function(e){return e.tag===Ht.Pure.tag?Ht.Pure(t(e._1)):Ht.Bind(e,function(n){return Ht.Pure(t(n))})}}function Ut(t){return function(e){return Ht.Bind(t,e)}}var se=Ht.Sync;var Wu=Ht.Async;function zn(t,e){return function(){return Ht.Fiber(t,null,e)}}var Wr=function(){function t(n,a){return n===0&&typeof setImmediate<"u"?setImmediate(a):setTimeout(a,n)}function e(n,a){return n===0&&typeof clearImmediate<"u"?clearImmediate(a):clearTimeout(a)}return function(n,a){return Ht.Async(function(o){return function(){var i=t(a,o(n()));return function(){return Ht.Sync(function(){return n(e(a,i))})}}})}}(),Pu=Ht.Seq;var Pr={map:$o};var qr={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;f()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return gt("unsafeFromLeft: Right");f()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return gt("unsafeFromRight: Left");f()},left:un,right:Qt};var fo={Applicative0:()=>Jn,Bind1:()=>qu},qu={bind:Ut,Apply0:()=>mo},mo={apply:t=>e=>Ut(t)(n=>Ut(e)(a=>Jn.pure(n(a)))),Functor0:()=>Pr},Jn={pure:ye,Apply0:()=>mo};var Bn={liftEffect:se,Monad0:()=>fo};var go={tailRecM:t=>{let e=n=>Ut(t(n))(a=>{if(a.tag==="Done")return ye(a._1);if(a.tag==="Loop")return e(a._1);f()});return e},Monad0:()=>fo};var vu=(t,e)=>({...t,...e}),_o=(t,e)=>t&&e?n=>t(e(n)):t||e,yo=(t,e,n,a,o,i)=>{if(e[0]==="o"&&e[1]==="n"){let d=e.slice(2);t.actions||(t.actions={}),t.actions[d]=i&&a?i(a):a,a?n||t.addEventListener(d,o):t.removeEventListener(d,o)}else a==null||a===!1||e==="class"&&!a?t.removeAttribute(e):t.setAttribute(e,a)},kn=(t,e,n,a)=>{let o=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),i=t.props,d=_o(a,t.mapf);for(let u in i)yo(o,u,null,i[u],e,d);for(let u=0,$=t.children.length;u<$;u++)o.appendChild(kn(ve(t.children[u]).html,e,n,d));return t.node=o,o},qe=(t,e,n,a,o,i,d)=>{if(n!==a)if(n!=null&&n.type===3&&a.type===3)n.tag!==a.tag&&(e.nodeValue=a.tag);else if(n==null||n.tag!==a.tag)e=t.insertBefore(kn(a,o,i,d),e),n&&n.node.remove();else{let u=n.props,$=a.props,l=n.children,p=a.children,c=l.length-1,r=p.length-1;d=_o(d,a.mapf),i=i||a.tag==="svg";for(let s in vu(u,$))(s==="value"||s==="selected"||s==="checked"?e[s]:u[s])!==$[s]&&yo(e,s,u[s],$[s],o,d);if(a.keyed){let s=0,h=0;for(;h<=r&&s<=c;){let{key:P,html:nt}=l[s];if(P!==p[h].key)break;let lt=ve(p[h],nt);qe(e,nt.node,nt,lt.html,o,i,d),h++,s++}for(;h<=r&&s<=c;){let{key:P,html:nt}=l[c];if(P!==p[r].key)break;let lt=ve(p[r],nt);qe(e,nt.node,nt,lt.html,o,i,d),r--,c--}if(s>c)for(;h<=r;){let P=ve(p[h]).html;e.insertBefore(kn(P,o,i,d),l[s]&&l[s].html.node),h++}else if(h>r)for(;s<=c;)l[s].html.node.remove(),s++;else{let P={},nt={};for(let lt=s;lt<=c;lt++)P[l[lt].key]=l[lt].html;for(;h<=r;){let{key:lt,html:Ft}=l[s]||{key:null,html:null},{key:ne,html:Oe}=ve(p[h],Ft);if(nt[lt]||l[s+1]&&ne===l[s+1].key){s++;continue}if(lt===ne)qe(e,Ft.node,Ft,Oe,o,i,d),nt[ne]=!0,s++;else{let M=P[ne];M!=null?(qe(e,e.insertBefore(M.node,Ft.node),M,p[h].html,o,i,d),nt[ne]=!0):qe(e,Ft&&Ft.node,null,p[h].html,o,i,d)}h++}for(let lt in P)nt[lt]||P[lt].node.remove()}}else{for(let s=0;s<=c&&s<=r;s++){let h=l[s].html,P=ve(p[s],h).html;qe(e,h.node,h,P,o,i,d)}for(let s=c+1;s<=r;s++){let h=ve(p[s],n).html;e.appendChild(kn(h,o,i,d))}for(let s=r+1;s<=c;s++)l[s].html.node.remove()}}return a.node=e,e},zu=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},Ju=(t,e)=>e.reduce((n,a)=>n(a),t),ve=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||zu(e.memo,t.html.memo))&&(e=Hn(Ju(t.html.type,t.html.memo)),e.memo=t.html.memo),t.html=e),t),Hn=t=>({...t,children:t.children&&t.children.map(({key:e,html:n})=>({key:e,html:Hn(n)}))}),ho=(t,e)=>t.actions[e],Do=qe,bo=t=>e=>(e.node=t,e);var ku=(t,e,n,a=!1)=>{let o=[],i={},d={tag:t,children:n,props:i,node:null,keyed:a},u=e.length;for(let $=0;$<u;$++){let[l,p,c]=e[$];l==1?i[p]=c:l===2?i.class=i.class?i.class+" "+p:p:l===3&&o.push(p+":"+c)}return i.style=o.join(";"),d},C=(t,e,n)=>ku(t,e,n.map(a=>({key:null,html:a})));var Hu=t=>({tag:t,props:{},children:[],type:3});var F=(t,e)=>[1,t,e],K=t=>[2,t];var ie=(t,e)=>[1,"on"+t,e],Un=(t,e)=>[3,t,e],O=Hu;var Gn=(t,e,n)=>({memo:[e,n],type:t});var To=O("");var zr={identity:t=>t,Semigroupoid0:()=>fr};var Qn={dimap:t=>e=>n=>a=>e(n(t(a)))};var Uu=t=>t,he=(()=>({first:t=>e=>_(t(e._1),e._2),second:Nn.map,Profunctor0:()=>Qn}))();var Jr=t=>{let e=t.identity,n=t.Semigroupoid0(),a=t.Semigroupoid0();return o=>{let i=o.Profunctor0().dimap;return d=>u=>n.compose(a.compose(o.second(u))(o.first(d)))(i(Uu)($=>_($,$))(e))}};function Kn(t){return function(e){return t===e}}var xt=(t,e,n)=>({tag:t,_1:e,_2:n});var Br={state:t=>A(j("Bind",xt("State",t),e=>A(j("Return",e),G)),G),Monad0:()=>Sn};var kr=t=>({liftEffect:e=>A(j("Bind",xt("Lift",t.liftEffect(e)),n=>A(j("Return",n),G)),G),Monad0:()=>Sn});var Lo=t=>{let e=kr(t.MonadEffect0());return{liftAff:n=>A(j("Bind",xt("Lift",t.liftAff(n)),a=>A(j("Return",a),G)),G),MonadEffect0:()=>e}},xo=t=>({map:e=>n=>{if(n.tag==="State")return xt("State",a=>{let o=n._1(a);return _(e(o._1),o._2)});if(n.tag==="Lift")return xt("Lift",t.map(e)(n._1));if(n.tag==="Subscribe")return xt("Subscribe",n._1,a=>e(n._2(a)));if(n.tag==="Unsubscribe")return xt("Unsubscribe",n._1,e(n._2));f()}});var No=t=>e=>Ka(n=>{if(n.tag==="State")return xt("State",n._1);if(n.tag==="Lift")return xt("Lift",t(n._1));if(n.tag==="Subscribe")return xt("Subscribe",n._1,n._2);if(n.tag==="Unsubscribe")return xt("Unsubscribe",n._1,n._2);f()})(e);function fn(t,e,n,a){if(typeof window<"u"){var o=window[n];if(o!=null&&a instanceof o)return e(a)}for(var i=a;i!=null;){var d=Object.getPrototypeOf(i),u=d.constructor.name;if(u===n)return e(a);if(u==="Object")return t;i=d}return t}var ze=function(t){return function(e){return function(){return e[t]}}},rf=ze("URL"),af=ze("documentURI"),of=ze("origin"),sf=ze("compatMode"),uf=ze("characterSet"),df=ze("contentType");var Qu=ze("documentElement");function Io(t){return function(e){return function(){return e.createTextNode(t)}}}var te=function(t){return function(e){return function(){return e[t]}}};var Sf=te("baseURI"),Ku=te("ownerDocument"),Ur=te("parentNode"),Yu=te("parentElement");var Af=te("childNodes"),Zu=te("firstChild"),Xu=te("lastChild"),td=te("previousSibling"),ed=te("nextSibling"),nd=te("nodeValue");var wf=te("textContent");function Eo(t){return function(e){return function(){e.appendChild(t)}}}var Zn=function(t){return function(e){return function(){return e[t]}}},om=Zn("children"),ad=Zn("firstElementChild"),od=Zn("lastElementChild"),sm=Zn("childElementCount");function Fo(t){return function(e){return function(){return e.querySelector(t)}}}var Ao=t=>{let e=Fo(t);return n=>{let a=e(n);return()=>{let o=a();return wt(o,m,H)}}};function Je(t){return t.currentTarget}function wo(t){return t.type}var Gr=function(){return window};function Or(t){return function(){return t.document}}var mn=Ln(mr)(cn),cd=Ln(Jn)(cn),ld=ja(xo(Pr))(go),pd=t=>e=>n=>{let a=n(e);return()=>{let o=a();return mn(o)(t.update(t))()}},Wo=t=>e=>{let n=t.node,a=t.vdom;return()=>{let o=a.value,i=n.value,d=Ur(i)();return mn(wt(d,m,H))(u=>{let $=Hn(e);return()=>{let l=Do(u,i,o,$,p=>{let c=wo(p);return mn(wt(Je(p),m,H))(r=>()=>{let s=ho(r,c);return pd(t)(p)(s)()})()});return n.value=l,a.value=$}})()}},$d=t=>e=>{let n=t.state;return()=>{let a=n.value,o=Kn(a)(e);if(!o)return n.value=e,Wo(t)(t.view(e))();o||f()}},Po=t=>e=>n=>{let a=e.subscriptions;return ld(o=>{if(o.tag==="State")return Ut(se((()=>{let i=e.state;return()=>i.value})()))(i=>{let d=o._1(i),u=d._1;return Ut(se($d(e)(d._2)))(()=>ye(u))});if(o.tag==="Lift")return o._1;if(o.tag==="Subscribe")return Ut(se(o._1(i=>{let d=zn(qr,Po(t)(e)(t(i)));return()=>{d().run()}})))(i=>Ut(se((()=>{let d=e.freshId;return()=>{let u=d.value;return d.value=u+1|0,u}})()))(d=>Ut(se((()=>{let u=qn(X)(d)(i);return()=>{let $=a.value;a.value=u($)}})()))(()=>ye(o._2(d)))));if(o.tag==="Unsubscribe"){let i=o._2,d=o._1;return Ut(se(()=>a.value))(u=>Ut(cd(Xt(X)(d)(u))(se))(()=>ye(i)))}f()})(n)},fd=t=>{let e=t.init.model,n=t.init.msg,a=t.selector,o=t.update,i=t.view;return()=>{let d=Gr(),u=Or(d)(),$=Ao(a)(u)();return mn($.tag==="Just"?b("Just",$._1):m)(l=>()=>{let p={value:e},c=Gr(),r=Or(c)(),s=Io("")(r)();Eo(s)(l)();let h={value:s},P={value:bo(s)(O(""))},Ft={view:i,update:o,state:p,node:h,vdom:P,subscriptions:{value:z},freshId:{value:0}};return Wo(Ft)(i(e))(),mn(n)(Ft.update(Ft))()})()}};var qo=t=>{let e=t.update;return fd({init:t.init,view:t.view,selector:t.selector,update:n=>a=>{let o=zn(qr,Po(e)(n)(e(a)));return()=>{o().run()}}})};var Qr=function(t){return function(e){return t+e|0}};var jr=function(t){return function(e){return t+e}};var Kr=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},gn=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var Yr=isFinite;var Be=Math.floor;var Xn=function(t){return function(e){return t%e}};var zo=Math.sin;var Jo=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},Z=function(t){return t},Bo=function(t){return function(e){return function(n){var a;n<11?a="[0-"+(n-1).toString()+"]":n===11?a="[0-9a]":a="[0-9a-"+String.fromCharCode(86+n)+"]";var o=new RegExp("^[\\+\\-]?"+a+"+$","i");return function(i){if(o.test(i)){var d=parseInt(i,n);return(d|0)===d?t(d):e}else return e}}}};var yd=Bo(H)(m),ke=yd(10),Zr=Jo(H)(m),tr=t=>{if(!Yr(t))return 0;if(t>=Z(2147483647))return 2147483647;if(t<=Z(-2147483648))return-2147483648;let e=Zr(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;f()};var ko=Math.random;var Ho=t=>e=>()=>{let n=ko();return tr(Be((Z(e)-Z(t)+1)*n+Z(t)))};var Xr=(()=>{let t=Ho(1)(2147483646);return()=>{let e=t();return(()=>{let n=gn(e)(2147483645);return n<1?n+2147483646|0:n})()}})();var Uo=t=>e=>{let n=Zr(Xn(Z(48271)*Z(e)+Z(t))(Z(2147483647)));if(n.tag==="Just")return n._1;f()};var De=t=>({map:e=>n=>a=>t.map(o=>_(e(o._1),o._2))(n(a))});var nn=t=>{let e=t.Bind1().bind;return{bind:n=>a=>o=>e(n(o))(i=>a(i._1)(i._2)),Apply0:()=>er(t)}},er=t=>{let e=De(t.Bind1().Apply0().Functor0());return{apply:(()=>{let n=nn(t).bind,a=ue(t).pure;return o=>i=>n(o)(d=>n(i)(u=>a(d(u))))})(),Functor0:()=>e}},ue=t=>{let e=t.Applicative0().pure;return{pure:n=>a=>e(_(n,a)),Apply0:()=>er(t)}};var ta=t=>{let e=t.Monad0(),n=e.Bind1().bind,a=e.Applicative0().pure,o={Applicative0:()=>ue(e),Bind1:()=>nn(e)};return{tailRecM:i=>d=>u=>t.tailRecM($=>n(i($._1)($._2))(l=>a((()=>{if(l._1.tag==="Loop")return Tt("Loop",_(l._1._1,l._2));if(l._1.tag==="Done")return Tt("Done",_(l._1._1,l._2));f()})())))(_(d,u)),Monad0:()=>o}},Oo=t=>{let e=t.Applicative0().pure,n={Applicative0:()=>ue(t),Bind1:()=>nn(t)};return{state:a=>o=>e(a(o)),Monad0:()=>n}};function Dd(t){return function(){return t.slice()}}var ea=Dd,bd=function(){function t(e,n,a,o,i,d){var u,$,l,p,c,r,s;for(u=i+(d-i>>1),u-i>1&&t(e,n,o,a,i,u),d-u>1&&t(e,n,o,a,u,d),$=i,l=u,p=i;$<u&&l<d;)c=o[$],r=o[l],s=n(e(c)(r)),s>0?(a[p++]=r,++l):(a[p++]=c,++$);for(;$<u;)a[p++]=o[$++];for(;l<d;)a[p++]=o[l++]}return function(e){return function(n){return function(a){return function(){return a.length<2||t(e,n,a,a.slice(0),0,a.length),a}}}}}();var Ue=function(t){return function(e){for(var n=e.length,a=Array(n),o=0;o<n;o++)a[o]=t(o)(e[o]);return a}};var de=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var ce=function(t){return function(e){for(var n=t>e?-1:1,a=new Array(n*(e-t)+1),o=t,i=0;o!==e;)a[i++]=o,o+=n;return a[i]=o,a}},Ld=function(t){return function(e){if(t<1)return[];var n=new Array(t);return n.fill(e)}},xd=function(t){return function(e){for(var n=[],a=0,o=0;o<t;o++)n[a++]=e;return n}},nr=typeof Array.prototype.fill=="function"?Ld:xd,jo=function(){function t(o,i){this.head=o,this.tail=i}var e={};function n(o){return function(i){return new t(o,i)}}function a(o){for(var i=[],d=0,u=o;u!==e;)i[d++]=u.head,u=u.tail;return i}return function(o){return function(i){return a(o(n)(e)(i))}}}();var Vo=function(t){return function(e){return function(n){return function(a){return a<0||a>=n.length?e:t(n[a])}}}};var Ko=function(t){return function(e){return function(n){return function(a){for(var o=0,i=a.length;o<i;o++)if(n(a[o]))return t(o);return e}}}};var Yo=function(t){return function(e){return function(n){return function(a){return function(o){if(n<0||n>=o.length)return e;var i=o.slice();return i[n]=a,t(i)}}}}};var Zo=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],n=0,a=t.length;n<a;n++)for(var o=t[n],i=0,d=o.length;i<d;i++)e.push(o[i]);return e},hn=function(t){return function(e){return e.filter(t)}};var Xo=function(t){return function(e){return function(n){for(var a=n.length,o=e,i=new Array(a),d=0;d<a;d++)o=t(o)(n[d]),i[d]=o;return i}}};var ts=function(){function t(e,n,a,o,i,d){var u,$,l,p,c,r,s;for(u=i+(d-i>>1),u-i>1&&t(e,n,o,a,i,u),d-u>1&&t(e,n,o,a,u,d),$=i,l=u,p=i;$<u&&l<d;)c=o[$],r=o[l],s=n(e(c)(r)),s>0?(a[p++]=r,++l):(a[p++]=c,++$);for(;$<u;)a[p++]=o[$++];for(;l<d;)a[p++]=o[l++]}return function(e){return function(n){return function(a){var o;return a.length<2?a:(o=a.slice(0),t(e,n,o,a.slice(0),0,a.length),o)}}}}();var rr=function(t){return function(e){for(var n=e.length,a=0;a<n;a++)if(!t(e[a]))return!1;return!0}};var ns=Yo(H)(m);var Dn=t=>ts(t)(e=>{if(e.tag==="GT")return 1;if(e.tag==="EQ")return 0;if(e.tag==="LT")return-1;f()});var rs=t=>e=>(()=>{let n=ea(t);return()=>{let a=n();return a.push(e),a}})()();var be=Vo(H)(m);var ra=Ko(H)(m);var ar=t=>e=>n=>{let a=ra(o=>t.eq(o)(e))(n);if(a.tag==="Nothing")return!1;if(a.tag==="Just")return!0;f()};var as=t=>e=>t.state(n=>_(void 0,e));var zd=function(){function t(d){this.fn=d}var e={},n=function(d,u){this.head=d,this.tail=u};function a(d){return new n(d,e)}function o(d){return function(u){return new n(d,u)}}function i(d){for(var u=[],$=d;$!==e;)u.push($.head),$=$.tail;return u}return function(d){return function(u){return function($){var l=function(c,r){return d(u(o)($(c)))(r)},p=function(c,r,s){if(r===0)return c;var h=s[r-1];return new t(function(){var P=p(l(h,c),r-1,s);return P})};return function(c){for(var r=u(a)($(c[c.length-1])),s=p(r,c.length-1,c);s instanceof t;)s=s.fn();return u(i)(s)}}}}}();var Bd=t=>Oo(t).state(e=>_(e.newSeed,{...e,newSeed:Uo(0)(e.newSeed)}));var kd=t=>{let e=De(t.Bind1().Apply0().Functor0()).map,n=Bd(t),a=er(t).apply;return o=>i=>{let d=Z(i),u=Z(o),$=e(Z)(n);return e(l=>tr(Be(u+Xn(l)(d-u+1))))(a(e(jr)($))(e(l=>2*l)($)))}},ss=t=>{let e=kd(t);return n=>a=>n<=a?e(n)(a):e(a)(n)};var Ud=(()=>ue(Kt).pure)(),Gd=(()=>De(fe).map)(),Od=ss(Kt);var oa=t=>t.length===0?Ud(m):Gd(e=>be(t)(e))(Od(0)(t.length-1|0)),or=t=>{let e=100*zo(Z(t+1|0));return e-Be(e)},is=(()=>{let t=Ue(a=>o=>_(or(a),o)),e=Dn(a=>o=>Ar.compare(a._1)(o._1)),n=ct(Yt);return a=>n(e(t(a)))})();var sa=(t,e)=>({tag:"Graph",_1:t,_2:e}),Qd=vn(X)(oe),ds=(()=>ue(Kt).pure)(),jd=vn(In(X)(X))(oe),Vd=t=>e=>{let n=X.compare(t)(e);if(n.tag==="LT")return e;if(n.tag==="EQ"||n.tag==="GT")return t;f()};var cs=t=>e=>sa(Qd(ct(n=>_(n,ae(e)(a=>ae((n-a|0)>=0?[void 0]:[])(()=>[{edge:a-1|0,dest:n-a|0}]))))(ce(0)(t))),t),ls=t=>({width:800,height:400,position:e=>e===0?m:e<=8?b("Just",{x:Z(e-1|0)*100,y:0}):b("Just",{x:Z(e-9|0)*100,y:200}),legend:ct(e=>({edge:e-1|0,name:rt(e)}))(t)});var ia=t=>e=>n=>{let a=Xt(t)(n)(e);if(a.tag==="Nothing")return ds(m);if(a.tag==="Just")return De(fe).map(o=>o.tag==="Just"?b("Just",{edge:o._1.edge,dest:o._1.dest}):m)(oa(a._1));f()},Kd=t=>{let e=vn(t)(oe);return n=>a=>sa(e(ct(o=>_(n(o._1),ct(i=>({edge:i.edge,dest:n(i.dest)}))(o._2)))(Pn(Pe)(a._1))),n(a._2))},Yd=Kd(X),ua=t=>e=>n=>oa(ae((()=>{let a=Xt(t)(n)(e);if(a.tag==="Nothing")return[];if(a.tag==="Just")return a._1;f()})())(a=>nr(a.nbBalls)({dest:a.dest,edge:a.edge}))),ps=t=>e=>{let n=Qe(()=>Zt.map(o=>tn(i=>rr(d=>{let u=Xt(t)(d.dest)(n());if(u.tag==="Nothing")return!0;if(u.tag==="Just")return!We(u._1);f()})(o)))(e._1)),a=n();return Zt.map(We)(a)},Zd=t=>e=>sa(jd(ae(ce(0)(t-1|0))(n=>ae(ce(0)(e-1|0))(a=>[_(_(n,a),hn(o=>o.dest._1>=0&&o.dest._2>=0)([{edge:0,dest:_(n-1|0,a)},{edge:1,dest:_(n-1|0,a-1|0)},{edge:2,dest:_(n,a-1|0)}]))]))),_(t-1|0,e-1|0)),$s=t=>e=>Yd(n=>n._1+(n._2*t|0)|0)(Zd(t)(e)),fs=t=>e=>{let n=Vd(t)(e);return{width:180*n|0,height:180*n|0,position:a=>a===0?m:b("Just",{x:50+180*Z(gn(a)(t)),y:10+180*Z((e-Kr(a)(t)|0)-1|0)}),legend:[{edge:0,name:"\u21D0"},{edge:1,name:"\u21D9"},{edge:2,name:"\u21D3"}]}},ms=t=>e=>n=>a=>(()=>{let o=Xt(t)(a)(n);return o.tag==="Nothing"?!1:o.tag==="Just"?o._1:!1})()?ia(t)(e)(a):ds((()=>{let o=Xt(t)(a)(e);if(o.tag==="Just"){let i=ra(d=>{let u=Xt(t)(d.dest)(n);return u.tag==="Nothing"?!1:u.tag==="Just"?u._1:!1})(o._1);return i.tag==="Just"?b("Just",{edge:o._1[i._1].edge,dest:o._1[i._1].dest}):m}if(o.tag==="Nothing")return m;f()})()),gs={width:0,height:0,position:t=>m,legend:[]},_s=t=>e=>n=>Zt.map(ct(a=>({edge:a.edge,dest:a.dest,nbBalls:e})))(n._1);var da=t=>({tag:t}),Fe=(t,e,n)=>({tag:t,_1:e,_2:n}),ca=t=>({tag:t}),tc=(()=>nn(Kt).bind)(),ys=(()=>ue(Kt).pure)(),ec=(()=>ta(Ia).tailRecM)(),nc=t=>e=>{let n=X.compare(t)(e);if(n.tag==="LT")return e;if(n.tag==="EQ"||n.tag==="GT")return t;f()},hs=ca("Running"),Ds=ca("IsStopping"),sr=ca("Stopped");var la=da("Random"),bs=da("Expert"),Ts=da("Machine");var Cs=t=>e=>ar(Re)(t)(e)?hn(n=>n!==t)(e):Dn(X.compare)(de([t])(e));var pa=t=>{let e=(()=>{if(t.config.graphType.tag==="Substract")return cs(t.config.graphType._1)(t.config.graphType._2);if(t.config.graphType.tag==="King")return $s(t.config.graphType._1)(t.config.graphType._2);f()})();return{config:t.config,source:e._2,nbVictories:0,nbLosses:0,graphWithBalls:_s(X)(t.config.ballsPerColor)(e),losingPositions:ps(X)(e),status:sr,gameResult:m,displayer:(()=>{if(t.config.graphType.tag==="Substract")return ls(t.config.graphType._2);if(t.config.graphType.tag==="King")return fs(t.config.graphType._1)(t.config.graphType._2);f()})(),colors:t.colors,fastMode:t.fastMode}},rc=["#f6b73c","#ff0000","#00ffff","90ee90","ff0090"],Ms=pa({config:{graphType:Fe("Substract",8,[1,2]),adversary:la,ballsPerColor:6,reward:3,penalty:-1,machineStarts:!0},source:0,nbVictories:0,nbLosses:0,graphWithBalls:z,losingPositions:z,status:sr,gameResult:m,displayer:gs,colors:rc,fastMode:!1});var ac=t=>e=>{if(t.config.adversary.tag==="Random")return ia(X)(t.graphWithBalls)(e);if(t.config.adversary.tag==="Expert")return ms(X)(t.graphWithBalls)(t.losingPositions)(e);if(t.config.adversary.tag==="Machine")return ua(X)(t.graphWithBalls)(e);f()},oc=t=>ec(e=>{let n=e.isMachineTurn,a=e.moves,o=e.pos;return tc(n?ua(X)(t.graphWithBalls)(o):ac(t)(o))(i=>{if(i.tag==="Nothing")return ys(Tt("Done",{moves:a,win:!n}));if(i.tag==="Just")return ys(Tt("Loop",{moves:rs(a)({pos:o,edge:i._1.edge,isMachineTurn:n}),isMachineTurn:!n,pos:i._1.dest}));f()})})({moves:[],pos:t.source,isMachineTurn:t.config.machineStarts});var sc=t=>e=>{let n=e.win;return{config:t.config,source:t.source,nbVictories:n?t.nbVictories+1|0:t.nbVictories+0|0,nbLosses:n?t.nbLosses+0|0:t.nbLosses+1|0,graphWithBalls:Zt.map(a=>rr(o=>o.nbBalls===0)(a)?ct(o=>({nbBalls:t.config.ballsPerColor,dest:o.dest,edge:o.edge}))(a):a)(we(a=>{let o=a.edge,i=a.isMachineTurn,d=ct(u=>o!==u.edge?u:{nbBalls:nc(0)((()=>!i&&(t.config.adversary.tag==="Random"||t.config.adversary.tag==="Expert"||t.config.adversary.tag!=="Machine")?u.nbBalls+0|0:n===i?u.nbBalls+t.config.reward|0:u.nbBalls+t.config.penalty|0)()),edge:u.edge,dest:u.dest});return Rr(X)(u=>b("Just",d(u)))(a.pos)})(t.graphWithBalls)(e.moves)),losingPositions:t.losingPositions,status:t.status,gameResult:b("Just",{moves:e.moves,win:n}),displayer:t.displayer,colors:t.colors,fastMode:t.fastMode}},Ls=t=>De(fe).map(sc(t))(oc(t));var ic=t=>{let e=t.Apply0(),n=e.Functor0(),a={map:i=>{let d=n.map(i);return u=>$=>d(u($))}},o={apply:i=>d=>u=>e.apply(i(u))(d(u)),Functor0:()=>a};return{bind:i=>d=>u=>t.bind(i(u))($=>d($)(u)),Apply0:()=>o}};var uc=t=>{let e=t.Applicative0(),n=e.Apply0(),a=n.Functor0(),o={map:$=>{let l=a.map($);return p=>c=>l(p(c))}},i={apply:$=>l=>p=>n.apply($(p))(l(p)),Functor0:()=>o},d={pure:$=>{let l=e.pure($);return p=>l},Apply0:()=>i},u=ic(t.Bind1());return{Applicative0:()=>d,Bind1:()=>u}};var ir=t=>{let e=uc(t.Monad0());return{liftEffect:n=>{let a=t.liftEffect(n);return o=>a},Monad0:()=>e}};var lc=Jr(zr)(he);var Is=t=>e=>n=>a=>{let o=lc(t)(e),i=a.Profunctor0().dimap;return d=>i(o)(u=>{if(u._2.tag==="Left")return u._2._1;if(u._2.tag==="Right")return u._1(u._2._1);f()})(n.second(a.right(d)))};var $a=t=>e=>n=>{let a=n.Profunctor0().dimap;return o=>a(i=>_(t(i),d=>e(i)(d)))(i=>i._2(i._1))(n.first(o))};function Fs(t){return function(e){var n=[];for(var a in e)hasOwnProperty.call(e,a)&&n.push(t(a)(e[a]));return n}}var dh=Object.keys||Fs(function(t){return function(){return t}});var Ss={ix:t=>e=>n=>Is(a=>o=>{let i=ns(t)(o)(a);if(i.tag==="Nothing")return a;if(i.tag==="Just")return i._1;f()})(a=>{let o=be(a)(t);if(o.tag==="Nothing")return tt("Left",a);if(o.tag==="Just")return tt("Right",o._1);f()})(e)(n)};var As=t=>()=>e=>n=>Me(t.reflectSymbol(e))(n);var ur=t=>()=>()=>e=>n=>$a(As(t)()(e))(a=>o=>je(t.reflectSymbol(e))(o)(a))(n);var ws=t=>{let e=t.Monad0().Bind1().Apply0().Functor0().map(n=>{});return n=>a=>e((()=>{let o=n(i=>a);return t.state(i=>{let d=o(i);return _(d,d)})})())};var Rs=(()=>({left:t=>e=>{if(e.tag==="Left")return tt("Left",t(e._1));if(e.tag==="Right")return tt("Right",e._1);f()},right:dn.map,Profunctor0:()=>Qn}))();var Ws={liftAff:t=>t,MonadEffect0:()=>Bn};var Ps=t=>{let e=ir(t.MonadEffect0());return{liftAff:n=>{let a=t.liftAff(n);return o=>a},MonadEffect0:()=>e}};var It=(t,e,n)=>({tag:t,_1:e,_2:n}),qs=It("NextGame"),vs=It("RunMachine"),zs=It("StopMachine"),Js=t=>It("SetGraphType",t),Bs=t=>It("SetNbPigeonholes",t);var ks=t=>It("SetKingWidth",t),Hs=t=>It("SetKingHeight",t),Us=t=>It("SetAdversary",t),Gs=t=>It("SetReward",t),Os=t=>It("SetPenalty",t),Qs=t=>It("SetBallsPerColor",t),js=t=>It("SetMachineStarts",t),Vs=t=>e=>It("ColorChange",t,e);var Ys=A(j("Bind",xt("Lift",ye),t=>A(j("Return",t),G)),G),Zs=(()=>kr(ir(Bn)).liftEffect)(),dr=A(j("Bind",xt("State",t=>_(t,t)),t=>A(j("Return",t),G)),G),qc=(()=>{let t=Lo(Ps(Ws)).liftAff;return e=>t(Wr(Qt,e))})(),vc=ws(Br),zc=t=>A(Ys._1,Mt(Ys._2)(Lt("CatCons",e=>{let n=e.genModel,a=Zs(()=>n.value);return A(a._1,Mt(a._2)(Lt("CatCons",o=>{let i=t(o),d=i._2,u=i._1,$=Zs(()=>n.value=d);return A($._1,Mt($._2)(Lt("CatCons",()=>A(j("Return",u),G),Ct(w,w))))},Ct(w,w))))},Ct(w,w)))),cr=ur({reflectSymbol:()=>"graphType"})()()(St)(he),Jc=ur({reflectSymbol:()=>"config"})()()(St)(he),le=t=>{let e=Jc(t);return A(j("Bind",xt("State",n=>_(void 0,pa(e(n)))),n=>A(j("Return",n),G)),G)},Bc=ur({reflectSymbol:()=>"colors"})()()(St)(he),fa=t=>{if(t.tag==="RunMachine")return A(j("Bind",xt("State",e=>_(void 0,{...e,status:hs})),e=>A(j("Return",e),G)),Mt(G)(Lt("CatCons",()=>wn.tailRecM(e=>A(dr._1,Mt(dr._2)(Lt("CatCons",n=>{if(n.status.tag!=="Running"){let o={...n,status:sr};return A(j("Bind",xt("State",i=>_(void 0,o)),i=>A(j("Return",i),G)),Mt(G)(Lt("CatCons",()=>A(j("Return",Tt("Done",void 0)),G),Ct(w,w))))}let a=fa(qs);return A(a._1,Mt(a._2)(Lt("CatCons",()=>{let o=qc(n.fastMode?100:500);return A(o._1,Mt(o._2)(Lt("CatCons",()=>A(j("Return",Tt("Loop",void 0)),G),Ct(w,w))))},Ct(w,w))))},Ct(w,w)))))(),Ct(w,w))));if(t.tag==="StopMachine")return A(j("Bind",xt("State",e=>_(void 0,{...e,status:Ds})),e=>A(j("Return",e),G)),G);if(t.tag==="NextGame")return A(dr._1,Mt(dr._2)(Lt("CatCons",e=>{let n=zc(Ls(e));return A(n._1,Mt(n._2)(Lt("CatCons",as(Br),Ct(w,w))))},Ct(w,w))));if(t.tag==="SetGraphType"){let e=t._1;return le(n=>({graphType:e==="sub"?Fe("Substract",8,[1,2]):Fe("King",3,3),adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetNbPigeonholes"){let e=t._1;return le(cr(n=>n.tag==="Substract"?Fe("Substract",(()=>{let a=ke(e);if(a.tag==="Nothing")return 8;if(a.tag==="Just")return a._1;f()})(),n._2):n))}if(t.tag==="TogglePossibleMove"){let e=t._1;return le(cr(n=>n.tag==="Substract"?Fe("Substract",n._1,Cs(e)(n._2)):n))}if(t.tag==="SetKingWidth"){let e=t._1;return le(cr(n=>n.tag==="King"?Fe("King",(()=>{let a=ke(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;f()})(),n._2):n))}if(t.tag==="SetKingHeight"){let e=t._1;return le(cr(n=>n.tag==="King"?Fe("King",n._1,(()=>{let a=ke(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;f()})()):n))}if(t.tag==="SetReward"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:(()=>{let a=ke(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;f()})(),penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetPenalty"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:(()=>{let a=ke(e);if(a.tag==="Nothing")return-1;if(a.tag==="Just")return a._1;f()})(),machineStarts:n.machineStarts}))}if(t.tag==="SetAdversary"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:(()=>e==="expert"?bs:e==="machine"?Ts:la)(),ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetBallsPerColor"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:(()=>{let a=ke(e);if(a.tag==="Nothing")return 6;if(a.tag==="Just")return a._1;f()})(),reward:n.reward,penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetMachineStarts"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:n.penalty,machineStarts:e==="y"}))}if(t.tag==="ColorChange")return vc((()=>{let e=Ss.ix(t._1)(he)(Rs);return n=>Bc(e(n))})())(t._2);if(t.tag==="SetFastMode"){let e=t._1;return A(j("Bind",xt("State",n=>_(void 0,{...n,fastMode:e})),n=>A(j("Return",n),G)),G)}f()};var Xs=t=>e=>n=>a=>F("viewBox",rt(t)+" "+rt(e)+" "+rt(n)+" "+rt(a));function ti(t){return function(){return t.checked}}function ei(t){return function(){return t.value}}function ni(t){return function(){return t.value}}var ri=t=>ie("change",e=>{let n=wt(Je(e),m,H),a=(()=>{if(n.tag==="Just")return fn(m,H,"HTMLInputElement",n._1);if(n.tag==="Nothing")return m;f()})();if(a.tag==="Nothing")return()=>m;if(a.tag==="Just"){let o=ti(a._1);return()=>{let i=o();return b("Just",t(i))}}f()});var ee=t=>ie("change",e=>{let n=wt(Je(e),m,H),a=(()=>{if(n.tag==="Just")return fn(m,H,"HTMLInputElement",n._1);if(n.tag==="Nothing")return m;f()})();if(a.tag==="Just"){let o=ei(a._1);return()=>{let i=o();return b("Just",t(i))}}if(a.tag==="Nothing"){let o=wt(Je(e),m,H),i=(()=>{if(o.tag==="Just")return fn(m,H,"HTMLSelectElement",o._1);if(o.tag==="Nothing")return m;f()})();if(i.tag==="Nothing")return()=>m;if(i.tag==="Just"){let d=ni(i._1);return()=>{let u=d();return b("Just",t(u))}}f()}f()});var Qc=t=>e=>{let n=X.compare(t)(e);if(n.tag==="LT"||n.tag==="EQ")return t;if(n.tag==="GT")return e;f()},jc=Xe(Qr)(0),Vc=t=>e=>C("div",[K("flex flex-row justify-between mt-4 mb-2")],[C("span",[K("text-blue-600 font-bold")],[O("Victoires: "+rt(t))]),C("div",[K("w-full bg-red-600 rounded-full h-6")],[C("div",[K("h-6 bg-blue-600 rounded-l-full"),(()=>{let n=t+e|0;return Un("width",re(n===0?50:Z(t)/Z(n)*100)+"%")})()],[])]),C("span",[K("text-red-600 font-bold")],[O("D\xE9faites: "+rt(e))])]),ma="block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",Kc=t=>e=>n=>a=>{let o=t.position(n);if(o.tag==="Just")return C("g",[Un("transform","translate("+re(o._1.x)+"px,"+re(o._1.y)+"px)")],[C("path",[F("d","M1 1 L10 109 L90 109 L99 1"),F("stroke-width","3.0"),F("stroke","#000"),F("fill","transparent")],[]),(()=>{let i=Zo(ct(u=>nr(u.nbBalls)(u.edge))(a)),d=Qc(105)(i.length);return C("g",[],is(Ue(u=>$=>C("circle",[F("cx",re(15+or(n+u|0)*71)),F("cy",re(100-or((10+n|0)+u|0)*Z(d))),F("r","5.0"),F("fill",(()=>{let l=be(e)($);if(l.tag==="Nothing")return"black";if(l.tag==="Just")return l._1;f()})())],[]))(i)))})(),(()=>{let i=Z(jc(ct(d=>d.nbBalls)(a)));return C("g",[],ct(d=>C("rect",[F("x",re(3+94*d.begin)),F("y","115.0"),F("width",re(94*(d.end-d.begin))),F("height","20"),F("stroke","black"),F("fill",(()=>{let u=be(e)(d.edge);if(u.tag==="Nothing")return"black";if(u.tag==="Just")return u._1;f()})())],[]))(Xo(d=>{let u=d.end;return $=>({begin:u,end:u+Z($.nbBalls)/i,edge:$.edge})})({begin:0,end:0,edge:-1})(a)))})()]);if(o.tag==="Nothing")return To;f()},Yc=t=>e=>n=>C("div",[K("w-[42vw]")],[C("svg",[Xs(0)(0)(t.width)(t.height)],ct(a=>Kc(t)(e)(a._1)(a._2))(Pn(Pe)(n)))]),_a=t=>e=>C("div",[K("rounded overflow-hidden shadow-lg p-4")],de([C("div",[K("font-bold text-xl mb-2")],[O(t)])])(e)),Zc=t=>e=>_a("L\xE9gende")([C("div",[K("grid grid-cols-2 gap-4")],ae(t)(n=>[C("input",[F("type","color"),K("inline w-12 h-12"),F("value",(()=>{let a=be(e)(n.edge);if(a.tag==="Nothing")return"black";if(a.tag==="Just")return a._1;f()})()),ee(Vs(n.edge))],[]),C("span",[K("text-2xl")],[O(" : "+n.name)])]))]),ga="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",Xc=t=>e=>_a("Choix des param\xE8tres")([C("div",[K("grid grid-cols-2 gap-4")],de([C("div",[],[O("type de jeu")]),C("select",[K("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",(()=>{if(t.graphType.tag==="Substract")return"sub";if(t.graphType.tag==="King")return"king";f()})()),ee(Js)],[C("option",[F("value","sub")],[O("Soustraction")]),C("option",[F("value","king")],[O("Roi")])])])(de((()=>{if(t.graphType.tag==="Substract"){let n=t.graphType._2;return[C("div",[],[O("Nombre de casiers")]),C("select",[K("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",rt(t.graphType._1)),ee(Bs)],ct(a=>C("option",[F("value",rt(a))],[O(rt(a))]))(ce(8)(16))),C("div",[],[O("Coups possibles")]),C("div",[K("flex flex-row justify-between")],ct(a=>C("label",[],[C("input",[F("type","checkbox"),F("checked",ar(Re)(a)(n)),K("w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"),ri(o=>It("TogglePossibleMove",a))],[]),C("span",[K("ml-2 text-sm font-medium text-gray-900")],[O(rt(a))])]))(ce(1)(5)))]}if(t.graphType.tag==="King")return[C("div",[],[O("Hauteur de la grille")]),C("select",[K("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",rt(t.graphType._2)),ee(Hs)],ct(n=>C("option",[F("value",rt(n))],[O(rt(n))]))(ce(3)(6))),C("div",[],[O("Largeur de la grille")]),C("select",[K("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",rt(t.graphType._1)),ee(ks)],ct(n=>C("option",[F("value",rt(n))],[O(rt(n))]))(ce(3)(6)))];f()})())([C("div",[],[O("Adversaire")]),C("select",[K("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",(()=>{if(t.adversary.tag==="Expert")return"expert";if(t.adversary.tag==="Machine")return"machine";if(t.adversary.tag==="Random")return"random";f()})()),ee(Us)],[C("option",[F("value","random")],[O("Al\xE9atoire")]),C("option",[F("value","expert")],[O("Expert")]),C("option",[F("value","machine")],[O("Machine")])]),C("div",[],[O("Billes par couleur")]),C("input",[F("type","number"),K(ma),F("min","2"),F("max","10"),F("value",rt(t.ballsPerColor)),ee(Qs)],[]),C("div",[],[O("R\xE9compense")]),C("input",[F("type","number"),K(ma),F("min","1"),F("value",rt(t.reward)),ee(Gs)],[]),C("div",[],[O("P\xE9nalit\xE9")]),C("input",[F("type","number"),K(ma),F("max","0"),F("value",rt(t.penalty)),ee(Os)],[]),C("div",[],[O("La machine commence")]),C("select",[K("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",t.machineStarts?"y":"n"),ee(js)],[C("option",[F("value","y")],[O("Oui")]),C("option",[F("value","n")],[O("Non")])]),e.tag==="Stopped"?C("button",[K(ga),ie("click",n=>()=>b("Just",vs))],[O("Lancer la machine")]):C("button",[K(ga),ie("click",n=>()=>b("Just",zs))],[O("Arr\xEAter la machine")]),C("button",[K(ga),ie("pointerdown",n=>()=>b("Just",It("SetFastMode",!0))),ie("pointerup",n=>()=>b("Just",It("SetFastMode",!1))),ie("pointerleave",n=>()=>b("Just",It("SetFastMode",!1)))],[O("Acc\xE9lerer")])])))]),ai=t=>C("div",[K("w-screen flex flex-row justify-around items-start")],[_a("Visualisation de la machine")([C("div",[K("flex flex-col")],[Yc(t.displayer)(t.colors)(t.graphWithBalls),Vc(t.nbVictories)(t.nbLosses)])]),Gn(Zc,t.displayer.legend,t.colors),Gn(Xc,t.config,t.status)]);var oi=()=>{let e={value:{newSeed:Xr(),size:0}};return qo({init:{model:Ms,msg:m},view:ai,update:(()=>{let n=No(a=>a({genModel:e}));return a=>n(fa(a))})(),selector:"#root"})()};oi();})();
