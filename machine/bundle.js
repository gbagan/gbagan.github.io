(()=>{function Qe(t){let e=0,r;return()=>{if(e===2)return r;if(e===1)throw new Error("Binding demanded before initialized");return e=1,r=t(),e=2,r}}function f(){throw new Error("Failed pattern match")}var Te=function(t){return function(e){return e[t]}},Oe=function(t){return function(e){return function(r){var a={};for(var o in r)({}).hasOwnProperty.call(r,o)&&(a[o]=r[o]);return a[t]=e,a}}};var fi=()=>({tag:"Proxy"}),St=fi();var Z=function(t){return t.toString()},Bt=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var $r=t=>({tag:t}),wt=$r("LT"),Rt=$r("GT"),$e=$r("EQ");var L=(t,e)=>({tag:t,_1:e}),m=L("Nothing"),O=t=>L("Just",t);var Cn=t=>{if(t.tag==="Nothing")return!0;if(t.tag==="Just")return!1;f()};var it=function(t){return function(e){for(var r=e.length,a=new Array(r),o=0;o<r;o++)a[o]=t(e[o]);return a}};var Nn=t=>t;var re=function(t){return function(e){for(var r=[],a=0,o=t.length;a<o;a++)Array.prototype.push.apply(r,e(t[a]));return r}};var Pt=(t,e)=>({tag:t,_1:e}),fr=t=>Pt("Left",t),fe=t=>Pt("Right",t);var xn=t=>t;var me={map:t=>e=>t(e)};var Ma={apply:t=>e=>t(e),Functor0:()=>me},Ci={bind:t=>e=>e(t),Apply0:()=>Ma},Mi={pure:xn,Apply0:()=>Ma},Yt={Applicative0:()=>Mi,Bind1:()=>Ci};var La=function(t){return function(){return t}};var Li={apply:t=>e=>()=>{let r=t(),a=e();return mr.pure(r(a))()},Functor0:()=>Ni},mr={pure:La,Apply0:()=>Li},Ni={map:t=>e=>()=>{let r=e();return t(r)}};var ht=(t,e)=>({tag:t,_1:e}),yr=t=>ht("Loop",t),Na=t=>ht("Done",t);var xa={tailRecM:t=>{let e=r=>{let a=r,o=!0,i;for(;o;){let d=a;if(d.tag==="Loop"){a=t(d._1);continue}if(d.tag==="Done"){o=!1,i=d._1;continue}f()}return i};return r=>e(t(r))},Monad0:()=>Yt};var Ye=function(t){return function(e){return function(r){for(var a=e,o=r.length,i=o-1;i>=0;i--)a=t(r[i])(a);return a}}},Ze=function(t){return function(e){return function(r){for(var a=e,o=r.length,i=0;i<o;i++)a=t(a)(r[i]);return a}}};var hr=t=>{let e=t.Apply0(),r=e.Functor0().map;return a=>o=>a.foldr(i=>{let d=o(i);return u=>e.apply(r($=>Nn)(d))(u)})(t.pure())},Dr=t=>{let e=hr(t);return r=>{let a=e(r);return o=>i=>a(i)(o)}};var dn={foldr:t=>e=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return t(r._1)(e);f()},foldl:t=>e=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return t(e)(r._1);f()},foldMap:t=>{let e=t.mempty;return r=>a=>{if(a.tag==="Nothing")return e;if(a.tag==="Just")return r(a._1);f()}}};var ae={foldr:Ye,foldl:Ze,foldMap:t=>{let e=t.Semigroup0().append,r=t.mempty;return a=>ae.foldr(o=>i=>e(a(o))(i))(r)}};var y=(t,e)=>({tag:"Tuple",_1:t,_2:e});var Zt=t=>t._2;var In={map:t=>e=>y(e._1,t(e._2))};var Se=t=>t._1;var br=t=>{let e=t.Eq0();return r=>{let a=r.Eq0(),o={eq:i=>d=>e.eq(i._1)(d._1)&&a.eq(i._2)(d._2)};return{compare:i=>d=>{let u=t.compare(i._1)(d._1);return u.tag==="LT"?wt:u.tag==="GT"?Rt:r.compare(i._2)(d._2)},Eq0:()=>o}}};var E=(t,e,r)=>({tag:t,_1:e,_2:r});var I=E("Nil");var Sa=(()=>(e=>r=>{let a=e,o=r,i=!0,d;for(;i;){let u=a,$=o;if($.tag==="Nil"){i=!1,d=u;continue}if($.tag==="Cons"){a=E("Cons",$._1,u),o=$._2;continue}f()}return d})(I))();var Yi=function(){function t(o){return[o]}function e(o){return function(i){return[o,i]}}function r(o){return function(i){return function(d){return[o,i,d]}}}function a(o){return function(i){return o.concat(i)}}return function(o){return function(i){return function(d){return function(u){return function($){function p(l,c){switch(c-l){case 0:return d([]);case 1:return i(t)(u($[l]));case 2:return o(i(e)(u($[l])))(u($[l+1]));case 3:return o(o(i(r)(u($[l])))(u($[l+1])))(u($[l+2]));default:var n=l+Math.floor((c-l)/4)*2;return o(i(a)(p(l,n)))(p(n,c))}}return p(0,$.length)}}}}}}();var Dt=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var Qa=t=>{let e=t,r=!0,a;for(;r;){let o=e;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){r=!1,a=m;continue}e=Dt(Sa(o._2),I);continue}if(o._1.tag==="Cons"){r=!1,a=L("Just",y(o._1._1,Dt(o._1._2,o._2)));continue}f()}return a};var Mt=(t,e,r)=>({tag:t,_1:e,_2:r}),G=Mt("CatNil");var Tt=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return Mt("CatCons",t._1,Dt(t._2._1,E("Cons",e,t._2._2)));f()},Lu=t=>e=>r=>{let a=i=>d=>u=>{let $=i,p=d,l=u,c=!0,n;for(;c;){let s=$,_=p,R=l;if(R.tag==="Nil"){c=!1,n=_;continue}if(R.tag==="Cons"){$=s,p=s(_)(R._1),l=R._2;continue}f()}return n};return(i=>d=>{let u=i,$=d,p=!0,l;for(;p;){let c=u,n=$,s=Qa(c);if(s.tag==="Nothing"){p=!1,l=a(_=>R=>R(_))(e)(n);continue}if(s.tag==="Just"){u=s._1._2,$=E("Cons",t(s._1._1),n);continue}f()}return l})(r)(I)},Oa=t=>{if(t.tag==="CatNil")return m;if(t.tag==="CatCons")return L("Just",y(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?G:Lu(Tt)(G)(t._2)));f()};var A=(t,e)=>({tag:"Free",_1:t,_2:e}),j=(t,e,r)=>({tag:t,_1:e,_2:r});var ja=t=>{let e=t,r=!0,a;for(;r;){let o=e;if(o._1.tag==="Return"){let i=Oa(o._2);if(i.tag==="Nothing"){r=!1,a=j("Return",o._1._1);continue}if(i.tag==="Just"){e=(()=>{let d=i._1._1(o._1._1);return A(d._1,Tt(d._2)(i._1._2))})();continue}f()}if(o._1.tag==="Bind"){r=!1,a=j("Bind",o._1._1,i=>{let d=o._1._2(i);return A(d._1,Tt(d._2)(o._2))});continue}f()}return a},Va=t=>e=>{let r=e.Monad0(),a=r.Bind1().Apply0().Functor0().map,o=r.Applicative0().pure;return i=>e.tailRecM(d=>{let u=ja(d);if(u.tag==="Return")return a(Na)(o(u._1));if(u.tag==="Bind")return a(yr)(i(t.map(u._2)(u._1)));f()})};var Fn={Applicative0:()=>An,Bind1:()=>Fr},Ka={map:t=>e=>Fr.bind(e)(r=>An.pure(t(r)))},Fr={bind:t=>e=>A(t._1,Tt(t._2)(Mt("CatCons",e,Dt(I,I)))),Apply0:()=>Ar},Ar={apply:t=>e=>A(t._1,Tt(t._2)(Mt("CatCons",r=>A(e._1,Tt(e._2)(Mt("CatCons",a=>An.pure(r(a)),Dt(I,I)))),Dt(I,I)))),Functor0:()=>Ka},An={pure:t=>A(j("Return",t),G),Apply0:()=>Ar};var Sn={tailRecM:t=>e=>{let r=t(e);return A(r._1,Tt(r._2)(Mt("CatCons",a=>{if(a.tag==="Loop")return Sn.tailRecM(t)(a._1);if(a.tag==="Done")return A(j("Return",a._1),G);f()},Dt(I,I))))},Monad0:()=>Fn};var Nu=t=>{let e=r=>{let a=ja(r);if(a.tag==="Return")return A(j("Return",a._1),G);if(a.tag==="Bind"){let o=t(a._1);return A(o._1,Tt(o._2)(Mt("CatCons",i=>e(a._2(i)),Dt(I,I))))}f()};return e},Ya=t=>Nu(e=>A(j("Bind",t(e),r=>A(j("Return",r),G)),G));var Za=function(t){return function(e){return t===e}};var Xa=Za,to=Za;var eo={eq:to},Re={eq:Xa};var Xe=function(t){var e=null;return function(){return t===void 0||(e=t(),t=void 0),e}},Pe=function(t){return t()};var ro=function(t){return function(e){return function(r){return function(a){return function(o){return a<o?t:a===o?e:r}}}}};var ao=ro,oo=ro;var Rr={compare:oo(wt)($e)(Rt),Eq0:()=>eo},Y={compare:ao(wt)($e)(Rt),Eq0:()=>Re};var io=function(t){return function(e){return function(r){return function(a){return function(o){return function(i){for(var d=[],u=i;;){var $=o(u);d.push(r($));var p=a($);if(t(p))return d;u=e(p)}}}}}}};var Au=t=>{if(t.tag==="Just")return t._1;f()};var Pr={unfoldr1:io(Cn)(Au)(Se)(Zt)};var co=function(t){return function(e){return function(r){return function(a){return function(o){return function(i){for(var d=[],u=i;;){var $=o(u);if(t($))return d;var p=e($);d.push(r(p)),u=a(p)}}}}}}};var Su=t=>{if(t.tag==="Just")return t._1;f()};var tn={unfoldr:co(Cn)(Su)(Se)(Zt),Unfoldable10:()=>Pr};var ft=function(t){throw new Error(t)};var Pn=(t,e,r,a)=>({tag:"KickUp",_1:t,_2:e,_3:r,_4:a}),b=(t,e,r,a,o,i,d,u)=>({tag:t,_1:e,_2:r,_3:a,_4:o,_5:i,_6:d,_7:u}),et=(t,e,r,a,o,i,d)=>({tag:t,_1:e,_2:r,_3:a,_4:o,_5:i,_6:d});var W=b("Leaf");var Wn=t=>e=>{let r=a=>{let o=a,i=!0,d;for(;i;){let u=o;if(u.tag==="Nil"){i=!1,d=m;continue}if(u.tag==="Cons"){if(u._1.tag==="Leaf"){o=u._2;continue}if(u._1.tag==="Two"){if(u._1._1.tag==="Leaf"){if(u._1._4.tag==="Leaf"){i=!1,d=L("Just",y(y(u._1._2,u._1._3),u._2));continue}i=!1,d=L("Just",y(y(u._1._2,u._1._3),E("Cons",u._1._4,u._2)));continue}o=E("Cons",u._1._1,E("Cons",b("Two",W,u._1._2,u._1._3,W),E("Cons",u._1._4,u._2)));continue}if(u._1.tag==="Three"){o=E("Cons",u._1._1,E("Cons",b("Two",W,u._1._2,u._1._3,W),E("Cons",u._1._4,E("Cons",b("Two",W,u._1._5,u._1._6,W),E("Cons",u._1._7,u._2)))));continue}f()}f()}return d};return t.unfoldr(r)(E("Cons",e,I))};var oe=t=>e=>a=>{let o=a,i=!0,d;for(;i;){let u=o;if(u.tag==="Leaf"){i=!1,d=m;continue}if(u.tag==="Two"){let $=t.compare(e)(u._2);if($.tag==="EQ"){i=!1,d=L("Just",u._3);continue}if($.tag==="LT"){o=u._1;continue}o=u._4;continue}if(u.tag==="Three"){let $=t.compare(e)(u._2);if($.tag==="EQ"){i=!1,d=L("Just",u._3);continue}let p=t.compare(e)(u._5);if(p.tag==="EQ"){i=!1,d=L("Just",u._6);continue}if($.tag==="LT"){o=u._1;continue}if(p.tag==="GT"){o=u._7;continue}o=u._4;continue}f()}return d};var te={map:t=>e=>{if(e.tag==="Leaf")return W;if(e.tag==="Two")return b("Two",te.map(t)(e._1),e._2,t(e._3),te.map(t)(e._4));if(e.tag==="Three")return b("Three",te.map(t)(e._1),e._2,t(e._3),te.map(t)(e._4),e._5,t(e._6),te.map(t)(e._7));f()}};var mt=t=>e=>r=>{let a=t,o=e,i=r,d=!0,u;for(;d;){let $=a,p=o,l=i;if(p.tag==="Nil"){d=!1,u=l;continue}if(p.tag==="Cons"){if(p._1.tag==="TwoLeft"){a=$,o=p._2,i=b("Two",l,p._1._1,p._1._2,p._1._3);continue}if(p._1.tag==="TwoRight"){a=$,o=p._2,i=b("Two",p._1._1,p._1._2,p._1._3,l);continue}if(p._1.tag==="ThreeLeft"){a=$,o=p._2,i=b("Three",l,p._1._1,p._1._2,p._1._3,p._1._4,p._1._5,p._1._6);continue}if(p._1.tag==="ThreeMiddle"){a=$,o=p._2,i=b("Three",p._1._1,p._1._2,p._1._3,l,p._1._4,p._1._5,p._1._6);continue}if(p._1.tag==="ThreeRight"){a=$,o=p._2,i=b("Three",p._1._1,p._1._2,p._1._3,p._1._4,p._1._5,p._1._6,l);continue}f()}f()}return u},qn=t=>e=>r=>{let a=i=>d=>{let u=i,$=d,p=!0,l;for(;p;){let c=u,n=$;if(c.tag==="Nil"){p=!1,l=b("Two",n._1,n._2,n._3,n._4);continue}if(c.tag==="Cons"){if(c._1.tag==="TwoLeft"){p=!1,l=mt(t)(c._2)(b("Three",n._1,n._2,n._3,n._4,c._1._1,c._1._2,c._1._3));continue}if(c._1.tag==="TwoRight"){p=!1,l=mt(t)(c._2)(b("Three",c._1._1,c._1._2,c._1._3,n._1,n._2,n._3,n._4));continue}if(c._1.tag==="ThreeLeft"){u=c._2,$=Pn(b("Two",n._1,n._2,n._3,n._4),c._1._1,c._1._2,b("Two",c._1._3,c._1._4,c._1._5,c._1._6));continue}if(c._1.tag==="ThreeMiddle"){u=c._2,$=Pn(b("Two",c._1._1,c._1._2,c._1._3,n._1),n._2,n._3,b("Two",n._4,c._1._4,c._1._5,c._1._6));continue}if(c._1.tag==="ThreeRight"){u=c._2,$=Pn(b("Two",c._1._1,c._1._2,c._1._3,c._1._4),c._1._5,c._1._6,b("Two",n._1,n._2,n._3,n._4));continue}f()}f()}return l};return(i=>d=>{let u=i,$=d,p=!0,l;for(;p;){let c=u,n=$;if(n.tag==="Leaf"){p=!1,l=a(c)(Pn(W,e,r,W));continue}if(n.tag==="Two"){let s=t.compare(e)(n._2);if(s.tag==="EQ"){p=!1,l=mt(t)(c)(b("Two",n._1,e,r,n._4));continue}if(s.tag==="LT"){u=E("Cons",et("TwoLeft",n._2,n._3,n._4),c),$=n._1;continue}u=E("Cons",et("TwoRight",n._1,n._2,n._3),c),$=n._4;continue}if(n.tag==="Three"){let s=t.compare(e)(n._2);if(s.tag==="EQ"){p=!1,l=mt(t)(c)(b("Three",n._1,e,r,n._4,n._5,n._6,n._7));continue}let _=t.compare(e)(n._5);if(_.tag==="EQ"){p=!1,l=mt(t)(c)(b("Three",n._1,n._2,n._3,n._4,e,r,n._7));continue}if(s.tag==="LT"){u=E("Cons",et("ThreeLeft",n._2,n._3,n._4,n._5,n._6,n._7),c),$=n._1;continue}if(s.tag==="GT"){if(_.tag==="LT"){u=E("Cons",et("ThreeMiddle",n._1,n._2,n._3,n._5,n._6,n._7),c),$=n._4;continue}u=E("Cons",et("ThreeRight",n._1,n._2,n._3,n._4,n._5,n._6),c),$=n._7;continue}u=E("Cons",et("ThreeRight",n._1,n._2,n._3,n._4,n._5,n._6),c),$=n._7;continue}f()}return l})(I)},Ru=t=>e=>{let r=d=>u=>{let $=d,p=u,l=!0,c;for(;l;){let n=$,s=p;if(n.tag==="Nil"){l=!1,c=s;continue}if(n.tag==="Cons"){let _=n._2,R=(gt,_t,nt,yt,X,v,rt,at,ot,B)=>mt(t)(_)(b("Two",b("Two",gt,X,at,_t),v,ot,b("Two",nt,rt,B,yt))),tt=(gt,_t,nt,yt,X,v,rt,at,ot,B)=>mt(t)(_)(b("Two",b("Two",gt,X,at,_t),v,ot,b("Two",nt,rt,B,yt))),ut=(gt,_t,nt,yt,X,v,rt,at,ot,B)=>mt(t)(_)(b("Two",b("Three",gt,X,at,_t,v,ot,nt),rt,B,yt)),It=(gt,_t,nt,yt,X,v,rt,at,ot,B)=>mt(t)(_)(b("Two",b("Three",gt,X,at,_t,v,ot,nt),rt,B,yt)),ne=(gt,_t,nt,yt,X,v,rt,at,ot,B)=>mt(t)(_)(b("Two",gt,X,at,b("Three",_t,v,ot,nt,rt,B,yt))),Ge=(gt,_t,nt,yt,X,v,rt,at,ot,B)=>mt(t)(_)(b("Two",gt,X,at,b("Three",_t,v,ot,nt,rt,B,yt))),T=(gt,_t,nt,yt,X,v,rt,at,ot,B,zt,Vt,pe)=>mt(t)(_)(b("Three",b("Two",gt,v,B,_t),rt,zt,b("Two",nt,at,Vt,yt),ot,pe,X)),At=(gt,_t,nt,yt,X,v,rt,at,ot,B,zt,Vt,pe)=>mt(t)(_)(b("Three",b("Two",gt,v,B,_t),rt,zt,b("Two",nt,at,Vt,yt),ot,pe,X)),Ie=(gt,_t,nt,yt,X,v,rt,at,ot,B,zt,Vt,pe)=>mt(t)(_)(b("Three",gt,v,B,b("Two",_t,rt,zt,nt),at,Vt,b("Two",yt,ot,pe,X))),sn=(gt,_t,nt,yt,X,v,rt,at,ot,B,zt,Vt,pe)=>mt(t)(_)(b("Three",gt,v,B,b("Two",_t,rt,zt,nt),at,Vt,b("Two",yt,ot,pe,X)));if(s.tag==="Leaf"){if(n._1.tag==="TwoLeft"){if(n._1._3.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Two",W,n._1._1,n._1._2,W));continue}if(n._1._3.tag==="Two"){$=_,p=b("Three",s,n._1._1,n._1._2,n._1._3._1,n._1._3._2,n._1._3._3,n._1._3._4);continue}if(n._1._3.tag==="Three"){l=!1,c=R(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._1,n._1._3._2,n._1._3._5,n._1._2,n._1._3._3,n._1._3._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="TwoRight"){if(n._1._1.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Two",W,n._1._2,n._1._3,W));continue}if(n._1._1.tag==="Two"){$=_,p=b("Three",n._1._1._1,n._1._1._2,n._1._1._3,n._1._1._4,n._1._2,n._1._3,s);continue}if(n._1._1.tag==="Three"){l=!1,c=tt(n._1._1._1,n._1._1._4,n._1._1._7,s,n._1._1._2,n._1._1._5,n._1._2,n._1._1._3,n._1._1._6,n._1._3);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeLeft"){if(n._1._6.tag==="Leaf"){if(n._1._3.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Three",W,n._1._1,n._1._2,W,n._1._4,n._1._5,W));continue}if(n._1._3.tag==="Two"){l=!1,c=ut(s,n._1._3._1,n._1._3._4,n._1._6,n._1._1,n._1._3._2,n._1._4,n._1._2,n._1._3._3,n._1._5);continue}if(n._1._3.tag==="Three"){l=!1,c=T(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._6,n._1._1,n._1._3._2,n._1._3._5,n._1._4,n._1._2,n._1._3._3,n._1._3._6,n._1._5);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1._3.tag==="Two"){l=!1,c=ut(s,n._1._3._1,n._1._3._4,n._1._6,n._1._1,n._1._3._2,n._1._4,n._1._2,n._1._3._3,n._1._5);continue}if(n._1._3.tag==="Three"){l=!1,c=T(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._6,n._1._1,n._1._3._2,n._1._3._5,n._1._4,n._1._2,n._1._3._3,n._1._3._6,n._1._5);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeMiddle"){if(n._1._1.tag==="Leaf"){if(n._1._6.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Three",W,n._1._2,n._1._3,W,n._1._4,n._1._5,W));continue}if(n._1._6.tag==="Two"){l=!1,c=ne(n._1._1,s,n._1._6._1,n._1._6._4,n._1._2,n._1._4,n._1._6._2,n._1._3,n._1._5,n._1._6._3);continue}if(n._1._6.tag==="Three"){l=!1,c=Ie(n._1._1,s,n._1._6._1,n._1._6._4,n._1._6._7,n._1._2,n._1._4,n._1._6._2,n._1._6._5,n._1._3,n._1._5,n._1._6._3,n._1._6._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1._1.tag==="Two"){l=!1,c=It(n._1._1._1,n._1._1._4,s,n._1._6,n._1._1._2,n._1._2,n._1._4,n._1._1._3,n._1._3,n._1._5);continue}if(n._1._6.tag==="Two"){l=!1,c=ne(n._1._1,s,n._1._6._1,n._1._6._4,n._1._2,n._1._4,n._1._6._2,n._1._3,n._1._5,n._1._6._3);continue}if(n._1._1.tag==="Three"){l=!1,c=At(n._1._1._1,n._1._1._4,n._1._1._7,s,n._1._6,n._1._1._2,n._1._1._5,n._1._2,n._1._4,n._1._1._3,n._1._1._6,n._1._3,n._1._5);continue}if(n._1._6.tag==="Three"){l=!1,c=Ie(n._1._1,s,n._1._6._1,n._1._6._4,n._1._6._7,n._1._2,n._1._4,n._1._6._2,n._1._6._5,n._1._3,n._1._5,n._1._6._3,n._1._6._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeRight"){if(n._1._1.tag==="Leaf"){if(n._1._4.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Three",W,n._1._2,n._1._3,W,n._1._5,n._1._6,W));continue}if(n._1._4.tag==="Two"){l=!1,c=Ge(n._1._1,n._1._4._1,n._1._4._4,s,n._1._2,n._1._4._2,n._1._5,n._1._3,n._1._4._3,n._1._6);continue}if(n._1._4.tag==="Three"){l=!1,c=sn(n._1._1,n._1._4._1,n._1._4._4,n._1._4._7,s,n._1._2,n._1._4._2,n._1._4._5,n._1._5,n._1._3,n._1._4._3,n._1._4._6,n._1._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1._4.tag==="Two"){l=!1,c=Ge(n._1._1,n._1._4._1,n._1._4._4,s,n._1._2,n._1._4._2,n._1._5,n._1._3,n._1._4._3,n._1._6);continue}if(n._1._4.tag==="Three"){l=!1,c=sn(n._1._1,n._1._4._1,n._1._4._4,n._1._4._7,s,n._1._2,n._1._4._2,n._1._4._5,n._1._5,n._1._3,n._1._4._3,n._1._4._6,n._1._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="TwoLeft"){if(n._1._3.tag==="Two"){$=_,p=b("Three",s,n._1._1,n._1._2,n._1._3._1,n._1._3._2,n._1._3._3,n._1._3._4);continue}if(n._1._3.tag==="Three"){l=!1,c=R(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._1,n._1._3._2,n._1._3._5,n._1._2,n._1._3._3,n._1._3._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="TwoRight"){if(n._1._1.tag==="Two"){$=_,p=b("Three",n._1._1._1,n._1._1._2,n._1._1._3,n._1._1._4,n._1._2,n._1._3,s);continue}if(n._1._1.tag==="Three"){l=!1,c=tt(n._1._1._1,n._1._1._4,n._1._1._7,s,n._1._1._2,n._1._1._5,n._1._2,n._1._1._3,n._1._1._6,n._1._3);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeLeft"){if(n._1._3.tag==="Two"){l=!1,c=ut(s,n._1._3._1,n._1._3._4,n._1._6,n._1._1,n._1._3._2,n._1._4,n._1._2,n._1._3._3,n._1._5);continue}if(n._1._3.tag==="Three"){l=!1,c=T(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._6,n._1._1,n._1._3._2,n._1._3._5,n._1._4,n._1._2,n._1._3._3,n._1._3._6,n._1._5);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeMiddle"){if(n._1._1.tag==="Two"){l=!1,c=It(n._1._1._1,n._1._1._4,s,n._1._6,n._1._1._2,n._1._2,n._1._4,n._1._1._3,n._1._3,n._1._5);continue}if(n._1._6.tag==="Two"){l=!1,c=ne(n._1._1,s,n._1._6._1,n._1._6._4,n._1._2,n._1._4,n._1._6._2,n._1._3,n._1._5,n._1._6._3);continue}if(n._1._1.tag==="Three"){l=!1,c=At(n._1._1._1,n._1._1._4,n._1._1._7,s,n._1._6,n._1._1._2,n._1._1._5,n._1._2,n._1._4,n._1._1._3,n._1._1._6,n._1._3,n._1._5);continue}if(n._1._6.tag==="Three"){l=!1,c=Ie(n._1._1,s,n._1._6._1,n._1._6._4,n._1._6._7,n._1._2,n._1._4,n._1._6._2,n._1._6._5,n._1._3,n._1._5,n._1._6._3,n._1._6._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeRight"){if(n._1._4.tag==="Two"){l=!1,c=Ge(n._1._1,n._1._4._1,n._1._4._4,s,n._1._2,n._1._4._2,n._1._5,n._1._3,n._1._4._3,n._1._6);continue}if(n._1._4.tag==="Three"){l=!1,c=sn(n._1._1,n._1._4._1,n._1._4._4,n._1._4._7,s,n._1._2,n._1._4._2,n._1._4._5,n._1._5,n._1._3,n._1._4._3,n._1._4._6,n._1._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}f()}return c},a=d=>u=>{let $=d,p=u,l=!0,c;for(;l;){let n=$,s=p;if(s.tag==="Two"){if(s._1.tag==="Leaf"){if(s._4.tag==="Leaf"){l=!1,c=r(n)(W);continue}$=E("Cons",et("TwoRight",s._1,s._2,s._3),n),p=s._4;continue}$=E("Cons",et("TwoRight",s._1,s._2,s._3),n),p=s._4;continue}if(s.tag==="Three"){if(s._1.tag==="Leaf"){if(s._4.tag==="Leaf"){if(s._7.tag==="Leaf"){l=!1,c=r(E("Cons",et("TwoRight",W,s._2,s._3),n))(W);continue}$=E("Cons",et("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}$=E("Cons",et("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}$=E("Cons",et("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}l=!1,c=ft("The impossible happened in partial function `removeMaxNode`.")}return c},o=d=>{let u=d,$=!0,p;for(;$;){let l=u;if(l.tag==="Two"){if(l._4.tag==="Leaf"){$=!1,p={key:l._2,value:l._3};continue}u=l._4;continue}if(l.tag==="Three"){if(l._7.tag==="Leaf"){$=!1,p={key:l._5,value:l._6};continue}u=l._7;continue}$=!1,p=ft("The impossible happened in partial function `maxNode`.")}return p};return(d=>u=>{let $=d,p=u,l=!0,c;for(;l;){let n=$,s=p;if(s.tag==="Leaf"){l=!1,c=m;continue}if(s.tag==="Two"){let _=t.compare(e)(s._2);if(_.tag==="EQ"){if(s._4.tag==="Leaf"){l=!1,c=L("Just",y(s._3,r(n)(W)));continue}let R=o(s._1);l=!1,c=L("Just",y(s._3,a(E("Cons",et("TwoLeft",R.key,R.value,s._4),n))(s._1)));continue}if(_.tag==="LT"){$=E("Cons",et("TwoLeft",s._2,s._3,s._4),n),p=s._1;continue}$=E("Cons",et("TwoRight",s._1,s._2,s._3),n),p=s._4;continue}if(s.tag==="Three"){let _=t.compare(e)(s._5),R=t.compare(e)(s._2);if((()=>s._1.tag==="Leaf"&&s._4.tag==="Leaf"?s._7.tag==="Leaf":!1)()){if(R.tag==="EQ"){l=!1,c=L("Just",y(s._3,mt(t)(n)(b("Two",W,s._5,s._6,W))));continue}if(_.tag==="EQ"){l=!1,c=L("Just",y(s._6,mt(t)(n)(b("Two",W,s._2,s._3,W))));continue}if(R.tag==="LT"){$=E("Cons",et("ThreeLeft",s._2,s._3,s._4,s._5,s._6,s._7),n),p=s._1;continue}if(R.tag==="GT"){if(_.tag==="LT"){$=E("Cons",et("ThreeMiddle",s._1,s._2,s._3,s._5,s._6,s._7),n),p=s._4;continue}$=E("Cons",et("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}$=E("Cons",et("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}if(R.tag==="EQ"){let tt=o(s._1);l=!1,c=L("Just",y(s._3,a(E("Cons",et("ThreeLeft",tt.key,tt.value,s._4,s._5,s._6,s._7),n))(s._1)));continue}if(_.tag==="EQ"){let tt=o(s._4);l=!1,c=L("Just",y(s._6,a(E("Cons",et("ThreeMiddle",s._1,s._2,s._3,tt.key,tt.value,s._7),n))(s._4)));continue}if(R.tag==="LT"){$=E("Cons",et("ThreeLeft",s._2,s._3,s._4,s._5,s._6,s._7),n),p=s._1;continue}if(R.tag==="GT"){if(_.tag==="LT"){$=E("Cons",et("ThreeMiddle",s._1,s._2,s._3,s._5,s._6,s._7),n),p=s._4;continue}$=E("Cons",et("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}$=E("Cons",et("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}f()}return c})(I)};var vn=t=>e=>e.foldl(r=>a=>qn(t)(a._1)(a._2)(r))(W);var Pu=t=>e=>r=>{let a=Ru(t)(e)(r);if(a.tag==="Nothing")return r;if(a.tag==="Just")return a._1._2;f()};var Wu=t=>e=>r=>a=>{let o=e(oe(t)(r)(a));if(o.tag==="Nothing")return Pu(t)(r)(a);if(o.tag==="Just")return qn(t)(r)(o._1)(a);f()};var po=t=>e=>r=>a=>Wu(t)(o=>{if(o.tag==="Nothing")return m;if(o.tag==="Just")return e(o._1);f()})(r)(a);function Ft(t,e,r){return t==null?e:r(t)}var Ut=function(){var t={},e="Pure",r="Throw",a="Catch",o="Sync",i="Async",d="Bind",u="Bracket",$="Fork",p="Sequential",l="Map",c="Apply",n="Alt",s="Cons",_="Resume",R="Release",tt="Finalizer",ut="Finalized",It="Forked",ne="Fiber",Ge="Thunk";function T(h,z,dt,U){this.tag=h,this._1=z,this._2=dt,this._3=U}function At(h){var z=function(dt,U,C){return new T(h,dt,U,C)};return z.tag=h,z}function Ie(h){return new T(e,void 0)}function sn(h){try{h()}catch(z){setTimeout(function(){throw z},0)}}function gt(h,z,dt){try{return z(dt())}catch(U){return h(U)}}function _t(h,z,dt){try{return z(dt)()}catch(U){return dt(h(U))(),Ie}}var nt=function(){var h=1024,z=0,dt=0,U=new Array(h),C=!1;function g(){var H;for(C=!0;z!==0;)z--,H=U[dt],U[dt]=void 0,dt=(dt+1)%h,H();C=!1}return{isDraining:function(){return C},enqueue:function(H){var S,st;z===h&&(st=C,g(),C=st),U[(dt+z)%h]=H,z++,C||g()}}}();function yt(h){var z={},dt=0,U=0;return{register:function(C){var g=dt++;C.onComplete({rethrow:!0,handler:function(H){return function(){U--,delete z[g]}}})(),z[g]=C,U++},isEmpty:function(){return U===0},killAll:function(C,g){return function(){if(U===0)return g();var H=0,S={};function st(V){S[V]=z[V].kill(C,function($t){return function(){delete S[V],H--,h.isLeft($t)&&h.fromLeft($t)&&setTimeout(function(){throw h.fromLeft($t)},0),H===0&&g()}})()}for(var Nt in z)z.hasOwnProperty(Nt)&&(H++,st(Nt));return z={},dt=0,U=0,function(V){return new T(o,function(){for(var $t in S)S.hasOwnProperty($t)&&S[$t]()})}}}}}var X=0,v=1,rt=2,at=3,ot=4,B=5,zt=6;function Vt(h,z,dt){var U=0,C=X,g=dt,H=null,S=null,st=null,Nt=null,V=null,$t=0,Fe=0,Qt=null,De=!0;function be(M){for(var N,P,q;;)switch(N=null,P=null,q=null,C){case rt:C=v;try{g=st(g),Nt===null?st=null:(st=Nt._1,Nt=Nt._2)}catch(Et){C=B,H=h.left(Et),g=null}break;case at:h.isLeft(g)?(C=B,H=g,g=null):st===null?C=B:(C=rt,g=h.fromRight(g));break;case v:switch(g.tag){case d:st&&(Nt=new T(s,st,Nt)),st=g._2,C=v,g=g._1;break;case e:st===null?(C=B,g=h.right(g._1)):(C=rt,g=g._1);break;case o:C=at,g=gt(h.left,h.right,g._1);break;case i:C=ot,g=_t(h.left,g._1,function(Et){return function(){U===M&&(U++,nt.enqueue(function(){U===M+1&&(C=at,g=Et,be(U))}))}});return;case r:C=B,H=h.left(g._1),g=null;break;case a:st===null?V=new T(s,g,V,S):V=new T(s,g,new T(s,new T(_,st,Nt),V,S),S),st=null,Nt=null,C=v,g=g._1;break;case u:$t++,st===null?V=new T(s,g,V,S):V=new T(s,g,new T(s,new T(_,st,Nt),V,S),S),st=null,Nt=null,C=v,g=g._1;break;case $:C=at,N=Vt(h,z,g._2),z&&z.register(N),g._1&&N.run(),g=h.right(N);break;case p:C=v,g=pi(h,z,g._1);break}break;case B:if(st=null,Nt=null,V===null)C=zt,g=S||H||g;else switch(N=V._3,q=V._1,V=V._2,q.tag){case a:S&&S!==N&&$t===0?C=B:H&&(C=v,g=q._2(h.fromLeft(H)),H=null);break;case _:S&&S!==N&&$t===0||H?C=B:(st=q._1,Nt=q._2,C=rt,g=h.fromRight(g));break;case u:$t--,H===null&&(P=h.fromRight(g),V=new T(s,new T(R,q._2,P),V,N),(S===N||$t>0)&&(C=v,g=q._3(P)));break;case R:V=new T(s,new T(ut,g,H),V,S),C=v,S&&S!==N&&$t===0?g=q._1.killed(h.fromLeft(S))(q._2):H?g=q._1.failed(h.fromLeft(H))(q._2):g=q._1.completed(h.fromRight(g))(q._2),H=null,$t++;break;case tt:$t++,V=new T(s,new T(ut,g,H),V,S),C=v,g=q._1;break;case ut:$t--,C=B,g=q._1,H=q._2;break}break;case zt:for(var lt in Qt)Qt.hasOwnProperty(lt)&&(De=De&&Qt[lt].rethrow,sn(Qt[lt].handler(g)));Qt=null,S&&H?setTimeout(function(){throw h.fromLeft(H)},0):h.isLeft(g)&&De&&setTimeout(function(){if(De)throw h.fromLeft(g)},0);return;case X:C=v;break;case ot:return}}function ct(M){return function(){if(C===zt)return De=De&&M.rethrow,M.handler(g)(),function(){};var N=Fe++;return Qt=Qt||{},Qt[N]=M,function(){Qt!==null&&delete Qt[N]}}}function x(M,N){return function(){if(C===zt)return N(h.right(void 0))(),function(){};var P=ct({rethrow:!1,handler:function(){return N(h.right(void 0))}})();switch(C){case X:S=h.left(M),C=zt,g=S,be(U);break;case ot:S===null&&(S=h.left(M)),$t===0&&(C===ot&&(V=new T(s,new T(tt,g(M)),V,S)),C=B,g=null,H=null,be(++U));break;default:S===null&&(S=h.left(M)),$t===0&&(C=B,g=null,H=null)}return P}}function w(M){return function(){var N=ct({rethrow:!1,handler:M})();return C===X&&be(U),N}}return{kill:x,join:w,onComplete:ct,isSuspended:function(){return C===X},run:function(){C===X&&(nt.isDraining()?be(U):nt.enqueue(function(){be(U)}))}}}function pe(h,z,dt,U){var C=0,g={},H=0,S={},st=new Error("[ParAff] Early exit"),Nt=null,V=t;function $t(ct,x,w){var M=x,N=null,P=null,q=0,lt={},Et,un;t:for(;;)switch(Et=null,M.tag){case It:if(M._3===t&&(Et=g[M._1],lt[q++]=Et.kill(ct,function($i){return function(){q--,q===0&&w($i)()}})),N===null)break t;M=N._2,P===null?N=null:(N=P._1,P=P._2);break;case l:M=M._2;break;case c:case n:N&&(P=new T(s,N,P)),N=M,M=M._1;break}if(q===0)w(h.right(void 0))();else for(un=0,Et=q;un<Et;un++)lt[un]=lt[un]();return lt}function Fe(ct,x,w){var M,N,P,q,lt,Et;h.isLeft(ct)?(M=ct,N=null):(N=ct,M=null);t:for(;;){if(P=null,q=null,lt=null,Et=null,Nt!==null)return;if(x===null){U(M||N)();return}if(x._3!==t)return;switch(x.tag){case l:M===null?(x._3=h.right(x._1(h.fromRight(N))),N=x._3):x._3=M;break;case c:if(P=x._1._3,q=x._2._3,M){if(x._3=M,lt=!0,Et=H++,S[Et]=$t(st,M===P?x._2:x._1,function(){return function(){delete S[Et],lt?lt=!1:w===null?Fe(M,null,null):Fe(M,w._1,w._2)}}),lt){lt=!1;return}}else{if(P===t||q===t)return;N=h.right(h.fromRight(P)(h.fromRight(q))),x._3=N}break;case n:if(P=x._1._3,q=x._2._3,P===t&&h.isLeft(q)||q===t&&h.isLeft(P))return;if(P!==t&&h.isLeft(P)&&q!==t&&h.isLeft(q))M=N===P?q:P,N=null,x._3=M;else if(x._3=N,lt=!0,Et=H++,S[Et]=$t(st,N===P?x._2:x._1,function(){return function(){delete S[Et],lt?lt=!1:w===null?Fe(N,null,null):Fe(N,w._1,w._2)}}),lt){lt=!1;return}break}w===null?x=null:(x=w._1,w=w._2)}}function Qt(ct){return function(x){return function(){delete g[ct._1],ct._3=x,Fe(x,ct._2._1,ct._2._2)}}}function De(){var ct=v,x=dt,w=null,M=null,N,P;t:for(;;)switch(N=null,P=null,ct){case v:switch(x.tag){case l:w&&(M=new T(s,w,M)),w=new T(l,x._1,t,t),x=x._2;break;case c:w&&(M=new T(s,w,M)),w=new T(c,t,x._2,t),x=x._1;break;case n:w&&(M=new T(s,w,M)),w=new T(n,t,x._2,t),x=x._1;break;default:P=C++,ct=B,N=x,x=new T(It,P,new T(s,w,M),t),N=Vt(h,z,N),N.onComplete({rethrow:!1,handler:Qt(x)})(),g[P]=N,z&&z.register(N)}break;case B:if(w===null)break t;w._1===t?(w._1=x,ct=v,x=w._2,w._2=t):(w._2=x,x=w,M===null?w=null:(w=M._1,M=M._2))}for(V=x,P=0;P<C;P++)g[P].run()}function be(ct,x){Nt=h.left(ct);var w;for(var M in S)if(S.hasOwnProperty(M)){w=S[M];for(M in w)w.hasOwnProperty(M)&&w[M]()}S=null;var N=$t(ct,V,x);return function(P){return new T(i,function(q){return function(){for(var lt in N)N.hasOwnProperty(lt)&&N[lt]();return Ie}})}}return De(),function(ct){return new T(i,function(x){return function(){return be(ct,x)}})}}function pi(h,z,dt){return new T(i,function(U){return function(){return pe(h,z,dt,U)}})}return T.EMPTY=t,T.Pure=At(e),T.Throw=At(r),T.Catch=At(a),T.Sync=At(o),T.Async=At(i),T.Bind=At(d),T.Bracket=At(u),T.Fork=At($),T.Seq=At(p),T.ParMap=At(l),T.ParApply=At(c),T.ParAlt=At(n),T.Fiber=Vt,T.Supervisor=yt,T.Scheduler=nt,T.nonCanceler=Ie,T}(),ye=Ut.Pure,Uu=Ut.Throw;function fo(t){return function(e){return e.tag===Ut.Pure.tag?Ut.Pure(t(e._1)):Ut.Bind(e,function(r){return Ut.Pure(t(r))})}}function Gt(t){return function(e){return Ut.Bind(t,e)}}var se=Ut.Sync;var Gu=Ut.Async;function Jn(t,e){return function(){return Ut.Fiber(t,null,e)}}var Bn=function(){function t(r,a){return r===0&&typeof setImmediate<"u"?setImmediate(a):setTimeout(a,r)}function e(r,a){return r===0&&typeof clearImmediate<"u"?clearImmediate(a):clearTimeout(a)}return function(r,a){return Ut.Async(function(o){return function(){var i=t(a,o(r()));return function(){return Ut.Sync(function(){return r(e(a,i))})}}})}}(),Qu=Ut.Seq;var Wr={map:fo};var qr={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;f()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return ft("unsafeFromLeft: Right");f()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return ft("unsafeFromRight: Left");f()},left:fr,right:fe};var mo={Applicative0:()=>kn,Bind1:()=>Ou},Ou={bind:Gt,Apply0:()=>go},go={apply:t=>e=>Gt(t)(r=>Gt(e)(a=>kn.pure(r(a)))),Functor0:()=>Wr},kn={pure:ye,Apply0:()=>go};var Hn={liftEffect:se,Monad0:()=>mo};var _o={tailRecM:t=>{let e=r=>Gt(t(r))(a=>{if(a.tag==="Done")return ye(a._1);if(a.tag==="Loop")return e(a._1);f()});return e},Monad0:()=>mo};var yo=(t,e)=>({...t,...e}),ho=(t,e)=>t&&e?r=>t(e(r)):t||e,Do=(t,e,r,a,o,i,d)=>{if(e==="style")for(let u in yo(r,a))r=a==null||a[u]==null?"":a[u],u[0]==="-"?t[e].setProperty(u,r):t[e][u]=r;else if(e[0]==="o"&&e[1]==="n"){let u=e.slice(2);t.actions||(t.actions={}),t.actions[u]=d&&a?d(a):a,a?r||t.addEventListener(u,o):t.removeEventListener(u,o)}else!i&&e in t?t[e]=a:a==null||a===!1||e==="class"&&!a?t.removeAttribute(e):t.setAttribute(e,a)},Gn=(t,e,r,a)=>{let o=t.type===3?document.createTextNode(t.tag):(r=r||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),i=t.props,d=ho(a,t.mapf);for(let u in i)Do(o,u,null,i[u],e,r,d);for(let u=0,$=t.children.length;u<$;u++)o.appendChild(Gn(qe(t.children[u]).html,e,r,d));return t.node=o,o},We=(t,e,r,a,o,i,d)=>{if(r!==a)if(r!=null&&r.type===3&&a.type===3)r.tag!==a.tag&&(e.nodeValue=a.tag);else if(r==null||r.tag!==a.tag)e=t.insertBefore(Gn(a,o,i,d),e),r&&t.removeChild(r.node);else{let u=r.props,$=a.props,p=r.children,l=a.children,c=p.length-1,n=l.length-1;d=ho(d,a.mapf),i=i||a.tag==="svg";for(let s in yo(u,$))(s==="value"||s==="selected"||s==="checked"?e[s]:u[s])!==$[s]&&Do(e,s,u[s],$[s],o,i,d);if(a.keyed){let s=0,_=0;for(;_<=n&&s<=c;){let{key:R,html:tt}=p[s];if(R!==l[_].key)break;let ut=qe(l[_],tt);We(e,tt.node,tt,ut.html,o,i,d),_++,s++}for(;_<=n&&s<=c;){let{key:R,html:tt}=p[c];if(R!==l[n].key)break;let ut=qe(l[n],tt);We(e,tt.node,tt,ut.html,o,i,d),n--,c--}if(s>c)for(;_<=n;){let R=qe(l[_]).html;e.insertBefore(Gn(R,o,i,d),p[s]&&p[s].html.node),_++}else if(_>n)for(;s<=c;)e.removeChild(p[s].html.node),s++;else{let R={},tt={};for(let ut=s;ut<=c;ut++)R[p[ut].key]=p[ut].html;for(;_<=n;){let{key:ut,html:It}=p[s]||{key:null,html:null},{key:ne,html:Ge}=qe(l[_],It);if(tt[ut]||p[s+1]&&ne===p[s+1].key){s++;continue}if(ut===ne)We(e,It.node,It,Ge,o,i,d),tt[ne]=!0,s++;else{let T=R[ne];T!=null?(We(e,e.insertBefore(T.node,It.node),T,l[_].html,o,i,d),tt[ne]=!0):We(e,It&&It.node,null,l[_].html,o,i,d)}_++}for(let ut in R)tt[ut]||e.removeChild(R[ut].node)}}else{for(let s=0;s<=c&&s<=n;s++){let _=p[s].html,R=qe(l[s],_).html;We(e,_.node,_,R,o,i,d)}for(let s=c+1;s<=n;s++){let _=qe(l[s],r).html;e.appendChild(Gn(_,o,i,d))}for(let s=n+1;s<=c;s++)e.removeChild(p[s].html.node)}}return a.node=e,e},ju=(t,e)=>{for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!0;return!1},Vu=(t,e)=>e.reduce((r,a)=>r(a),t),qe=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||ju(e.memo,t.html.memo))&&(e=Qn(Vu(t.html.type,t.html.memo)),e.memo=t.html.memo),t.html=e),t),Qn=t=>({...t,children:t.children&&t.children.map(({key:e,html:r})=>({key:e,html:Qn(r)}))}),bo=t=>e=>()=>t.actions[e],To=t=>e=>r=>a=>o=>()=>We(t,e,r,a,i=>o(i)()),Co=t=>e=>(e.node=t,e);var Yu=(t,e,r,a=!1)=>{let o={},i={style:o},d={tag:t,children:r,props:i,node:null,keyed:a},u=e.length;for(let $=0;$<u;$++){let[p,l,c]=e[$];p==1?i[l]=c:p===2?i.class=i.class?i.class+" "+l:l:p===3&&(o[l]=c)}return d},bt=t=>e=>r=>Yu(t,e,r.map(a=>({key:null,html:a})));var Zu=t=>({tag:t,props:{},children:[],type:3});var Lt=t=>e=>[1,t,e],Q=t=>[2,t];var Ne=t=>e=>[1,"on"+t,e],On=t=>e=>[3,t,e],J=Zu,Mo=t=>e=>({memo:[e],type:t}),Lo=t=>e=>r=>({memo:[e,r],type:t});var No=J("");var xo={dimap:t=>e=>r=>a=>e(r(t(a)))};var pn=(()=>({first:t=>e=>y(t(e._1),e._2),second:In.map,Profunctor0:()=>xo}))();function jn(t){return function(e){return t===e}}var xt=(t,e,r)=>({tag:t,_1:e,_2:r});var Io={state:t=>A(j("Bind",xt("State",t),e=>A(j("Return",e),G)),G),Monad0:()=>Fn};var zr=t=>({liftEffect:e=>A(j("Bind",xt("Lift",t.liftEffect(e)),r=>A(j("Return",r),G)),G),Monad0:()=>Fn});var Fo=t=>{let e=zr(t.MonadEffect0());return{liftAff:r=>A(j("Bind",xt("Lift",t.liftAff(r)),a=>A(j("Return",a),G)),G),MonadEffect0:()=>e}},Ao=t=>({map:e=>r=>{if(r.tag==="State")return xt("State",a=>{let o=r._1(a);return y(e(o._1),o._2)});if(r.tag==="Lift")return xt("Lift",t.map(e)(r._1));if(r.tag==="Subscribe")return xt("Subscribe",r._1,a=>e(r._2(a)));if(r.tag==="Unsubscribe")return xt("Unsubscribe",r._1,e(r._2));f()}});var So=t=>e=>Ya(r=>{if(r.tag==="State")return xt("State",r._1);if(r.tag==="Lift")return xt("Lift",t(r._1));if(r.tag==="Subscribe")return xt("Subscribe",r._1,r._2);if(r.tag==="Unsubscribe")return xt("Unsubscribe",r._1,r._2);f()})(e);function $n(t,e,r,a){if(typeof window<"u"){var o=window[r];if(o!=null&&a instanceof o)return e(a)}for(var i=a;i!=null;){var d=Object.getPrototypeOf(i),u=d.constructor.name;if(u===r)return e(a);if(u==="Object")return t;i=d}return t}var ve=function(t){return function(e){return function(){return e[t]}}},af=ve("URL"),of=ve("documentURI"),sf=ve("origin"),uf=ve("compatMode"),df=ve("characterSet"),cf=ve("contentType");var rd=ve("documentElement");function wo(t){return function(e){return function(){return e.createTextNode(t)}}}var ee=function(t){return function(e){return function(){return e[t]}}};var Sf=ee("baseURI"),sd=ee("ownerDocument"),Br=ee("parentNode"),id=ee("parentElement");var wf=ee("childNodes"),ud=ee("firstChild"),dd=ee("lastChild"),cd=ee("previousSibling"),ld=ee("nextSibling"),pd=ee("nodeValue");var Rf=ee("textContent");function Ro(t){return function(e){return function(){e.appendChild(t)}}}var Kn=function(t){return function(e){return function(){return e[t]}}},sm=Kn("children"),fd=Kn("firstElementChild"),md=Kn("lastElementChild"),im=Kn("childElementCount");function Po(t){return function(e){return function(){return e.querySelector(t)}}}var Wo=t=>{let e=Po(t);return r=>{let a=e(r);return()=>{let o=a();return Ft(o,m,O)}}};function ze(t){return t.currentTarget}function qo(t){return t.type}var kr=function(){return window};function Hr(t){return function(){return t.document}}var fn=Dr(mr)(dn),bd=Dr(kn)(dn),Td=Va(Ao(Wr))(_o),Cd=t=>e=>r=>{let a=r(e);return()=>{let o=a();return fn(o)(t.update(t))()}},zo=t=>e=>{let r=t.node,a=t.vdom;return()=>{let o=a.value,i=r.value,d=Br(i)();return fn(Ft(d,m,O))(u=>{let $=Qn(e),p=To(u)(i)(o)($)(l=>{let c=qo(l);return fn(Ft(ze(l),m,O))(n=>{let s=bo(n)(c);return()=>{let _=s();return Cd(t)(l)(_)()}})});return()=>{let l=p();return r.value=l,a.value=$}})()}},Md=t=>e=>{let r=t.state;return()=>{let a=r.value,o=jn(a)(e);if(!o)return r.value=e,zo(t)(t.view(e))();o||f()}},Jo=t=>e=>r=>{let a=e.subscriptions;return Td(o=>{if(o.tag==="State")return Gt(se((()=>{let i=e.state;return()=>i.value})()))(i=>{let d=o._1(i),u=d._1;return Gt(se(Md(e)(d._2)))(()=>ye(u))});if(o.tag==="Lift")return o._1;if(o.tag==="Subscribe")return Gt(se(o._1(i=>{let d=Jn(qr,Jo(t)(e)(t(i)));return()=>{d().run()}})))(i=>Gt(se((()=>{let d=e.freshId;return()=>{let u=d.value;return d.value=u+1|0,u}})()))(d=>Gt(se((()=>{let u=qn(Y)(d)(i);return()=>{let $=a.value;a.value=u($)}})()))(()=>ye(o._2(d)))));if(o.tag==="Unsubscribe"){let i=o._2,d=o._1;return Gt(se(()=>a.value))(u=>Gt(bd(oe(Y)(d)(u))(se))(()=>ye(i)))}f()})(r)},Ld=t=>{let e=t.init.model,r=t.init.msg,a=t.selector,o=t.update,i=t.view;return()=>{let d=kr(),u=Hr(d)(),$=Wo(a)(u)();return fn($.tag==="Just"?L("Just",$._1):m)(p=>()=>{let l={value:e},c=kr(),n=Hr(c)(),s=wo("")(n)();Ro(s)(p)();let _={value:s},R={value:Co(s)(J(""))},It={view:i,update:o,state:l,node:_,vdom:R,subscriptions:{value:W},freshId:{value:0}};return zo(It)(i(e))(),fn(r)(It.update(It))()})()}};var Bo=t=>{let e=t.update;return Ld({init:t.init,view:t.view,selector:t.selector,update:r=>a=>{let o=Jn(qr,Jo(e)(r)(e(a)));return()=>{o().run()}}})};var Ur=function(t){return function(e){return t+e|0}};var Gr=function(t){return function(e){return t+e}};var Or=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},mn=function(t){return function(e){if(e===0)return 0;var r=Math.abs(e);return(t%r+r)%r}};var jr=isFinite;var Je=Math.floor;var Yn=function(t){return function(e){return t%e}};var Ho=Math.sin;var Uo=function(t){return function(e){return function(r){return(r|0)===r?t(r):e}}},K=function(t){return t},Go=function(t){return function(e){return function(r){var a;r<11?a="[0-"+(r-1).toString()+"]":r===11?a="[0-9a]":a="[0-9a-"+String.fromCharCode(86+r)+"]";var o=new RegExp("^[\\+\\-]?"+a+"+$","i");return function(i){if(o.test(i)){var d=parseInt(i,r);return(d|0)===d?t(d):e}else return e}}}};var Id=Go(O)(m),Be=Id(10),Vr=Uo(O)(m),Zn=t=>{if(!jr(t))return 0;if(t>=K(2147483647))return 2147483647;if(t<=K(-2147483648))return-2147483648;let e=Vr(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;f()};var Qo=Math.random;var Oo=t=>e=>()=>{let r=Qo();return Zn(Je((K(e)-K(t)+1)*r+K(t)))};var Kr=(()=>{let t=Oo(1)(2147483646);return()=>{let e=t();return(()=>{let r=mn(e)(2147483645);return r<1?r+2147483646|0:r})()}})();var jo=t=>e=>{let r=Vr(Yn(K(48271)*K(e)+K(t))(K(2147483647)));if(r.tag==="Just")return r._1;f()};var he=t=>({map:e=>r=>a=>t.map(o=>y(e(o._1),o._2))(r(a))});var nn=t=>{let e=t.Bind1().bind;return{bind:r=>a=>o=>e(r(o))(i=>a(i._1)(i._2)),Apply0:()=>Xn(t)}},Xn=t=>{let e=he(t.Bind1().Apply0().Functor0());return{apply:(()=>{let r=nn(t).bind,a=ie(t).pure;return o=>i=>r(o)(d=>r(i)(u=>a(d(u))))})(),Functor0:()=>e}},ie=t=>{let e=t.Applicative0().pure;return{pure:r=>a=>e(y(r,a)),Apply0:()=>Xn(t)}};var Yr=t=>{let e=t.Monad0(),r=e.Bind1().bind,a=e.Applicative0().pure,o={Applicative0:()=>ie(e),Bind1:()=>nn(e)};return{tailRecM:i=>d=>u=>t.tailRecM($=>r(i($._1)($._2))(p=>a((()=>{if(p._1.tag==="Loop")return ht("Loop",y(p._1._1,p._2));if(p._1.tag==="Done")return ht("Done",y(p._1._1,p._2));f()})())))(y(d,u)),Monad0:()=>o}},Ko=t=>{let e=t.Applicative0().pure,r={Applicative0:()=>ie(t),Bind1:()=>nn(t)};return{state:a=>o=>e(a(o)),Monad0:()=>r}};function Sd(t){return function(){return t.slice()}}var Zr=Sd,wd=function(){function t(e,r,a,o,i,d){var u,$,p,l,c,n,s;for(u=i+(d-i>>1),u-i>1&&t(e,r,o,a,i,u),d-u>1&&t(e,r,o,a,u,d),$=i,p=u,l=i;$<u&&p<d;)c=o[$],n=o[p],s=r(e(c)(n)),s>0?(a[l++]=n,++p):(a[l++]=c,++$);for(;$<u;)a[l++]=o[$++];for(;p<d;)a[l++]=o[p++]}return function(e){return function(r){return function(a){return function(){return a.length<2||t(e,r,a,a.slice(0),0,a.length),a}}}}}();var He=function(t){return function(e){for(var r=e.length,a=Array(r),o=0;o<r;o++)a[o]=t(o)(e[o]);return a}};var ue=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var de=function(t){return function(e){for(var r=t>e?-1:1,a=new Array(r*(e-t)+1),o=t,i=0;o!==e;)a[i++]=o,o+=r;return a[i]=o,a}},qd=function(t){return function(e){if(t<1)return[];var r=new Array(t);return r.fill(e)}},vd=function(t){return function(e){for(var r=[],a=0,o=0;o<t;o++)r[a++]=e;return r}},tr=typeof Array.prototype.fill=="function"?qd:vd,zd=function(){function t(o,i){this.head=o,this.tail=i}var e={};function r(o){return function(i){return new t(o,i)}}function a(o){for(var i=[],d=0,u=o;u!==e;)i[d++]=u.head,u=u.tail;return i}return function(o){return function(i){return a(o(r)(e)(i))}}}();var Zo=function(t){return function(e){return function(r){return function(a){return a<0||a>=r.length?e:t(r[a])}}}};var Xo=function(t){return function(e){return function(r){return function(a){for(var o=0,i=a.length;o<i;o++)if(r(a[o]))return t(o);return e}}}};var ts=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],r=0,a=t.length;r<a;r++)for(var o=t[r],i=0,d=o.length;i<d;i++)e.push(o[i]);return e},yn=function(t){return function(e){return e.filter(t)}};var es=function(t){return function(e){return function(r){for(var a=r.length,o=e,i=new Array(a),d=0;d<a;d++)o=t(o)(r[d]),i[d]=o;return i}}};var ns=function(){function t(e,r,a,o,i,d){var u,$,p,l,c,n,s;for(u=i+(d-i>>1),u-i>1&&t(e,r,o,a,i,u),d-u>1&&t(e,r,o,a,u,d),$=i,p=u,l=i;$<u&&p<d;)c=o[$],n=o[p],s=r(e(c)(n)),s>0?(a[l++]=n,++p):(a[l++]=c,++$);for(;$<u;)a[l++]=o[$++];for(;p<d;)a[l++]=o[p++]}return function(e){return function(r){return function(a){var o;return a.length<2?a:(o=a.slice(0),t(e,r,o,a.slice(0),0,a.length),o)}}}}();var er=function(t){return function(e){for(var r=e.length,a=0;a<r;a++)if(!t(e[a]))return!1;return!0}};var hn=t=>ns(t)(e=>{if(e.tag==="GT")return 1;if(e.tag==="EQ")return 0;if(e.tag==="LT")return-1;f()});var as=t=>e=>(()=>{let r=Zr(t);return()=>{let a=r();return a.push(e),a}})()();var Ue=Zo(O)(m);var Xr=Xo(O)(m);var nr=t=>e=>r=>{let a=Xr(o=>t.eq(o)(e))(r);if(a.tag==="Nothing")return!1;if(a.tag==="Just")return!0;f()};var os=t=>e=>t.state(r=>y(void 0,e));var Yd=function(){function t(d){this.fn=d}var e={},r=function(d,u){this.head=d,this.tail=u};function a(d){return new r(d,e)}function o(d){return function(u){return new r(d,u)}}function i(d){for(var u=[],$=d;$!==e;)u.push($.head),$=$.tail;return u}return function(d){return function(u){return function($){var p=function(c,n){return d(u(o)($(c)))(n)},l=function(c,n,s){if(n===0)return c;var _=s[n-1];return new t(function(){var R=l(p(_,c),n-1,s);return R})};return function(c){for(var n=u(a)($(c[c.length-1])),s=l(n,c.length-1,c);s instanceof t;)s=s.fn();return u(i)(s)}}}}}();var Xd=t=>Ko(t).state(e=>y(e.newSeed,{...e,newSeed:jo(0)(e.newSeed)}));var tc=t=>{let e=he(t.Bind1().Apply0().Functor0()).map,r=Xd(t),a=Xn(t).apply;return o=>i=>{let d=K(i),u=K(o),$=e(K)(r);return e(p=>Zn(Je(u+Yn(p)(d-u+1))))(a(e(Gr)($))(e(p=>2*p)($)))}},us=t=>{let e=tc(t);return r=>a=>r<=a?e(r)(a):e(a)(r)};var nc=(()=>ie(Yt).pure)(),rc=(()=>he(me).map)(),ac=us(Yt);var ta=t=>t.length===0?nc(m):rc(e=>Ue(t)(e))(ac(0)(t.length-1|0)),rr=t=>{let e=100*Ho(K(t+1|0));return e-Je(e)},ds=(()=>{let t=He(a=>o=>y(rr(a),o)),e=hn(a=>o=>Rr.compare(a._1)(o._1)),r=it(Zt);return a=>r(e(t(a)))})();var ea=(t,e)=>({tag:"Graph",_1:t,_2:e}),oc=vn(Y)(ae),ls=(()=>ie(Yt).pure)(),sc=vn(br(Y)(Y))(ae),ic=t=>e=>{let r=Y.compare(t)(e);if(r.tag==="LT")return e;if(r.tag==="EQ"||r.tag==="GT")return t;f()};var ps=t=>e=>ea(oc(it(r=>y(r,re(e)(a=>re((r-a|0)>=0?[void 0]:[])(()=>[{edge:a-1|0,dest:r-a|0}]))))(de(0)(t))),t),$s=t=>({width:800,height:400,position:e=>e===0?m:e<=8?L("Just",{x:K(e-1|0)*100,y:0}):L("Just",{x:K(e-9|0)*100,y:200}),legend:it(e=>({edge:e-1|0,name:Z(e)}))(t)});var na=t=>e=>r=>{let a=oe(t)(r)(e);if(a.tag==="Nothing")return ls(m);if(a.tag==="Just")return he(me).map(o=>o.tag==="Just"?L("Just",{edge:o._1.edge,dest:o._1.dest}):m)(ta(a._1));f()},uc=t=>{let e=vn(t)(ae);return r=>a=>ea(e(it(o=>y(r(o._1),it(i=>({edge:i.edge,dest:r(i.dest)}))(o._2)))(Wn(tn)(a._1))),r(a._2))},dc=uc(Y),ra=t=>e=>r=>ta(re((()=>{let a=oe(t)(r)(e);if(a.tag==="Nothing")return[];if(a.tag==="Just")return a._1;f()})())(a=>tr(a.nbBalls)({dest:a.dest,edge:a.edge}))),fs=t=>e=>{let r=Qe(()=>te.map(o=>Xe(i=>er(d=>{let u=oe(t)(d.dest)(r());if(u.tag==="Nothing")return!0;if(u.tag==="Just")return!Pe(u._1);f()})(o)))(e._1)),a=r();return te.map(Pe)(a)},cc=t=>e=>ea(sc(re(de(0)(t-1|0))(r=>re(de(0)(e-1|0))(a=>[y(y(r,a),yn(o=>o.dest._1>=0&&o.dest._2>=0)([{edge:0,dest:y(r-1|0,a)},{edge:1,dest:y(r-1|0,a-1|0)},{edge:2,dest:y(r,a-1|0)}]))]))),y(t-1|0,e-1|0)),ms=t=>e=>dc(r=>r._1+(r._2*t|0)|0)(cc(t)(e)),gs=t=>e=>{let r=ic(t)(e);return{width:180*r|0,height:180*r|0,position:a=>a===0?m:L("Just",{x:50+180*K(mn(a)(t)),y:10+180*K((e-Or(a)(t)|0)-1|0)}),legend:[{edge:0,name:"\u21D0"},{edge:1,name:"\u21D9"},{edge:2,name:"\u21D3"}]}},_s=t=>e=>r=>a=>(()=>{let o=oe(t)(a)(r);return o.tag==="Nothing"?!1:o.tag==="Just"?o._1:!1})()?na(t)(e)(a):ls((()=>{let o=oe(t)(a)(e);if(o.tag==="Just"){let i=Xr(d=>{let u=oe(t)(d.dest)(r);return u.tag==="Nothing"?!1:u.tag==="Just"?u._1:!1})(o._1);return i.tag==="Just"?L("Just",{edge:o._1[i._1].edge,dest:o._1[i._1].dest}):m}if(o.tag==="Nothing")return m;f()})()),ys={width:0,height:0,position:t=>m,legend:[]},hs=t=>e=>r=>te.map(it(a=>({edge:a.edge,dest:a.dest,nbBalls:e})))(r._1);var aa=t=>({tag:t}),xe=(t,e,r)=>({tag:t,_1:e,_2:r}),oa=t=>({tag:t}),pc=(()=>nn(Yt).bind)(),Ds=(()=>ie(Yt).pure)(),$c=(()=>Yr(xa).tailRecM)(),fc=t=>e=>{let r=Y.compare(t)(e);if(r.tag==="LT")return e;if(r.tag==="EQ"||r.tag==="GT")return t;f()},bs=oa("Running"),Ts=oa("IsStopping"),ar=oa("Stopped");var sa=aa("Random"),Cs=aa("Expert"),Ms=aa("Machine");var Ls=t=>e=>nr(Re)(t)(e)?yn(r=>r!==t)(e):hn(Y.compare)(ue([t])(e));var ia=t=>{let e=(()=>{if(t.config.graphType.tag==="Substract")return ps(t.config.graphType._1)(t.config.graphType._2);if(t.config.graphType.tag==="King")return ms(t.config.graphType._1)(t.config.graphType._2);f()})();return{config:t.config,source:e._2,nbVictories:0,nbLosses:0,graphWithBalls:hs(Y)(t.config.ballsPerColor)(e),losingPositions:fs(Y)(e),status:ar,gameResult:m,displayer:(()=>{if(t.config.graphType.tag==="Substract")return $s(t.config.graphType._2);if(t.config.graphType.tag==="King")return gs(t.config.graphType._1)(t.config.graphType._2);f()})()}},Ns=ia({config:{graphType:xe("Substract",8,[1,2]),adversary:sa,ballsPerColor:6,reward:3,penalty:-1,machineStarts:!0},source:0,nbVictories:0,nbLosses:0,graphWithBalls:W,losingPositions:W,status:ar,gameResult:m,displayer:ys});var mc=t=>e=>{if(t.config.adversary.tag==="Random")return na(Y)(t.graphWithBalls)(e);if(t.config.adversary.tag==="Expert")return _s(Y)(t.graphWithBalls)(t.losingPositions)(e);if(t.config.adversary.tag==="Machine")return ra(Y)(t.graphWithBalls)(e);f()},gc=t=>$c(e=>{let r=e.isMachineTurn,a=e.moves,o=e.pos;return pc(r?ra(Y)(t.graphWithBalls)(o):mc(t)(o))(i=>{if(i.tag==="Nothing")return Ds(ht("Done",{moves:a,win:!r}));if(i.tag==="Just")return Ds(ht("Loop",{moves:as(a)({pos:o,edge:i._1.edge,isMachineTurn:r}),isMachineTurn:!r,pos:i._1.dest}));f()})})({moves:[],pos:t.source,isMachineTurn:t.config.machineStarts});var _c=t=>e=>{let r=e.win;return{config:t.config,source:t.source,nbVictories:r?t.nbVictories+1|0:t.nbVictories+0|0,nbLosses:r?t.nbLosses+0|0:t.nbLosses+1|0,graphWithBalls:te.map(a=>er(o=>o.nbBalls===0)(a)?it(o=>({nbBalls:t.config.ballsPerColor,dest:o.dest,edge:o.edge}))(a):a)(Ye(a=>{let o=a.edge,i=a.isMachineTurn,d=it(u=>o!==u.edge?u:{nbBalls:fc(0)((()=>!i&&(t.config.adversary.tag==="Random"||t.config.adversary.tag==="Expert"||t.config.adversary.tag!=="Machine")?u.nbBalls+0|0:r===i?u.nbBalls+t.config.reward|0:u.nbBalls+t.config.penalty|0)()),edge:u.edge,dest:u.dest});return po(Y)(u=>L("Just",d(u)))(a.pos)})(t.graphWithBalls)(e.moves)),losingPositions:t.losingPositions,status:t.status,gameResult:L("Just",{moves:e.moves,win:r}),displayer:t.displayer}},xs=t=>he(me).map(_c(t))(gc(t));var yc=t=>{let e=t.Apply0(),r=e.Functor0(),a={map:i=>{let d=r.map(i);return u=>$=>d(u($))}},o={apply:i=>d=>u=>e.apply(i(u))(d(u)),Functor0:()=>a};return{bind:i=>d=>u=>t.bind(i(u))($=>d($)(u)),Apply0:()=>o}};var hc=t=>{let e=t.Applicative0(),r=e.Apply0(),a=r.Functor0(),o={map:$=>{let p=a.map($);return l=>c=>p(l(c))}},i={apply:$=>p=>l=>r.apply($(l))(p(l)),Functor0:()=>o},d={pure:$=>{let p=e.pure($);return l=>p},Apply0:()=>i},u=yc(t.Bind1());return{Applicative0:()=>d,Bind1:()=>u}};var or=t=>{let e=hc(t.Monad0());return{liftEffect:r=>{let a=t.liftEffect(r);return o=>a},Monad0:()=>e}};var Fs=t=>e=>r=>{let a=r.Profunctor0().dimap;return o=>a(i=>y(t(i),d=>e(i)(d)))(i=>i._2(i._1))(r.first(o))};var As=t=>()=>e=>r=>Te(t.reflectSymbol(e))(r);var ua=t=>()=>()=>e=>r=>Fs(As(t)()(e))(a=>o=>Oe(t.reflectSymbol(e))(o)(a))(r);var Ss={liftAff:t=>t,MonadEffect0:()=>Hn};var ws=t=>{let e=or(t.MonadEffect0());return{liftAff:r=>{let a=t.liftAff(r);return o=>a},MonadEffect0:()=>e}};var vt=(t,e)=>({tag:t,_1:e}),sr=vt("NextGame"),Rs=vt("RunMachine"),Ps=vt("StopMachine"),Ws=t=>vt("SetGraphType",t),qs=t=>vt("SetNbPigeonholes",t);var vs=t=>vt("SetKingWidth",t),zs=t=>vt("SetKingHeight",t),Js=t=>vt("SetAdversary",t),Bs=t=>vt("SetReward",t),ks=t=>vt("SetPenalty",t),Hs=t=>vt("SetBallsPerColor",t),Us=t=>vt("SetMachineStarts",t);var Qs=A(j("Bind",xt("Lift",ye),t=>A(j("Return",t),G)),G),Os=(()=>zr(or(Hn)).liftEffect)(),ir=A(j("Bind",xt("State",t=>y(t,t)),t=>A(j("Return",t),G)),G),wc=(()=>{let t=Fo(ws(Ss)).liftAff;return e=>t(Bn(fe,e))})(),Rc=t=>A(Qs._1,Tt(Qs._2)(Mt("CatCons",e=>{let r=e.genModel,a=Os(()=>r.value);return A(a._1,Tt(a._2)(Mt("CatCons",o=>{let i=t(o),d=i._2,u=i._1,$=Os(()=>r.value=d);return A($._1,Tt($._2)(Mt("CatCons",()=>A(j("Return",u),G),Dt(I,I))))},Dt(I,I))))},Dt(I,I)))),ur=ua({reflectSymbol:()=>"graphType"})()()(St)(pn),Pc=ua({reflectSymbol:()=>"config"})()()(St)(pn),ce=t=>{let e=Pc(t);return A(j("Bind",xt("State",r=>y(void 0,ia(e(r)))),r=>A(j("Return",r),G)),G)},da=t=>{if(t.tag==="RunMachine")return A(j("Bind",xt("State",e=>y(void 0,{...e,status:bs})),e=>A(j("Return",e),G)),Tt(G)(Mt("CatCons",()=>Sn.tailRecM(e=>A(ir._1,Tt(ir._2)(Mt("CatCons",r=>{if(r.status.tag!=="Running"){let o={...r,status:ar};return A(j("Bind",xt("State",i=>y(void 0,o)),i=>A(j("Return",i),G)),Tt(G)(Mt("CatCons",()=>A(j("Return",ht("Done",void 0)),G),Dt(I,I))))}let a=da(sr);return A(a._1,Tt(a._2)(Mt("CatCons",()=>{let o=wc(500);return A(o._1,Tt(o._2)(Mt("CatCons",()=>A(j("Return",ht("Loop",void 0)),G),Dt(I,I))))},Dt(I,I))))},Dt(I,I)))))(),Dt(I,I))));if(t.tag==="StopMachine")return A(j("Bind",xt("State",e=>y(void 0,{...e,status:Ts})),e=>A(j("Return",e),G)),G);if(t.tag==="NextGame")return A(ir._1,Tt(ir._2)(Mt("CatCons",e=>{let r=Rc(xs(e));return A(r._1,Tt(r._2)(Mt("CatCons",os(Io),Dt(I,I))))},Dt(I,I))));if(t.tag==="SetGraphType"){let e=t._1;return ce(r=>({graphType:e==="sub"?xe("Substract",8,[1,2]):xe("King",3,3),adversary:r.adversary,ballsPerColor:r.ballsPerColor,reward:r.reward,penalty:r.penalty,machineStarts:r.machineStarts}))}if(t.tag==="SetNbPigeonholes"){let e=t._1;return ce(ur(r=>r.tag==="Substract"?xe("Substract",(()=>{let a=Be(e);if(a.tag==="Nothing")return 8;if(a.tag==="Just")return a._1;f()})(),r._2):r))}if(t.tag==="TogglePossibleMove"){let e=t._1;return ce(ur(r=>r.tag==="Substract"?xe("Substract",r._1,Ls(e)(r._2)):r))}if(t.tag==="SetKingWidth"){let e=t._1;return ce(ur(r=>r.tag==="King"?xe("King",(()=>{let a=Be(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;f()})(),r._2):r))}if(t.tag==="SetKingHeight"){let e=t._1;return ce(ur(r=>r.tag==="King"?xe("King",r._1,(()=>{let a=Be(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;f()})()):r))}if(t.tag==="SetReward"){let e=t._1;return ce(r=>({graphType:r.graphType,adversary:r.adversary,ballsPerColor:r.ballsPerColor,reward:(()=>{let a=Be(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;f()})(),penalty:r.penalty,machineStarts:r.machineStarts}))}if(t.tag==="SetPenalty"){let e=t._1;return ce(r=>({graphType:r.graphType,adversary:r.adversary,ballsPerColor:r.ballsPerColor,reward:r.reward,penalty:(()=>{let a=Be(e);if(a.tag==="Nothing")return-1;if(a.tag==="Just")return a._1;f()})(),machineStarts:r.machineStarts}))}if(t.tag==="SetAdversary"){let e=t._1;return ce(r=>({graphType:r.graphType,adversary:(()=>e==="expert"?Cs:e==="machine"?Ms:sa)(),ballsPerColor:r.ballsPerColor,reward:r.reward,penalty:r.penalty,machineStarts:r.machineStarts}))}if(t.tag==="SetBallsPerColor"){let e=t._1;return ce(r=>({graphType:r.graphType,adversary:r.adversary,ballsPerColor:(()=>{let a=Be(e);if(a.tag==="Nothing")return 6;if(a.tag==="Just")return a._1;f()})(),reward:r.reward,penalty:r.penalty,machineStarts:r.machineStarts}))}if(t.tag==="SetMachineStarts"){let e=t._1;return ce(r=>({graphType:r.graphType,adversary:r.adversary,ballsPerColor:r.ballsPerColor,reward:r.reward,penalty:r.penalty,machineStarts:e==="y"}))}f()};var js=(()=>{let t=Lt("y");return e=>t(Bt(e))})();var Vs=(()=>{let t=Lt("x");return e=>t(Bt(e))})(),Ks=Lt("width"),Ys=t=>e=>r=>a=>Lt("viewBox")(Z(t)+" "+Z(e)+" "+Z(r)+" "+Z(a)),Ct=Lt("value"),bn=Lt("type");var Zs=(()=>{let t=Lt("stroke-width");return e=>t(Bt(e))})();var ca=Lt("stroke");var Xs=(()=>{let t=Lt("r");return e=>t(Bt(e))})();var la=(()=>{let t=Lt("min");return e=>t(Z(e))})();var pa=(()=>{let t=Lt("max");return e=>t(Z(e))})();var ti=Lt("height"),dr=Lt("fill");var ei=Lt("d"),ni=(()=>{let t=Lt("cy");return e=>t(Bt(e))})(),ri=(()=>{let t=Lt("cx");return e=>t(Bt(e))})();var ai=bt("svg"),Tn=bt("span"),on=bt("select");var Ee=bt("option");var oi=bt("label");var cr=bt("g");var pt=bt("div");var lr=bt("button");function si(t){return function(){return t.checked}}function ii(t){return function(){return t.value}}function ui(t){return function(){return t.value}}var di=t=>Ne("change")(e=>{let r=Ft(ze(e),m,O),a=(()=>{if(r.tag==="Just")return $n(m,O,"HTMLInputElement",r._1);if(r.tag==="Nothing")return m;f()})();if(a.tag==="Nothing")return()=>m;if(a.tag==="Just"){let o=si(a._1);return()=>{let i=o();return L("Just",t(i))}}f()});var le=t=>Ne("change")(e=>{let r=Ft(ze(e),m,O),a=(()=>{if(r.tag==="Just")return $n(m,O,"HTMLInputElement",r._1);if(r.tag==="Nothing")return m;f()})();if(a.tag==="Just"){let o=ii(a._1);return()=>{let i=o();return L("Just",t(i))}}if(a.tag==="Nothing"){let o=Ft(ze(e),m,O),i=(()=>{if(o.tag==="Just")return $n(m,O,"HTMLSelectElement",o._1);if(o.tag==="Nothing")return m;f()})();if(i.tag==="Nothing")return()=>m;if(i.tag==="Just"){let d=ui(i._1);return()=>{let u=d();return L("Just",t(u))}}f()}f()});var kc=t=>e=>{let r=Y.compare(t)(e);if(r.tag==="LT"||r.tag==="EQ")return t;if(r.tag==="GT")return e;f()},Hc=Ze(Ur)(0),Uc=t=>e=>pt([Q("flex flex-row justify-between mt-4 mb-2")])([Tn([Q("text-blue-600 font-bold")])([J("Victoires: "+Z(t))]),pt([Q("w-full bg-red-600 rounded-full h-6")])([pt([Q("h-6 bg-blue-600 rounded-l-full"),On("width")((()=>{let r=t+e|0;return Bt(r===0?50:K(t)/K(r)*100)+"%"})())])([])]),Tn([Q("text-red-600 font-bold")])([J("D\xE9faites: "+Z(e))])]),$a="block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",ma=["yellow","red","cyan","lightgreen","magenta"],Gc=t=>e=>r=>{let a=t.position(e);if(a.tag==="Just")return cr([On("transform")("translate("+Bt(a._1.x)+"px,"+Bt(a._1.y)+"px)")])([bt("path")([ei("M1 1 L10 109 L90 109 L99 1"),Zs(3),ca("#000"),dr("transparent")])([]),cr([])((()=>{let o=ts(it(d=>tr(d.nbBalls)(d.edge))(r)),i=kc(105)(o.length);return ds(He(d=>u=>bt("circle")([ri(15+rr(e+d|0)*71),ni(100-rr((10+e|0)+d|0)*K(i)),Xs(5),dr((()=>{let $=Ue(ma)(u);if($.tag==="Nothing")return"black";if($.tag==="Just")return $._1;f()})())])([]))(o))})()),cr([])((()=>{let o=K(Hc(it(i=>i.nbBalls)(r)));return it(i=>bt("rect")([Vs(3+94*i.begin),js(115),Ks(Bt(94*(i.end-i.begin))),ti("20"),ca("black"),dr((()=>{let d=Ue(ma)(i.edge);if(d.tag==="Nothing")return"black";if(d.tag==="Just")return d._1;f()})())])([]))(es(i=>{let d=i.end;return u=>({begin:d,end:d+K(u.nbBalls)/o,edge:u.edge})})({begin:0,end:0,edge:-1})(r))})())]);if(a.tag==="Nothing")return No;f()},Qc=t=>e=>pt([Q("w-[42vw]")])([ai([Ys(0)(0)(t.width)(t.height)])(it(r=>Gc(t)(r._1)(r._2))(Wn(tn)(e)))]),ga=t=>e=>pt([Q("rounded overflow-hidden shadow-lg p-4")])(ue([pt([Q("font-bold text-xl mb-2")])([J(t)])])(e)),Oc=t=>ga("L\xE9gende")([pt([Q("grid grid-cols-2 gap-4")])(re(t)(e=>[pt([Q("inline w-12 h-12"),On("background-color")((()=>{let r=Ue(ma)(e.edge);if(r.tag==="Nothing")return"black";if(r.tag==="Just")return r._1;f()})())])([]),Tn([Q("text-2xl")])([J(" : "+e.name)])]))]),fa="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",jc=t=>e=>ga("Choix des param\xE8tres")([pt([Q("grid grid-cols-2 gap-4")])(ue([pt([])([J("type de jeu")]),on([Q("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct((()=>{if(t.graphType.tag==="Substract")return"sub";if(t.graphType.tag==="King")return"king";f()})()),le(Ws)])([Ee([Ct("sub")])([J("Soustraction")]),Ee([Ct("king")])([J("Roi")])])])(ue((()=>{if(t.graphType.tag==="Substract"){let r=t.graphType._2;return[pt([])([J("Nombre de casiers")]),on([Q("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct(Z(t.graphType._1)),le(qs)])(it(a=>Ee([Ct(Z(a))])([J(Z(a))]))(de(8)(16))),pt([])([J("Coups possibles")]),pt([Q("flex flex-row justify-between")])(it(a=>oi([])([bt("input")([bn("checkbox"),Lt("checked")(nr(Re)(a)(r)),Q("w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"),di(o=>vt("TogglePossibleMove",a))])([]),Tn([Q("ml-2 text-sm font-medium text-gray-900")])([J(Z(a))])]))(de(1)(5)))]}if(t.graphType.tag==="King")return[pt([])([J("Hauteur de la grille")]),on([Q("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct(Z(t.graphType._2)),le(zs)])(it(r=>Ee([Ct(Z(r))])([J(Z(r))]))(de(3)(6))),pt([])([J("Largeur de la grille")]),on([Q("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct(Z(t.graphType._1)),le(vs)])(it(r=>Ee([Ct(Z(r))])([J(Z(r))]))(de(3)(6)))];f()})())([pt([])([J("Adversaire")]),bt("select")([Q("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct((()=>{if(t.adversary.tag==="Expert")return"expert";if(t.adversary.tag==="Machine")return"machine";if(t.adversary.tag==="Random")return"random";f()})()),le(Js)])([bt("option")([Ct("random")])([J("Al\xE9atoire")]),bt("option")([Ct("expert")])([J("Expert")]),bt("option")([Ct("machine")])([J("Machine")])]),pt([])([J("Billes par couleur")]),bt("input")([bn("number"),Q($a),la(2),pa(10),Ct(Z(t.ballsPerColor)),le(Hs)])([]),pt([])([J("R\xE9compense")]),bt("input")([bn("number"),Q($a),la(1),Ct(Z(t.reward)),le(Bs)])([]),pt([])([J("P\xE9nalit\xE9")]),bt("input")([bn("number"),Q($a),pa(0),Ct(Z(t.penalty)),le(ks)])([]),pt([])([J("La machine commence")]),on([Q("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct(t.machineStarts?"y":"n"),le(Us)])([Ee([Ct("y")])([J("Oui")]),Ee([Ct("n")])([J("Non")])]),e.tag==="Stopped"?lr([Q(fa),Ne("click")(r=>()=>L("Just",Rs))])([J("Lancer la machine")]):lr([Q(fa),Ne("click")(r=>()=>L("Just",Ps))])([J("Arr\xEAter la machine")]),lr([Q(fa),Ne("click")(r=>()=>L("Just",sr))])([J("Pas \xE0 pas")])])))]),ci=t=>pt([Q("w-screen flex flex-row justify-around items-start")])([ga("Visualisation de la machine")([pt([Q("flex flex-col")])([Qc(t.displayer)(t.graphWithBalls),Uc(t.nbVictories)(t.nbLosses)])]),Mo(Oc)(t.displayer.legend),Lo(jc)(t.config)(t.status)]);var li=()=>{let e={value:{newSeed:Kr(),size:0}};return Bo({init:{model:Ns,msg:m},view:ci,update:(()=>{let r=So(a=>a({genModel:e}));return a=>r(da(a))})(),selector:"#root"})()};li();})();
