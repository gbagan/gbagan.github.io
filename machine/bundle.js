(()=>{function Qe(t){let e=0,r;return()=>{if(e===2)return r;if(e===1)throw new Error("Binding demanded before initialized");return e=1,r=t(),e=2,r}}function f(){throw new Error("Failed pattern match")}var Te=function(t){return function(e){return e[t]}},Oe=function(t){return function(e){return function(r){var o={};for(var a in r)({}).hasOwnProperty.call(r,a)&&(o[a]=r[a]);return o[t]=e,o}}};var li=()=>({tag:"Proxy"}),St=li();var Z=function(t){return t.toString()},Bt=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var $r=t=>({tag:t}),wt=$r("LT"),Rt=$r("GT"),pe=$r("EQ");var L=(t,e)=>({tag:t,_1:e}),m=L("Nothing"),O=t=>L("Just",t);var Cn=t=>{if(t.tag==="Nothing")return!0;if(t.tag==="Just")return!1;f()};var ut=function(t){return function(e){for(var r=e.length,o=new Array(r),a=0;a<r;a++)o[a]=t(e[a]);return o}};var Nn=t=>t;var re=function(t){return function(e){for(var r=[],o=0,a=t.length;o<a;o++)Array.prototype.push.apply(r,e(t[o]));return r}};var Pt=(t,e)=>({tag:t,_1:e}),fr=t=>Pt("Left",t),$e=t=>Pt("Right",t);var xn=t=>t;var fe={map:t=>e=>t(e)};var Mo={apply:t=>e=>t(e),Functor0:()=>fe},Di={bind:t=>e=>e(t),Apply0:()=>Mo},bi={pure:xn,Apply0:()=>Mo},Yt={Applicative0:()=>bi,Bind1:()=>Di};var Lo=function(t){return function(){return t}};var Ti={apply:t=>e=>()=>{let r=t(),o=e();return mr.pure(r(o))()},Functor0:()=>Ci},mr={pure:Lo,Apply0:()=>Ti},Ci={map:t=>e=>()=>{let r=e();return t(r)}};var ht=(t,e)=>({tag:t,_1:e}),yr=t=>ht("Loop",t),No=t=>ht("Done",t);var xo={tailRecM:t=>{let e=r=>{let o=r,a=!0,i;for(;a;){let d=o;if(d.tag==="Loop"){o=t(d._1);continue}if(d.tag==="Done"){a=!1,i=d._1;continue}f()}return i};return r=>e(t(r))},Monad0:()=>Yt};var Ye=function(t){return function(e){return function(r){for(var o=e,a=r.length,i=a-1;i>=0;i--)o=t(r[i])(o);return o}}},Ze=function(t){return function(e){return function(r){for(var o=e,a=r.length,i=0;i<a;i++)o=t(o)(r[i]);return o}}};var hr=t=>{let e=t.Apply0(),r=e.Functor0().map;return o=>a=>o.foldr(i=>{let d=a(i);return u=>e.apply(r($=>Nn)(d))(u)})(t.pure())},Dr=t=>{let e=hr(t);return r=>{let o=e(r);return a=>i=>o(i)(a)}};var dn={foldr:t=>e=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return t(r._1)(e);f()},foldl:t=>e=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return t(e)(r._1);f()},foldMap:t=>{let e=t.mempty;return r=>o=>{if(o.tag==="Nothing")return e;if(o.tag==="Just")return r(o._1);f()}}};var oe={foldr:Ye,foldl:Ze,foldMap:t=>{let e=t.Semigroup0().append,r=t.mempty;return o=>oe.foldr(a=>i=>e(o(a))(i))(r)}};var y=(t,e)=>({tag:"Tuple",_1:t,_2:e});var Zt=t=>t._2;var In={map:t=>e=>y(e._1,t(e._2))};var Se=t=>t._1;var br=t=>{let e=t.Eq0();return r=>{let o=r.Eq0(),a={eq:i=>d=>e.eq(i._1)(d._1)&&o.eq(i._2)(d._2)};return{compare:i=>d=>{let u=t.compare(i._1)(d._1);return u.tag==="LT"?wt:u.tag==="GT"?Rt:r.compare(i._2)(d._2)},Eq0:()=>a}}};var E=(t,e,r)=>({tag:t,_1:e,_2:r});var I=E("Nil");var So=(()=>(e=>r=>{let o=e,a=r,i=!0,d;for(;i;){let u=o,$=a;if($.tag==="Nil"){i=!1,d=u;continue}if($.tag==="Cons"){o=E("Cons",$._1,u),a=$._2;continue}f()}return d})(I))();var ji=function(){function t(a){return[a]}function e(a){return function(i){return[a,i]}}function r(a){return function(i){return function(d){return[a,i,d]}}}function o(a){return function(i){return a.concat(i)}}return function(a){return function(i){return function(d){return function(u){return function($){function p(l,c){switch(c-l){case 0:return d([]);case 1:return i(t)(u($[l]));case 2:return a(i(e)(u($[l])))(u($[l+1]));case 3:return a(a(i(r)(u($[l])))(u($[l+1])))(u($[l+2]));default:var n=l+Math.floor((c-l)/4)*2;return a(i(o)(p(l,n)))(p(n,c))}}return p(0,$.length)}}}}}}();var Dt=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var Qo=t=>{let e=t,r=!0,o;for(;r;){let a=e;if(a._1.tag==="Nil"){if(a._2.tag==="Nil"){r=!1,o=m;continue}e=Dt(So(a._2),I);continue}if(a._1.tag==="Cons"){r=!1,o=L("Just",y(a._1._1,Dt(a._1._2,a._2)));continue}f()}return o};var Mt=(t,e,r)=>({tag:t,_1:e,_2:r}),Q=Mt("CatNil");var Tt=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return Mt("CatCons",t._1,Dt(t._2._1,E("Cons",e,t._2._2)));f()},Tu=t=>e=>r=>{let o=i=>d=>u=>{let $=i,p=d,l=u,c=!0,n;for(;c;){let s=$,_=p,R=l;if(R.tag==="Nil"){c=!1,n=_;continue}if(R.tag==="Cons"){$=s,p=s(_)(R._1),l=R._2;continue}f()}return n};return(i=>d=>{let u=i,$=d,p=!0,l;for(;p;){let c=u,n=$,s=Qo(c);if(s.tag==="Nothing"){p=!1,l=o(_=>R=>R(_))(e)(n);continue}if(s.tag==="Just"){u=s._1._2,$=E("Cons",t(s._1._1),n);continue}f()}return l})(r)(I)},Oo=t=>{if(t.tag==="CatNil")return m;if(t.tag==="CatCons")return L("Just",y(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?Q:Tu(Tt)(Q)(t._2)));f()};var A=(t,e)=>({tag:"Free",_1:t,_2:e}),j=(t,e,r)=>({tag:t,_1:e,_2:r});var jo=t=>{let e=t,r=!0,o;for(;r;){let a=e;if(a._1.tag==="Return"){let i=Oo(a._2);if(i.tag==="Nothing"){r=!1,o=j("Return",a._1._1);continue}if(i.tag==="Just"){e=(()=>{let d=i._1._1(a._1._1);return A(d._1,Tt(d._2)(i._1._2))})();continue}f()}if(a._1.tag==="Bind"){r=!1,o=j("Bind",a._1._1,i=>{let d=a._1._2(i);return A(d._1,Tt(d._2)(a._2))});continue}f()}return o},Vo=t=>e=>{let r=e.Monad0(),o=r.Bind1().Apply0().Functor0().map,a=r.Applicative0().pure;return i=>e.tailRecM(d=>{let u=jo(d);if(u.tag==="Return")return o(No)(a(u._1));if(u.tag==="Bind")return o(yr)(i(t.map(u._2)(u._1)));f()})};var Fn={Applicative0:()=>An,Bind1:()=>Fr},Ko={map:t=>e=>Fr.bind(e)(r=>An.pure(t(r)))},Fr={bind:t=>e=>A(t._1,Tt(t._2)(Mt("CatCons",e,Dt(I,I)))),Apply0:()=>Ar},Ar={apply:t=>e=>A(t._1,Tt(t._2)(Mt("CatCons",r=>A(e._1,Tt(e._2)(Mt("CatCons",o=>An.pure(r(o)),Dt(I,I)))),Dt(I,I)))),Functor0:()=>Ko},An={pure:t=>A(j("Return",t),Q),Apply0:()=>Ar};var Sn={tailRecM:t=>e=>{let r=t(e);return A(r._1,Tt(r._2)(Mt("CatCons",o=>{if(o.tag==="Loop")return Sn.tailRecM(t)(o._1);if(o.tag==="Done")return A(j("Return",o._1),Q);f()},Dt(I,I))))},Monad0:()=>Fn};var Cu=t=>{let e=r=>{let o=jo(r);if(o.tag==="Return")return A(j("Return",o._1),Q);if(o.tag==="Bind"){let a=t(o._1);return A(a._1,Tt(a._2)(Mt("CatCons",i=>e(o._2(i)),Dt(I,I))))}f()};return e},Yo=t=>Cu(e=>A(j("Bind",t(e),r=>A(j("Return",r),Q)),Q));var Zo=function(t){return function(e){return t===e}};var Xo=Zo,ta=Zo;var ea={eq:ta},Re={eq:Xo};var Xe=function(t){var e=null;return function(){return t===void 0||(e=t(),t=void 0),e}},Pe=function(t){return t()};var ra=function(t){return function(e){return function(r){return function(o){return function(a){return o<a?t:o===a?e:r}}}}};var oa=ra,aa=ra;var Rr={compare:aa(wt)(pe)(Rt),Eq0:()=>ea},Y={compare:oa(wt)(pe)(Rt),Eq0:()=>Re};var ia=function(t){return function(e){return function(r){return function(o){return function(a){return function(i){for(var d=[],u=i;;){var $=a(u);d.push(r($));var p=o($);if(t(p))return d;u=e(p)}}}}}}};var Eu=t=>{if(t.tag==="Just")return t._1;f()};var Pr={unfoldr1:ia(Cn)(Eu)(Se)(Zt)};var da=function(t){return function(e){return function(r){return function(o){return function(a){return function(i){for(var d=[],u=i;;){var $=a(u);if(t($))return d;var p=e($);d.push(r(p)),u=o(p)}}}}}}};var Iu=t=>{if(t.tag==="Just")return t._1;f()};var tn={unfoldr:da(Cn)(Iu)(Se)(Zt),Unfoldable10:()=>Pr};var ft=function(t){throw new Error(t)};var Pn=(t,e,r,o)=>({tag:"KickUp",_1:t,_2:e,_3:r,_4:o}),b=(t,e,r,o,a,i,d,u)=>({tag:t,_1:e,_2:r,_3:o,_4:a,_5:i,_6:d,_7:u}),nt=(t,e,r,o,a,i,d)=>({tag:t,_1:e,_2:r,_3:o,_4:a,_5:i,_6:d});var W=b("Leaf");var Wn=t=>e=>{let r=o=>{let a=o,i=!0,d;for(;i;){let u=a;if(u.tag==="Nil"){i=!1,d=m;continue}if(u.tag==="Cons"){if(u._1.tag==="Leaf"){a=u._2;continue}if(u._1.tag==="Two"){if(u._1._1.tag==="Leaf"){if(u._1._4.tag==="Leaf"){i=!1,d=L("Just",y(y(u._1._2,u._1._3),u._2));continue}i=!1,d=L("Just",y(y(u._1._2,u._1._3),E("Cons",u._1._4,u._2)));continue}a=E("Cons",u._1._1,E("Cons",b("Two",W,u._1._2,u._1._3,W),E("Cons",u._1._4,u._2)));continue}if(u._1.tag==="Three"){a=E("Cons",u._1._1,E("Cons",b("Two",W,u._1._2,u._1._3,W),E("Cons",u._1._4,E("Cons",b("Two",W,u._1._5,u._1._6,W),E("Cons",u._1._7,u._2)))));continue}f()}f()}return d};return t.unfoldr(r)(E("Cons",e,I))};var ae=t=>e=>o=>{let a=o,i=!0,d;for(;i;){let u=a;if(u.tag==="Leaf"){i=!1,d=m;continue}if(u.tag==="Two"){let $=t.compare(e)(u._2);if($.tag==="EQ"){i=!1,d=L("Just",u._3);continue}if($.tag==="LT"){a=u._1;continue}a=u._4;continue}if(u.tag==="Three"){let $=t.compare(e)(u._2);if($.tag==="EQ"){i=!1,d=L("Just",u._3);continue}let p=t.compare(e)(u._5);if(p.tag==="EQ"){i=!1,d=L("Just",u._6);continue}if($.tag==="LT"){a=u._1;continue}if(p.tag==="GT"){a=u._7;continue}a=u._4;continue}f()}return d};var te={map:t=>e=>{if(e.tag==="Leaf")return W;if(e.tag==="Two")return b("Two",te.map(t)(e._1),e._2,t(e._3),te.map(t)(e._4));if(e.tag==="Three")return b("Three",te.map(t)(e._1),e._2,t(e._3),te.map(t)(e._4),e._5,t(e._6),te.map(t)(e._7));f()}};var mt=t=>e=>r=>{let o=t,a=e,i=r,d=!0,u;for(;d;){let $=o,p=a,l=i;if(p.tag==="Nil"){d=!1,u=l;continue}if(p.tag==="Cons"){if(p._1.tag==="TwoLeft"){o=$,a=p._2,i=b("Two",l,p._1._1,p._1._2,p._1._3);continue}if(p._1.tag==="TwoRight"){o=$,a=p._2,i=b("Two",p._1._1,p._1._2,p._1._3,l);continue}if(p._1.tag==="ThreeLeft"){o=$,a=p._2,i=b("Three",l,p._1._1,p._1._2,p._1._3,p._1._4,p._1._5,p._1._6);continue}if(p._1.tag==="ThreeMiddle"){o=$,a=p._2,i=b("Three",p._1._1,p._1._2,p._1._3,l,p._1._4,p._1._5,p._1._6);continue}if(p._1.tag==="ThreeRight"){o=$,a=p._2,i=b("Three",p._1._1,p._1._2,p._1._3,p._1._4,p._1._5,p._1._6,l);continue}f()}f()}return u},qn=t=>e=>r=>{let o=i=>d=>{let u=i,$=d,p=!0,l;for(;p;){let c=u,n=$;if(c.tag==="Nil"){p=!1,l=b("Two",n._1,n._2,n._3,n._4);continue}if(c.tag==="Cons"){if(c._1.tag==="TwoLeft"){p=!1,l=mt(t)(c._2)(b("Three",n._1,n._2,n._3,n._4,c._1._1,c._1._2,c._1._3));continue}if(c._1.tag==="TwoRight"){p=!1,l=mt(t)(c._2)(b("Three",c._1._1,c._1._2,c._1._3,n._1,n._2,n._3,n._4));continue}if(c._1.tag==="ThreeLeft"){u=c._2,$=Pn(b("Two",n._1,n._2,n._3,n._4),c._1._1,c._1._2,b("Two",c._1._3,c._1._4,c._1._5,c._1._6));continue}if(c._1.tag==="ThreeMiddle"){u=c._2,$=Pn(b("Two",c._1._1,c._1._2,c._1._3,n._1),n._2,n._3,b("Two",n._4,c._1._4,c._1._5,c._1._6));continue}if(c._1.tag==="ThreeRight"){u=c._2,$=Pn(b("Two",c._1._1,c._1._2,c._1._3,c._1._4),c._1._5,c._1._6,b("Two",n._1,n._2,n._3,n._4));continue}f()}f()}return l};return(i=>d=>{let u=i,$=d,p=!0,l;for(;p;){let c=u,n=$;if(n.tag==="Leaf"){p=!1,l=o(c)(Pn(W,e,r,W));continue}if(n.tag==="Two"){let s=t.compare(e)(n._2);if(s.tag==="EQ"){p=!1,l=mt(t)(c)(b("Two",n._1,e,r,n._4));continue}if(s.tag==="LT"){u=E("Cons",nt("TwoLeft",n._2,n._3,n._4),c),$=n._1;continue}u=E("Cons",nt("TwoRight",n._1,n._2,n._3),c),$=n._4;continue}if(n.tag==="Three"){let s=t.compare(e)(n._2);if(s.tag==="EQ"){p=!1,l=mt(t)(c)(b("Three",n._1,e,r,n._4,n._5,n._6,n._7));continue}let _=t.compare(e)(n._5);if(_.tag==="EQ"){p=!1,l=mt(t)(c)(b("Three",n._1,n._2,n._3,n._4,e,r,n._7));continue}if(s.tag==="LT"){u=E("Cons",nt("ThreeLeft",n._2,n._3,n._4,n._5,n._6,n._7),c),$=n._1;continue}if(s.tag==="GT"){if(_.tag==="LT"){u=E("Cons",nt("ThreeMiddle",n._1,n._2,n._3,n._5,n._6,n._7),c),$=n._4;continue}u=E("Cons",nt("ThreeRight",n._1,n._2,n._3,n._4,n._5,n._6),c),$=n._7;continue}u=E("Cons",nt("ThreeRight",n._1,n._2,n._3,n._4,n._5,n._6),c),$=n._7;continue}f()}return l})(I)},Au=t=>e=>{let r=d=>u=>{let $=d,p=u,l=!0,c;for(;l;){let n=$,s=p;if(n.tag==="Nil"){l=!1,c=s;continue}if(n.tag==="Cons"){let _=n._2,R=(gt,_t,rt,yt,tt,J,ot,at,st,H)=>mt(t)(_)(b("Two",b("Two",gt,tt,at,_t),J,st,b("Two",rt,ot,H,yt))),et=(gt,_t,rt,yt,tt,J,ot,at,st,H)=>mt(t)(_)(b("Two",b("Two",gt,tt,at,_t),J,st,b("Two",rt,ot,H,yt))),dt=(gt,_t,rt,yt,tt,J,ot,at,st,H)=>mt(t)(_)(b("Two",b("Three",gt,tt,at,_t,J,st,rt),ot,H,yt)),It=(gt,_t,rt,yt,tt,J,ot,at,st,H)=>mt(t)(_)(b("Two",b("Three",gt,tt,at,_t,J,st,rt),ot,H,yt)),ne=(gt,_t,rt,yt,tt,J,ot,at,st,H)=>mt(t)(_)(b("Two",gt,tt,at,b("Three",_t,J,st,rt,ot,H,yt))),Ge=(gt,_t,rt,yt,tt,J,ot,at,st,H)=>mt(t)(_)(b("Two",gt,tt,at,b("Three",_t,J,st,rt,ot,H,yt))),T=(gt,_t,rt,yt,tt,J,ot,at,st,H,zt,Vt,le)=>mt(t)(_)(b("Three",b("Two",gt,J,H,_t),ot,zt,b("Two",rt,at,Vt,yt),st,le,tt)),At=(gt,_t,rt,yt,tt,J,ot,at,st,H,zt,Vt,le)=>mt(t)(_)(b("Three",b("Two",gt,J,H,_t),ot,zt,b("Two",rt,at,Vt,yt),st,le,tt)),Ie=(gt,_t,rt,yt,tt,J,ot,at,st,H,zt,Vt,le)=>mt(t)(_)(b("Three",gt,J,H,b("Two",_t,ot,zt,rt),at,Vt,b("Two",yt,st,le,tt))),sn=(gt,_t,rt,yt,tt,J,ot,at,st,H,zt,Vt,le)=>mt(t)(_)(b("Three",gt,J,H,b("Two",_t,ot,zt,rt),at,Vt,b("Two",yt,st,le,tt)));if(s.tag==="Leaf"){if(n._1.tag==="TwoLeft"){if(n._1._3.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Two",W,n._1._1,n._1._2,W));continue}if(n._1._3.tag==="Two"){$=_,p=b("Three",s,n._1._1,n._1._2,n._1._3._1,n._1._3._2,n._1._3._3,n._1._3._4);continue}if(n._1._3.tag==="Three"){l=!1,c=R(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._1,n._1._3._2,n._1._3._5,n._1._2,n._1._3._3,n._1._3._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="TwoRight"){if(n._1._1.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Two",W,n._1._2,n._1._3,W));continue}if(n._1._1.tag==="Two"){$=_,p=b("Three",n._1._1._1,n._1._1._2,n._1._1._3,n._1._1._4,n._1._2,n._1._3,s);continue}if(n._1._1.tag==="Three"){l=!1,c=et(n._1._1._1,n._1._1._4,n._1._1._7,s,n._1._1._2,n._1._1._5,n._1._2,n._1._1._3,n._1._1._6,n._1._3);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeLeft"){if(n._1._6.tag==="Leaf"){if(n._1._3.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Three",W,n._1._1,n._1._2,W,n._1._4,n._1._5,W));continue}if(n._1._3.tag==="Two"){l=!1,c=dt(s,n._1._3._1,n._1._3._4,n._1._6,n._1._1,n._1._3._2,n._1._4,n._1._2,n._1._3._3,n._1._5);continue}if(n._1._3.tag==="Three"){l=!1,c=T(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._6,n._1._1,n._1._3._2,n._1._3._5,n._1._4,n._1._2,n._1._3._3,n._1._3._6,n._1._5);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1._3.tag==="Two"){l=!1,c=dt(s,n._1._3._1,n._1._3._4,n._1._6,n._1._1,n._1._3._2,n._1._4,n._1._2,n._1._3._3,n._1._5);continue}if(n._1._3.tag==="Three"){l=!1,c=T(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._6,n._1._1,n._1._3._2,n._1._3._5,n._1._4,n._1._2,n._1._3._3,n._1._3._6,n._1._5);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeMiddle"){if(n._1._1.tag==="Leaf"){if(n._1._6.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Three",W,n._1._2,n._1._3,W,n._1._4,n._1._5,W));continue}if(n._1._6.tag==="Two"){l=!1,c=ne(n._1._1,s,n._1._6._1,n._1._6._4,n._1._2,n._1._4,n._1._6._2,n._1._3,n._1._5,n._1._6._3);continue}if(n._1._6.tag==="Three"){l=!1,c=Ie(n._1._1,s,n._1._6._1,n._1._6._4,n._1._6._7,n._1._2,n._1._4,n._1._6._2,n._1._6._5,n._1._3,n._1._5,n._1._6._3,n._1._6._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1._1.tag==="Two"){l=!1,c=It(n._1._1._1,n._1._1._4,s,n._1._6,n._1._1._2,n._1._2,n._1._4,n._1._1._3,n._1._3,n._1._5);continue}if(n._1._6.tag==="Two"){l=!1,c=ne(n._1._1,s,n._1._6._1,n._1._6._4,n._1._2,n._1._4,n._1._6._2,n._1._3,n._1._5,n._1._6._3);continue}if(n._1._1.tag==="Three"){l=!1,c=At(n._1._1._1,n._1._1._4,n._1._1._7,s,n._1._6,n._1._1._2,n._1._1._5,n._1._2,n._1._4,n._1._1._3,n._1._1._6,n._1._3,n._1._5);continue}if(n._1._6.tag==="Three"){l=!1,c=Ie(n._1._1,s,n._1._6._1,n._1._6._4,n._1._6._7,n._1._2,n._1._4,n._1._6._2,n._1._6._5,n._1._3,n._1._5,n._1._6._3,n._1._6._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeRight"){if(n._1._1.tag==="Leaf"){if(n._1._4.tag==="Leaf"){l=!1,c=mt(t)(_)(b("Three",W,n._1._2,n._1._3,W,n._1._5,n._1._6,W));continue}if(n._1._4.tag==="Two"){l=!1,c=Ge(n._1._1,n._1._4._1,n._1._4._4,s,n._1._2,n._1._4._2,n._1._5,n._1._3,n._1._4._3,n._1._6);continue}if(n._1._4.tag==="Three"){l=!1,c=sn(n._1._1,n._1._4._1,n._1._4._4,n._1._4._7,s,n._1._2,n._1._4._2,n._1._4._5,n._1._5,n._1._3,n._1._4._3,n._1._4._6,n._1._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1._4.tag==="Two"){l=!1,c=Ge(n._1._1,n._1._4._1,n._1._4._4,s,n._1._2,n._1._4._2,n._1._5,n._1._3,n._1._4._3,n._1._6);continue}if(n._1._4.tag==="Three"){l=!1,c=sn(n._1._1,n._1._4._1,n._1._4._4,n._1._4._7,s,n._1._2,n._1._4._2,n._1._4._5,n._1._5,n._1._3,n._1._4._3,n._1._4._6,n._1._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="TwoLeft"){if(n._1._3.tag==="Two"){$=_,p=b("Three",s,n._1._1,n._1._2,n._1._3._1,n._1._3._2,n._1._3._3,n._1._3._4);continue}if(n._1._3.tag==="Three"){l=!1,c=R(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._1,n._1._3._2,n._1._3._5,n._1._2,n._1._3._3,n._1._3._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="TwoRight"){if(n._1._1.tag==="Two"){$=_,p=b("Three",n._1._1._1,n._1._1._2,n._1._1._3,n._1._1._4,n._1._2,n._1._3,s);continue}if(n._1._1.tag==="Three"){l=!1,c=et(n._1._1._1,n._1._1._4,n._1._1._7,s,n._1._1._2,n._1._1._5,n._1._2,n._1._1._3,n._1._1._6,n._1._3);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeLeft"){if(n._1._3.tag==="Two"){l=!1,c=dt(s,n._1._3._1,n._1._3._4,n._1._6,n._1._1,n._1._3._2,n._1._4,n._1._2,n._1._3._3,n._1._5);continue}if(n._1._3.tag==="Three"){l=!1,c=T(s,n._1._3._1,n._1._3._4,n._1._3._7,n._1._6,n._1._1,n._1._3._2,n._1._3._5,n._1._4,n._1._2,n._1._3._3,n._1._3._6,n._1._5);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeMiddle"){if(n._1._1.tag==="Two"){l=!1,c=It(n._1._1._1,n._1._1._4,s,n._1._6,n._1._1._2,n._1._2,n._1._4,n._1._1._3,n._1._3,n._1._5);continue}if(n._1._6.tag==="Two"){l=!1,c=ne(n._1._1,s,n._1._6._1,n._1._6._4,n._1._2,n._1._4,n._1._6._2,n._1._3,n._1._5,n._1._6._3);continue}if(n._1._1.tag==="Three"){l=!1,c=At(n._1._1._1,n._1._1._4,n._1._1._7,s,n._1._6,n._1._1._2,n._1._1._5,n._1._2,n._1._4,n._1._1._3,n._1._1._6,n._1._3,n._1._5);continue}if(n._1._6.tag==="Three"){l=!1,c=Ie(n._1._1,s,n._1._6._1,n._1._6._4,n._1._6._7,n._1._2,n._1._4,n._1._6._2,n._1._6._5,n._1._3,n._1._5,n._1._6._3,n._1._6._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}if(n._1.tag==="ThreeRight"){if(n._1._4.tag==="Two"){l=!1,c=Ge(n._1._1,n._1._4._1,n._1._4._4,s,n._1._2,n._1._4._2,n._1._5,n._1._3,n._1._4._3,n._1._6);continue}if(n._1._4.tag==="Three"){l=!1,c=sn(n._1._1,n._1._4._1,n._1._4._4,n._1._4._7,s,n._1._2,n._1._4._2,n._1._4._5,n._1._5,n._1._3,n._1._4._3,n._1._4._6,n._1._6);continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}l=!1,c=ft("The impossible happened in partial function `up`.");continue}f()}return c},o=d=>u=>{let $=d,p=u,l=!0,c;for(;l;){let n=$,s=p;if(s.tag==="Two"){if(s._1.tag==="Leaf"){if(s._4.tag==="Leaf"){l=!1,c=r(n)(W);continue}$=E("Cons",nt("TwoRight",s._1,s._2,s._3),n),p=s._4;continue}$=E("Cons",nt("TwoRight",s._1,s._2,s._3),n),p=s._4;continue}if(s.tag==="Three"){if(s._1.tag==="Leaf"){if(s._4.tag==="Leaf"){if(s._7.tag==="Leaf"){l=!1,c=r(E("Cons",nt("TwoRight",W,s._2,s._3),n))(W);continue}$=E("Cons",nt("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}$=E("Cons",nt("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}$=E("Cons",nt("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}l=!1,c=ft("The impossible happened in partial function `removeMaxNode`.")}return c},a=d=>{let u=d,$=!0,p;for(;$;){let l=u;if(l.tag==="Two"){if(l._4.tag==="Leaf"){$=!1,p={key:l._2,value:l._3};continue}u=l._4;continue}if(l.tag==="Three"){if(l._7.tag==="Leaf"){$=!1,p={key:l._5,value:l._6};continue}u=l._7;continue}$=!1,p=ft("The impossible happened in partial function `maxNode`.")}return p};return(d=>u=>{let $=d,p=u,l=!0,c;for(;l;){let n=$,s=p;if(s.tag==="Leaf"){l=!1,c=m;continue}if(s.tag==="Two"){let _=t.compare(e)(s._2);if(_.tag==="EQ"){if(s._4.tag==="Leaf"){l=!1,c=L("Just",y(s._3,r(n)(W)));continue}let R=a(s._1);l=!1,c=L("Just",y(s._3,o(E("Cons",nt("TwoLeft",R.key,R.value,s._4),n))(s._1)));continue}if(_.tag==="LT"){$=E("Cons",nt("TwoLeft",s._2,s._3,s._4),n),p=s._1;continue}$=E("Cons",nt("TwoRight",s._1,s._2,s._3),n),p=s._4;continue}if(s.tag==="Three"){let _=t.compare(e)(s._5),R=t.compare(e)(s._2);if((()=>s._1.tag==="Leaf"&&s._4.tag==="Leaf"?s._7.tag==="Leaf":!1)()){if(R.tag==="EQ"){l=!1,c=L("Just",y(s._3,mt(t)(n)(b("Two",W,s._5,s._6,W))));continue}if(_.tag==="EQ"){l=!1,c=L("Just",y(s._6,mt(t)(n)(b("Two",W,s._2,s._3,W))));continue}if(R.tag==="LT"){$=E("Cons",nt("ThreeLeft",s._2,s._3,s._4,s._5,s._6,s._7),n),p=s._1;continue}if(R.tag==="GT"){if(_.tag==="LT"){$=E("Cons",nt("ThreeMiddle",s._1,s._2,s._3,s._5,s._6,s._7),n),p=s._4;continue}$=E("Cons",nt("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}$=E("Cons",nt("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}if(R.tag==="EQ"){let et=a(s._1);l=!1,c=L("Just",y(s._3,o(E("Cons",nt("ThreeLeft",et.key,et.value,s._4,s._5,s._6,s._7),n))(s._1)));continue}if(_.tag==="EQ"){let et=a(s._4);l=!1,c=L("Just",y(s._6,o(E("Cons",nt("ThreeMiddle",s._1,s._2,s._3,et.key,et.value,s._7),n))(s._4)));continue}if(R.tag==="LT"){$=E("Cons",nt("ThreeLeft",s._2,s._3,s._4,s._5,s._6,s._7),n),p=s._1;continue}if(R.tag==="GT"){if(_.tag==="LT"){$=E("Cons",nt("ThreeMiddle",s._1,s._2,s._3,s._5,s._6,s._7),n),p=s._4;continue}$=E("Cons",nt("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}$=E("Cons",nt("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),n),p=s._7;continue}f()}return c})(I)};var vn=t=>e=>e.foldl(r=>o=>qn(t)(o._1)(o._2)(r))(W);var Su=t=>e=>r=>{let o=Au(t)(e)(r);if(o.tag==="Nothing")return r;if(o.tag==="Just")return o._1._2;f()};var wu=t=>e=>r=>o=>{let a=e(ae(t)(r)(o));if(a.tag==="Nothing")return Su(t)(r)(o);if(a.tag==="Just")return qn(t)(r)(a._1)(o);f()};var la=t=>e=>r=>o=>wu(t)(a=>{if(a.tag==="Nothing")return m;if(a.tag==="Just")return e(a._1);f()})(r)(o);function Ft(t,e,r){return t==null?e:r(t)}var Ut=function(){var t={},e="Pure",r="Throw",o="Catch",a="Sync",i="Async",d="Bind",u="Bracket",$="Fork",p="Sequential",l="Map",c="Apply",n="Alt",s="Cons",_="Resume",R="Release",et="Finalizer",dt="Finalized",It="Forked",ne="Fiber",Ge="Thunk";function T(h,B,ct,G){this.tag=h,this._1=B,this._2=ct,this._3=G}function At(h){var B=function(ct,G,C){return new T(h,ct,G,C)};return B.tag=h,B}function Ie(h){return new T(e,void 0)}function sn(h){try{h()}catch(B){setTimeout(function(){throw B},0)}}function gt(h,B,ct){try{return B(ct())}catch(G){return h(G)}}function _t(h,B,ct){try{return B(ct)()}catch(G){return ct(h(G))(),Ie}}var rt=function(){var h=1024,B=0,ct=0,G=new Array(h),C=!1;function g(){var U;for(C=!0;B!==0;)B--,U=G[ct],G[ct]=void 0,ct=(ct+1)%h,U();C=!1}return{isDraining:function(){return C},enqueue:function(U){var S,it;B===h&&(it=C,g(),C=it),G[(ct+B)%h]=U,B++,C||g()}}}();function yt(h){var B={},ct=0,G=0;return{register:function(C){var g=ct++;C.onComplete({rethrow:!0,handler:function(U){return function(){G--,delete B[g]}}})(),B[g]=C,G++},isEmpty:function(){return G===0},killAll:function(C,g){return function(){if(G===0)return g();var U=0,S={};function it(V){S[V]=B[V].kill(C,function($t){return function(){delete S[V],U--,h.isLeft($t)&&h.fromLeft($t)&&setTimeout(function(){throw h.fromLeft($t)},0),U===0&&g()}})()}for(var Nt in B)B.hasOwnProperty(Nt)&&(U++,it(Nt));return B={},ct=0,G=0,function(V){return new T(a,function(){for(var $t in S)S.hasOwnProperty($t)&&S[$t]()})}}}}}var tt=0,J=1,ot=2,at=3,st=4,H=5,zt=6;function Vt(h,B,ct){var G=0,C=tt,g=ct,U=null,S=null,it=null,Nt=null,V=null,$t=0,Fe=0,Qt=null,De=!0;function be(M){for(var N,P,v;;)switch(N=null,P=null,v=null,C){case ot:C=J;try{g=it(g),Nt===null?it=null:(it=Nt._1,Nt=Nt._2)}catch(Et){C=H,U=h.left(Et),g=null}break;case at:h.isLeft(g)?(C=H,U=g,g=null):it===null?C=H:(C=ot,g=h.fromRight(g));break;case J:switch(g.tag){case d:it&&(Nt=new T(s,it,Nt)),it=g._2,C=J,g=g._1;break;case e:it===null?(C=H,g=h.right(g._1)):(C=ot,g=g._1);break;case a:C=at,g=gt(h.left,h.right,g._1);break;case i:C=st,g=_t(h.left,g._1,function(Et){return function(){G===M&&(G++,rt.enqueue(function(){G===M+1&&(C=at,g=Et,be(G))}))}});return;case r:C=H,U=h.left(g._1),g=null;break;case o:it===null?V=new T(s,g,V,S):V=new T(s,g,new T(s,new T(_,it,Nt),V,S),S),it=null,Nt=null,C=J,g=g._1;break;case u:$t++,it===null?V=new T(s,g,V,S):V=new T(s,g,new T(s,new T(_,it,Nt),V,S),S),it=null,Nt=null,C=J,g=g._1;break;case $:C=at,N=Vt(h,B,g._2),B&&B.register(N),g._1&&N.run(),g=h.right(N);break;case p:C=J,g=di(h,B,g._1);break}break;case H:if(it=null,Nt=null,V===null)C=zt,g=S||U||g;else switch(N=V._3,v=V._1,V=V._2,v.tag){case o:S&&S!==N&&$t===0?C=H:U&&(C=J,g=v._2(h.fromLeft(U)),U=null);break;case _:S&&S!==N&&$t===0||U?C=H:(it=v._1,Nt=v._2,C=ot,g=h.fromRight(g));break;case u:$t--,U===null&&(P=h.fromRight(g),V=new T(s,new T(R,v._2,P),V,N),(S===N||$t>0)&&(C=J,g=v._3(P)));break;case R:V=new T(s,new T(dt,g,U),V,S),C=J,S&&S!==N&&$t===0?g=v._1.killed(h.fromLeft(S))(v._2):U?g=v._1.failed(h.fromLeft(U))(v._2):g=v._1.completed(h.fromRight(g))(v._2),U=null,$t++;break;case et:$t++,V=new T(s,new T(dt,g,U),V,S),C=J,g=v._1;break;case dt:$t--,C=H,g=v._1,U=v._2;break}break;case zt:for(var pt in Qt)Qt.hasOwnProperty(pt)&&(De=De&&Qt[pt].rethrow,sn(Qt[pt].handler(g)));Qt=null,S&&U?setTimeout(function(){throw h.fromLeft(U)},0):h.isLeft(g)&&De&&setTimeout(function(){if(De)throw h.fromLeft(g)},0);return;case tt:C=J;break;case st:return}}function lt(M){return function(){if(C===zt)return De=De&&M.rethrow,M.handler(g)(),function(){};var N=Fe++;return Qt=Qt||{},Qt[N]=M,function(){Qt!==null&&delete Qt[N]}}}function x(M,N){return function(){if(C===zt)return N(h.right(void 0))(),function(){};var P=lt({rethrow:!1,handler:function(){return N(h.right(void 0))}})();switch(C){case tt:S=h.left(M),C=zt,g=S,be(G);break;case st:S===null&&(S=h.left(M)),$t===0&&(C===st&&(V=new T(s,new T(et,g(M)),V,S)),C=H,g=null,U=null,be(++G));break;default:S===null&&(S=h.left(M)),$t===0&&(C=H,g=null,U=null)}return P}}function w(M){return function(){var N=lt({rethrow:!1,handler:M})();return C===tt&&be(G),N}}return{kill:x,join:w,onComplete:lt,isSuspended:function(){return C===tt},run:function(){C===tt&&(rt.isDraining()?be(G):rt.enqueue(function(){be(G)}))}}}function le(h,B,ct,G){var C=0,g={},U=0,S={},it=new Error("[ParAff] Early exit"),Nt=null,V=t;function $t(lt,x,w){var M=x,N=null,P=null,v=0,pt={},Et,un;t:for(;;)switch(Et=null,M.tag){case It:if(M._3===t&&(Et=g[M._1],pt[v++]=Et.kill(lt,function(ci){return function(){v--,v===0&&w(ci)()}})),N===null)break t;M=N._2,P===null?N=null:(N=P._1,P=P._2);break;case l:M=M._2;break;case c:case n:N&&(P=new T(s,N,P)),N=M,M=M._1;break}if(v===0)w(h.right(void 0))();else for(un=0,Et=v;un<Et;un++)pt[un]=pt[un]();return pt}function Fe(lt,x,w){var M,N,P,v,pt,Et;h.isLeft(lt)?(M=lt,N=null):(N=lt,M=null);t:for(;;){if(P=null,v=null,pt=null,Et=null,Nt!==null)return;if(x===null){G(M||N)();return}if(x._3!==t)return;switch(x.tag){case l:M===null?(x._3=h.right(x._1(h.fromRight(N))),N=x._3):x._3=M;break;case c:if(P=x._1._3,v=x._2._3,M){if(x._3=M,pt=!0,Et=U++,S[Et]=$t(it,M===P?x._2:x._1,function(){return function(){delete S[Et],pt?pt=!1:w===null?Fe(M,null,null):Fe(M,w._1,w._2)}}),pt){pt=!1;return}}else{if(P===t||v===t)return;N=h.right(h.fromRight(P)(h.fromRight(v))),x._3=N}break;case n:if(P=x._1._3,v=x._2._3,P===t&&h.isLeft(v)||v===t&&h.isLeft(P))return;if(P!==t&&h.isLeft(P)&&v!==t&&h.isLeft(v))M=N===P?v:P,N=null,x._3=M;else if(x._3=N,pt=!0,Et=U++,S[Et]=$t(it,N===P?x._2:x._1,function(){return function(){delete S[Et],pt?pt=!1:w===null?Fe(N,null,null):Fe(N,w._1,w._2)}}),pt){pt=!1;return}break}w===null?x=null:(x=w._1,w=w._2)}}function Qt(lt){return function(x){return function(){delete g[lt._1],lt._3=x,Fe(x,lt._2._1,lt._2._2)}}}function De(){var lt=J,x=ct,w=null,M=null,N,P;t:for(;;)switch(N=null,P=null,lt){case J:switch(x.tag){case l:w&&(M=new T(s,w,M)),w=new T(l,x._1,t,t),x=x._2;break;case c:w&&(M=new T(s,w,M)),w=new T(c,t,x._2,t),x=x._1;break;case n:w&&(M=new T(s,w,M)),w=new T(n,t,x._2,t),x=x._1;break;default:P=C++,lt=H,N=x,x=new T(It,P,new T(s,w,M),t),N=Vt(h,B,N),N.onComplete({rethrow:!1,handler:Qt(x)})(),g[P]=N,B&&B.register(N)}break;case H:if(w===null)break t;w._1===t?(w._1=x,lt=J,x=w._2,w._2=t):(w._2=x,x=w,M===null?w=null:(w=M._1,M=M._2))}for(V=x,P=0;P<C;P++)g[P].run()}function be(lt,x){Nt=h.left(lt);var w;for(var M in S)if(S.hasOwnProperty(M)){w=S[M];for(M in w)w.hasOwnProperty(M)&&w[M]()}S=null;var N=$t(lt,V,x);return function(P){return new T(i,function(v){return function(){for(var pt in N)N.hasOwnProperty(pt)&&N[pt]();return Ie}})}}return De(),function(lt){return new T(i,function(x){return function(){return be(lt,x)}})}}function di(h,B,ct){return new T(i,function(G){return function(){return le(h,B,ct,G)}})}return T.EMPTY=t,T.Pure=At(e),T.Throw=At(r),T.Catch=At(o),T.Sync=At(a),T.Async=At(i),T.Bind=At(d),T.Bracket=At(u),T.Fork=At($),T.Seq=At(p),T.ParMap=At(l),T.ParApply=At(c),T.ParAlt=At(n),T.Fiber=Vt,T.Supervisor=yt,T.Scheduler=rt,T.nonCanceler=Ie,T}(),_e=Ut.Pure,Bu=Ut.Throw;function $a(t){return function(e){return e.tag===Ut.Pure.tag?Ut.Pure(t(e._1)):Ut.Bind(e,function(r){return Ut.Pure(t(r))})}}function Gt(t){return function(e){return Ut.Bind(t,e)}}var se=Ut.Sync;var Hu=Ut.Async;function Jn(t,e){return function(){return Ut.Fiber(t,null,e)}}var Bn=function(){function t(r,o){return r===0&&typeof setImmediate<"u"?setImmediate(o):setTimeout(o,r)}function e(r,o){return r===0&&typeof clearImmediate<"u"?clearImmediate(o):clearTimeout(o)}return function(r,o){return Ut.Async(function(a){return function(){var i=t(o,a(r()));return function(){return Ut.Sync(function(){return r(e(o,i))})}}})}}(),ku=Ut.Seq;var Wr={map:$a};var qr={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;f()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return ft("unsafeFromLeft: Right");f()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return ft("unsafeFromRight: Left");f()},left:fr,right:$e};var fa={Applicative0:()=>Hn,Bind1:()=>Uu},Uu={bind:Gt,Apply0:()=>ma},ma={apply:t=>e=>Gt(t)(r=>Gt(e)(o=>Hn.pure(r(o)))),Functor0:()=>Wr},Hn={pure:_e,Apply0:()=>ma};var kn={liftEffect:se,Monad0:()=>fa};var ga={tailRecM:t=>{let e=r=>Gt(t(r))(o=>{if(o.tag==="Done")return _e(o._1);if(o.tag==="Loop")return e(o._1);f()});return e},Monad0:()=>fa};var _a=(t,e)=>({...t,...e}),ya=(t,e)=>t&&e?r=>t(e(r)):t||e,ha=(t,e,r,o,a,i,d)=>{if(e==="style")for(let u in _a(r,o))r=o==null||o[u]==null?"":o[u],u[0]==="-"?t[e].setProperty(u,r):t[e][u]=r;else if(e[0]==="o"&&e[1]==="n"){let u=e.slice(2);t.actions||(t.actions={}),t.actions[u]=d&&o?d(o):o,o?r||t.addEventListener(u,a):t.removeEventListener(u,a)}else!i&&e in t?t[e]=o:o==null||o===!1||e==="class"&&!o?t.removeAttribute(e):t.setAttribute(e,o)},Gn=(t,e,r,o)=>{let a=t.type===3?document.createTextNode(t.tag):(r=r||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),i=t.props,d=ya(o,t.mapf);for(let u in i)ha(a,u,null,i[u],e,r,d);for(let u=0,$=t.children.length;u<$;u++)a.appendChild(Gn(qe(t.children[u]).html,e,r,d));return t.node=a,a},We=(t,e,r,o,a,i,d)=>{if(r!==o)if(r!=null&&r.type===3&&o.type===3)r.tag!==o.tag&&(e.nodeValue=o.tag);else if(r==null||r.tag!==o.tag)e=t.insertBefore(Gn(o,a,i,d),e),r&&t.removeChild(r.node);else{let u=r.props,$=o.props,p=r.children,l=o.children,c=p.length-1,n=l.length-1;d=ya(d,o.mapf),i=i||o.tag==="svg";for(let s in _a(u,$))(s==="value"||s==="selected"||s==="checked"?e[s]:u[s])!==$[s]&&ha(e,s,u[s],$[s],a,i,d);if(o.keyed){let s=0,_=0;for(;_<=n&&s<=c;){let{key:R,html:et}=p[s];if(R!==l[_].key)break;let dt=qe(l[_],et);We(e,et.node,et,dt.html,a,i,d),_++,s++}for(;_<=n&&s<=c;){let{key:R,html:et}=p[c];if(R!==l[n].key)break;let dt=qe(l[n],et);We(e,et.node,et,dt.html,a,i,d),n--,c--}if(s>c)for(;_<=n;){let R=qe(l[_]).html;e.insertBefore(Gn(R,a,i,d),p[s]&&p[s].html.node),_++}else if(_>n)for(;s<=c;)e.removeChild(p[s].html.node),s++;else{let R={},et={};for(let dt=s;dt<=c;dt++)R[p[dt].key]=p[dt].html;for(;_<=n;){let{key:dt,html:It}=p[s]||{key:null,html:null},{key:ne,html:Ge}=qe(l[_],It);if(et[dt]||p[s+1]&&ne===p[s+1].key){s++;continue}if(dt===ne)We(e,It.node,It,Ge,a,i,d),et[ne]=!0,s++;else{let T=R[ne];T!=null?(We(e,e.insertBefore(T.node,It.node),T,l[_].html,a,i,d),et[ne]=!0):We(e,It&&It.node,null,l[_].html,a,i,d)}_++}for(let dt in R)et[dt]||e.removeChild(R[dt].node)}}else{for(let s=0;s<=c&&s<=n;s++){let _=p[s].html,R=qe(l[s],_).html;We(e,_.node,_,R,a,i,d)}for(let s=c+1;s<=n;s++){let _=qe(l[s],r).html;e.appendChild(Gn(_,a,i,d))}for(let s=n+1;s<=c;s++)e.removeChild(p[s].html.node)}}return o.node=e,e},Gu=(t,e)=>{for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!0;return!1},Qu=(t,e)=>e.reduce((r,o)=>r(o),t),qe=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||Gu(e.memo,t.html.memo))&&(e=Qn(Qu(t.html.type,t.html.memo)),e.memo=t.html.memo),t.html=e),t),Qn=t=>({...t,children:t.children&&t.children.map(({key:e,html:r})=>({key:e,html:Qn(r)}))}),Da=t=>e=>()=>t.actions[e],ba=t=>e=>r=>o=>a=>()=>We(t,e,r,o,i=>a(i)()),Ta=t=>e=>(e.node=t,e);var ju=(t,e,r,o=!1)=>{let a={},i={style:a},d={tag:t,children:r,props:i,node:null,keyed:o},u=e.length;for(let $=0;$<u;$++){let[p,l,c]=e[$];p==1?i[l]=c:p===2?i.class=i.class?i.class+" "+l:l:p===3&&(a[l]=c)}return d},bt=t=>e=>r=>ju(t,e,r.map(o=>({key:null,html:o})));var Vu=t=>({tag:t,props:{},children:[],type:3});var Lt=t=>e=>[1,t,e],z=t=>[2,t];var Ne=t=>e=>[1,"on"+t,e],On=t=>e=>[3,t,e],q=Vu;var Ca=q("");var Ma={dimap:t=>e=>r=>o=>e(r(t(o)))};var pn=(()=>({first:t=>e=>y(t(e._1),e._2),second:In.map,Profunctor0:()=>Ma}))();function jn(t){return function(e){return t===e}}var xt=(t,e,r)=>({tag:t,_1:e,_2:r});var Na={state:t=>A(j("Bind",xt("State",t),e=>A(j("Return",e),Q)),Q),Monad0:()=>Fn};var zr=t=>({liftEffect:e=>A(j("Bind",xt("Lift",t.liftEffect(e)),r=>A(j("Return",r),Q)),Q),Monad0:()=>Fn});var xa=t=>{let e=zr(t.MonadEffect0());return{liftAff:r=>A(j("Bind",xt("Lift",t.liftAff(r)),o=>A(j("Return",o),Q)),Q),MonadEffect0:()=>e}},Ea=t=>({map:e=>r=>{if(r.tag==="State")return xt("State",o=>{let a=r._1(o);return y(e(a._1),a._2)});if(r.tag==="Lift")return xt("Lift",t.map(e)(r._1));if(r.tag==="Subscribe")return xt("Subscribe",r._1,o=>e(r._2(o)));if(r.tag==="Unsubscribe")return xt("Unsubscribe",r._1,e(r._2));f()}});var Ia=t=>e=>Yo(r=>{if(r.tag==="State")return xt("State",r._1);if(r.tag==="Lift")return xt("Lift",t(r._1));if(r.tag==="Subscribe")return xt("Subscribe",r._1,r._2);if(r.tag==="Unsubscribe")return xt("Unsubscribe",r._1,r._2);f()})(e);function $n(t,e,r,o){if(typeof window<"u"){var a=window[r];if(a!=null&&o instanceof a)return e(o)}for(var i=o;i!=null;){var d=Object.getPrototypeOf(i),u=d.constructor.name;if(u===r)return e(o);if(u==="Object")return t;i=d}return t}var ve=function(t){return function(e){return function(){return e[t]}}},tf=ve("URL"),ef=ve("documentURI"),nf=ve("origin"),rf=ve("compatMode"),of=ve("characterSet"),af=ve("contentType");var td=ve("documentElement");function Fa(t){return function(e){return function(){return e.createTextNode(t)}}}var ee=function(t){return function(e){return function(){return e[t]}}};var Ef=ee("baseURI"),rd=ee("ownerDocument"),Br=ee("parentNode"),od=ee("parentElement");var If=ee("childNodes"),ad=ee("firstChild"),sd=ee("lastChild"),id=ee("previousSibling"),ud=ee("nextSibling"),dd=ee("nodeValue");var Ff=ee("textContent");function Aa(t){return function(e){return function(){e.appendChild(t)}}}var Kn=function(t){return function(e){return function(){return e[t]}}},nm=Kn("children"),ld=Kn("firstElementChild"),pd=Kn("lastElementChild"),rm=Kn("childElementCount");function Sa(t){return function(e){return function(){return e.querySelector(t)}}}var wa=t=>{let e=Sa(t);return r=>{let o=e(r);return()=>{let a=o();return Ft(a,m,O)}}};function ze(t){return t.currentTarget}function Ra(t){return t.type}var Hr=function(){return window};function kr(t){return function(){return t.document}}var fn=Dr(mr)(dn),yd=Dr(Hn)(dn),hd=Vo(Ea(Wr))(ga),Dd=t=>e=>r=>{let o=r(e);return()=>{let a=o();return fn(a)(t.update(t))()}},Wa=t=>e=>{let r=t.node,o=t.vdom;return()=>{let a=o.value,i=r.value,d=Br(i)();return fn(Ft(d,m,O))(u=>{let $=Qn(e),p=ba(u)(i)(a)($)(l=>{let c=Ra(l);return fn(Ft(ze(l),m,O))(n=>{let s=Da(n)(c);return()=>{let _=s();return Dd(t)(l)(_)()}})});return()=>{let l=p();return r.value=l,o.value=$}})()}},bd=t=>e=>{let r=t.state;return()=>{let o=r.value,a=jn(o)(e);if(!a)return r.value=e,Wa(t)(t.view(e))();a||f()}},qa=t=>e=>r=>{let o=e.subscriptions;return hd(a=>{if(a.tag==="State")return Gt(se((()=>{let i=e.state;return()=>i.value})()))(i=>{let d=a._1(i),u=d._1;return Gt(se(bd(e)(d._2)))(()=>_e(u))});if(a.tag==="Lift")return a._1;if(a.tag==="Subscribe")return Gt(se(a._1(i=>{let d=Jn(qr,qa(t)(e)(t(i)));return()=>{d().run()}})))(i=>Gt(se((()=>{let d=e.freshId;return()=>{let u=d.value;return d.value=u+1|0,u}})()))(d=>Gt(se((()=>{let u=qn(Y)(d)(i);return()=>{let $=o.value;o.value=u($)}})()))(()=>_e(a._2(d)))));if(a.tag==="Unsubscribe"){let i=a._2,d=a._1;return Gt(se(()=>o.value))(u=>Gt(yd(ae(Y)(d)(u))(se))(()=>_e(i)))}f()})(r)},Td=t=>{let e=t.init.model,r=t.init.msg,o=t.selector,a=t.update,i=t.view;return()=>{let d=Hr(),u=kr(d)(),$=wa(o)(u)();return fn($.tag==="Just"?L("Just",$._1):m)(p=>()=>{let l={value:e},c=Hr(),n=kr(c)(),s=Fa("")(n)();Aa(s)(p)();let _={value:s},R={value:Ta(s)(q(""))},It={view:i,update:a,state:l,node:_,vdom:R,subscriptions:{value:W},freshId:{value:0}};return Wa(It)(i(e))(),fn(r)(It.update(It))()})()}};var va=t=>{let e=t.update;return Td({init:t.init,view:t.view,selector:t.selector,update:r=>o=>{let a=Jn(qr,qa(e)(r)(e(o)));return()=>{a().run()}}})};var Ur=function(t){return function(e){return t+e|0}};var Gr=function(t){return function(e){return t+e}};var Or=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},mn=function(t){return function(e){if(e===0)return 0;var r=Math.abs(e);return(t%r+r)%r}};var jr=isFinite;var Je=Math.floor;var Yn=function(t){return function(e){return t%e}};var Ja=Math.sin;var Ba=function(t){return function(e){return function(r){return(r|0)===r?t(r):e}}},K=function(t){return t},Ha=function(t){return function(e){return function(r){var o;r<11?o="[0-"+(r-1).toString()+"]":r===11?o="[0-9a]":o="[0-9a-"+String.fromCharCode(86+r)+"]";var a=new RegExp("^[\\+\\-]?"+o+"+$","i");return function(i){if(a.test(i)){var d=parseInt(i,r);return(d|0)===d?t(d):e}else return e}}}};var Nd=Ha(O)(m),Be=Nd(10),Vr=Ba(O)(m),Zn=t=>{if(!jr(t))return 0;if(t>=K(2147483647))return 2147483647;if(t<=K(-2147483648))return-2147483648;let e=Vr(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;f()};var ka=Math.random;var Ua=t=>e=>()=>{let r=ka();return Zn(Je((K(e)-K(t)+1)*r+K(t)))};var Kr=(()=>{let t=Ua(1)(2147483646);return()=>{let e=t();return(()=>{let r=mn(e)(2147483645);return r<1?r+2147483646|0:r})()}})();var Ga=t=>e=>{let r=Vr(Yn(K(48271)*K(e)+K(t))(K(2147483647)));if(r.tag==="Just")return r._1;f()};var ye=t=>({map:e=>r=>o=>t.map(a=>y(e(a._1),a._2))(r(o))});var nn=t=>{let e=t.Bind1().bind;return{bind:r=>o=>a=>e(r(a))(i=>o(i._1)(i._2)),Apply0:()=>Xn(t)}},Xn=t=>{let e=ye(t.Bind1().Apply0().Functor0());return{apply:(()=>{let r=nn(t).bind,o=ie(t).pure;return a=>i=>r(a)(d=>r(i)(u=>o(d(u))))})(),Functor0:()=>e}},ie=t=>{let e=t.Applicative0().pure;return{pure:r=>o=>e(y(r,o)),Apply0:()=>Xn(t)}};var Yr=t=>{let e=t.Monad0(),r=e.Bind1().bind,o=e.Applicative0().pure,a={Applicative0:()=>ie(e),Bind1:()=>nn(e)};return{tailRecM:i=>d=>u=>t.tailRecM($=>r(i($._1)($._2))(p=>o((()=>{if(p._1.tag==="Loop")return ht("Loop",y(p._1._1,p._2));if(p._1.tag==="Done")return ht("Done",y(p._1._1,p._2));f()})())))(y(d,u)),Monad0:()=>a}},Oa=t=>{let e=t.Applicative0().pure,r={Applicative0:()=>ie(t),Bind1:()=>nn(t)};return{state:o=>a=>e(o(a)),Monad0:()=>r}};function Id(t){return function(){return t.slice()}}var Zr=Id,Fd=function(){function t(e,r,o,a,i,d){var u,$,p,l,c,n,s;for(u=i+(d-i>>1),u-i>1&&t(e,r,a,o,i,u),d-u>1&&t(e,r,a,o,u,d),$=i,p=u,l=i;$<u&&p<d;)c=a[$],n=a[p],s=r(e(c)(n)),s>0?(o[l++]=n,++p):(o[l++]=c,++$);for(;$<u;)o[l++]=a[$++];for(;p<d;)o[l++]=a[p++]}return function(e){return function(r){return function(o){return function(){return o.length<2||t(e,r,o,o.slice(0),0,o.length),o}}}}}();var ke=function(t){return function(e){for(var r=e.length,o=Array(r),a=0;a<r;a++)o[a]=t(a)(e[a]);return o}};var he=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var ue=function(t){return function(e){for(var r=t>e?-1:1,o=new Array(r*(e-t)+1),a=t,i=0;a!==e;)o[i++]=a,a+=r;return o[i]=a,o}},Rd=function(t){return function(e){if(t<1)return[];var r=new Array(t);return r.fill(e)}},Pd=function(t){return function(e){for(var r=[],o=0,a=0;a<t;a++)r[o++]=e;return r}},tr=typeof Array.prototype.fill=="function"?Rd:Pd,Wd=function(){function t(a,i){this.head=a,this.tail=i}var e={};function r(a){return function(i){return new t(a,i)}}function o(a){for(var i=[],d=0,u=a;u!==e;)i[d++]=u.head,u=u.tail;return i}return function(a){return function(i){return o(a(r)(e)(i))}}}();var Va=function(t){return function(e){return function(r){return function(o){return o<0||o>=r.length?e:t(r[o])}}}};var Ka=function(t){return function(e){return function(r){return function(o){for(var a=0,i=o.length;a<i;a++)if(r(o[a]))return t(a);return e}}}};var Ya=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],r=0,o=t.length;r<o;r++)for(var a=t[r],i=0,d=a.length;i<d;i++)e.push(a[i]);return e},yn=function(t){return function(e){return e.filter(t)}};var Za=function(t){return function(e){return function(r){for(var o=r.length,a=e,i=new Array(o),d=0;d<o;d++)a=t(a)(r[d]),i[d]=a;return i}}};var Xa=function(){function t(e,r,o,a,i,d){var u,$,p,l,c,n,s;for(u=i+(d-i>>1),u-i>1&&t(e,r,a,o,i,u),d-u>1&&t(e,r,a,o,u,d),$=i,p=u,l=i;$<u&&p<d;)c=a[$],n=a[p],s=r(e(c)(n)),s>0?(o[l++]=n,++p):(o[l++]=c,++$);for(;$<u;)o[l++]=a[$++];for(;p<d;)o[l++]=a[p++]}return function(e){return function(r){return function(o){var a;return o.length<2?o:(a=o.slice(0),t(e,r,a,o.slice(0),0,o.length),a)}}}}();var er=function(t){return function(e){for(var r=e.length,o=0;o<r;o++)if(!t(e[o]))return!1;return!0}};var hn=t=>Xa(t)(e=>{if(e.tag==="GT")return 1;if(e.tag==="EQ")return 0;if(e.tag==="LT")return-1;f()});var es=t=>e=>(()=>{let r=Zr(t);return()=>{let o=r();return o.push(e),o}})()();var Ue=Va(O)(m);var Xr=Ka(O)(m);var nr=t=>e=>r=>{let o=Xr(a=>t.eq(a)(e))(r);if(o.tag==="Nothing")return!1;if(o.tag==="Just")return!0;f()};var ns=t=>e=>t.state(r=>y(void 0,e));var jd=function(){function t(d){this.fn=d}var e={},r=function(d,u){this.head=d,this.tail=u};function o(d){return new r(d,e)}function a(d){return function(u){return new r(d,u)}}function i(d){for(var u=[],$=d;$!==e;)u.push($.head),$=$.tail;return u}return function(d){return function(u){return function($){var p=function(c,n){return d(u(a)($(c)))(n)},l=function(c,n,s){if(n===0)return c;var _=s[n-1];return new t(function(){var R=l(p(_,c),n-1,s);return R})};return function(c){for(var n=u(o)($(c[c.length-1])),s=l(n,c.length-1,c);s instanceof t;)s=s.fn();return u(i)(s)}}}}}();var Kd=t=>Oa(t).state(e=>y(e.newSeed,{...e,newSeed:Ga(0)(e.newSeed)}));var Yd=t=>{let e=ye(t.Bind1().Apply0().Functor0()).map,r=Kd(t),o=Xn(t).apply;return a=>i=>{let d=K(i),u=K(a),$=e(K)(r);return e(p=>Zn(Je(u+Yn(p)(d-u+1))))(o(e(Gr)($))(e(p=>2*p)($)))}},as=t=>{let e=Yd(t);return r=>o=>r<=o?e(r)(o):e(o)(r)};var Xd=(()=>ie(Yt).pure)(),tc=(()=>ye(fe).map)(),ec=as(Yt);var to=t=>t.length===0?Xd(m):tc(e=>Ue(t)(e))(ec(0)(t.length-1|0)),rr=t=>{let e=100*Ja(K(t+1|0));return e-Je(e)},ss=(()=>{let t=ke(o=>a=>y(rr(o),a)),e=hn(o=>a=>Rr.compare(o._1)(a._1)),r=ut(Zt);return o=>r(e(t(o)))})();var eo=(t,e)=>({tag:"Graph",_1:t,_2:e}),nc=vn(Y)(oe),us=(()=>ie(Yt).pure)(),rc=vn(br(Y)(Y))(oe),oc=t=>e=>{let r=Y.compare(t)(e);if(r.tag==="LT")return e;if(r.tag==="EQ"||r.tag==="GT")return t;f()};var ds=t=>e=>eo(nc(ut(r=>y(r,re(e)(o=>re((r-o|0)>=0?[void 0]:[])(()=>[{edge:o-1|0,dest:r-o|0}]))))(ue(0)(t))),t),cs=t=>({width:800,height:400,position:e=>e===0?m:e<=8?L("Just",{x:K(e-1|0)*100,y:0}):L("Just",{x:K(e-9|0)*100,y:200}),legend:ut(e=>({edge:e-1|0,name:Z(e)}))(t)});var no=t=>e=>r=>{let o=ae(t)(r)(e);if(o.tag==="Nothing")return us(m);if(o.tag==="Just")return ye(fe).map(a=>a.tag==="Just"?L("Just",{edge:a._1.edge,dest:a._1.dest}):m)(to(o._1));f()},ac=t=>{let e=vn(t)(oe);return r=>o=>eo(e(ut(a=>y(r(a._1),ut(i=>({edge:i.edge,dest:r(i.dest)}))(a._2)))(Wn(tn)(o._1))),r(o._2))},sc=ac(Y),ro=t=>e=>r=>to(re((()=>{let o=ae(t)(r)(e);if(o.tag==="Nothing")return[];if(o.tag==="Just")return o._1;f()})())(o=>tr(o.nbBalls)({dest:o.dest,edge:o.edge}))),ls=t=>e=>{let r=Qe(()=>te.map(a=>Xe(i=>er(d=>{let u=ae(t)(d.dest)(r());if(u.tag==="Nothing")return!0;if(u.tag==="Just")return!Pe(u._1);f()})(a)))(e._1)),o=r();return te.map(Pe)(o)},ic=t=>e=>eo(rc(re(ue(0)(t-1|0))(r=>re(ue(0)(e-1|0))(o=>[y(y(r,o),yn(a=>a.dest._1>=0&&a.dest._2>=0)([{edge:0,dest:y(r-1|0,o)},{edge:1,dest:y(r-1|0,o-1|0)},{edge:2,dest:y(r,o-1|0)}]))]))),y(t-1|0,e-1|0)),ps=t=>e=>sc(r=>r._1+(r._2*t|0)|0)(ic(t)(e)),$s=t=>e=>{let r=oc(t)(e);return{width:180*r|0,height:180*r|0,position:o=>o===0?m:L("Just",{x:50+180*K(mn(o)(t)),y:10+180*K((e-Or(o)(t)|0)-1|0)}),legend:[{edge:0,name:"\u21D0"},{edge:1,name:"\u21D9"},{edge:2,name:"\u21D3"}]}},fs=t=>e=>r=>o=>(()=>{let a=ae(t)(o)(r);return a.tag==="Nothing"?!1:a.tag==="Just"?a._1:!1})()?no(t)(e)(o):us((()=>{let a=ae(t)(o)(e);if(a.tag==="Just"){let i=Xr(d=>{let u=ae(t)(d.dest)(r);return u.tag==="Nothing"?!1:u.tag==="Just"?u._1:!1})(a._1);return i.tag==="Just"?L("Just",{edge:a._1[i._1].edge,dest:a._1[i._1].dest}):m}if(a.tag==="Nothing")return m;f()})()),ms=t=>e=>r=>te.map(ut(o=>({edge:o.edge,dest:o.dest,nbBalls:e})))(r._1);var oo=t=>({tag:t}),xe=(t,e,r)=>({tag:t,_1:e,_2:r}),ao=t=>({tag:t}),uc=(()=>nn(Yt).bind)(),_s=(()=>ie(Yt).pure)(),dc=(()=>Yr(xo).tailRecM)(),cc=t=>e=>{let r=Y.compare(t)(e);if(r.tag==="LT")return e;if(r.tag==="EQ"||r.tag==="GT")return t;f()},ys=ao("Running"),hs=ao("IsStopping"),or=ao("Stopped");var so=oo("Random"),Ds=oo("Expert"),bs=oo("Machine");var Ts=t=>e=>nr(Re)(t)(e)?yn(r=>r!==t)(e):hn(Y.compare)(he([t])(e));var io=t=>{let e=(()=>{if(t.config.graphType.tag==="Substract")return ds(t.config.graphType._1)(t.config.graphType._2);if(t.config.graphType.tag==="King")return ps(t.config.graphType._1)(t.config.graphType._2);f()})();return{config:t.config,source:e._2,nbVictories:0,nbLosses:0,graphWithBalls:ms(Y)(t.config.ballsPerColor)(e),losingPositions:ls(Y)(e),status:or,gameResult:m}},Cs=io({config:{graphType:xe("Substract",8,[1,2]),adversary:so,ballsPerColor:6,reward:3,penalty:-1,machineStarts:!0},source:0,nbVictories:0,nbLosses:0,graphWithBalls:W,losingPositions:W,status:or,gameResult:m});var lc=t=>e=>{if(t.config.adversary.tag==="Random")return no(Y)(t.graphWithBalls)(e);if(t.config.adversary.tag==="Expert")return fs(Y)(t.graphWithBalls)(t.losingPositions)(e);if(t.config.adversary.tag==="Machine")return ro(Y)(t.graphWithBalls)(e);f()},pc=t=>dc(e=>{let r=e.isMachineTurn,o=e.moves,a=e.pos;return uc(r?ro(Y)(t.graphWithBalls)(a):lc(t)(a))(i=>{if(i.tag==="Nothing")return _s(ht("Done",{moves:o,win:!r}));if(i.tag==="Just")return _s(ht("Loop",{moves:es(o)({pos:a,edge:i._1.edge,isMachineTurn:r}),isMachineTurn:!r,pos:i._1.dest}));f()})})({moves:[],pos:t.source,isMachineTurn:t.config.machineStarts});var $c=t=>e=>{let r=e.win;return{config:t.config,source:t.source,nbVictories:r?t.nbVictories+1|0:t.nbVictories+0|0,nbLosses:r?t.nbLosses+0|0:t.nbLosses+1|0,graphWithBalls:te.map(o=>er(a=>a.nbBalls===0)(o)?ut(a=>({nbBalls:t.config.ballsPerColor,dest:a.dest,edge:a.edge}))(o):o)(Ye(o=>{let a=o.edge,i=o.isMachineTurn,d=ut(u=>a!==u.edge?u:{nbBalls:cc(0)((()=>!i&&(t.config.adversary.tag==="Random"||t.config.adversary.tag==="Expert"||t.config.adversary.tag!=="Machine")?u.nbBalls+0|0:r===i?u.nbBalls+t.config.reward|0:u.nbBalls+t.config.penalty|0)()),edge:u.edge,dest:u.dest});return la(Y)(u=>L("Just",d(u)))(o.pos)})(t.graphWithBalls)(e.moves)),losingPositions:t.losingPositions,status:t.status,gameResult:L("Just",{moves:e.moves,win:r})}},Ms=t=>ye(fe).map($c(t))(pc(t));var fc=t=>{let e=t.Apply0(),r=e.Functor0(),o={map:i=>{let d=r.map(i);return u=>$=>d(u($))}},a={apply:i=>d=>u=>e.apply(i(u))(d(u)),Functor0:()=>o};return{bind:i=>d=>u=>t.bind(i(u))($=>d($)(u)),Apply0:()=>a}};var mc=t=>{let e=t.Applicative0(),r=e.Apply0(),o=r.Functor0(),a={map:$=>{let p=o.map($);return l=>c=>p(l(c))}},i={apply:$=>p=>l=>r.apply($(l))(p(l)),Functor0:()=>a},d={pure:$=>{let p=e.pure($);return l=>p},Apply0:()=>i},u=fc(t.Bind1());return{Applicative0:()=>d,Bind1:()=>u}};var ar=t=>{let e=mc(t.Monad0());return{liftEffect:r=>{let o=t.liftEffect(r);return a=>o},Monad0:()=>e}};var xs=t=>e=>r=>{let o=r.Profunctor0().dimap;return a=>o(i=>y(t(i),d=>e(i)(d)))(i=>i._2(i._1))(r.first(a))};var Es=t=>()=>e=>r=>Te(t.reflectSymbol(e))(r);var uo=t=>()=>()=>e=>r=>xs(Es(t)()(e))(o=>a=>Oe(t.reflectSymbol(e))(a)(o))(r);var Is={liftAff:t=>t,MonadEffect0:()=>kn};var Fs=t=>{let e=ar(t.MonadEffect0());return{liftAff:r=>{let o=t.liftAff(r);return a=>o},MonadEffect0:()=>e}};var vt=(t,e)=>({tag:t,_1:e}),sr=vt("NextGame"),As=vt("RunMachine"),Ss=vt("StopMachine"),ws=t=>vt("SetGraphType",t),Rs=t=>vt("SetNbPigeonholes",t);var Ps=t=>vt("SetKingWidth",t),Ws=t=>vt("SetKingHeight",t),qs=t=>vt("SetAdversary",t),vs=t=>vt("SetReward",t),zs=t=>vt("SetPenalty",t),Js=t=>vt("SetBallsPerColor",t),Bs=t=>vt("SetMachineStarts",t);var ks=A(j("Bind",xt("Lift",_e),t=>A(j("Return",t),Q)),Q),Us=(()=>zr(ar(kn)).liftEffect)(),ir=A(j("Bind",xt("State",t=>y(t,t)),t=>A(j("Return",t),Q)),Q),Ic=(()=>{let t=xa(Fs(Is)).liftAff;return e=>t(Bn($e,e))})(),Fc=t=>A(ks._1,Tt(ks._2)(Mt("CatCons",e=>{let r=e.genModel,o=Us(()=>r.value);return A(o._1,Tt(o._2)(Mt("CatCons",a=>{let i=t(a),d=i._2,u=i._1,$=Us(()=>r.value=d);return A($._1,Tt($._2)(Mt("CatCons",()=>A(j("Return",u),Q),Dt(I,I))))},Dt(I,I))))},Dt(I,I)))),ur=uo({reflectSymbol:()=>"graphType"})()()(St)(pn),Ac=uo({reflectSymbol:()=>"config"})()()(St)(pn),de=t=>{let e=Ac(t);return A(j("Bind",xt("State",r=>y(void 0,io(e(r)))),r=>A(j("Return",r),Q)),Q)},co=t=>{if(t.tag==="RunMachine")return A(j("Bind",xt("State",e=>y(void 0,{...e,status:ys})),e=>A(j("Return",e),Q)),Tt(Q)(Mt("CatCons",()=>Sn.tailRecM(e=>A(ir._1,Tt(ir._2)(Mt("CatCons",r=>{if(r.status.tag!=="Running"){let a={...r,status:or};return A(j("Bind",xt("State",i=>y(void 0,a)),i=>A(j("Return",i),Q)),Tt(Q)(Mt("CatCons",()=>A(j("Return",ht("Done",void 0)),Q),Dt(I,I))))}let o=co(sr);return A(o._1,Tt(o._2)(Mt("CatCons",()=>{let a=Ic(500);return A(a._1,Tt(a._2)(Mt("CatCons",()=>A(j("Return",ht("Loop",void 0)),Q),Dt(I,I))))},Dt(I,I))))},Dt(I,I)))))(),Dt(I,I))));if(t.tag==="StopMachine")return A(j("Bind",xt("State",e=>y(void 0,{...e,status:hs})),e=>A(j("Return",e),Q)),Q);if(t.tag==="NextGame")return A(ir._1,Tt(ir._2)(Mt("CatCons",e=>{let r=Fc(Ms(e));return A(r._1,Tt(r._2)(Mt("CatCons",ns(Na),Dt(I,I))))},Dt(I,I))));if(t.tag==="SetGraphType"){let e=t._1;return de(r=>({graphType:e==="sub"?xe("Substract",8,[1,2]):xe("King",3,3),adversary:r.adversary,ballsPerColor:r.ballsPerColor,reward:r.reward,penalty:r.penalty,machineStarts:r.machineStarts}))}if(t.tag==="SetNbPigeonholes"){let e=t._1;return de(ur(r=>r.tag==="Substract"?xe("Substract",(()=>{let o=Be(e);if(o.tag==="Nothing")return 8;if(o.tag==="Just")return o._1;f()})(),r._2):r))}if(t.tag==="TogglePossibleMove"){let e=t._1;return de(ur(r=>r.tag==="Substract"?xe("Substract",r._1,Ts(e)(r._2)):r))}if(t.tag==="SetKingWidth"){let e=t._1;return de(ur(r=>r.tag==="King"?xe("King",(()=>{let o=Be(e);if(o.tag==="Nothing")return 3;if(o.tag==="Just")return o._1;f()})(),r._2):r))}if(t.tag==="SetKingHeight"){let e=t._1;return de(ur(r=>r.tag==="King"?xe("King",r._1,(()=>{let o=Be(e);if(o.tag==="Nothing")return 3;if(o.tag==="Just")return o._1;f()})()):r))}if(t.tag==="SetReward"){let e=t._1;return de(r=>({graphType:r.graphType,adversary:r.adversary,ballsPerColor:r.ballsPerColor,reward:(()=>{let o=Be(e);if(o.tag==="Nothing")return 3;if(o.tag==="Just")return o._1;f()})(),penalty:r.penalty,machineStarts:r.machineStarts}))}if(t.tag==="SetPenalty"){let e=t._1;return de(r=>({graphType:r.graphType,adversary:r.adversary,ballsPerColor:r.ballsPerColor,reward:r.reward,penalty:(()=>{let o=Be(e);if(o.tag==="Nothing")return-1;if(o.tag==="Just")return o._1;f()})(),machineStarts:r.machineStarts}))}if(t.tag==="SetAdversary"){let e=t._1;return de(r=>({graphType:r.graphType,adversary:(()=>e==="expert"?Ds:e==="machine"?bs:so)(),ballsPerColor:r.ballsPerColor,reward:r.reward,penalty:r.penalty,machineStarts:r.machineStarts}))}if(t.tag==="SetBallsPerColor"){let e=t._1;return de(r=>({graphType:r.graphType,adversary:r.adversary,ballsPerColor:(()=>{let o=Be(e);if(o.tag==="Nothing")return 6;if(o.tag==="Just")return o._1;f()})(),reward:r.reward,penalty:r.penalty,machineStarts:r.machineStarts}))}if(t.tag==="SetMachineStarts"){let e=t._1;return de(r=>({graphType:r.graphType,adversary:r.adversary,ballsPerColor:r.ballsPerColor,reward:r.reward,penalty:r.penalty,machineStarts:e==="y"}))}f()};var Gs=(()=>{let t=Lt("y");return e=>t(Bt(e))})();var Qs=(()=>{let t=Lt("x");return e=>t(Bt(e))})(),Os=Lt("width"),js=t=>e=>r=>o=>Lt("viewBox")(Z(t)+" "+Z(e)+" "+Z(r)+" "+Z(o)),Ct=Lt("value"),bn=Lt("type");var Vs=(()=>{let t=Lt("stroke-width");return e=>t(Bt(e))})();var lo=Lt("stroke");var Ks=(()=>{let t=Lt("r");return e=>t(Bt(e))})();var po=(()=>{let t=Lt("min");return e=>t(Z(e))})();var $o=(()=>{let t=Lt("max");return e=>t(Z(e))})();var Ys=Lt("height"),dr=Lt("fill");var Zs=Lt("d"),Xs=(()=>{let t=Lt("cy");return e=>t(Bt(e))})(),ti=(()=>{let t=Lt("cx");return e=>t(Bt(e))})();var ei=bt("svg"),Tn=bt("span"),an=bt("select");var Ee=bt("option");var ni=bt("label");var cr=bt("g");var X=bt("div");var lr=bt("button");function ri(t){return function(){return t.checked}}function oi(t){return function(){return t.value}}function ai(t){return function(){return t.value}}var si=t=>Ne("change")(e=>{let r=Ft(ze(e),m,O),o=(()=>{if(r.tag==="Just")return $n(m,O,"HTMLInputElement",r._1);if(r.tag==="Nothing")return m;f()})();if(o.tag==="Nothing")return()=>m;if(o.tag==="Just"){let a=ri(o._1);return()=>{let i=a();return L("Just",t(i))}}f()});var ce=t=>Ne("change")(e=>{let r=Ft(ze(e),m,O),o=(()=>{if(r.tag==="Just")return $n(m,O,"HTMLInputElement",r._1);if(r.tag==="Nothing")return m;f()})();if(o.tag==="Just"){let a=oi(o._1);return()=>{let i=a();return L("Just",t(i))}}if(o.tag==="Nothing"){let a=Ft(ze(e),m,O),i=(()=>{if(a.tag==="Just")return $n(m,O,"HTMLSelectElement",a._1);if(a.tag==="Nothing")return m;f()})();if(i.tag==="Nothing")return()=>m;if(i.tag==="Just"){let d=ai(i._1);return()=>{let u=d();return L("Just",t(u))}}f()}f()});var vc=t=>e=>{let r=Y.compare(t)(e);if(r.tag==="LT"||r.tag==="EQ")return t;if(r.tag==="GT")return e;f()},zc=Ze(Ur)(0),Jc=t=>e=>X([z("flex flex-row justify-between mt-4 mb-2")])([Tn([z("text-blue-600 font-bold")])([q("Victoires: "+Z(t))]),X([z("w-full bg-red-600 rounded-full h-6")])([X([z("h-6 bg-blue-600 rounded-l-full"),On("width")((()=>{let r=t+e|0;return Bt(r===0?50:K(t)/K(r)*100)+"%"})())])([])]),Tn([z("text-red-600 font-bold")])([q("D\xE9faites: "+Z(e))])]),fo="block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",go=["yellow","red","cyan","lightgreen","magenta"],Bc=t=>e=>r=>{let o=t.position(e);if(o.tag==="Just")return cr([On("transform")("translate("+Bt(o._1.x)+"px,"+Bt(o._1.y)+"px)")])([bt("path")([Zs("M1 1 L10 109 L90 109 L99 1"),Vs(3),lo("#000"),dr("transparent")])([]),cr([])((()=>{let a=Ya(ut(d=>tr(d.nbBalls)(d.edge))(r)),i=vc(105)(a.length);return ss(ke(d=>u=>bt("circle")([ti(15+rr(e+d|0)*71),Xs(100-rr((10+e|0)+d|0)*K(i)),Ks(5),dr((()=>{let $=Ue(go)(u);if($.tag==="Nothing")return"black";if($.tag==="Just")return $._1;f()})())])([]))(a))})()),cr([])((()=>{let a=K(zc(ut(i=>i.nbBalls)(r)));return ut(i=>bt("rect")([Qs(3+94*i.begin),Gs(115),Os(Bt(94*(i.end-i.begin))),Ys("20"),lo("black"),dr((()=>{let d=Ue(go)(i.edge);if(d.tag==="Nothing")return"black";if(d.tag==="Just")return d._1;f()})())])([]))(Za(i=>{let d=i.end;return u=>({begin:d,end:d+K(u.nbBalls)/a,edge:u.edge})})({begin:0,end:0,edge:-1})(r))})())]);if(o.tag==="Nothing")return Ca;f()},Hc=t=>e=>X([z("w-[42vw]")])([ei([js(0)(0)(t.width)(t.height)])(ut(r=>Bc(t)(r._1)(r._2))(Wn(tn)(e)))]),kc=t=>X([z("max-w rounded overflow-hidden shadow-lg p-4")])([X([z("font-bold text-xl mb-2")])([q("L\xE9gende")]),X([z("grid grid-cols-2 gap-4")])(re(t.legend)(e=>[X([z("inline w-12 h-12"),On("background-color")((()=>{let r=Ue(go)(e.edge);if(r.tag==="Nothing")return"black";if(r.tag==="Just")return r._1;f()})())])([]),Tn([z("text-2xl")])([q(" : "+e.name)])]))]),mo="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",Uc=t=>e=>X([z("max-w rounded overflow-hidden shadow-lg p-4")])([X([z("font-bold text-xl mb-2")])([q("Choix des param\xE8tres")]),X([z("grid grid-cols-2 gap-4")])(he([X([])([q("type de jeu")]),an([z("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct((()=>{if(t.graphType.tag==="Substract")return"sub";if(t.graphType.tag==="King")return"king";f()})()),ce(ws)])([Ee([Ct("sub")])([q("Soustraction")]),Ee([Ct("king")])([q("Roi")])])])(he((()=>{if(t.graphType.tag==="Substract"){let r=t.graphType._2;return[X([])([q("Nombre de casiers")]),an([z("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct(Z(t.graphType._1)),ce(Rs)])(ut(o=>Ee([Ct(Z(o))])([q(Z(o))]))(ue(8)(16))),X([])([q("Coups possibles")]),X([z("flex flex-row justify-between")])(ut(o=>ni([])([bt("input")([bn("checkbox"),Lt("checked")(nr(Re)(o)(r)),z("w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"),si(a=>vt("TogglePossibleMove",o))])([]),Tn([z("ml-2 text-sm font-medium text-gray-900")])([q(Z(o))])]))(ue(1)(5)))]}if(t.graphType.tag==="King")return[X([])([q("Hauteur de la grille")]),an([z("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct(Z(t.graphType._2)),ce(Ws)])(ut(r=>Ee([Ct(Z(r))])([q(Z(r))]))(ue(3)(6))),X([])([q("Largeur de la grille")]),an([z("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct(Z(t.graphType._1)),ce(Ps)])(ut(r=>Ee([Ct(Z(r))])([q(Z(r))]))(ue(3)(6)))];f()})())([X([])([q("Adversaire")]),bt("select")([z("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct((()=>{if(t.adversary.tag==="Expert")return"expert";if(t.adversary.tag==="Machine")return"machine";if(t.adversary.tag==="Random")return"random";f()})()),ce(qs)])([bt("option")([Ct("random")])([q("Al\xE9atoire")]),bt("option")([Ct("expert")])([q("Expert")]),bt("option")([Ct("machine")])([q("Machine")])]),X([])([q("Billes par couleur")]),bt("input")([bn("number"),z(fo),po(2),$o(10),Ct(Z(t.ballsPerColor)),ce(Js)])([]),X([])([q("R\xE9compense")]),bt("input")([bn("number"),z(fo),po(1),Ct(Z(t.reward)),ce(vs)])([]),X([])([q("P\xE9nalit\xE9")]),bt("input")([bn("number"),z(fo),$o(0),Ct(Z(t.penalty)),ce(zs)])([]),X([])([q("La machine commence")]),an([z("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Ct(t.machineStarts?"y":"n"),ce(Bs)])([Ee([Ct("y")])([q("Oui")]),Ee([Ct("n")])([q("Non")])]),e.tag==="Stopped"?lr([z(mo),Ne("click")(r=>()=>L("Just",As))])([q("Lancer la machine")]):lr([z(mo),Ne("click")(r=>()=>L("Just",Ss))])([q("Arr\xEAter la machine")]),lr([z(mo),Ne("click")(r=>()=>L("Just",sr))])([q("Pas \xE0 pas")])])))]),ii=t=>{let e=(()=>{if(t.config.graphType.tag==="Substract")return cs(t.config.graphType._2);if(t.config.graphType.tag==="King")return $s(t.config.graphType._1)(t.config.graphType._2);f()})();return X([z("w-screen flex flex-row justify-around")])([X([z("max-w rounded overflow-hidden shadow-lg p-4 mr-4")])([X([z("font-bold text-xl mb-2")])([q("Visualisation de la machine")]),X([z("flex flex-col")])([Hc(e)(t.graphWithBalls),Jc(t.nbVictories)(t.nbLosses)])]),kc(e),Uc(t.config)(t.status)])};var ui=()=>{let e={value:{newSeed:Kr(),size:0}};return va({init:{model:Cs,msg:m},view:ii,update:(()=>{let r=Ia(o=>o({genModel:e}));return o=>r(co(o))})(),selector:"#root"})()};ui();})();
