(()=>{function Ce(t){let e=0,n;return()=>{if(e===2)return n;if(e===1)throw new Error("Binding demanded before initialized");return e=1,n=t(),e=2,n}}function f(){throw new Error("Failed pattern match")}var Le=function(t){return function(e){return e[t]}},je=function(t){return function(e){return function(n){var a={};for(var o in n)({}).hasOwnProperty.call(n,o)&&(a[o]=n[o]);return a[t]=e,a}}};var ii=()=>({tag:"Proxy"}),St=ii();var rt=function(t){return t.toString()},re=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var lr=t=>({tag:t}),Wt=lr("LT"),Pt=lr("GT"),$e=lr("EQ");var b=(t,e)=>({tag:t,_1:e}),m=b("Nothing"),H=t=>b("Just",t);var bn=t=>{if(t.tag==="Nothing")return!0;if(t.tag==="Just")return!1;f()};var pr={compose:t=>e=>n=>t(e(n))};var ct=function(t){return function(e){for(var n=e.length,a=new Array(n),o=0;o<n;o++)a[o]=t(e[o]);return a}};var Mn=t=>t;var ae=function(t){return function(e){for(var n=[],a=0,o=t.length;a<o;a++)Array.prototype.push.apply(n,e(t[a]));return n}};var tt=(t,e)=>({tag:t,_1:e}),un=t=>tt("Left",t),Ot=t=>tt("Right",t);var dn={map:t=>e=>{if(e.tag==="Left")return tt("Left",e._1);if(e.tag==="Right")return tt("Right",t(e._1));f()}};var Cn=t=>t;var fe={map:t=>e=>t(e)};var Ca={apply:t=>e=>t(e),Functor0:()=>fe},fi={bind:t=>e=>e(t),Apply0:()=>Ca},mi={pure:Cn,Apply0:()=>Ca},Kt={Applicative0:()=>mi,Bind1:()=>fi};var La=function(t){return function(){return t}};var gi={apply:t=>e=>()=>{let n=t(),a=e();return $r.pure(n(a))()},Functor0:()=>_i},$r={pure:La,Apply0:()=>gi},_i={map:t=>e=>()=>{let n=e();return t(n)}};var Lt=(t,e)=>({tag:t,_1:e}),gr=t=>Lt("Loop",t),xa=t=>Lt("Done",t);var Na={tailRecM:t=>{let e=n=>{let a=n,o=!0,i;for(;o;){let d=a;if(d.tag==="Loop"){a=t(d._1);continue}if(d.tag==="Done"){o=!1,i=d._1;continue}f()}return i};return n=>e(t(n))},Monad0:()=>Kt};var Re=function(t){return function(e){return function(n){for(var a=e,o=n.length,i=o-1;i>=0;i--)a=t(n[i])(a);return a}}},Xe=function(t){return function(e){return function(n){for(var a=e,o=n.length,i=0;i<o;i++)a=t(a)(n[i]);return a}}};var _r=t=>{let e=t.Apply0(),n=e.Functor0().map;return a=>o=>a.foldr(i=>{let d=o(i);return u=>e.apply(n($=>Mn)(d))(u)})(t.pure())},Ln=t=>{let e=_r(t);return n=>{let a=e(n);return o=>i=>a(i)(o)}};var cn={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);f()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);f()},foldMap:t=>{let e=t.mempty;return n=>a=>{if(a.tag==="Nothing")return e;if(a.tag==="Just")return n(a._1);f()}}};var oe={foldr:Re,foldl:Xe,foldMap:t=>{let e=t.Semigroup0().append,n=t.mempty;return a=>oe.foldr(o=>i=>e(a(o))(i))(n)}};var _=(t,e)=>({tag:"Tuple",_1:t,_2:e});var Yt=t=>t._2;var Nn={map:t=>e=>_(e._1,t(e._2))};var Ie=t=>t._1;var In=t=>{let e=t.Eq0();return n=>{let a=n.Eq0(),o={eq:i=>d=>e.eq(i._1)(d._1)&&a.eq(i._2)(d._2)};return{compare:i=>d=>{let u=t.compare(i._1)(d._1);return u.tag==="LT"?Wt:u.tag==="GT"?Pt:n.compare(i._2)(d._2)},Eq0:()=>o}}};var S=(t,e,n)=>({tag:t,_1:e,_2:n});var W=S("Nil");var Aa=(()=>(e=>n=>{let a=e,o=n,i=!0,d;for(;i;){let u=a,$=o;if($.tag==="Nil"){i=!1,d=u;continue}if($.tag==="Cons"){a=S("Cons",$._1,u),o=$._2;continue}f()}return d})(W))();var Bi=function(){function t(o){return[o]}function e(o){return function(i){return[o,i]}}function n(o){return function(i){return function(d){return[o,i,d]}}}function a(o){return function(i){return o.concat(i)}}return function(o){return function(i){return function(d){return function(u){return function($){function l(p,c){switch(c-p){case 0:return d([]);case 1:return i(t)(u($[p]));case 2:return o(i(e)(u($[p])))(u($[p+1]));case 3:return o(o(i(n)(u($[p])))(u($[p+1])))(u($[p+2]));default:var r=p+Math.floor((c-p)/4)*2;return o(i(a)(l(p,r)))(l(r,c))}}return l(0,$.length)}}}}}}();var Tt=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var Ua=t=>{let e=t,n=!0,a;for(;n;){let o=e;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){n=!1,a=m;continue}e=Tt(Aa(o._2),W);continue}if(o._1.tag==="Cons"){n=!1,a=b("Just",_(o._1._1,Tt(o._1._2,o._2)));continue}f()}return a};var Et=(t,e,n)=>({tag:t,_1:e,_2:n}),V=Et("CatNil");var xt=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return Et("CatCons",t._1,Tt(t._2._1,S("Cons",e,t._2._2)));f()},mu=t=>e=>n=>{let a=i=>d=>u=>{let $=i,l=d,p=u,c=!0,r;for(;c;){let s=$,h=l,P=p;if(P.tag==="Nil"){c=!1,r=h;continue}if(P.tag==="Cons"){$=s,l=s(h)(P._1),p=P._2;continue}f()}return r};return(i=>d=>{let u=i,$=d,l=!0,p;for(;l;){let c=u,r=$,s=Ua(c);if(s.tag==="Nothing"){l=!1,p=a(h=>P=>P(h))(e)(r);continue}if(s.tag==="Just"){u=s._1._2,$=S("Cons",t(s._1._1),r);continue}f()}return p})(n)(W)},Ga=t=>{if(t.tag==="CatNil")return m;if(t.tag==="CatCons")return b("Just",_(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?V:mu(xt)(V)(t._2)));f()};var w=(t,e)=>({tag:"Free",_1:t,_2:e}),Y=(t,e,n)=>({tag:t,_1:e,_2:n});var Oa=t=>{let e=t,n=!0,a;for(;n;){let o=e;if(o._1.tag==="Return"){let i=Ga(o._2);if(i.tag==="Nothing"){n=!1,a=Y("Return",o._1._1);continue}if(i.tag==="Just"){e=(()=>{let d=i._1._1(o._1._1);return w(d._1,xt(d._2)(i._1._2))})();continue}f()}if(o._1.tag==="Bind"){n=!1,a=Y("Bind",o._1._1,i=>{let d=o._1._2(i);return w(d._1,xt(d._2)(o._2))});continue}f()}return a},Qa=t=>e=>{let n=e.Monad0(),a=n.Bind1().Apply0().Functor0().map,o=n.Applicative0().pure;return i=>e.tailRecM(d=>{let u=Oa(d);if(u.tag==="Return")return a(xa)(o(u._1));if(u.tag==="Bind")return a(gr)(i(t.map(u._2)(u._1)));f()})};var xr={Applicative0:()=>Sn,Bind1:()=>Nr},ja={map:t=>e=>Nr.bind(e)(n=>Sn.pure(t(n)))},Nr={bind:t=>e=>w(t._1,xt(t._2)(Et("CatCons",e,Tt(W,W)))),Apply0:()=>Ir},Ir={apply:t=>e=>w(t._1,xt(t._2)(Et("CatCons",n=>w(e._1,xt(e._2)(Et("CatCons",a=>Sn.pure(n(a)),Tt(W,W)))),Tt(W,W)))),Functor0:()=>ja},Sn={pure:t=>w(Y("Return",t),V),Apply0:()=>Ir};var gu=t=>{let e=n=>{let a=Oa(n);if(a.tag==="Return")return w(Y("Return",a._1),V);if(a.tag==="Bind"){let o=t(a._1);return w(o._1,xt(o._2)(Et("CatCons",i=>e(a._2(i)),Tt(W,W))))}f()};return e},Va=t=>gu(e=>w(Y("Bind",t(e),n=>w(Y("Return",n),V)),V));var Ka=function(t){return function(e){return t===e}};var Ya=Ka,Za=Ka;var Xa={eq:Za},We={eq:Ya};var tn=function(t){var e=null;return function(){return t===void 0||(e=t(),t=void 0),e}},Pe=function(t){return t()};var eo=function(t){return function(e){return function(n){return function(a){return function(o){return a<o?t:a===o?e:n}}}}};var no=eo,ro=eo;var Sr={compare:ro(Wt)($e)(Pt),Eq0:()=>Xa},X={compare:no(Wt)($e)(Pt),Eq0:()=>We};var oo=function(t){return function(e){return function(n){return function(a){return function(o){return function(i){for(var d=[],u=i;;){var $=o(u);d.push(n($));var l=a($);if(t(l))return d;u=e(l)}}}}}}};var bu=t=>{if(t.tag==="Just")return t._1;f()};var Ar={unfoldr1:oo(bn)(bu)(Ie)(Yt)};var io=function(t){return function(e){return function(n){return function(a){return function(o){return function(i){for(var d=[],u=i;;){var $=o(u);if(t($))return d;var l=e($);d.push(n(l)),u=a(l)}}}}}}};var Tu=t=>{if(t.tag==="Just")return t._1;f()};var qe={unfoldr:io(bn)(Tu)(Ie)(Yt),Unfoldable10:()=>Ar};var gt=function(t){throw new Error(t)};var wn=(t,e,n,a)=>({tag:"KickUp",_1:t,_2:e,_3:n,_4:a}),T=(t,e,n,a,o,i,d,u)=>({tag:t,_1:e,_2:n,_3:a,_4:o,_5:i,_6:d,_7:u}),at=(t,e,n,a,o,i,d)=>({tag:t,_1:e,_2:n,_3:a,_4:o,_5:i,_6:d});var z=T("Leaf");var Rn=t=>e=>{let n=a=>{let o=a,i=!0,d;for(;i;){let u=o;if(u.tag==="Nil"){i=!1,d=m;continue}if(u.tag==="Cons"){if(u._1.tag==="Leaf"){o=u._2;continue}if(u._1.tag==="Two"){if(u._1._1.tag==="Leaf"){if(u._1._4.tag==="Leaf"){i=!1,d=b("Just",_(_(u._1._2,u._1._3),u._2));continue}i=!1,d=b("Just",_(_(u._1._2,u._1._3),S("Cons",u._1._4,u._2)));continue}o=S("Cons",u._1._1,S("Cons",T("Two",z,u._1._2,u._1._3,z),S("Cons",u._1._4,u._2)));continue}if(u._1.tag==="Three"){o=S("Cons",u._1._1,S("Cons",T("Two",z,u._1._2,u._1._3,z),S("Cons",u._1._4,S("Cons",T("Two",z,u._1._5,u._1._6,z),S("Cons",u._1._7,u._2)))));continue}f()}f()}return d};return t.unfoldr(n)(S("Cons",e,W))};var Xt=t=>e=>a=>{let o=a,i=!0,d;for(;i;){let u=o;if(u.tag==="Leaf"){i=!1,d=m;continue}if(u.tag==="Two"){let $=t.compare(e)(u._2);if($.tag==="EQ"){i=!1,d=b("Just",u._3);continue}if($.tag==="LT"){o=u._1;continue}o=u._4;continue}if(u.tag==="Three"){let $=t.compare(e)(u._2);if($.tag==="EQ"){i=!1,d=b("Just",u._3);continue}let l=t.compare(e)(u._5);if(l.tag==="EQ"){i=!1,d=b("Just",u._6);continue}if($.tag==="LT"){o=u._1;continue}if(l.tag==="GT"){o=u._7;continue}o=u._4;continue}f()}return d};var Zt={map:t=>e=>{if(e.tag==="Leaf")return z;if(e.tag==="Two")return T("Two",Zt.map(t)(e._1),e._2,t(e._3),Zt.map(t)(e._4));if(e.tag==="Three")return T("Three",Zt.map(t)(e._1),e._2,t(e._3),Zt.map(t)(e._4),e._5,t(e._6),Zt.map(t)(e._7));f()}};var _t=t=>e=>n=>{let a=t,o=e,i=n,d=!0,u;for(;d;){let $=a,l=o,p=i;if(l.tag==="Nil"){d=!1,u=p;continue}if(l.tag==="Cons"){if(l._1.tag==="TwoLeft"){a=$,o=l._2,i=T("Two",p,l._1._1,l._1._2,l._1._3);continue}if(l._1.tag==="TwoRight"){a=$,o=l._2,i=T("Two",l._1._1,l._1._2,l._1._3,p);continue}if(l._1.tag==="ThreeLeft"){a=$,o=l._2,i=T("Three",p,l._1._1,l._1._2,l._1._3,l._1._4,l._1._5,l._1._6);continue}if(l._1.tag==="ThreeMiddle"){a=$,o=l._2,i=T("Three",l._1._1,l._1._2,l._1._3,p,l._1._4,l._1._5,l._1._6);continue}if(l._1.tag==="ThreeRight"){a=$,o=l._2,i=T("Three",l._1._1,l._1._2,l._1._3,l._1._4,l._1._5,l._1._6,p);continue}f()}f()}return u},Wn=t=>e=>n=>{let a=i=>d=>{let u=i,$=d,l=!0,p;for(;l;){let c=u,r=$;if(c.tag==="Nil"){l=!1,p=T("Two",r._1,r._2,r._3,r._4);continue}if(c.tag==="Cons"){if(c._1.tag==="TwoLeft"){l=!1,p=_t(t)(c._2)(T("Three",r._1,r._2,r._3,r._4,c._1._1,c._1._2,c._1._3));continue}if(c._1.tag==="TwoRight"){l=!1,p=_t(t)(c._2)(T("Three",c._1._1,c._1._2,c._1._3,r._1,r._2,r._3,r._4));continue}if(c._1.tag==="ThreeLeft"){u=c._2,$=wn(T("Two",r._1,r._2,r._3,r._4),c._1._1,c._1._2,T("Two",c._1._3,c._1._4,c._1._5,c._1._6));continue}if(c._1.tag==="ThreeMiddle"){u=c._2,$=wn(T("Two",c._1._1,c._1._2,c._1._3,r._1),r._2,r._3,T("Two",r._4,c._1._4,c._1._5,c._1._6));continue}if(c._1.tag==="ThreeRight"){u=c._2,$=wn(T("Two",c._1._1,c._1._2,c._1._3,c._1._4),c._1._5,c._1._6,T("Two",r._1,r._2,r._3,r._4));continue}f()}f()}return p};return(i=>d=>{let u=i,$=d,l=!0,p;for(;l;){let c=u,r=$;if(r.tag==="Leaf"){l=!1,p=a(c)(wn(z,e,n,z));continue}if(r.tag==="Two"){let s=t.compare(e)(r._2);if(s.tag==="EQ"){l=!1,p=_t(t)(c)(T("Two",r._1,e,n,r._4));continue}if(s.tag==="LT"){u=S("Cons",at("TwoLeft",r._2,r._3,r._4),c),$=r._1;continue}u=S("Cons",at("TwoRight",r._1,r._2,r._3),c),$=r._4;continue}if(r.tag==="Three"){let s=t.compare(e)(r._2);if(s.tag==="EQ"){l=!1,p=_t(t)(c)(T("Three",r._1,e,n,r._4,r._5,r._6,r._7));continue}let h=t.compare(e)(r._5);if(h.tag==="EQ"){l=!1,p=_t(t)(c)(T("Three",r._1,r._2,r._3,r._4,e,n,r._7));continue}if(s.tag==="LT"){u=S("Cons",at("ThreeLeft",r._2,r._3,r._4,r._5,r._6,r._7),c),$=r._1;continue}if(s.tag==="GT"){if(h.tag==="LT"){u=S("Cons",at("ThreeMiddle",r._1,r._2,r._3,r._5,r._6,r._7),c),$=r._4;continue}u=S("Cons",at("ThreeRight",r._1,r._2,r._3,r._4,r._5,r._6),c),$=r._7;continue}u=S("Cons",at("ThreeRight",r._1,r._2,r._3,r._4,r._5,r._6),c),$=r._7;continue}f()}return p})(W)},Mu=t=>e=>{let n=d=>u=>{let $=d,l=u,p=!0,c;for(;p;){let r=$,s=l;if(r.tag==="Nil"){p=!1,c=s;continue}if(r.tag==="Cons"){let h=r._2,P=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",T("Two",yt,et,it,ht),B,ut,T("Two",ot,st,U,Dt))),nt=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",T("Two",yt,et,it,ht),B,ut,T("Two",ot,st,U,Dt))),lt=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",T("Three",yt,et,it,ht,B,ut,ot),st,U,Dt)),Ft=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",T("Three",yt,et,it,ht,B,ut,ot),st,U,Dt)),ne=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",yt,et,it,T("Three",ht,B,ut,ot,st,U,Dt))),Qe=(yt,ht,ot,Dt,et,B,st,it,ut,U)=>_t(t)(h)(T("Two",yt,et,it,T("Three",ht,B,ut,ot,st,U,Dt))),C=(yt,ht,ot,Dt,et,B,st,it,ut,U,zt,jt,pe)=>_t(t)(h)(T("Three",T("Two",yt,B,U,ht),st,zt,T("Two",ot,it,jt,Dt),ut,pe,et)),Rt=(yt,ht,ot,Dt,et,B,st,it,ut,U,zt,jt,pe)=>_t(t)(h)(T("Three",T("Two",yt,B,U,ht),st,zt,T("Two",ot,it,jt,Dt),ut,pe,et)),Ae=(yt,ht,ot,Dt,et,B,st,it,ut,U,zt,jt,pe)=>_t(t)(h)(T("Three",yt,B,U,T("Two",ht,st,zt,ot),it,jt,T("Two",Dt,ut,pe,et))),on=(yt,ht,ot,Dt,et,B,st,it,ut,U,zt,jt,pe)=>_t(t)(h)(T("Three",yt,B,U,T("Two",ht,st,zt,ot),it,jt,T("Two",Dt,ut,pe,et)));if(s.tag==="Leaf"){if(r._1.tag==="TwoLeft"){if(r._1._3.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Two",z,r._1._1,r._1._2,z));continue}if(r._1._3.tag==="Two"){$=h,l=T("Three",s,r._1._1,r._1._2,r._1._3._1,r._1._3._2,r._1._3._3,r._1._3._4);continue}if(r._1._3.tag==="Three"){p=!1,c=P(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._1,r._1._3._2,r._1._3._5,r._1._2,r._1._3._3,r._1._3._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="TwoRight"){if(r._1._1.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Two",z,r._1._2,r._1._3,z));continue}if(r._1._1.tag==="Two"){$=h,l=T("Three",r._1._1._1,r._1._1._2,r._1._1._3,r._1._1._4,r._1._2,r._1._3,s);continue}if(r._1._1.tag==="Three"){p=!1,c=nt(r._1._1._1,r._1._1._4,r._1._1._7,s,r._1._1._2,r._1._1._5,r._1._2,r._1._1._3,r._1._1._6,r._1._3);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeLeft"){if(r._1._6.tag==="Leaf"){if(r._1._3.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Three",z,r._1._1,r._1._2,z,r._1._4,r._1._5,z));continue}if(r._1._3.tag==="Two"){p=!1,c=lt(s,r._1._3._1,r._1._3._4,r._1._6,r._1._1,r._1._3._2,r._1._4,r._1._2,r._1._3._3,r._1._5);continue}if(r._1._3.tag==="Three"){p=!1,c=C(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._6,r._1._1,r._1._3._2,r._1._3._5,r._1._4,r._1._2,r._1._3._3,r._1._3._6,r._1._5);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1._3.tag==="Two"){p=!1,c=lt(s,r._1._3._1,r._1._3._4,r._1._6,r._1._1,r._1._3._2,r._1._4,r._1._2,r._1._3._3,r._1._5);continue}if(r._1._3.tag==="Three"){p=!1,c=C(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._6,r._1._1,r._1._3._2,r._1._3._5,r._1._4,r._1._2,r._1._3._3,r._1._3._6,r._1._5);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeMiddle"){if(r._1._1.tag==="Leaf"){if(r._1._6.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Three",z,r._1._2,r._1._3,z,r._1._4,r._1._5,z));continue}if(r._1._6.tag==="Two"){p=!1,c=ne(r._1._1,s,r._1._6._1,r._1._6._4,r._1._2,r._1._4,r._1._6._2,r._1._3,r._1._5,r._1._6._3);continue}if(r._1._6.tag==="Three"){p=!1,c=Ae(r._1._1,s,r._1._6._1,r._1._6._4,r._1._6._7,r._1._2,r._1._4,r._1._6._2,r._1._6._5,r._1._3,r._1._5,r._1._6._3,r._1._6._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1._1.tag==="Two"){p=!1,c=Ft(r._1._1._1,r._1._1._4,s,r._1._6,r._1._1._2,r._1._2,r._1._4,r._1._1._3,r._1._3,r._1._5);continue}if(r._1._6.tag==="Two"){p=!1,c=ne(r._1._1,s,r._1._6._1,r._1._6._4,r._1._2,r._1._4,r._1._6._2,r._1._3,r._1._5,r._1._6._3);continue}if(r._1._1.tag==="Three"){p=!1,c=Rt(r._1._1._1,r._1._1._4,r._1._1._7,s,r._1._6,r._1._1._2,r._1._1._5,r._1._2,r._1._4,r._1._1._3,r._1._1._6,r._1._3,r._1._5);continue}if(r._1._6.tag==="Three"){p=!1,c=Ae(r._1._1,s,r._1._6._1,r._1._6._4,r._1._6._7,r._1._2,r._1._4,r._1._6._2,r._1._6._5,r._1._3,r._1._5,r._1._6._3,r._1._6._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeRight"){if(r._1._1.tag==="Leaf"){if(r._1._4.tag==="Leaf"){p=!1,c=_t(t)(h)(T("Three",z,r._1._2,r._1._3,z,r._1._5,r._1._6,z));continue}if(r._1._4.tag==="Two"){p=!1,c=Qe(r._1._1,r._1._4._1,r._1._4._4,s,r._1._2,r._1._4._2,r._1._5,r._1._3,r._1._4._3,r._1._6);continue}if(r._1._4.tag==="Three"){p=!1,c=on(r._1._1,r._1._4._1,r._1._4._4,r._1._4._7,s,r._1._2,r._1._4._2,r._1._4._5,r._1._5,r._1._3,r._1._4._3,r._1._4._6,r._1._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1._4.tag==="Two"){p=!1,c=Qe(r._1._1,r._1._4._1,r._1._4._4,s,r._1._2,r._1._4._2,r._1._5,r._1._3,r._1._4._3,r._1._6);continue}if(r._1._4.tag==="Three"){p=!1,c=on(r._1._1,r._1._4._1,r._1._4._4,r._1._4._7,s,r._1._2,r._1._4._2,r._1._4._5,r._1._5,r._1._3,r._1._4._3,r._1._4._6,r._1._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="TwoLeft"){if(r._1._3.tag==="Two"){$=h,l=T("Three",s,r._1._1,r._1._2,r._1._3._1,r._1._3._2,r._1._3._3,r._1._3._4);continue}if(r._1._3.tag==="Three"){p=!1,c=P(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._1,r._1._3._2,r._1._3._5,r._1._2,r._1._3._3,r._1._3._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="TwoRight"){if(r._1._1.tag==="Two"){$=h,l=T("Three",r._1._1._1,r._1._1._2,r._1._1._3,r._1._1._4,r._1._2,r._1._3,s);continue}if(r._1._1.tag==="Three"){p=!1,c=nt(r._1._1._1,r._1._1._4,r._1._1._7,s,r._1._1._2,r._1._1._5,r._1._2,r._1._1._3,r._1._1._6,r._1._3);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeLeft"){if(r._1._3.tag==="Two"){p=!1,c=lt(s,r._1._3._1,r._1._3._4,r._1._6,r._1._1,r._1._3._2,r._1._4,r._1._2,r._1._3._3,r._1._5);continue}if(r._1._3.tag==="Three"){p=!1,c=C(s,r._1._3._1,r._1._3._4,r._1._3._7,r._1._6,r._1._1,r._1._3._2,r._1._3._5,r._1._4,r._1._2,r._1._3._3,r._1._3._6,r._1._5);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeMiddle"){if(r._1._1.tag==="Two"){p=!1,c=Ft(r._1._1._1,r._1._1._4,s,r._1._6,r._1._1._2,r._1._2,r._1._4,r._1._1._3,r._1._3,r._1._5);continue}if(r._1._6.tag==="Two"){p=!1,c=ne(r._1._1,s,r._1._6._1,r._1._6._4,r._1._2,r._1._4,r._1._6._2,r._1._3,r._1._5,r._1._6._3);continue}if(r._1._1.tag==="Three"){p=!1,c=Rt(r._1._1._1,r._1._1._4,r._1._1._7,s,r._1._6,r._1._1._2,r._1._1._5,r._1._2,r._1._4,r._1._1._3,r._1._1._6,r._1._3,r._1._5);continue}if(r._1._6.tag==="Three"){p=!1,c=Ae(r._1._1,s,r._1._6._1,r._1._6._4,r._1._6._7,r._1._2,r._1._4,r._1._6._2,r._1._6._5,r._1._3,r._1._5,r._1._6._3,r._1._6._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}if(r._1.tag==="ThreeRight"){if(r._1._4.tag==="Two"){p=!1,c=Qe(r._1._1,r._1._4._1,r._1._4._4,s,r._1._2,r._1._4._2,r._1._5,r._1._3,r._1._4._3,r._1._6);continue}if(r._1._4.tag==="Three"){p=!1,c=on(r._1._1,r._1._4._1,r._1._4._4,r._1._4._7,s,r._1._2,r._1._4._2,r._1._4._5,r._1._5,r._1._3,r._1._4._3,r._1._4._6,r._1._6);continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}p=!1,c=gt("The impossible happened in partial function `up`.");continue}f()}return c},a=d=>u=>{let $=d,l=u,p=!0,c;for(;p;){let r=$,s=l;if(s.tag==="Two"){if(s._1.tag==="Leaf"){if(s._4.tag==="Leaf"){p=!1,c=n(r)(z);continue}$=S("Cons",at("TwoRight",s._1,s._2,s._3),r),l=s._4;continue}$=S("Cons",at("TwoRight",s._1,s._2,s._3),r),l=s._4;continue}if(s.tag==="Three"){if(s._1.tag==="Leaf"){if(s._4.tag==="Leaf"){if(s._7.tag==="Leaf"){p=!1,c=n(S("Cons",at("TwoRight",z,s._2,s._3),r))(z);continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}p=!1,c=gt("The impossible happened in partial function `removeMaxNode`.")}return c},o=d=>{let u=d,$=!0,l;for(;$;){let p=u;if(p.tag==="Two"){if(p._4.tag==="Leaf"){$=!1,l={key:p._2,value:p._3};continue}u=p._4;continue}if(p.tag==="Three"){if(p._7.tag==="Leaf"){$=!1,l={key:p._5,value:p._6};continue}u=p._7;continue}$=!1,l=gt("The impossible happened in partial function `maxNode`.")}return l};return(d=>u=>{let $=d,l=u,p=!0,c;for(;p;){let r=$,s=l;if(s.tag==="Leaf"){p=!1,c=m;continue}if(s.tag==="Two"){let h=t.compare(e)(s._2);if(h.tag==="EQ"){if(s._4.tag==="Leaf"){p=!1,c=b("Just",_(s._3,n(r)(z)));continue}let P=o(s._1);p=!1,c=b("Just",_(s._3,a(S("Cons",at("TwoLeft",P.key,P.value,s._4),r))(s._1)));continue}if(h.tag==="LT"){$=S("Cons",at("TwoLeft",s._2,s._3,s._4),r),l=s._1;continue}$=S("Cons",at("TwoRight",s._1,s._2,s._3),r),l=s._4;continue}if(s.tag==="Three"){let h=t.compare(e)(s._5),P=t.compare(e)(s._2);if((()=>s._1.tag==="Leaf"&&s._4.tag==="Leaf"?s._7.tag==="Leaf":!1)()){if(P.tag==="EQ"){p=!1,c=b("Just",_(s._3,_t(t)(r)(T("Two",z,s._5,s._6,z))));continue}if(h.tag==="EQ"){p=!1,c=b("Just",_(s._6,_t(t)(r)(T("Two",z,s._2,s._3,z))));continue}if(P.tag==="LT"){$=S("Cons",at("ThreeLeft",s._2,s._3,s._4,s._5,s._6,s._7),r),l=s._1;continue}if(P.tag==="GT"){if(h.tag==="LT"){$=S("Cons",at("ThreeMiddle",s._1,s._2,s._3,s._5,s._6,s._7),r),l=s._4;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}if(P.tag==="EQ"){let nt=o(s._1);p=!1,c=b("Just",_(s._3,a(S("Cons",at("ThreeLeft",nt.key,nt.value,s._4,s._5,s._6,s._7),r))(s._1)));continue}if(h.tag==="EQ"){let nt=o(s._4);p=!1,c=b("Just",_(s._6,a(S("Cons",at("ThreeMiddle",s._1,s._2,s._3,nt.key,nt.value,s._7),r))(s._4)));continue}if(P.tag==="LT"){$=S("Cons",at("ThreeLeft",s._2,s._3,s._4,s._5,s._6,s._7),r),l=s._1;continue}if(P.tag==="GT"){if(h.tag==="LT"){$=S("Cons",at("ThreeMiddle",s._1,s._2,s._3,s._5,s._6,s._7),r),l=s._4;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}$=S("Cons",at("ThreeRight",s._1,s._2,s._3,s._4,s._5,s._6),r),l=s._7;continue}f()}return c})(W)};var Pn=t=>e=>e.foldl(n=>a=>Wn(t)(a._1)(a._2)(n))(z);var Cu=t=>e=>n=>{let a=Mu(t)(e)(n);if(a.tag==="Nothing")return n;if(a.tag==="Just")return a._1._2;f()};var Lu=t=>e=>n=>a=>{let o=e(Xt(t)(n)(a));if(o.tag==="Nothing")return Cu(t)(n)(a);if(o.tag==="Just")return Wn(t)(n)(o._1)(a);f()};var wr=t=>e=>n=>a=>Lu(t)(o=>{if(o.tag==="Nothing")return m;if(o.tag==="Just")return e(o._1);f()})(n)(a);function wt(t,e,n){return t==null?e:n(t)}var kt=function(){var t={},e="Pure",n="Throw",a="Catch",o="Sync",i="Async",d="Bind",u="Bracket",$="Fork",l="Sequential",p="Map",c="Apply",r="Alt",s="Cons",h="Resume",P="Release",nt="Finalizer",lt="Finalized",Ft="Forked",ne="Fiber",Qe="Thunk";function C(D,k,pt,Q){this.tag=D,this._1=k,this._2=pt,this._3=Q}function Rt(D){var k=function(pt,Q,L){return new C(D,pt,Q,L)};return k.tag=D,k}function Ae(D){return new C(e,void 0)}function on(D){try{D()}catch(k){setTimeout(function(){throw k},0)}}function yt(D,k,pt){try{return k(pt())}catch(Q){return D(Q)}}function ht(D,k,pt){try{return k(pt)()}catch(Q){return pt(D(Q))(),Ae}}var ot=function(){var D=1024,k=0,pt=0,Q=new Array(D),L=!1;function g(){var O;for(L=!0;k!==0;)k--,O=Q[pt],Q[pt]=void 0,pt=(pt+1)%D,O();L=!1}return{isDraining:function(){return L},enqueue:function(O){var A,dt;k===D&&(dt=L,g(),L=dt),Q[(pt+k)%D]=O,k++,L||g()}}}();function Dt(D){var k={},pt=0,Q=0;return{register:function(L){var g=pt++;L.onComplete({rethrow:!0,handler:function(O){return function(){Q--,delete k[g]}}})(),k[g]=L,Q++},isEmpty:function(){return Q===0},killAll:function(L,g){return function(){if(Q===0)return g();var O=0,A={};function dt(K){A[K]=k[K].kill(L,function(mt){return function(){delete A[K],O--,D.isLeft(mt)&&D.fromLeft(mt)&&setTimeout(function(){throw D.fromLeft(mt)},0),O===0&&g()}})()}for(var Ct in k)k.hasOwnProperty(Ct)&&(O++,dt(Ct));return k={},pt=0,Q=0,function(K){return new C(o,function(){for(var mt in A)A.hasOwnProperty(mt)&&A[mt]()})}}}}}var et=0,B=1,st=2,it=3,ut=4,U=5,zt=6;function jt(D,k,pt){var Q=0,L=et,g=pt,O=null,A=null,dt=null,Ct=null,K=null,mt=0,we=0,Ut=null,Te=!0;function Me(x){for(var N,q,J;;)switch(N=null,q=null,J=null,L){case st:L=B;try{g=dt(g),Ct===null?dt=null:(dt=Ct._1,Ct=Ct._2)}catch(It){L=U,O=D.left(It),g=null}break;case it:D.isLeft(g)?(L=U,O=g,g=null):dt===null?L=U:(L=st,g=D.fromRight(g));break;case B:switch(g.tag){case d:dt&&(Ct=new C(s,dt,Ct)),dt=g._2,L=B,g=g._1;break;case e:dt===null?(L=U,g=D.right(g._1)):(L=st,g=g._1);break;case o:L=it,g=yt(D.left,D.right,g._1);break;case i:L=ut,g=ht(D.left,g._1,function(It){return function(){Q===x&&(Q++,ot.enqueue(function(){Q===x+1&&(L=it,g=It,Me(Q))}))}});return;case n:L=U,O=D.left(g._1),g=null;break;case a:dt===null?K=new C(s,g,K,A):K=new C(s,g,new C(s,new C(h,dt,Ct),K,A),A),dt=null,Ct=null,L=B,g=g._1;break;case u:mt++,dt===null?K=new C(s,g,K,A):K=new C(s,g,new C(s,new C(h,dt,Ct),K,A),A),dt=null,Ct=null,L=B,g=g._1;break;case $:L=it,N=jt(D,k,g._2),k&&k.register(N),g._1&&N.run(),g=D.right(N);break;case l:L=B,g=oi(D,k,g._1);break}break;case U:if(dt=null,Ct=null,K===null)L=zt,g=A||O||g;else switch(N=K._3,J=K._1,K=K._2,J.tag){case a:A&&A!==N&&mt===0?L=U:O&&(L=B,g=J._2(D.fromLeft(O)),O=null);break;case h:A&&A!==N&&mt===0||O?L=U:(dt=J._1,Ct=J._2,L=st,g=D.fromRight(g));break;case u:mt--,O===null&&(q=D.fromRight(g),K=new C(s,new C(P,J._2,q),K,N),(A===N||mt>0)&&(L=B,g=J._3(q)));break;case P:K=new C(s,new C(lt,g,O),K,A),L=B,A&&A!==N&&mt===0?g=J._1.killed(D.fromLeft(A))(J._2):O?g=J._1.failed(D.fromLeft(O))(J._2):g=J._1.completed(D.fromRight(g))(J._2),O=null,mt++;break;case nt:mt++,K=new C(s,new C(lt,g,O),K,A),L=B,g=J._1;break;case lt:mt--,L=U,g=J._1,O=J._2;break}break;case zt:for(var ft in Ut)Ut.hasOwnProperty(ft)&&(Te=Te&&Ut[ft].rethrow,on(Ut[ft].handler(g)));Ut=null,A&&O?setTimeout(function(){throw D.fromLeft(O)},0):D.isLeft(g)&&Te&&setTimeout(function(){if(Te)throw D.fromLeft(g)},0);return;case et:L=B;break;case ut:return}}function $t(x){return function(){if(L===zt)return Te=Te&&x.rethrow,x.handler(g)(),function(){};var N=we++;return Ut=Ut||{},Ut[N]=x,function(){Ut!==null&&delete Ut[N]}}}function I(x,N){return function(){if(L===zt)return N(D.right(void 0))(),function(){};var q=$t({rethrow:!1,handler:function(){return N(D.right(void 0))}})();switch(L){case et:A=D.left(x),L=zt,g=A,Me(Q);break;case ut:A===null&&(A=D.left(x)),mt===0&&(L===ut&&(K=new C(s,new C(nt,g(x)),K,A)),L=U,g=null,O=null,Me(++Q));break;default:A===null&&(A=D.left(x)),mt===0&&(L=U,g=null,O=null)}return q}}function R(x){return function(){var N=$t({rethrow:!1,handler:x})();return L===et&&Me(Q),N}}return{kill:I,join:R,onComplete:$t,isSuspended:function(){return L===et},run:function(){L===et&&(ot.isDraining()?Me(Q):ot.enqueue(function(){Me(Q)}))}}}function pe(D,k,pt,Q){var L=0,g={},O=0,A={},dt=new Error("[ParAff] Early exit"),Ct=null,K=t;function mt($t,I,R){var x=I,N=null,q=null,J=0,ft={},It,sn;t:for(;;)switch(It=null,x.tag){case Ft:if(x._3===t&&(It=g[x._1],ft[J++]=It.kill($t,function(si){return function(){J--,J===0&&R(si)()}})),N===null)break t;x=N._2,q===null?N=null:(N=q._1,q=q._2);break;case p:x=x._2;break;case c:case r:N&&(q=new C(s,N,q)),N=x,x=x._1;break}if(J===0)R(D.right(void 0))();else for(sn=0,It=J;sn<It;sn++)ft[sn]=ft[sn]();return ft}function we($t,I,R){var x,N,q,J,ft,It;D.isLeft($t)?(x=$t,N=null):(N=$t,x=null);t:for(;;){if(q=null,J=null,ft=null,It=null,Ct!==null)return;if(I===null){Q(x||N)();return}if(I._3!==t)return;switch(I.tag){case p:x===null?(I._3=D.right(I._1(D.fromRight(N))),N=I._3):I._3=x;break;case c:if(q=I._1._3,J=I._2._3,x){if(I._3=x,ft=!0,It=O++,A[It]=mt(dt,x===q?I._2:I._1,function(){return function(){delete A[It],ft?ft=!1:R===null?we(x,null,null):we(x,R._1,R._2)}}),ft){ft=!1;return}}else{if(q===t||J===t)return;N=D.right(D.fromRight(q)(D.fromRight(J))),I._3=N}break;case r:if(q=I._1._3,J=I._2._3,q===t&&D.isLeft(J)||J===t&&D.isLeft(q))return;if(q!==t&&D.isLeft(q)&&J!==t&&D.isLeft(J))x=N===q?J:q,N=null,I._3=x;else if(I._3=N,ft=!0,It=O++,A[It]=mt(dt,N===q?I._2:I._1,function(){return function(){delete A[It],ft?ft=!1:R===null?we(N,null,null):we(N,R._1,R._2)}}),ft){ft=!1;return}break}R===null?I=null:(I=R._1,R=R._2)}}function Ut($t){return function(I){return function(){delete g[$t._1],$t._3=I,we(I,$t._2._1,$t._2._2)}}}function Te(){var $t=B,I=pt,R=null,x=null,N,q;t:for(;;)switch(N=null,q=null,$t){case B:switch(I.tag){case p:R&&(x=new C(s,R,x)),R=new C(p,I._1,t,t),I=I._2;break;case c:R&&(x=new C(s,R,x)),R=new C(c,t,I._2,t),I=I._1;break;case r:R&&(x=new C(s,R,x)),R=new C(r,t,I._2,t),I=I._1;break;default:q=L++,$t=U,N=I,I=new C(Ft,q,new C(s,R,x),t),N=jt(D,k,N),N.onComplete({rethrow:!1,handler:Ut(I)})(),g[q]=N,k&&k.register(N)}break;case U:if(R===null)break t;R._1===t?(R._1=I,$t=B,I=R._2,R._2=t):(R._2=I,I=R,x===null?R=null:(R=x._1,x=x._2))}for(K=I,q=0;q<L;q++)g[q].run()}function Me($t,I){Ct=D.left($t);var R;for(var x in A)if(A.hasOwnProperty(x)){R=A[x];for(x in R)R.hasOwnProperty(x)&&R[x]()}A=null;var N=mt($t,K,I);return function(q){return new C(i,function(J){return function(){for(var ft in N)N.hasOwnProperty(ft)&&N[ft]();return Ae}})}}return Te(),function($t){return new C(i,function(I){return function(){return Me($t,I)}})}}function oi(D,k,pt){return new C(i,function(Q){return function(){return pe(D,k,pt,Q)}})}return C.EMPTY=t,C.Pure=Rt(e),C.Throw=Rt(n),C.Catch=Rt(a),C.Sync=Rt(o),C.Async=Rt(i),C.Bind=Rt(d),C.Bracket=Rt(u),C.Fork=Rt($),C.Seq=Rt(l),C.ParMap=Rt(p),C.ParApply=Rt(c),C.ParAlt=Rt(r),C.Fiber=jt,C.Supervisor=Dt,C.Scheduler=ot,C.nonCanceler=Ae,C}(),ye=kt.Pure,wu=kt.Throw;function po(t){return function(e){return e.tag===kt.Pure.tag?kt.Pure(t(e._1)):kt.Bind(e,function(n){return kt.Pure(t(n))})}}function Ht(t){return function(e){return kt.Bind(t,e)}}var se=kt.Sync;var Ru=kt.Async;function qn(t,e){return function(){return kt.Fiber(t,null,e)}}var Rr=function(){function t(n,a){return n===0&&typeof setImmediate<"u"?setImmediate(a):setTimeout(a,n)}function e(n,a){return n===0&&typeof clearImmediate<"u"?clearImmediate(a):clearTimeout(a)}return function(n,a){return kt.Async(function(o){return function(){var i=t(a,o(n()));return function(){return kt.Sync(function(){return n(e(a,i))})}}})}}(),Wu=kt.Seq;var Wr={map:po};var Pr={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;f()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return gt("unsafeFromLeft: Right");f()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return gt("unsafeFromRight: Left");f()},left:un,right:Ot};var $o={Applicative0:()=>vn,Bind1:()=>Pu},Pu={bind:Ht,Apply0:()=>fo},fo={apply:t=>e=>Ht(t)(n=>Ht(e)(a=>vn.pure(n(a)))),Functor0:()=>Wr},vn={pure:ye,Apply0:()=>fo};var zn={liftEffect:se,Monad0:()=>$o};var mo={tailRecM:t=>{let e=n=>Ht(t(n))(a=>{if(a.tag==="Done")return ye(a._1);if(a.tag==="Loop")return e(a._1);f()});return e},Monad0:()=>$o};var qu=(t,e)=>({...t,...e}),go=(t,e)=>t&&e?n=>t(e(n)):t||e,_o=(t,e,n,a,o,i)=>{if(e[0]==="o"&&e[1]==="n"){let d=e.slice(2);t.actions||(t.actions={}),t.actions[d]=i&&a?i(a):a,a?n||t.addEventListener(d,o):t.removeEventListener(d,o)}else a==null||a===!1||e==="class"&&!a?t.removeAttribute(e):t.setAttribute(e,a)},Jn=(t,e,n,a)=>{let o=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),i=t.props,d=go(a,t.mapf);for(let u in i)_o(o,u,null,i[u],e,d);for(let u=0,$=t.children.length;u<$;u++)o.appendChild(Jn(ze(t.children[u]).html,e,n,d));return t.node=o,o},ve=(t,e,n,a,o,i,d)=>{if(n!==a)if(n!=null&&n.type===3&&a.type===3)n.tag!==a.tag&&(e.nodeValue=a.tag);else if(n==null||n.tag!==a.tag)e=t.insertBefore(Jn(a,o,i,d),e),n&&n.node.remove();else{let u=n.props,$=a.props,l=n.children,p=a.children,c=l.length-1,r=p.length-1;d=go(d,a.mapf),i=i||a.tag==="svg";for(let s in qu(u,$))_o(e,s,u[s],$[s],o,d);if(a.keyed){let s=0,h=0;for(;h<=r&&s<=c;){let{key:P,html:nt}=l[s];if(P!==p[h].key)break;let lt=ze(p[h],nt);ve(e,nt.node,nt,lt.html,o,i,d),h++,s++}for(;h<=r&&s<=c;){let{key:P,html:nt}=l[c];if(P!==p[r].key)break;let lt=ze(p[r],nt);ve(e,nt.node,nt,lt.html,o,i,d),r--,c--}if(s>c)for(;h<=r;){let P=ze(p[h]).html;e.insertBefore(Jn(P,o,i,d),l[s]&&l[s].html.node),h++}else if(h>r)for(;s<=c;)l[s].html.node.remove(),s++;else{let P={},nt={};for(let lt=s;lt<=c;lt++)P[l[lt].key]=l[lt].html;for(;h<=r;){let{key:lt,html:Ft}=l[s]||{key:null,html:null},{key:ne,html:Qe}=ze(p[h],Ft);if(nt[lt]||l[s+1]&&ne===l[s+1].key){s++;continue}if(lt===ne)ve(e,Ft.node,Ft,Qe,o,i,d),nt[ne]=!0,s++;else{let C=P[ne];C!=null?(ve(e,e.insertBefore(C.node,Ft.node),C,p[h].html,o,i,d),nt[ne]=!0):ve(e,Ft&&Ft.node,null,p[h].html,o,i,d)}h++}for(let lt in P)nt[lt]||P[lt].node.remove()}}else{for(let s=0;s<=c&&s<=r;s++){let h=l[s].html,P=ze(p[s],h).html;ve(e,h.node,h,P,o,i,d)}for(let s=c+1;s<=r;s++){let h=ze(p[s],n).html;e.appendChild(Jn(h,o,i,d))}for(let s=r+1;s<=c;s++)l[s].html.node.remove()}}return a.node=e,e},vu=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},ze=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||vu(e.memo,t.html.memo))&&(e=Bn(t.html.type(...t.html.memo)),e.memo=t.html.memo),t.html=e),t),Bn=t=>({...t,children:t.children&&t.children.map(({key:e,html:n})=>({key:e,html:Bn(n)}))}),yo=(t,e)=>t.actions[e],ho=ve,Do=t=>e=>(e.node=t,e);var Ju=(t,e,n,a=!1)=>{let o=[],i={},d={tag:t,children:n,props:i,node:null,keyed:a},u=e.length;for(let $=0;$<u;$++){let[l,p,c]=e[$];l==1?i[p]=c:l===2?i.class=i.class?i.class+" "+p:p:l===3&&o.push(p+":"+c)}return i.style=o.join(";"),d},M=(t,e,n)=>Ju(t,e,n.map(a=>({key:null,html:a})));var Bu=t=>({tag:t,props:{},children:[],type:3});var F=(t,e)=>[1,t,e],j=t=>[2,t];var ie=(t,e)=>[1,"on"+t,e],kn=(t,e)=>[3,t,e],G=Bu;var Hn=(t,e,n)=>({memo:[e,n],type:t});var bo=G("");var vr={identity:t=>t,Semigroupoid0:()=>pr};var Gn={dimap:t=>e=>n=>a=>e(n(t(a)))};var ku=t=>t,he=(()=>({first:t=>e=>_(t(e._1),e._2),second:Nn.map,Profunctor0:()=>Gn}))();var zr=t=>{let e=t.identity,n=t.Semigroupoid0(),a=t.Semigroupoid0();return o=>{let i=o.Profunctor0().dimap;return d=>u=>n.compose(a.compose(o.second(u))(o.first(d)))(i(ku)($=>_($,$))(e))}};function jn(t){return function(e){return t===e}}var Mt=(t,e,n)=>({tag:t,_1:e,_2:n});var Jr={state:t=>w(Y("Bind",Mt("State",t),e=>w(Y("Return",e),V)),V),Monad0:()=>xr};var Br=t=>({liftEffect:e=>w(Y("Bind",Mt("Lift",t.liftEffect(e)),n=>w(Y("Return",n),V)),V),Monad0:()=>xr});var Co=t=>{let e=Br(t.MonadEffect0());return{liftAff:n=>w(Y("Bind",Mt("Lift",t.liftAff(n)),a=>w(Y("Return",a),V)),V),MonadEffect0:()=>e}},Lo=t=>({map:e=>n=>{if(n.tag==="State")return Mt("State",a=>{let o=n._1(a);return _(e(o._1),o._2)});if(n.tag==="Lift")return Mt("Lift",t.map(e)(n._1));if(n.tag==="Subscribe")return Mt("Subscribe",n._1,a=>e(n._2(a)));if(n.tag==="Unsubscribe")return Mt("Unsubscribe",n._1,e(n._2));f()}});var xo=t=>e=>Va(n=>{if(n.tag==="State")return Mt("State",n._1);if(n.tag==="Lift")return Mt("Lift",t(n._1));if(n.tag==="Subscribe")return Mt("Subscribe",n._1,n._2);if(n.tag==="Unsubscribe")return Mt("Unsubscribe",n._1,n._2);f()})(e);function fn(t,e,n,a){if(typeof window<"u"){var o=window[n];if(o!=null&&a instanceof o)return e(a)}for(var i=a;i!=null;){var d=Object.getPrototypeOf(i),u=d.constructor.name;if(u===n)return e(a);if(u==="Object")return t;i=d}return t}var Je=function(t){return function(e){return function(){return e[t]}}},af=Je("URL"),of=Je("documentURI"),sf=Je("origin"),uf=Je("compatMode"),df=Je("characterSet"),cf=Je("contentType");var Gu=Je("documentElement");function No(t){return function(e){return function(){return e.createTextNode(t)}}}var te=function(t){return function(e){return function(){return e[t]}}};var Af=te("baseURI"),ju=te("ownerDocument"),Hr=te("parentNode"),Vu=te("parentElement");var wf=te("childNodes"),Ku=te("firstChild"),Yu=te("lastChild"),Zu=te("previousSibling"),Xu=te("nextSibling"),td=te("nodeValue");var Rf=te("textContent");function Io(t){return function(e){return function(){e.appendChild(t)}}}var Kn=function(t){return function(e){return function(){return e[t]}}},sm=Kn("children"),nd=Kn("firstElementChild"),rd=Kn("lastElementChild"),im=Kn("childElementCount");function Eo(t){return function(e){return function(){return e.querySelector(t)}}}var So=t=>{let e=Eo(t);return n=>{let a=e(n);return()=>{let o=a();return wt(o,m,H)}}};function Be(t){return t.currentTarget}function Ao(t){return t.type}var Ur=function(){return window};function Gr(t){return function(){return t.document}}var mn=Ln($r)(cn),ud=Ln(vn)(cn),dd=Qa(Lo(Wr))(mo),cd=t=>e=>n=>{let a=n(e);return()=>{let o=a();return mn(o)(t.update(t))()}},Ro=t=>e=>{let n=t.node,a=t.vdom;return()=>{let o=a.value,i=n.value,d=Hr(i)();return mn(wt(d,m,H))(u=>{let $=Bn(e);return()=>{let l=ho(u,i,o,$,p=>{let c=Ao(p);return mn(wt(Be(p),m,H))(r=>()=>{let s=yo(r,c);return cd(t)(p)(s)()})()});return n.value=l,a.value=$}})()}},ld=t=>e=>{let n=t.state;return()=>{let a=n.value,o=jn(a)(e);if(!o)return n.value=e,Ro(t)(t.view(e))();o||f()}},Wo=t=>e=>n=>{let a=e.subscriptions;return dd(o=>{if(o.tag==="State")return Ht(se((()=>{let i=e.state;return()=>i.value})()))(i=>{let d=o._1(i),u=d._1;return Ht(se(ld(e)(d._2)))(()=>ye(u))});if(o.tag==="Lift")return o._1;if(o.tag==="Subscribe")return Ht(se(o._1(i=>{let d=qn(Pr,Wo(t)(e)(t(i)));return()=>{d().run()}})))(i=>Ht(se((()=>{let d=e.freshId;return()=>{let u=d.value;return d.value=u+1|0,u}})()))(d=>Ht(se((()=>{let u=Wn(X)(d)(i);return()=>{let $=a.value;a.value=u($)}})()))(()=>ye(o._2(d)))));if(o.tag==="Unsubscribe"){let i=o._2,d=o._1;return Ht(se(()=>a.value))(u=>Ht(ud(Xt(X)(d)(u))(se))(()=>ye(i)))}f()})(n)},pd=t=>{let e=t.init.model,n=t.init.msg,a=t.selector,o=t.update,i=t.view;return()=>{let d=Ur(),u=Gr(d)(),$=So(a)(u)();return mn($.tag==="Just"?b("Just",$._1):m)(l=>()=>{let p={value:e},c=Ur(),r=Gr(c)(),s=No("")(r)();Io(s)(l)();let h={value:s},P={value:Do(s)(G(""))},Ft={view:i,update:o,state:p,node:h,vdom:P,subscriptions:{value:z},freshId:{value:0}};return Ro(Ft)(i(e))(),mn(n)(Ft.update(Ft))()})()}};var Po=t=>{let e=t.update;return pd({init:t.init,view:t.view,selector:t.selector,update:n=>a=>{let o=qn(Pr,Wo(e)(n)(e(a)));return()=>{o().run()}}})};var Or=function(t){return function(e){return t+e|0}};var Qr=function(t){return function(e){return t+e}};var Vr=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},gn=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var Kr=isFinite;var ke=Math.floor;var Yn=function(t){return function(e){return t%e}};var vo=Math.sin;var zo=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},Z=function(t){return t},Jo=function(t){return function(e){return function(n){var a;n<11?a="[0-"+(n-1).toString()+"]":n===11?a="[0-9a]":a="[0-9a-"+String.fromCharCode(86+n)+"]";var o=new RegExp("^[\\+\\-]?"+a+"+$","i");return function(i){if(o.test(i)){var d=parseInt(i,n);return(d|0)===d?t(d):e}else return e}}}};var gd=Jo(H)(m),He=gd(10),Yr=zo(H)(m),Zn=t=>{if(!Kr(t))return 0;if(t>=Z(2147483647))return 2147483647;if(t<=Z(-2147483648))return-2147483648;let e=Yr(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;f()};var Bo=Math.random;var ko=t=>e=>()=>{let n=Bo();return Zn(ke((Z(e)-Z(t)+1)*n+Z(t)))};var Zr=(()=>{let t=ko(1)(2147483646);return()=>{let e=t();return(()=>{let n=gn(e)(2147483645);return n<1?n+2147483646|0:n})()}})();var Ho=t=>e=>{let n=Yr(Yn(Z(48271)*Z(e)+Z(t))(Z(2147483647)));if(n.tag==="Just")return n._1;f()};var De=t=>({map:e=>n=>a=>t.map(o=>_(e(o._1),o._2))(n(a))});var nn=t=>{let e=t.Bind1().bind;return{bind:n=>a=>o=>e(n(o))(i=>a(i._1)(i._2)),Apply0:()=>Xn(t)}},Xn=t=>{let e=De(t.Bind1().Apply0().Functor0());return{apply:(()=>{let n=nn(t).bind,a=ue(t).pure;return o=>i=>n(o)(d=>n(i)(u=>a(d(u))))})(),Functor0:()=>e}},ue=t=>{let e=t.Applicative0().pure;return{pure:n=>a=>e(_(n,a)),Apply0:()=>Xn(t)}};var Xr=t=>{let e=t.Monad0(),n=e.Bind1().bind,a=e.Applicative0().pure,o={Applicative0:()=>ue(e),Bind1:()=>nn(e)};return{tailRecM:i=>d=>u=>t.tailRecM($=>n(i($._1)($._2))(l=>a((()=>{if(l._1.tag==="Loop")return Lt("Loop",_(l._1._1,l._2));if(l._1.tag==="Done")return Lt("Done",_(l._1._1,l._2));f()})())))(_(d,u)),Monad0:()=>o}},Go=t=>{let e=t.Applicative0().pure,n={Applicative0:()=>ue(t),Bind1:()=>nn(t)};return{state:a=>o=>e(a(o)),Monad0:()=>n}};function yd(t){return function(){return t.slice()}}var ta=yd,hd=function(){function t(e,n,a,o,i,d){var u,$,l,p,c,r,s;for(u=i+(d-i>>1),u-i>1&&t(e,n,o,a,i,u),d-u>1&&t(e,n,o,a,u,d),$=i,l=u,p=i;$<u&&l<d;)c=o[$],r=o[l],s=n(e(c)(r)),s>0?(a[p++]=r,++l):(a[p++]=c,++$);for(;$<u;)a[p++]=o[$++];for(;l<d;)a[p++]=o[l++]}return function(e){return function(n){return function(a){return function(){return a.length<2||t(e,n,a,a.slice(0),0,a.length),a}}}}}();var Ge=function(t){return function(e){for(var n=e.length,a=Array(n),o=0;o<n;o++)a[o]=t(o)(e[o]);return a}};var de=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var ce=function(t){return function(e){for(var n=t>e?-1:1,a=new Array(n*(e-t)+1),o=t,i=0;o!==e;)a[i++]=o,o+=n;return a[i]=o,a}},Md=function(t){return function(e){if(t<1)return[];var n=new Array(t);return n.fill(e)}},Cd=function(t){return function(e){for(var n=[],a=0,o=0;o<t;o++)n[a++]=e;return n}},tr=typeof Array.prototype.fill=="function"?Md:Cd,Qo=function(){function t(o,i){this.head=o,this.tail=i}var e={};function n(o){return function(i){return new t(o,i)}}function a(o){for(var i=[],d=0,u=o;u!==e;)i[d++]=u.head,u=u.tail;return i}return function(o){return function(i){return a(o(n)(e)(i))}}}();var jo=function(t){return function(e){return function(n){return function(a){return a<0||a>=n.length?e:t(n[a])}}}};var Vo=function(t){return function(e){return function(n){return function(a){for(var o=0,i=a.length;o<i;o++)if(n(a[o]))return t(o);return e}}}};var Ko=function(t){return function(e){return function(n){return function(a){return function(o){if(n<0||n>=o.length)return e;var i=o.slice();return i[n]=a,t(i)}}}}};var Yo=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],n=0,a=t.length;n<a;n++)for(var o=t[n],i=0,d=o.length;i<d;i++)e.push(o[i]);return e},hn=function(t){return function(e){return e.filter(t)}};var Zo=function(t){return function(e){return function(n){for(var a=n.length,o=e,i=new Array(a),d=0;d<a;d++)o=t(o)(n[d]),i[d]=o;return i}}};var Xo=function(){function t(e,n,a,o,i,d){var u,$,l,p,c,r,s;for(u=i+(d-i>>1),u-i>1&&t(e,n,o,a,i,u),d-u>1&&t(e,n,o,a,u,d),$=i,l=u,p=i;$<u&&l<d;)c=o[$],r=o[l],s=n(e(c)(r)),s>0?(a[p++]=r,++l):(a[p++]=c,++$);for(;$<u;)a[p++]=o[$++];for(;l<d;)a[p++]=o[l++]}return function(e){return function(n){return function(a){var o;return a.length<2?a:(o=a.slice(0),t(e,n,o,a.slice(0),0,a.length),o)}}}}();var er=function(t){return function(e){for(var n=e.length,a=0;a<n;a++)if(!t(e[a]))return!1;return!0}};var es=Ko(H)(m);var Dn=t=>Xo(t)(e=>{if(e.tag==="GT")return 1;if(e.tag==="EQ")return 0;if(e.tag==="LT")return-1;f()});var ns=t=>e=>(()=>{let n=ta(t);return()=>{let a=n();return a.push(e),a}})()();var be=jo(H)(m);var na=Vo(H)(m);var nr=t=>e=>n=>{let a=na(o=>t.eq(o)(e))(n);if(a.tag==="Nothing")return!1;if(a.tag==="Just")return!0;f()};var rs=t=>e=>t.state(n=>_(void 0,e));var qd=function(){function t(d){this.fn=d}var e={},n=function(d,u){this.head=d,this.tail=u};function a(d){return new n(d,e)}function o(d){return function(u){return new n(d,u)}}function i(d){for(var u=[],$=d;$!==e;)u.push($.head),$=$.tail;return u}return function(d){return function(u){return function($){var l=function(c,r){return d(u(o)($(c)))(r)},p=function(c,r,s){if(r===0)return c;var h=s[r-1];return new t(function(){var P=p(l(h,c),r-1,s);return P})};return function(c){for(var r=u(a)($(c[c.length-1])),s=p(r,c.length-1,c);s instanceof t;)s=s.fn();return u(i)(s)}}}}}();var zd=t=>Go(t).state(e=>_(e.newSeed,{...e,newSeed:Ho(0)(e.newSeed)}));var Jd=t=>{let e=De(t.Bind1().Apply0().Functor0()).map,n=zd(t),a=Xn(t).apply;return o=>i=>{let d=Z(i),u=Z(o),$=e(Z)(n);return e(l=>Zn(ke(u+Yn(l)(d-u+1))))(a(e(Qr)($))(e(l=>2*l)($)))}},os=t=>{let e=Jd(t);return n=>a=>n<=a?e(n)(a):e(a)(n)};var kd=(()=>ue(Kt).pure)(),Hd=(()=>De(fe).map)(),Ud=os(Kt);var aa=t=>t.length===0?kd(m):Hd(e=>be(t)(e))(Ud(0)(t.length-1|0)),rr=t=>{let e=100*vo(Z(t+1|0));return e-ke(e)},ss=(()=>{let t=Ge(a=>o=>_(rr(a),o)),e=Dn(a=>o=>Sr.compare(a._1)(o._1)),n=ct(Yt);return a=>n(e(t(a)))})();var oa=(t,e)=>({tag:"Graph",_1:t,_2:e}),Gd=Pn(X)(oe),us=(()=>ue(Kt).pure)(),Od=Pn(In(X)(X))(oe),Qd=t=>e=>{let n=X.compare(t)(e);if(n.tag==="LT")return e;if(n.tag==="EQ"||n.tag==="GT")return t;f()};var ds=t=>e=>oa(Gd(ct(n=>_(n,ae(e)(a=>ae((n-a|0)>=0?[void 0]:[])(()=>[{edge:a-1|0,dest:n-a|0}]))))(ce(0)(t))),t),cs=t=>({width:800,height:400,position:e=>e===0?m:e<=8?b("Just",{x:Z(e-1|0)*100,y:0}):b("Just",{x:Z(e-9|0)*100,y:200}),legend:ct(e=>({edge:e-1|0,name:rt(e)}))(t)});var sa=t=>e=>n=>{let a=Xt(t)(n)(e);if(a.tag==="Nothing")return us(m);if(a.tag==="Just")return De(fe).map(o=>o.tag==="Just"?b("Just",{edge:o._1.edge,dest:o._1.dest}):m)(aa(a._1));f()},jd=t=>{let e=Pn(t)(oe);return n=>a=>oa(e(ct(o=>_(n(o._1),ct(i=>({edge:i.edge,dest:n(i.dest)}))(o._2)))(Rn(qe)(a._1))),n(a._2))},Vd=jd(X),ia=t=>e=>n=>aa(ae((()=>{let a=Xt(t)(n)(e);if(a.tag==="Nothing")return[];if(a.tag==="Just")return a._1;f()})())(a=>tr(a.nbBalls)({dest:a.dest,edge:a.edge}))),ls=t=>e=>{let n=Ce(()=>Zt.map(o=>tn(i=>er(d=>{let u=Xt(t)(d.dest)(n());if(u.tag==="Nothing")return!0;if(u.tag==="Just")return!Pe(u._1);f()})(o)))(e._1)),a=n();return Zt.map(Pe)(a)},Kd=t=>e=>oa(Od(ae(ce(0)(t-1|0))(n=>ae(ce(0)(e-1|0))(a=>[_(_(n,a),hn(o=>o.dest._1>=0&&o.dest._2>=0)([{edge:0,dest:_(n-1|0,a)},{edge:1,dest:_(n-1|0,a-1|0)},{edge:2,dest:_(n,a-1|0)}]))]))),_(t-1|0,e-1|0)),ps=t=>e=>Vd(n=>n._1+(n._2*t|0)|0)(Kd(t)(e)),$s=t=>e=>{let n=Qd(t)(e);return{width:180*n|0,height:180*n|0,position:a=>a===0?m:b("Just",{x:50+180*Z(gn(a)(t)),y:10+180*Z((e-Vr(a)(t)|0)-1|0)}),legend:[{edge:0,name:"\u21D0"},{edge:1,name:"\u21D9"},{edge:2,name:"\u21D3"}]}},fs=t=>e=>n=>a=>(()=>{let o=Xt(t)(a)(n);return o.tag==="Nothing"?!1:o.tag==="Just"?o._1:!1})()?sa(t)(e)(a):us((()=>{let o=Xt(t)(a)(e);if(o.tag==="Just"){let i=na(d=>{let u=Xt(t)(d.dest)(n);return u.tag==="Nothing"?!1:u.tag==="Just"?u._1:!1})(o._1);return i.tag==="Just"?b("Just",{edge:o._1[i._1].edge,dest:o._1[i._1].dest}):m}if(o.tag==="Nothing")return m;f()})()),ms={width:0,height:0,position:t=>m,legend:[]},gs=t=>e=>n=>Zt.map(ct(a=>({edge:a.edge,dest:a.dest,nbBalls:e})))(n._1);var ua=t=>({tag:t}),Se=(t,e,n)=>({tag:t,_1:e,_2:n}),da=t=>({tag:t}),Zd=(()=>nn(Kt).bind)(),_s=(()=>ue(Kt).pure)(),Xd=(()=>Xr(Na).tailRecM)(),tc=t=>e=>{let n=X.compare(t)(e);if(n.tag==="LT")return e;if(n.tag==="EQ"||n.tag==="GT")return t;f()},ys=da("Running"),hs=da("IsStopping"),ar=da("Stopped");var ca=ua("Random"),Ds=ua("Expert"),bs=ua("Machine");var Ts=t=>e=>nr(We)(t)(e)?hn(n=>n!==t)(e):Dn(X.compare)(de([t])(e));var la=t=>{let e=(()=>{if(t.config.graphType.tag==="Substract")return ds(t.config.graphType._1)(t.config.graphType._2);if(t.config.graphType.tag==="King")return ps(t.config.graphType._1)(t.config.graphType._2);f()})();return{config:t.config,source:e._2,nbVictories:0,nbLosses:0,graphWithBalls:gs(X)(t.config.ballsPerColor)(e),losingPositions:ls(X)(e),status:ar,gameResult:m,displayer:(()=>{if(t.config.graphType.tag==="Substract")return cs(t.config.graphType._2);if(t.config.graphType.tag==="King")return $s(t.config.graphType._1)(t.config.graphType._2);f()})(),colors:t.colors,fastMode:t.fastMode}},ec=["#f6b73c","#ff0000","#00ffff","#90ee90","#900090"],Ms=la({config:{graphType:Se("Substract",8,[1,2]),adversary:ca,ballsPerColor:6,reward:3,penalty:-1,machineStarts:!0},source:0,nbVictories:0,nbLosses:0,graphWithBalls:z,losingPositions:z,status:ar,gameResult:m,displayer:ms,colors:ec,fastMode:!1});var nc=t=>e=>{if(t.config.adversary.tag==="Random")return sa(X)(t.graphWithBalls)(e);if(t.config.adversary.tag==="Expert")return fs(X)(t.graphWithBalls)(t.losingPositions)(e);if(t.config.adversary.tag==="Machine")return ia(X)(t.graphWithBalls)(e);f()},rc=t=>Xd(e=>{let n=e.isMachineTurn,a=e.moves,o=e.pos;return Zd(n?ia(X)(t.graphWithBalls)(o):nc(t)(o))(i=>{if(i.tag==="Nothing")return _s(Lt("Done",{moves:a,win:!n}));if(i.tag==="Just")return _s(Lt("Loop",{moves:ns(a)({pos:o,edge:i._1.edge,isMachineTurn:n}),isMachineTurn:!n,pos:i._1.dest}));f()})})({moves:[],pos:t.source,isMachineTurn:t.config.machineStarts});var ac=t=>e=>{let n=e.win;return{config:t.config,source:t.source,nbVictories:n?t.nbVictories+1|0:t.nbVictories+0|0,nbLosses:n?t.nbLosses+0|0:t.nbLosses+1|0,graphWithBalls:Zt.map(a=>er(o=>o.nbBalls===0)(a)?ct(o=>({nbBalls:t.config.ballsPerColor,dest:o.dest,edge:o.edge}))(a):a)(Re(a=>{let o=a.edge,i=a.isMachineTurn,d=ct(u=>o!==u.edge?u:{nbBalls:tc(0)((()=>!i&&(t.config.adversary.tag==="Random"||t.config.adversary.tag==="Expert"||t.config.adversary.tag!=="Machine")?u.nbBalls+0|0:n===i?u.nbBalls+t.config.reward|0:u.nbBalls+t.config.penalty|0)()),edge:u.edge,dest:u.dest});return wr(X)(u=>b("Just",d(u)))(a.pos)})(t.graphWithBalls)(e.moves)),losingPositions:t.losingPositions,status:t.status,gameResult:b("Just",{moves:e.moves,win:n}),displayer:t.displayer,colors:t.colors,fastMode:t.fastMode}},Cs=t=>De(fe).map(ac(t))(rc(t));var oc=t=>{let e=t.Apply0(),n=e.Functor0(),a={map:i=>{let d=n.map(i);return u=>$=>d(u($))}},o={apply:i=>d=>u=>e.apply(i(u))(d(u)),Functor0:()=>a};return{bind:i=>d=>u=>t.bind(i(u))($=>d($)(u)),Apply0:()=>o}};var sc=t=>{let e=t.Applicative0(),n=e.Apply0(),a=n.Functor0(),o={map:$=>{let l=a.map($);return p=>c=>l(p(c))}},i={apply:$=>l=>p=>n.apply($(p))(l(p)),Functor0:()=>o},d={pure:$=>{let l=e.pure($);return p=>l},Apply0:()=>i},u=oc(t.Bind1());return{Applicative0:()=>d,Bind1:()=>u}};var or=t=>{let e=sc(t.Monad0());return{liftEffect:n=>{let a=t.liftEffect(n);return o=>a},Monad0:()=>e}};var dc=zr(vr)(he);var Ns=t=>e=>n=>a=>{let o=dc(t)(e),i=a.Profunctor0().dimap;return d=>i(o)(u=>{if(u._2.tag==="Left")return u._2._1;if(u._2.tag==="Right")return u._1(u._2._1);f()})(n.second(a.right(d)))};var pa=t=>e=>n=>{let a=n.Profunctor0().dimap;return o=>a(i=>_(t(i),d=>e(i)(d)))(i=>i._2(i._1))(n.first(o))};function Es(t){return function(e){var n=[];for(var a in e)hasOwnProperty.call(e,a)&&n.push(t(a)(e[a]));return n}}var ch=Object.keys||Es(function(t){return function(){return t}});var Fs={ix:t=>e=>n=>Ns(a=>o=>{let i=es(t)(o)(a);if(i.tag==="Nothing")return a;if(i.tag==="Just")return i._1;f()})(a=>{let o=be(a)(t);if(o.tag==="Nothing")return tt("Left",a);if(o.tag==="Just")return tt("Right",o._1);f()})(e)(n)};var Ss=t=>()=>e=>n=>Le(t.reflectSymbol(e))(n);var sr=t=>()=>()=>e=>n=>pa(Ss(t)()(e))(a=>o=>je(t.reflectSymbol(e))(o)(a))(n);var As=t=>{let e=t.Monad0().Bind1().Apply0().Functor0().map(n=>{});return n=>a=>e((()=>{let o=n(i=>a);return t.state(i=>{let d=o(i);return _(d,d)})})())};var ws=(()=>({left:t=>e=>{if(e.tag==="Left")return tt("Left",t(e._1));if(e.tag==="Right")return tt("Right",e._1);f()},right:dn.map,Profunctor0:()=>Gn}))();var Rs={liftAff:t=>t,MonadEffect0:()=>zn};var Ws=t=>{let e=or(t.MonadEffect0());return{liftAff:n=>{let a=t.liftAff(n);return o=>a},MonadEffect0:()=>e}};var Nt=(t,e,n)=>({tag:t,_1:e,_2:n}),Ps=Nt("NextGame"),qs=Nt("RunMachine"),vs=Nt("StopMachine"),zs=t=>Nt("SetGraphType",t),Js=t=>Nt("SetNbPigeonholes",t);var Bs=t=>Nt("SetKingWidth",t),ks=t=>Nt("SetKingHeight",t),Hs=t=>Nt("SetAdversary",t),Us=t=>Nt("SetReward",t),Gs=t=>Nt("SetPenalty",t),Os=t=>Nt("SetBallsPerColor",t),Qs=t=>Nt("SetMachineStarts",t),js=t=>e=>Nt("ColorChange",t,e);var Ks=w(Y("Bind",Mt("Lift",ye),t=>w(Y("Return",t),V)),V),Ys=(()=>Br(or(zn)).liftEffect)(),ir=w(Y("Bind",Mt("State",t=>_(t,t)),t=>w(Y("Return",t),V)),V),Wc=(()=>{let t=Co(Ws(Rs)).liftAff;return e=>t(Rr(Ot,e))})(),Pc=As(Jr),qc=t=>w(Ks._1,xt(Ks._2)(Et("CatCons",e=>{let n=e.genModel,a=Ys(()=>n.value);return w(a._1,xt(a._2)(Et("CatCons",o=>{let i=t(o),d=i._2,u=i._1,$=Ys(()=>n.value=d);return w($._1,xt($._2)(Et("CatCons",()=>w(Y("Return",u),V),Tt(W,W))))},Tt(W,W))))},Tt(W,W)))),ur=sr({reflectSymbol:()=>"graphType"})()()(St)(he),vc=sr({reflectSymbol:()=>"config"})()()(St)(he),le=t=>{let e=vc(t);return w(Y("Bind",Mt("State",n=>_(void 0,la(e(n)))),n=>w(Y("Return",n),V)),V)},zc=sr({reflectSymbol:()=>"colors"})()()(St)(he),$a=t=>{if(t.tag==="RunMachine"){let e=Ce(()=>w(ir._1,xt(ir._2)(Et("CatCons",a=>{if(a.status.tag!=="Running"){let i={...a,status:ar};return w(Y("Bind",Mt("State",d=>_(void 0,i)),d=>w(Y("Return",d),V)),V)}let o=$a(Ps);return w(o._1,xt(o._2)(Et("CatCons",()=>{let i=Wc(a.fastMode?100:500);return w(i._1,xt(i._2)(Et("CatCons",()=>e(),Tt(W,W))))},Tt(W,W))))},Tt(W,W))))),n=e();return w(Y("Bind",Mt("State",a=>_(void 0,{...a,status:ys})),a=>w(Y("Return",a),V)),xt(V)(Et("CatCons",()=>n,Tt(W,W))))}if(t.tag==="StopMachine")return w(Y("Bind",Mt("State",e=>_(void 0,{...e,status:hs})),e=>w(Y("Return",e),V)),V);if(t.tag==="NextGame")return w(ir._1,xt(ir._2)(Et("CatCons",e=>{let n=qc(Cs(e));return w(n._1,xt(n._2)(Et("CatCons",rs(Jr),Tt(W,W))))},Tt(W,W))));if(t.tag==="SetGraphType"){let e=t._1;return le(n=>({graphType:e==="sub"?Se("Substract",8,[1,2]):Se("King",3,3),adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetNbPigeonholes"){let e=t._1;return le(ur(n=>n.tag==="Substract"?Se("Substract",(()=>{let a=He(e);if(a.tag==="Nothing")return 8;if(a.tag==="Just")return a._1;f()})(),n._2):n))}if(t.tag==="TogglePossibleMove"){let e=t._1;return le(ur(n=>n.tag==="Substract"?Se("Substract",n._1,Ts(e)(n._2)):n))}if(t.tag==="SetKingWidth"){let e=t._1;return le(ur(n=>n.tag==="King"?Se("King",(()=>{let a=He(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;f()})(),n._2):n))}if(t.tag==="SetKingHeight"){let e=t._1;return le(ur(n=>n.tag==="King"?Se("King",n._1,(()=>{let a=He(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;f()})()):n))}if(t.tag==="SetReward"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:(()=>{let a=He(e);if(a.tag==="Nothing")return 3;if(a.tag==="Just")return a._1;f()})(),penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetPenalty"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:(()=>{let a=He(e);if(a.tag==="Nothing")return-1;if(a.tag==="Just")return a._1;f()})(),machineStarts:n.machineStarts}))}if(t.tag==="SetAdversary"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:(()=>e==="expert"?Ds:e==="machine"?bs:ca)(),ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetBallsPerColor"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:(()=>{let a=He(e);if(a.tag==="Nothing")return 6;if(a.tag==="Just")return a._1;f()})(),reward:n.reward,penalty:n.penalty,machineStarts:n.machineStarts}))}if(t.tag==="SetMachineStarts"){let e=t._1;return le(n=>({graphType:n.graphType,adversary:n.adversary,ballsPerColor:n.ballsPerColor,reward:n.reward,penalty:n.penalty,machineStarts:e==="y"}))}if(t.tag==="ColorChange")return Pc((()=>{let e=Fs.ix(t._1)(he)(ws);return n=>zc(e(n))})())(t._2);if(t.tag==="SetFastMode"){let e=t._1;return w(Y("Bind",Mt("State",n=>_(void 0,{...n,fastMode:e})),n=>w(Y("Return",n),V)),V)}f()};var Zs=t=>e=>n=>a=>F("viewBox",rt(t)+" "+rt(e)+" "+rt(n)+" "+rt(a));function Xs(t){return function(){return t.checked}}function ti(t){return function(){return t.value}}function ei(t){return function(){return t.value}}var ni=t=>ie("change",e=>{let n=wt(Be(e),m,H),a=(()=>{if(n.tag==="Just")return fn(m,H,"HTMLInputElement",n._1);if(n.tag==="Nothing")return m;f()})();if(a.tag==="Nothing")return()=>m;if(a.tag==="Just"){let o=Xs(a._1);return()=>{let i=o();return b("Just",t(i))}}f()});var ee=t=>ie("change",e=>{let n=wt(Be(e),m,H),a=(()=>{if(n.tag==="Just")return fn(m,H,"HTMLInputElement",n._1);if(n.tag==="Nothing")return m;f()})();if(a.tag==="Just"){let o=ti(a._1);return()=>{let i=o();return b("Just",t(i))}}if(a.tag==="Nothing"){let o=wt(Be(e),m,H),i=(()=>{if(o.tag==="Just")return fn(m,H,"HTMLSelectElement",o._1);if(o.tag==="Nothing")return m;f()})();if(i.tag==="Nothing")return()=>m;if(i.tag==="Just"){let d=ei(i._1);return()=>{let u=d();return b("Just",t(u))}}f()}f()});var Gc=t=>e=>{let n=X.compare(t)(e);if(n.tag==="LT"||n.tag==="EQ")return t;if(n.tag==="GT")return e;f()},Oc=Xe(Or)(0),Qc=t=>e=>M("div",[j("flex flex-row justify-between mt-4 mb-2")],[M("span",[j("text-blue-600 font-bold")],[G("Victoires: "+rt(t))]),M("div",[j("w-full bg-red-600 rounded-full h-6")],[M("div",[j("h-6 bg-blue-600 rounded-l-full"),(()=>{let n=t+e|0;return kn("width",re(n===0?50:Z(t)/Z(n)*100)+"%")})()],[])]),M("span",[j("text-red-600 font-bold")],[G("D\xE9faites: "+rt(e))])]),fa="block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",jc=t=>e=>n=>a=>{let o=t.position(n);if(o.tag==="Just")return M("g",[kn("transform","translate("+re(o._1.x)+"px,"+re(o._1.y)+"px)")],[M("path",[F("d","M1 1 L10 109 L90 109 L99 1"),F("stroke-width","3.0"),F("stroke","#000"),F("fill","transparent")],[]),(()=>{let i=Yo(ct(u=>tr(u.nbBalls)(u.edge))(a)),d=Z(Gc(95)(i.length));return M("g",[],ss(Ge(u=>$=>M("circle",[F("cx",re(15+rr(n+u|0)*71)),F("cy",re(100-rr((10+n|0)+u|0)*d)),F("r","5.0"),F("fill",(()=>{let l=be(e)($);if(l.tag==="Nothing")return"black";if(l.tag==="Just")return l._1;f()})())],[]))(i)))})(),(()=>{let i=Z(Oc(ct(d=>d.nbBalls)(a)));return M("g",[],ct(d=>M("rect",[F("x",re(3+94*d.begin)),F("y","115.0"),F("width",re(94*(d.end-d.begin))),F("height","20"),F("stroke","black"),F("fill",(()=>{let u=be(e)(d.edge);if(u.tag==="Nothing")return"black";if(u.tag==="Just")return u._1;f()})())],[]))(Zo(d=>{let u=d.end;return $=>({begin:u,end:u+Z($.nbBalls)/i,edge:$.edge})})({begin:0,end:0,edge:-1})(a)))})()]);if(o.tag==="Nothing")return bo;f()},Vc=t=>e=>n=>M("div",[j("w-[42vw]")],[M("svg",[Zs(0)(0)(t.width)(t.height)],ct(a=>jc(t)(e)(a._1)(a._2))(Rn(qe)(n)))]),ga=t=>e=>M("div",[j("rounded overflow-hidden shadow-lg p-4")],de([M("div",[j("font-bold text-xl mb-2")],[G(t)])])(e)),Kc=t=>e=>ga("L\xE9gende")([M("div",[j("grid grid-cols-2 gap-4")],ae(t)(n=>[M("input",[F("type","color"),j("inline w-12 h-12"),F("value",(()=>{let a=be(e)(n.edge);if(a.tag==="Nothing")return"#000000";if(a.tag==="Just")return a._1;f()})()),ee(js(n.edge))],[]),M("span",[j("text-2xl")],[G(" : "+n.name)])]))]),ma="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",Yc=t=>e=>ga("Choix des param\xE8tres")([M("div",[j("grid grid-cols-2 gap-4")],de([M("div",[],[G("type de jeu")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",(()=>{if(t.graphType.tag==="Substract")return"sub";if(t.graphType.tag==="King")return"king";f()})()),ee(zs)],[M("option",[F("value","sub")],[G("Soustraction")]),M("option",[F("value","king")],[G("Roi")])])])(de((()=>{if(t.graphType.tag==="Substract"){let n=t.graphType._2;return[M("div",[],[G("Nombre de casiers")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",rt(t.graphType._1)),ee(Js)],ct(a=>M("option",[F("value",rt(a))],[G(rt(a))]))(ce(8)(16))),M("div",[],[G("Coups possibles")]),M("div",[j("flex flex-row justify-between")],ct(a=>M("label",[],[M("input",[F("type","checkbox"),F("checked",nr(We)(a)(n)),j("w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"),ni(o=>Nt("TogglePossibleMove",a))],[]),M("span",[j("ml-2 text-sm font-medium text-gray-900")],[G(rt(a))])]))(ce(1)(5)))]}if(t.graphType.tag==="King")return[M("div",[],[G("Hauteur de la grille")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",rt(t.graphType._2)),ee(ks)],ct(n=>M("option",[F("value",rt(n))],[G(rt(n))]))(ce(3)(6))),M("div",[],[G("Largeur de la grille")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",rt(t.graphType._1)),ee(Bs)],ct(n=>M("option",[F("value",rt(n))],[G(rt(n))]))(ce(3)(6)))];f()})())([M("div",[],[G("Adversaire")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",(()=>{if(t.adversary.tag==="Expert")return"expert";if(t.adversary.tag==="Machine")return"machine";if(t.adversary.tag==="Random")return"random";f()})()),ee(Hs)],[M("option",[F("value","random")],[G("Al\xE9atoire")]),M("option",[F("value","expert")],[G("Expert")]),M("option",[F("value","machine")],[G("Machine")])]),M("div",[],[G("Billes par couleur")]),M("input",[F("type","number"),j(fa),F("min","2"),F("max","10"),F("value",rt(t.ballsPerColor)),ee(Os)],[]),M("div",[],[G("R\xE9compense")]),M("input",[F("type","number"),j(fa),F("min","1"),F("value",rt(t.reward)),ee(Us)],[]),M("div",[],[G("P\xE9nalit\xE9")]),M("input",[F("type","number"),j(fa),F("max","0"),F("value",rt(t.penalty)),ee(Gs)],[]),M("div",[],[G("La machine commence")]),M("select",[j("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),F("value",t.machineStarts?"y":"n"),ee(Qs)],[M("option",[F("value","y")],[G("Oui")]),M("option",[F("value","n")],[G("Non")])]),e.tag==="Stopped"?M("button",[j(ma),ie("click",n=>()=>b("Just",qs))],[G("Lancer la machine")]):M("button",[j(ma),ie("click",n=>()=>b("Just",vs))],[G("Arr\xEAter la machine")]),M("button",[j(ma),ie("pointerdown",n=>()=>b("Just",Nt("SetFastMode",!0))),ie("pointerup",n=>()=>b("Just",Nt("SetFastMode",!1))),ie("pointerleave",n=>()=>b("Just",Nt("SetFastMode",!1)))],[G("Acc\xE9lerer")])])))]),ri=t=>M("div",[j("w-screen flex flex-row justify-around items-start")],[ga("Visualisation de la machine")([M("div",[j("flex flex-col")],[Vc(t.displayer)(t.colors)(t.graphWithBalls),Qc(t.nbVictories)(t.nbLosses)])]),Hn((e,n)=>Kc(e)(n),t.displayer.legend,t.colors),Hn((e,n)=>Yc(e)(n),t.config,t.status)]);var ai=()=>{let e={value:{newSeed:Zr(),size:0}};return Po({init:{model:Ms,msg:m},view:ri,update:(()=>{let n=xo(a=>a({genModel:e}));return a=>n($a(a))})(),selector:"#root"})()};ai();})();
