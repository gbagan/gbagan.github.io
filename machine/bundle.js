(()=>{var $f=function(n){return function(r){for(var t=r.length,e=new Array(t),a=0;a<t;a++)e[a]=n(r[a]);return e}};var ra={compose:function(n){return function(r){return function(t){return n(r(t))}}}},ta=function(n){return n.compose};var Z=function(n){return n.identity},en={identity:function(n){return n},Semigroupoid0:function(){return ra}};var sr=!0;var Cn=function(n){return function(r){return function(t){return n(t)(r)}}},Mn=function(n){return function(r){return n}};var Vn=function(){function n(){}return n.value=new n,n}();var m=function(n){return n.map},ar=function(n){var r=m(n);return function(t){return function(e){return r(e)(t)}}},tr=function(n){return m(n)(Mn(void 0))};var jr={map:ta(ra)},zn={map:$f};var Uf=function(n){return function(r){return n.length===0?r:r.length===0?n:n.concat(r)}};var Mr=function(n){return n.reflectSymbol};var Vr=function(n){return function(r){return r[n]}},lt=function(n){return function(r){return function(t){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e[n]=r,e}}};var st={append:Uf};var U=function(n){return n.append};var Pu={alt:U(st),Functor0:function(){return zn}};var Of=function(n){return function(r){for(var t=n.length,e=r.length,a=new Array(t*e),u=0,i=0;i<t;i++)for(var c=n[i],f=0;f<e;f++)a[u++]=c(r[f]);return a}};var bm=Z(en);var ea={apply:Of,Functor0:function(){return zn}},yn=function(n){return n.apply};var Ya=function(n){var r=yn(n),t=m(n.Functor0());return function(e){return function(a){return r(t(Mn(bm))(e))(a)}}};var E=function(n){return n.pure},De=function(n){var r=E(n);return function(t){return function(e){if(!t)return e;if(t)return r(void 0);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[t.constructor.name,e.constructor.name])}}};var aa=function(n){var r=yn(n.Apply0()),t=E(n);return function(e){return function(a){return r(t(e))(a)}}};var ye={pure:function(n){return[n]},Apply0:function(){return ea}};var Bf=function(n){return function(r){for(var t=[],e=0,a=n.length;e<a;e++)Array.prototype.push.apply(t,r(n[e]));return t}};var Kr=function(n){return n.discard};var Ft={bind:Bf,Apply0:function(){return ea}},R=function(n){return n.bind},wt=function(n){return Cn(R(n))};var Yr={discard:function(n){return R(n)}};var Fm=String.fromCharCode(65535),wm=String.fromCharCode(0),Lm=Number.POSITIVE_INFINITY,Im=Number.NEGATIVE_INFINITY;var Nm=function(n){return function(r){return function(t){return function(e){return function(a){return e<a?n:e===a?r:t}}}}};var zf=Nm;var kf=function(n){return function(r){return n===r}},Jf=kf,Gf=kf;var Lt={eq:Gf};var Za={eq:Jf};var V=function(n){return n.eq},Pm=V(Za);var kt=function(n){var r=V(n);return function(t){return function(e){return Pm(r(t)(e))(!1)}}};var q=function(){function n(){}return n.value=new n,n}(),J=function(){function n(){}return n.value=new n,n}(),G=function(){function n(){}return n.value=new n,n}();var jf=function(n){return function(r){return n-r|0}};var Vf=function(n){return function(r){return n+r|0}},Qf=function(n){return function(r){return n*r|0}},Kf=function(n){return function(r){return n+r}},Yf=function(n){return function(r){return n*r}};var no={add:Kf,zero:0,mul:Yf,one:1},ua={add:Vf,zero:0,mul:Qf,one:1};var xr=function(n){return n.mul};var hr=function(n){return n.add};var Xf={sub:jf,Semiring0:function(){return ua}};var gn=function(){return{compare:zf(q.value)(G.value)(J.value),Eq0:function(){return Lt}}}();var Q=function(n){return n.compare};var Jt=function(n){var r=Q(n);return function(t){return function(e){var a=r(t)(e);if(a instanceof q)return e;if(a instanceof G||a instanceof J)return t;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[a.constructor.name])}}},to=function(n){var r=Q(n);return function(t){return function(e){var a=r(t)(e);if(a instanceof q||a instanceof G)return t;if(a instanceof J)return e;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[a.constructor.name])}}};var mt=function(n){return n.top};var ia={top:2147483647,bottom:-2147483648,Ord0:function(){return gn}};var xt=function(n){return n.bottom};var rc=function(n){return n.toString()},tc=function(n){var r=n.toString();return isNaN(r+".0")?r:r+".0"};var fa={show:tc},vt={show:rc};var z=function(n){return n.show};var Qm=Z(en),D=function(){function n(){}return n.value=new n,n}(),d=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var Xn=function(n){return function(r){return function(t){if(t instanceof D)return n;if(t instanceof d)return r(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},Gt=Xn(!0)(Mn(!1)),$u=Xn(!1)(Mn(!0));var kn={map:function(n){return function(r){return r instanceof d?new d(n(r.value0)):D.value}}},Km=m(kn);var Jn=function(n){return Xn(n)(Qm)},Nr=function(){return function(n){if(n instanceof d)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}};var Te=function(n){var r=V(n);return{eq:function(t){return function(e){return t instanceof D&&e instanceof D?!0:t instanceof d&&e instanceof d?r(t.value0)(e.value0):!1}}}};var ca={apply:function(n){return function(r){if(n instanceof d)return Km(n.value0)(r);if(n instanceof D)return D.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[n.constructor.name,r.constructor.name])}},Functor0:function(){return kn}};var dt={bind:function(n){return function(r){if(n instanceof d)return r(n.value0);if(n instanceof D)return D.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[n.constructor.name,r.constructor.name])}},Apply0:function(){return ca}};var jt=function(){return{pure:d.create,Apply0:function(){return ca}}}();var Nn=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),In=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var ec=function(n){return function(){return n}},ac=function(n){return function(r){return function(){return r(n())()}}};var _r=function(n){var r=R(n.Bind1()),t=E(n.Applicative0());return function(e){return function(a){return r(e)(function(u){return r(a)(function(i){return t(u(i))})})}}};var oc=function(n){return Math.min(Math.abs(n),2147483647)},uc=function(n){return function(r){return r===0?0:r>0?Math.floor(n/r):-Math.floor(n/-r)}},ic=function(n){return function(r){if(r===0)return 0;var t=Math.abs(r);return(n%t+t)%t}};var fc={Ring0:function(){return Xf}};var Ce=function(n){return n.mod};var be={degree:oc,div:uc,mod:ic,CommutativeRing0:function(){return fc}},la=function(n){return n.div};var bn=function(n){return n.mempty};var cc=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}},pa={Applicative0:function(){return Xr},Bind1:function(){return eo}},eo={bind:ac,Apply0:function(){return sc(0)}},Xr={pure:ec,Apply0:function(){return sc(0)}},lc=cc("functorEffect","Effect",function(){return{map:aa(Xr)}}),sc=cc("applyEffect","Effect",function(){return{apply:_r(pa),Functor0:function(){return lc(0)}}}),tn=lc(20);var Zr=function(n){return n.ask};var Dt=function(n){return n};var nt={map:function(n){return function(r){return n(r)}}};var dc={apply:function(n){return function(r){return n(r)}},Functor0:function(){return nt}},i_={bind:function(n){return function(r){return r(n)}},Apply0:function(){return dc}},Dc={pure:Dt,Apply0:function(){return dc}},qr={Applicative0:function(){return Dc},Bind1:function(){return i_}};var yc=function(n){return function(){return{value:n}}};var Sr=function(n){return function(){return n.value}},hc=function(n){return function(r){return function(){var t=n(r.value);return r.value=t.state,t.value}}},rt=function(n){return function(r){return function(){r.value=n}}};var c_=tr(tn),tt=yc,l_=hc,s_=function(n){return l_(function(r){var t=n(r);return{state:t,value:t}})},gc=function(n){return function(r){return c_(s_(n)(r))}};var $n=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Un=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),ur=function(n){return n.tailRecM};var m_=function(n){var r=function(t){var e=!1,a;function u(i){if(i instanceof $n){t=n(i.value0);return}if(i instanceof Un)return e=!0,i.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 103, column 3 - line 103, column 25): "+[i.constructor.name])}for(;!e;)a=u(t);return a};return function(t){return r(n(t))}};var Tc={tailRecM:function(n){var r=function(e){return e},t=m_(function(e){return r(n(e))});return function(e){return Dt(t(e))}},Monad0:function(){return qr}};var b=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Ee=function(n){return function(r){return n(r.value0)(r.value1)}};var er=function(n){return n.value1};var Kt={map:function(n){return function(r){return new b(r.value0,n(r.value1))}}};var Or=function(n){return n.value0};var bc=function(n){var r=V(n);return function(t){var e=V(t);return{eq:function(a){return function(u){return r(a.value0)(u.value0)&&e(a.value1)(u.value1)}}}}},io=function(n){var r=Q(n),t=bc(n.Eq0());return function(e){var a=Q(e),u=t(e.Eq0());return{compare:function(i){return function(c){var f=r(i.value0)(c.value0);return f instanceof q?q.value:f instanceof J?J.value:a(i.value1)(c.value1)}},Eq0:function(){return u}}}};var Pr=function(n){return n.state},va=function(n){var r=Pr(n);return function(t){return r(function(e){return new b(void 0,t)})}},Fe=function(n){var r=Pr(n);return function(t){return r(function(e){return new b(void 0,t(e))})}};var da=function(n){return Pr(n)(function(r){return new b(r,r)})};var Gn=function(n){return n.lift};var Mc={empty:[],Alt0:function(){return Pu}},Rr=function(n){return n.empty};var h=function(n){return n};var ku=function(){return h};var d_=ku();var Br=function(){return d_};var Zn=function(n){return n.liftEffect};var wc=function(n){return n};var Lc=function(n){return n};var Gu={lift:function(n){return function(r){return wc(Mn(r))}}},h_=Gn(Gu),Ic=function(n){return function(r){return function(t){return n(r(t))}}},g_=function(n){return{map:function(){var r=m(n);return function(t){return Ic(r(t))}}()}};var xc=function(n){var r=yn(n),t=g_(n.Functor0());return{apply:function(e){return function(a){return function(u){return r(e(u))(a(u))}}},Functor0:function(){return t}}},T_=function(n){var r=R(n),t=xc(n.Apply0());return{bind:function(e){return function(a){return function(u){return r(e(u))(function(i){var c=a(i);return c(u)})}}},Apply0:function(){return t}}};var Nc=function(n){var r=xc(n.Apply0());return{pure:function(){var t=E(n);return function(e){return wc(Mn(t(e)))}}(),Apply0:function(){return r}}},ju=function(n){var r=Nc(n.Applicative0()),t=T_(n.Bind1());return{Applicative0:function(){return r},Bind1:function(){return t}}},Ac=function(n){var r=ju(n);return{ask:E(n.Applicative0()),Monad0:function(){return r}}};var po=function(n){var r=n.Monad0(),t=ju(r);return{liftEffect:function(){var e=h_(r),a=Zn(n);return function(u){return e(a(u))}}(),Monad0:function(){return t}}};var Sc=function(n){return function(r){return function(t){for(var e=r,a=t.length,u=a-1;u>=0;u--)e=n(t[u])(e);return e}}},Pc=function(n){return function(r){return function(t){for(var e=r,a=t.length,u=0;u<a;u++)e=n(e)(t[u]);return e}}};var E_=Z(en),we=function(n){return n.bimap},_o=function(n){var r=we(n);return function(t){return r(t)(E_)}};var ha={bimap:function(n){return function(r){return function(t){return new b(n(t.value0),r(t.value1))}}}};var fr=function(n){return n.foldr};var go=function(n){var r=Ya(n.Apply0()),t=E(n);return function(e){var a=fr(e);return function(u){return a(function(i){return r(u(i))})(t(void 0))}}},To=function(n){var r=go(n);return function(t){return Cn(r(t))}};var dr=function(n){return n.foldl};var Ta={foldr:function(n){return function(r){return function(t){if(t instanceof D)return r;if(t instanceof d)return n(t.value0)(r);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},foldl:function(n){return function(r){return function(t){if(t instanceof D)return r;if(t instanceof d)return n(r)(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},foldMap:function(n){var r=bn(n);return function(t){return function(e){if(e instanceof D)return r;if(e instanceof d)return t(e.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,e.constructor.name])}}}};var qc=function(n){var r=fr(n);return function(t){var e=U(t.Semigroup0()),a=bn(t);return function(u){return r(function(i){return function(c){return e(u(i))(c)}})(a)}}},zr={foldr:Sc,foldl:Pc,foldMap:function(n){return qc(zr)(n)}};var Oc=function(n){return function(r){for(var t=r.length,e=Array(t),a=0;a<t;a++)e[a]=n(a)(r[a]);return e}};var Pt=function(n){return n.mapWithIndex};var Ca={mapWithIndex:Oc,Functor0:function(){return zn}};var lv=function(){function n(a){return[a]}function r(a){return function(u){return[a,u]}}function t(a){return function(u){return function(i){return[a,u,i]}}}function e(a){return function(u){return a.concat(u)}}return function(a){return function(u){return function(i){return function(c){return function(f){function l(_,v){switch(v-_){case 0:return i([]);case 1:return u(n)(c(f[_]));case 2:return a(u(r)(c(f[_])))(c(f[_+1]));case 3:return a(a(u(t)(c(f[_])))(c(f[_+1])))(c(f[_+2]));default:var C=_+Math.floor((v-_)/4)*2;return a(u(e)(l(_,C)))(l(C,v))}}return l(0,f.length)}}}}}}();var rl=function(n){return function(r){return function(t){return function(e){return function(a){return function(u){for(var i=[],c=u;;){var f=a(c);if(n(f))return i;var l=r(f);i.push(t(l)),c=e(l)}}}}}}};var tl=function(n){return function(r){return function(t){return function(e){return function(a){return function(u){for(var i=[],c=u;;){var f=a(c);i.push(t(f));var l=e(f);if(n(l))return i;c=r(l)}}}}}}};var Iv=Nr();var ii={unfoldr1:tl(Gt)(Iv)(Or)(er)};var Nv=Nr(),re=function(n){return n.unfoldr};var xe={unfoldr:rl(Gt)(Nv)(Or)(er),Unfoldable10:function(){return ii}};var xn=function(){function n(){}return n.value=new n,n}(),j=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var al=function(){var n=function(r){return function(t){var e=r,a=!1,u;function i(c,f){if(f instanceof xn)return a=!0,c;if(f instanceof j){e=new j(f.value0,c),t=f.value1;return}throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[c.constructor.name,f.constructor.name])}for(;!a;)u=i(e,t);return u}};return n(xn.value)}();var wo=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var ol=function(n){var r=!1,t;function e(a){if(a.value0 instanceof xn&&a.value1 instanceof xn)return r=!0,D.value;if(a.value0 instanceof xn){n=new wo(al(a.value1),xn.value);return}if(a.value0 instanceof j)return r=!0,new d(new b(a.value0.value0,new wo(a.value0.value1,a.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[a.constructor.name])}for(;!r;)t=e(n);return t},ul=function(n){return function(r){return new wo(n.value0,new j(r,n.value1))}};var il=function(n){return n.value0 instanceof xn&&n.value1 instanceof xn};var fl=function(){return new wo(xn.value,xn.value)}();var Ae=function(){function n(){}return n.value=new n,n}(),Lo=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var cl=function(n){return function(r){if(n instanceof Ae)return r;if(r instanceof Ae)return n;if(n instanceof Lo)return new Lo(n.value0,ul(n.value1)(r));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[n.constructor.name,r.constructor.name])}},td=function(n){return function(r){return function(t){var e=function(u){return function(i){return function(c){var f=u,l=i,_=!1,v;function C(p,o,s){if(s instanceof xn)return _=!0,o;if(s instanceof j){f=p,l=p(o)(s.value0),c=s.value1;return}throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[p.constructor.name,o.constructor.name,s.constructor.name])}for(;!_;)v=C(f,l,c);return v}}},a=function(u){return function(i){var c=u,f=!1,l;function _(v,C){var p=ol(v);if(p instanceof D)return f=!0,e(function(o){return function(s){return s(o)}})(r)(C);if(p instanceof d){c=p.value0.value1,i=new j(n(p.value0.value0),C);return}throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[p.constructor.name])}for(;!f;)l=_(c,i);return l}};return a(t)(xn.value)}}},ll=function(n){if(n instanceof Ae)return D.value;if(n instanceof Lo)return new d(new b(n.value0,function(){var r=il(n.value1);return r?Ae.value:td(cl)(Ae.value)(n.value1)}()));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[n.constructor.name])};var sl=function(){return Ae.value}(),pl=cl;var ml={append:pl};var _l=function(n){return function(r){return pl(n)(new Lo(r,fl))}};var ad=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}},od=U(ml),ud=m(jr);var vi=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),wa=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),La=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),vl=function(n){var r=!1,t;function e(a){var u=function(f){return f},i=function(f){return function(l){return new vi(f.value0,od(f.value1)(l))}};if(a.value0 instanceof wa){var c=ll(a.value1);if(c instanceof D)return r=!0,new wa(a.value0.value0);if(c instanceof d){n=i(u(c.value0.value0)(a.value0.value0))(c.value0.value1);return}throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[c.constructor.name])}if(a.value0 instanceof La)return r=!0,new La(a.value0.value0,function(f){return i(a.value0.value1(f))(a.value1)});throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[a.value0.constructor.name])}for(;!r;)t=e(n);return t},dl=function(n){var r=m(n);return function(t){var e=t.Monad0(),a=m(e.Bind1().Apply0().Functor0()),u=E(e.Applicative0()),i=ur(t);return function(c){var f=function(l){var _=vl(l);if(_ instanceof wa)return a(Un.create)(u(_.value0));if(_ instanceof La)return a($n.create)(c(r(_.value1)(_.value0)));throw new Error("Failed pattern match at Control.Monad.Free (line 194, column 10 - line 196, column 37): "+[_.constructor.name])};return i(f)}}};var Dl=function(n){return new vi(n,sl)};var Io={Applicative0:function(){return xa},Bind1:function(){return Ia}},yl={map:function(n){return function(r){return wt(Ia)(function(){var t=E(xa);return function(e){return t(n(e))}}())(r)}}},Ia={bind:function(n){return function(r){return new vi(n.value0,_l(n.value1)(r))}},Apply0:function(){return hl(0)}},xa={pure:function(n){return Dl(wa.create(n))},Apply0:function(){return hl(0)}},hl=ad("freeApply","Control.Monad.Free",function(){return{apply:_r(Io),Functor0:function(){return yl}}});var gl=R(Ia),di=E(xa);var Di={tailRecM:function(n){return function(r){return gl(n(r))(function(t){if(t instanceof $n)return ur(Di)(n)(t.value0);if(t instanceof Un)return di(t.value0);throw new Error("Failed pattern match at Control.Monad.Free (line 86, column 26 - line 88, column 21): "+[t.constructor.name])})}},Monad0:function(){return Io}},Se=function(n){return Dl(new La(n,function(r){return di(r)}))};var id=function(n){var r=function(t){var e=vl(t);if(e instanceof wa)return di(e.value0);if(e instanceof La)return gl(n(e.value0))(ud(r)(e.value1));throw new Error("Failed pattern match at Control.Monad.Free (line 168, column 10 - line 170, column 33): "+[e.constructor.name])};return r},Tl=function(n){return id(function(r){return Se(n(r))})};var te=function(n){var r=null;return function(){return n===void 0||(r=n(),n=void 0),r}},ee=function(n){return n()};var El=function(n){return n()};var Fl=function(n){throw new Error(n)};var wl=function(){return Fl};var Cd=wl(),bd=El,ae=function(n){return bd(function(){return Cd(n)})};var I=function(){function n(){}return n.value=new n,n}(),W=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}(),sn=function(){function n(r,t,e,a,u,i,c){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i,this.value6=c}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return function(c){return new n(r,t,e,a,u,i,c)}}}}}}},n}(),Wt=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),Ct=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),Ht=function(){function n(r,t,e,a,u,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return new n(r,t,e,a,u,i)}}}}}},n}(),ot=function(){function n(r,t,e,a,u,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return new n(r,t,e,a,u,i)}}}}}},n}(),$t=function(){function n(r,t,e,a,u,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=u,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(u){return function(i){return new n(r,t,e,a,u,i)}}}}}},n}(),No=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}();var yi=function(n){return function(r){return new W(I.value,n,r,I.value)}},Ao=function(n){var r=re(n);return function(t){var e=function(a){var u=!1,i;function c(f){if(f instanceof xn)return u=!0,D.value;if(f instanceof j){if(f.value0 instanceof I){a=f.value1;return}if(f.value0 instanceof W&&f.value0.value0 instanceof I&&f.value0.value3 instanceof I)return u=!0,new d(new b(new b(f.value0.value1,f.value0.value2),f.value1));if(f.value0 instanceof W&&f.value0.value0 instanceof I)return u=!0,new d(new b(new b(f.value0.value1,f.value0.value2),new j(f.value0.value3,f.value1)));if(f.value0 instanceof W){a=new j(f.value0.value0,new j(yi(f.value0.value1)(f.value0.value2),new j(f.value0.value3,f.value1)));return}if(f.value0 instanceof sn){a=new j(f.value0.value0,new j(yi(f.value0.value1)(f.value0.value2),new j(f.value0.value3,new j(yi(f.value0.value4)(f.value0.value5),new j(f.value0.value6,f.value1)))));return}throw new Error("Failed pattern match at Data.Map.Internal (line 624, column 18 - line 633, column 71): "+[f.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 623, column 3 - line 623, column 19): "+[f.constructor.name])}for(;!u;)i=c(a);return i};return r(e)(new j(t,xn.value))}};var Ut=function(n){var r=Q(n);return function(t){var e=function(a){var u=!1,i;function c(f){if(f instanceof I)return u=!0,D.value;if(f instanceof W){var l=r(t)(f.value1);if(l instanceof G)return u=!0,new d(f.value2);if(l instanceof q){a=f.value0;return}a=f.value3;return}if(f instanceof sn){var _=r(t)(f.value1);if(_ instanceof G)return u=!0,new d(f.value2);var v=r(t)(f.value4);if(v instanceof G)return u=!0,new d(f.value5);if(_ instanceof q){a=f.value0;return}if(v instanceof J){a=f.value6;return}a=f.value3;return}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[f.constructor.name])}for(;!u;)i=c(a);return i};return e}};var ut={map:function(n){return function(r){if(r instanceof I)return I.value;if(r instanceof W)return new W(m(ut)(n)(r.value0),r.value1,n(r.value2),m(ut)(n)(r.value3));if(r instanceof sn)return new sn(m(ut)(n)(r.value0),r.value1,n(r.value2),m(ut)(n)(r.value3),r.value4,n(r.value5),m(ut)(n)(r.value6));throw new Error("Failed pattern match at Data.Map.Internal (line 116, column 1 - line 119, column 110): "+[n.constructor.name,r.constructor.name])}}};var Il=function(n){return function(r){return function(t){var e=n,a=r,u=!1,i;function c(f,l,_){if(l instanceof xn)return u=!0,_;if(l instanceof j){if(l.value0 instanceof Wt){e=f,a=l.value1,t=new W(_,l.value0.value0,l.value0.value1,l.value0.value2);return}if(l.value0 instanceof Ct){e=f,a=l.value1,t=new W(l.value0.value0,l.value0.value1,l.value0.value2,_);return}if(l.value0 instanceof Ht){e=f,a=l.value1,t=new sn(_,l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5);return}if(l.value0 instanceof ot){e=f,a=l.value1,t=new sn(l.value0.value0,l.value0.value1,l.value0.value2,_,l.value0.value3,l.value0.value4,l.value0.value5);return}if(l.value0 instanceof $t){e=f,a=l.value1,t=new sn(l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5,_);return}throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[l.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[l.constructor.name,_.constructor.name])}for(;!u;)i=c(e,a,t);return i}}},So=function(n){var r=Il(n),t=Q(n);return function(e){return function(a){var u=function(c){return function(f){var l=c,_=!1,v;function C(p,o){if(p instanceof xn)return _=!0,new W(o.value0,o.value1,o.value2,o.value3);if(p instanceof j){if(p.value0 instanceof Wt)return _=!0,r(p.value1)(new sn(o.value0,o.value1,o.value2,o.value3,p.value0.value0,p.value0.value1,p.value0.value2));if(p.value0 instanceof Ct)return _=!0,r(p.value1)(new sn(p.value0.value0,p.value0.value1,p.value0.value2,o.value0,o.value1,o.value2,o.value3));if(p.value0 instanceof Ht){l=p.value1,f=new No(new W(o.value0,o.value1,o.value2,o.value3),p.value0.value0,p.value0.value1,new W(p.value0.value2,p.value0.value3,p.value0.value4,p.value0.value5));return}if(p.value0 instanceof ot){l=p.value1,f=new No(new W(p.value0.value0,p.value0.value1,p.value0.value2,o.value0),o.value1,o.value2,new W(o.value3,p.value0.value3,p.value0.value4,p.value0.value5));return}if(p.value0 instanceof $t){l=p.value1,f=new No(new W(p.value0.value0,p.value0.value1,p.value0.value2,p.value0.value3),p.value0.value4,p.value0.value5,new W(o.value0,o.value1,o.value2,o.value3));return}throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[p.value0.constructor.name,o.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[p.constructor.name,o.constructor.name])}for(;!_;)v=C(l,f);return v}},i=function(c){return function(f){var l=c,_=!1,v;function C(p,o){if(o instanceof I)return _=!0,u(p)(new No(I.value,e,a,I.value));if(o instanceof W){var s=t(e)(o.value1);if(s instanceof G)return _=!0,r(p)(new W(o.value0,e,a,o.value3));if(s instanceof q){l=new j(new Wt(o.value1,o.value2,o.value3),p),f=o.value0;return}l=new j(new Ct(o.value0,o.value1,o.value2),p),f=o.value3;return}if(o instanceof sn){var s=t(e)(o.value1);if(s instanceof G)return _=!0,r(p)(new sn(o.value0,e,a,o.value3,o.value4,o.value5,o.value6));var Ln=t(e)(o.value4);if(Ln instanceof G)return _=!0,r(p)(new sn(o.value0,o.value1,o.value2,o.value3,e,a,o.value6));if(s instanceof q){l=new j(new Ht(o.value1,o.value2,o.value3,o.value4,o.value5,o.value6),p),f=o.value0;return}if(s instanceof J&&Ln instanceof q){l=new j(new ot(o.value0,o.value1,o.value2,o.value4,o.value5,o.value6),p),f=o.value3;return}l=new j(new $t(o.value0,o.value1,o.value2,o.value3,o.value4,o.value5),p),f=o.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[p.constructor.name,o.constructor.name])}for(;!_;)v=C(l,f);return v}};return i(xn.value)}}},Ld=function(n){var r=Il(n),t=Q(n);return function(e){var a=function(f){return function(l){var _=f,v=!1,C;function p(o,s){if(o instanceof xn)return v=!0,s;if(o instanceof j){if(o.value0 instanceof Wt&&o.value0.value2 instanceof I&&s instanceof I)return v=!0,r(o.value1)(new W(I.value,o.value0.value0,o.value0.value1,I.value));if(o.value0 instanceof Ct&&o.value0.value0 instanceof I&&s instanceof I)return v=!0,r(o.value1)(new W(I.value,o.value0.value1,o.value0.value2,I.value));if(o.value0 instanceof Wt&&o.value0.value2 instanceof W){_=o.value1,l=new sn(s,o.value0.value0,o.value0.value1,o.value0.value2.value0,o.value0.value2.value1,o.value0.value2.value2,o.value0.value2.value3);return}if(o.value0 instanceof Ct&&o.value0.value0 instanceof W){_=o.value1,l=new sn(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3,o.value0.value1,o.value0.value2,s);return}return o.value0 instanceof Wt&&o.value0.value2 instanceof sn?(v=!0,r(o.value1)(new W(new W(s,o.value0.value0,o.value0.value1,o.value0.value2.value0),o.value0.value2.value1,o.value0.value2.value2,new W(o.value0.value2.value3,o.value0.value2.value4,o.value0.value2.value5,o.value0.value2.value6)))):o.value0 instanceof Ct&&o.value0.value0 instanceof sn?(v=!0,r(o.value1)(new W(new W(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3),o.value0.value0.value4,o.value0.value0.value5,new W(o.value0.value0.value6,o.value0.value1,o.value0.value2,s)))):o.value0 instanceof Ht&&o.value0.value2 instanceof I&&o.value0.value5 instanceof I&&s instanceof I?(v=!0,r(o.value1)(new sn(I.value,o.value0.value0,o.value0.value1,I.value,o.value0.value3,o.value0.value4,I.value))):o.value0 instanceof ot&&o.value0.value0 instanceof I&&o.value0.value5 instanceof I&&s instanceof I?(v=!0,r(o.value1)(new sn(I.value,o.value0.value1,o.value0.value2,I.value,o.value0.value3,o.value0.value4,I.value))):o.value0 instanceof $t&&o.value0.value0 instanceof I&&o.value0.value3 instanceof I&&s instanceof I?(v=!0,r(o.value1)(new sn(I.value,o.value0.value1,o.value0.value2,I.value,o.value0.value4,o.value0.value5,I.value))):o.value0 instanceof Ht&&o.value0.value2 instanceof W?(v=!0,r(o.value1)(new W(new sn(s,o.value0.value0,o.value0.value1,o.value0.value2.value0,o.value0.value2.value1,o.value0.value2.value2,o.value0.value2.value3),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ot&&o.value0.value0 instanceof W?(v=!0,r(o.value1)(new W(new sn(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3,o.value0.value1,o.value0.value2,s),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ot&&o.value0.value5 instanceof W?(v=!0,r(o.value1)(new W(o.value0.value0,o.value0.value1,o.value0.value2,new sn(s,o.value0.value3,o.value0.value4,o.value0.value5.value0,o.value0.value5.value1,o.value0.value5.value2,o.value0.value5.value3)))):o.value0 instanceof $t&&o.value0.value3 instanceof W?(v=!0,r(o.value1)(new W(o.value0.value0,o.value0.value1,o.value0.value2,new sn(o.value0.value3.value0,o.value0.value3.value1,o.value0.value3.value2,o.value0.value3.value3,o.value0.value4,o.value0.value5,s)))):o.value0 instanceof Ht&&o.value0.value2 instanceof sn?(v=!0,r(o.value1)(new sn(new W(s,o.value0.value0,o.value0.value1,o.value0.value2.value0),o.value0.value2.value1,o.value0.value2.value2,new W(o.value0.value2.value3,o.value0.value2.value4,o.value0.value2.value5,o.value0.value2.value6),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ot&&o.value0.value0 instanceof sn?(v=!0,r(o.value1)(new sn(new W(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3),o.value0.value0.value4,o.value0.value0.value5,new W(o.value0.value0.value6,o.value0.value1,o.value0.value2,s),o.value0.value3,o.value0.value4,o.value0.value5))):o.value0 instanceof ot&&o.value0.value5 instanceof sn?(v=!0,r(o.value1)(new sn(o.value0.value0,o.value0.value1,o.value0.value2,new W(s,o.value0.value3,o.value0.value4,o.value0.value5.value0),o.value0.value5.value1,o.value0.value5.value2,new W(o.value0.value5.value3,o.value0.value5.value4,o.value0.value5.value5,o.value0.value5.value6)))):o.value0 instanceof $t&&o.value0.value3 instanceof sn?(v=!0,r(o.value1)(new sn(o.value0.value0,o.value0.value1,o.value0.value2,new W(o.value0.value3.value0,o.value0.value3.value1,o.value0.value3.value2,o.value0.value3.value3),o.value0.value3.value4,o.value0.value3.value5,new W(o.value0.value3.value6,o.value0.value4,o.value0.value5,s)))):(v=!0,ae("The impossible happened in partial function `up`."))}throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[o.constructor.name])}for(;!v;)C=p(_,l);return C}},u=function(f){return function(l){var _=f,v=!1,C;function p(o,s){if(s instanceof W&&s.value0 instanceof I&&s.value3 instanceof I)return v=!0,a(o)(I.value);if(s instanceof W){_=new j(new Ct(s.value0,s.value1,s.value2),o),l=s.value3;return}if(s instanceof sn&&s.value0 instanceof I&&s.value3 instanceof I&&s.value6 instanceof I)return v=!0,a(new j(new Ct(I.value,s.value1,s.value2),o))(I.value);if(s instanceof sn){_=new j(new $t(s.value0,s.value1,s.value2,s.value3,s.value4,s.value5),o),l=s.value6;return}return v=!0,ae("The impossible happened in partial function `removeMaxNode`.")}for(;!v;)C=p(_,l);return C}},i=function(f){var l=!1,_;function v(C){if(C instanceof W&&C.value3 instanceof I)return l=!0,{key:C.value1,value:C.value2};if(C instanceof W){f=C.value3;return}if(C instanceof sn&&C.value6 instanceof I)return l=!0,{key:C.value4,value:C.value5};if(C instanceof sn){f=C.value6;return}return l=!0,ae("The impossible happened in partial function `maxNode`.")}for(;!l;)_=v(f);return _},c=function(f){return function(l){var _=f,v=!1,C;function p(o,s){if(s instanceof I)return v=!0,D.value;if(s instanceof W){var Ln=t(e)(s.value1);if(s.value3 instanceof I&&Ln instanceof G)return v=!0,new d(new b(s.value2,a(o)(I.value)));if(Ln instanceof G){var En=i(s.value0);return v=!0,new d(new b(s.value2,u(new j(new Wt(En.key,En.value,s.value3),o))(s.value0)))}if(Ln instanceof q){_=new j(new Wt(s.value1,s.value2,s.value3),o),l=s.value0;return}_=new j(new Ct(s.value0,s.value1,s.value2),o),l=s.value3;return}if(s instanceof sn){var Fr=function(){return s.value0 instanceof I&&s.value3 instanceof I&&s.value6 instanceof I}(),Ln=t(e)(s.value4),$r=t(e)(s.value1);if(Fr&&$r instanceof G)return v=!0,new d(new b(s.value2,r(o)(new W(I.value,s.value4,s.value5,I.value))));if(Fr&&Ln instanceof G)return v=!0,new d(new b(s.value5,r(o)(new W(I.value,s.value1,s.value2,I.value))));if($r instanceof G){var En=i(s.value0);return v=!0,new d(new b(s.value2,u(new j(new Ht(En.key,En.value,s.value3,s.value4,s.value5,s.value6),o))(s.value0)))}if(Ln instanceof G){var En=i(s.value3);return v=!0,new d(new b(s.value5,u(new j(new ot(s.value0,s.value1,s.value2,En.key,En.value,s.value6),o))(s.value3)))}if($r instanceof q){_=new j(new Ht(s.value1,s.value2,s.value3,s.value4,s.value5,s.value6),o),l=s.value0;return}if($r instanceof J&&Ln instanceof q){_=new j(new ot(s.value0,s.value1,s.value2,s.value4,s.value5,s.value6),o),l=s.value3;return}_=new j(new $t(s.value0,s.value1,s.value2,s.value3,s.value4,s.value5),o),l=s.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[s.constructor.name])}for(;!v;)C=p(_,l);return C}};return c(xn.value)}};var Pe=function(){return I.value}(),Po=function(n){var r=So(n);return function(t){return dr(t)(function(e){return function(a){return r(a.value0)(a.value1)(e)}})(Pe)}};var Id=function(n){var r=Ld(n);return function(t){return function(e){return Xn(e)(er)(r(t)(e))}}};var xd=function(n){var r=Ut(n),t=Id(n),e=So(n);return function(a){return function(u){return function(i){var c=a(r(u)(i));if(c instanceof D)return t(u)(i);if(c instanceof d)return e(u)(c.value0)(i);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[c.constructor.name])}}}};var xl=function(n){var r=xd(n);return function(t){return function(e){return function(a){return r(Xn(D.value)(t))(e)(a)}}}};var Er=function(){var n={},r="Pure",t="Throw",e="Catch",a="Sync",u="Async",i="Bind",c="Bracket",f="Fork",l="Sequential",_="Map",v="Apply",C="Alt",p="Cons",o="Resume",s="Release",Ln="Finalizer",En="Finalized",Fr="Forked",$r="Fiber",Hf="Thunk";function x(L,_n,Rn,Dn){this.tag=L,this._1=_n,this._2=Rn,this._3=Dn}function wr(L){var _n=function(Rn,Dn,N){return new x(L,Rn,Dn,N)};return _n.tag=L,_n}function Nu(L){return new x(r,void 0)}function sm(L){try{L()}catch(_n){setTimeout(function(){throw _n},0)}}function pm(L,_n,Rn){try{return _n(Rn())}catch(Dn){return L(Dn)}}function mm(L,_n,Rn){try{return _n(Rn)()}catch(Dn){return Rn(L(Dn))(),Nu}}var ja=function(){var L=1024,_n=0,Rn=0,Dn=new Array(L),N=!1;function T(){var dn;for(N=!0;_n!==0;)_n--,dn=Dn[Rn],Dn[Rn]=void 0,Rn=(Rn+1)%L,dn();N=!1}return{isDraining:function(){return N},enqueue:function(dn){var Y,Sn;_n===L&&(Sn=N,T(),N=Sn),Dn[(Rn+_n)%L]=dn,_n++,N||T()}}}();function _m(L){var _n={},Rn=0,Dn=0;return{register:function(N){var T=Rn++;N.onComplete({rethrow:!0,handler:function(dn){return function(){Dn--,delete _n[T]}}})(),_n[T]=N,Dn++},isEmpty:function(){return Dn===0},killAll:function(N,T){return function(){if(Dn===0)return T();var dn=0,Y={};function Sn(Tn){Y[Tn]=_n[Tn].kill(N,function(qn){return function(){delete Y[Tn],dn--,L.isLeft(qn)&&L.fromLeft(qn)&&setTimeout(function(){throw L.fromLeft(qn)},0),dn===0&&T()}})()}for(var Yn in _n)_n.hasOwnProperty(Yn)&&(dn++,Sn(Yn));return _n={},Rn=0,Dn=0,function(Tn){return new x(a,function(){for(var qn in Y)Y.hasOwnProperty(qn)&&Y[qn]()})}}}}}var ve=0,yr=1,Va=2,Qa=3,Ka=4,br=5,Ze=6;function Au(L,_n,Rn){var Dn=0,N=ve,T=Rn,dn=null,Y=null,Sn=null,Yn=null,Tn=null,qn=0,zt=0,Lr=null,Mt=!0;function Et(A){for(var S,an,pn;;)switch(S=null,an=null,pn=null,N){case Va:N=yr;try{T=Sn(T),Yn===null?Sn=null:(Sn=Yn._1,Yn=Yn._2)}catch(nr){N=br,dn=L.left(nr),T=null}break;case Qa:L.isLeft(T)?(N=br,dn=T,T=null):Sn===null?N=br:(N=Va,T=L.fromRight(T));break;case yr:switch(T.tag){case i:Sn&&(Yn=new x(p,Sn,Yn)),Sn=T._2,N=yr,T=T._1;break;case r:Sn===null?(N=br,T=L.right(T._1)):(N=Va,T=T._1);break;case a:N=Qa,T=pm(L.left,L.right,T._1);break;case u:N=Ka,T=mm(L.left,T._1,function(nr){return function(){Dn===A&&(Dn++,ja.enqueue(function(){Dn===A+1&&(N=Qa,T=nr,Et(Dn))}))}});return;case t:N=br,dn=L.left(T._1),T=null;break;case e:Sn===null?Tn=new x(p,T,Tn,Y):Tn=new x(p,T,new x(p,new x(o,Sn,Yn),Tn,Y),Y),Sn=null,Yn=null,N=yr,T=T._1;break;case c:qn++,Sn===null?Tn=new x(p,T,Tn,Y):Tn=new x(p,T,new x(p,new x(o,Sn,Yn),Tn,Y),Y),Sn=null,Yn=null,N=yr,T=T._1;break;case f:N=Qa,S=Au(L,_n,T._2),_n&&_n.register(S),T._1&&S.run(),T=L.right(S);break;case l:N=yr,T=dm(L,_n,T._1);break}break;case br:if(Sn=null,Yn=null,Tn===null)N=Ze,T=Y||dn||T;else switch(S=Tn._3,pn=Tn._1,Tn=Tn._2,pn.tag){case e:Y&&Y!==S&&qn===0?N=br:dn&&(N=yr,T=pn._2(L.fromLeft(dn)),dn=null);break;case o:Y&&Y!==S&&qn===0||dn?N=br:(Sn=pn._1,Yn=pn._2,N=Va,T=L.fromRight(T));break;case c:qn--,dn===null&&(an=L.fromRight(T),Tn=new x(p,new x(s,pn._2,an),Tn,S),(Y===S||qn>0)&&(N=yr,T=pn._3(an)));break;case s:Tn=new x(p,new x(En,T,dn),Tn,Y),N=yr,Y&&Y!==S&&qn===0?T=pn._1.killed(L.fromLeft(Y))(pn._2):dn?T=pn._1.failed(L.fromLeft(dn))(pn._2):T=pn._1.completed(L.fromRight(T))(pn._2),dn=null,qn++;break;case Ln:qn++,Tn=new x(p,new x(En,T,dn),Tn,Y),N=yr,T=pn._1;break;case En:qn--,N=br,T=pn._1,dn=pn._2;break}break;case Ze:for(var Hn in Lr)Lr.hasOwnProperty(Hn)&&(Mt=Mt&&Lr[Hn].rethrow,sm(Lr[Hn].handler(T)));Lr=null,Y&&dn?setTimeout(function(){throw L.fromLeft(dn)},0):L.isLeft(T)&&Mt&&setTimeout(function(){if(Mt)throw L.fromLeft(T)},0);return;case ve:N=yr;break;case Ka:return}}function Wn(A){return function(){if(N===Ze)return Mt=Mt&&A.rethrow,A.handler(T)(),function(){};var S=zt++;return Lr=Lr||{},Lr[S]=A,function(){Lr!==null&&delete Lr[S]}}}function P(A,S){return function(){if(N===Ze)return S(L.right(void 0))(),function(){};var an=Wn({rethrow:!1,handler:function(){return S(L.right(void 0))}})();switch(N){case ve:Y=L.left(A),N=Ze,T=Y,Et(Dn);break;case Ka:Y===null&&(Y=L.left(A)),qn===0&&(N===Ka&&(Tn=new x(p,new x(Ln,T(A)),Tn,Y)),N=br,T=null,dn=null,Et(++Dn));break;default:Y===null&&(Y=L.left(A)),qn===0&&(N=br,T=null,dn=null)}return an}}function X(A){return function(){var S=Wn({rethrow:!1,handler:A})();return N===ve&&Et(Dn),S}}return{kill:P,join:X,onComplete:Wn,isSuspended:function(){return N===ve},run:function(){N===ve&&(ja.isDraining()?Et(Dn):ja.enqueue(function(){Et(Dn)}))}}}function vm(L,_n,Rn,Dn){var N=0,T={},dn=0,Y={},Sn=new Error("[ParAff] Early exit"),Yn=null,Tn=n;function qn(Wn,P,X){var A=P,S=null,an=null,pn=0,Hn={},nr,na;n:for(;;)switch(nr=null,A.tag){case Fr:if(A._3===n&&(nr=T[A._1],Hn[pn++]=nr.kill(Wn,function(Dm){return function(){pn--,pn===0&&X(Dm)()}})),S===null)break n;A=S._2,an===null?S=null:(S=an._1,an=an._2);break;case _:A=A._2;break;case v:case C:S&&(an=new x(p,S,an)),S=A,A=A._1;break}if(pn===0)X(L.right(void 0))();else for(na=0,nr=pn;na<nr;na++)Hn[na]=Hn[na]();return Hn}function zt(Wn,P,X){var A,S,an,pn,Hn,nr;L.isLeft(Wn)?(A=Wn,S=null):(S=Wn,A=null);n:for(;;){if(an=null,pn=null,Hn=null,nr=null,Yn!==null)return;if(P===null){Dn(A||S)();return}if(P._3!==n)return;switch(P.tag){case _:A===null?(P._3=L.right(P._1(L.fromRight(S))),S=P._3):P._3=A;break;case v:if(an=P._1._3,pn=P._2._3,A){if(P._3=A,Hn=!0,nr=dn++,Y[nr]=qn(Sn,A===an?P._2:P._1,function(){return function(){delete Y[nr],Hn?Hn=!1:X===null?zt(A,null,null):zt(A,X._1,X._2)}}),Hn){Hn=!1;return}}else{if(an===n||pn===n)return;S=L.right(L.fromRight(an)(L.fromRight(pn))),P._3=S}break;case C:if(an=P._1._3,pn=P._2._3,an===n&&L.isLeft(pn)||pn===n&&L.isLeft(an))return;if(an!==n&&L.isLeft(an)&&pn!==n&&L.isLeft(pn))A=S===an?pn:an,S=null,P._3=A;else if(P._3=S,Hn=!0,nr=dn++,Y[nr]=qn(Sn,S===an?P._2:P._1,function(){return function(){delete Y[nr],Hn?Hn=!1:X===null?zt(S,null,null):zt(S,X._1,X._2)}}),Hn){Hn=!1;return}break}X===null?P=null:(P=X._1,X=X._2)}}function Lr(Wn){return function(P){return function(){delete T[Wn._1],Wn._3=P,zt(P,Wn._2._1,Wn._2._2)}}}function Mt(){var Wn=yr,P=Rn,X=null,A=null,S,an;n:for(;;)switch(S=null,an=null,Wn){case yr:switch(P.tag){case _:X&&(A=new x(p,X,A)),X=new x(_,P._1,n,n),P=P._2;break;case v:X&&(A=new x(p,X,A)),X=new x(v,n,P._2,n),P=P._1;break;case C:X&&(A=new x(p,X,A)),X=new x(C,n,P._2,n),P=P._1;break;default:an=N++,Wn=br,S=P,P=new x(Fr,an,new x(p,X,A),n),S=Au(L,_n,S),S.onComplete({rethrow:!1,handler:Lr(P)})(),T[an]=S,_n&&_n.register(S)}break;case br:if(X===null)break n;X._1===n?(X._1=P,Wn=yr,P=X._2,X._2=n):(X._2=P,P=X,A===null?X=null:(X=A._1,A=A._2))}for(Tn=P,an=0;an<N;an++)T[an].run()}function Et(Wn,P){Yn=L.left(Wn);var X;for(var A in Y)if(Y.hasOwnProperty(A)){X=Y[A];for(A in X)X.hasOwnProperty(A)&&X[A]()}Y=null;var S=qn(Wn,Tn,P);return function(an){return new x(u,function(pn){return function(){for(var Hn in S)S.hasOwnProperty(Hn)&&S[Hn]();return Nu}})}}return Mt(),function(Wn){return new x(u,function(P){return function(){return Et(Wn,P)}})}}function dm(L,_n,Rn){return new x(u,function(Dn){return function(){return vm(L,_n,Rn,Dn)}})}return x.EMPTY=n,x.Pure=wr(r),x.Throw=wr(t),x.Catch=wr(e),x.Sync=wr(a),x.Async=wr(u),x.Bind=wr(i),x.Bracket=wr(c),x.Fork=wr(f),x.Seq=wr(l),x.ParMap=wr(_),x.ParApply=wr(v),x.ParAlt=wr(C),x.Fiber=Au,x.Supervisor=_m,x.Scheduler=ja,x.nonCanceler=Nu,x}(),Nl=Er.Pure,Nd=Er.Throw;function Al(n){return function(r){return r.tag===Er.Pure.tag?Er.Pure(n(r._1)):Er.Bind(r,function(t){return Er.Pure(n(t))})}}function Sl(n){return function(r){return Er.Bind(n,r)}}var Pl=Er.Sync;var Rl=Er.Async;function Wl(n,r){return function(){return Er.Fiber(n,null,r)}}var Hl=function(){function n(t,e){return t===0&&typeof setImmediate<"u"?setImmediate(e):setTimeout(e,t)}function r(t,e){return t===0&&typeof clearImmediate<"u"?clearImmediate(e):clearTimeout(e)}return function(t,e){return Er.Async(function(a){return function(){var u=n(e,a(t()));return function(){return Er.Sync(function(){return t(r(e,u))})}}})}}(),Ad=Er.Seq;var Ho={dimap:function(n){return function(r){return function(t){return function(e){return r(t(n(e)))}}}}},Re=function(n){return n.dimap};var Qd=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}};var Kd=tr(tn);var gi={map:Al};var Yd=function(){var n=function(e){if(e instanceof In)return e.value0;if(e instanceof Nn)return ae("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[e.constructor.name])},r=function(e){if(e instanceof Nn)return e.value0;if(e instanceof In)return ae("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[e.constructor.name])},t=function(e){if(e instanceof Nn)return!0;if(e instanceof In)return!1;throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[e.constructor.name])};return{isLeft:t,fromLeft:r,fromRight:n,left:Nn.create,right:In.create}}(),Xd=function(n){return Wl(Yd,n)},Zd=function(n){return function(){var t=Xd(n)();return t.run(),t}},Ti=function(n){return Kd(Zd(n))};var Vl=function(n){return Hl(In.create,n)};var Na={Applicative0:function(){return Sa},Bind1:function(){return Aa}},Aa={bind:Sl,Apply0:function(){return Ql(0)}},Sa={pure:Nl,Apply0:function(){return Ql(0)}},Ql=Qd("applyAff","Effect.Aff",function(){return{apply:_r(Na),Functor0:function(){return gi}}});var nD=E(Sa),rD=R(Aa);var He={liftEffect:Pl,Monad0:function(){return Na}};var Kl={tailRecM:function(n){var r=function(t){return rD(n(t))(function(e){if(e instanceof Un)return nD(e.value0);if(e instanceof $n)return r(e.value0);throw new Error("Failed pattern match at Effect.Aff (line 104, column 7 - line 106, column 23): "+[e.constructor.name])})};return r},Monad0:function(){return Na}};var Yl=(n,r)=>({...n,...r}),Xl=(n,r)=>n&&r?t=>n(r(t)):n||r,Zl=(n,r,t,e,a,u,i)=>{if(r==="style")for(let c in Yl(t,e))t=e==null||e[c]==null?"":e[c],c[0]==="-"?n[r].setProperty(c,t):n[r][c]=t;else if(r[0]==="o"&&r[1]==="n"){let c=r.slice(2);n.actions||(n.actions={}),n.actions[c]=i&&e?i(e):e,e?t||n.addEventListener(c,a):n.removeEventListener(c,a)}else!u&&r in n?n[r]=e:e==null||e===!1||r==="class"&&!e?n.removeAttribute(r):n.setAttribute(r,e)},Uo=(n,r,t,e)=>{let a=n.type===3?document.createTextNode(n.tag):(t=t||n.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",n.tag):document.createElement(n.tag),u=n.props,i=Xl(e,n.mapf);for(let c in u)Zl(a,c,null,u[c],r,t,i);for(let c=0,f=n.children.length;c<f;c++)a.appendChild(Uo(ue(n.children[c]).html,r,t,i));return n.node=a,a},oe=(n,r,t,e,a,u,i)=>{if(t!==e)if(t!=null&&t.type===3&&e.type===3)t.tag!==e.tag&&(r.nodeValue=e.tag);else if(t==null||t.tag!==e.tag)r=n.insertBefore(Uo(e,a,u,i),r),t&&n.removeChild(t.node);else{let c=t.props,f=e.props,l=t.children,_=e.children,v=l.length-1,C=_.length-1;i=Xl(i,e.mapf),u=u||e.tag==="svg";for(let p in Yl(c,f))(p==="value"||p==="selected"||p==="checked"?r[p]:c[p])!==f[p]&&Zl(r,p,c[p],f[p],a,u,i);if(e.keyed){let p=0,o=0;for(;o<=C&&p<=v;){let{key:s,html:Ln}=l[p];if(s!==_[o].key)break;let En=ue(_[o],Ln);oe(r,Ln.node,Ln,En.html,a,u,i),o++,p++}for(;o<=C&&p<=v;){let{key:s,html:Ln}=l[v];if(s!==_[C].key)break;let En=ue(_[C],Ln);oe(r,Ln.node,Ln,En.html,a,u,i),C--,v--}if(p>v)for(;o<=C;){let s=ue(_[o]).html;r.insertBefore(Uo(s,a,u,i),l[p]&&l[p].html.node),o++}else if(o>C)for(;p<=v;)r.removeChild(l[p].html.node),p++;else{let s={},Ln={};for(let En=p;En<=v;En++)s[l[En].key]=l[En].html;for(;o<=C;){let{key:En,html:Fr}=l[p]||{key:null,html:null},{key:$r,html:Hf}=ue(_[o],Fr);if(Ln[En]||l[p+1]&&$r===l[p+1].key){p++;continue}if(En===$r)oe(r,Fr.node,Fr,Hf,a,u,i),Ln[$r]=!0,p++;else{let x=s[$r];x!=null?(oe(r,r.insertBefore(x.node,Fr.node),x,_[o].html,a,u,i),Ln[$r]=!0):oe(r,Fr&&Fr.node,null,_[o].html,a,u,i)}o++}for(let En in s)Ln[En]||r.removeChild(s[En].node)}}else{for(let p=0;p<=v&&p<=C;p++){let o=l[p].html,s=ue(_[p],o).html;oe(r,o.node,o,s,a,u,i)}for(let p=v+1;p<=C;p++){let o=ue(_[p],t).html;r.appendChild(Uo(o,a,u,i))}for(let p=C+1;p<=v;p++)r.removeChild(l[p].html.node)}}return e.node=r,r},tD=(n,r)=>{for(let t=0;t<n.length;t++)if(n[t]!==r[t])return!0;return!1},eD=(n,r)=>r.reduce((t,e)=>t(e),n),ue=(n,r)=>(typeof n.html.type=="function"&&((!r||r.memo==null||tD(r.memo,n.html.memo))&&(r=Pa(eD(n.html.type,n.html.memo)),r.memo=n.html.memo),n.html=r),n),Pa=n=>({...n,children:n.children&&n.children.map(({key:r,html:t})=>({key:r,html:Pa(t)}))}),Ci=n=>r=>()=>n.actions[r],bi=n=>r=>t=>e=>a=>()=>oe(n,r,t,e,u=>a(u)()),Mi=n=>r=>(r.node=n,r);var oD=(n,r,t,e=!1)=>{let a={},u={style:a},i={tag:n,children:t,props:u,node:null,keyed:e},c=r.length;for(let f=0;f<c;f++){let[l,_,v]=r[f];l==1?u[_]=v:l===2?u.class=u.class?u.class+" "+_:_:l===3&&(a[_]=v)}return i},Kn=n=>r=>t=>oD(n,r,t.map(e=>({key:null,html:e})));var uD=n=>({tag:n,props:{},children:[],type:3});var Dr=n=>r=>[1,n,r],hn=n=>[2,n];var qo=n=>r=>[1,"on"+n,r],Oo=n=>r=>[3,n,r],fn=uD;function ns(n){return n.currentTarget}function Ei(n){return n.type}var Fi=function(n){var r=E(n.Applicative0()),t=Rr(n.Plus1());return function(e){if(e)return r(void 0);if(!e)return t;throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): "+[e.constructor.name])}},rs={Applicative0:function(){return ye},Plus1:function(){return Mc}};function es(n,r,t){return n==null?r:t(n)}var An=function(n){return es(n,D.value,d.create)};var $e=function(n){return An(ns(n))};var vD=fn("");var os=function(n){return function(r){if(n instanceof d)return r(n.value0);if(n instanceof D)return vD;throw new Error("Failed pattern match at Pha.Html.Core (line 82, column 1 - line 82, column 52): "+[n.constructor.name,r.constructor.name])}};var ie={first:function(n){return function(r){return new b(n(r.value0),r.value1)}},second:m(Kt),Profunctor0:function(){return Ho}};var Jo=function(n){return n.first};var Ue=function(n){return n};var Ai=function(n){var r=m(n);return{map:function(t){return function(e){return function(a){return r(function(u){return new b(t(u.value0),u.value1)})(e(a))}}}}};var Go=function(n){return{Applicative0:function(){return Pi(n)},Bind1:function(){return Si(n)}}},Si=function(n){var r=R(n.Bind1());return{bind:function(t){return function(e){return function(a){return r(t(a))(function(u){var i=e(u.value0);return i(u.value1)})}}},Apply0:function(){return jo(n)}}},jo=function(n){var r=Ai(n.Bind1().Apply0().Functor0());return{apply:_r(Go(n)),Functor0:function(){return r}}},Pi=function(n){var r=E(n.Applicative0());return{pure:function(t){return function(e){return r(new b(t,e))}},Apply0:function(){return jo(n)}}};var is=function(n){var r=n.Monad0(),t=R(r.Bind1()),e=E(r.Applicative0()),a=ur(n),u=Go(r);return{tailRecM:function(i){return function(c){var f=function(l){var _=i(l.value0);return t(_(l.value1))(function(v){return e(function(){if(v.value0 instanceof $n)return new $n(new b(v.value0.value0,v.value1));if(v.value0 instanceof Un)return new Un(new b(v.value0.value0,v.value1));throw new Error("Failed pattern match at Control.Monad.State.Trans (line 87, column 16 - line 89, column 40): "+[v.value0.constructor.name])}())})};return function(l){return a(f)(new b(c,l))}}},Monad0:function(){return u}}},fs=function(n){var r=E(n.Applicative0()),t=Go(n);return{state:function(e){return function(a){return r(e(a))}},Monad0:function(){return t}}};var xD=Gn(Gu);var cs={liftAff:Z(en),MonadEffect0:function(){return He}},Vo=function(n){return n.liftAff};var ls=function(n){var r=n.MonadEffect0(),t=po(r);return{liftAff:function(){var e=xD(r.Monad0()),a=Vo(n);return function(u){return e(a(u))}}(),MonadEffect0:function(){return t}}};function Wi(n){return function(r){return n===r}}var Hi=Wi;var AD=_o(ha);var ce=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),bt=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),qe=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Oe=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),$i=function(n){return n},Ui=gn,qi=Io;var Qo={state:function(n){return $i(Se(ce.create(n)))},Monad0:function(){return qi}},ms=Di,Oi=function(n){return{liftEffect:function(){var r=Zn(n);return function(t){return $i(Se(bt.create(r(t))))}}(),Monad0:function(){return qi}}},_s=function(n){return{ask:Se(new bt(Zr(n))),Monad0:function(){return qi}}},SD=function(n){var r=Oi(n.MonadEffect0());return{liftAff:function(){var t=Vo(n);return function(e){return $i(Se(bt.create(t(e))))}}(),MonadEffect0:function(){return r}}},vs=function(n){var r=m(n);return{map:function(t){return function(e){if(e instanceof ce)return new ce(function(){var a=AD(t);return function(u){return a(e.value0(u))}}());if(e instanceof bt)return new bt(r(t)(e.value0));if(e instanceof qe)return new qe(e.value0,function(a){return t(e.value1(a))});if(e instanceof Oe)return new Oe(e.value0,t(e.value1));throw new Error("Failed pattern match at Pha.Update (line 43, column 1 - line 47, column 50): "+[t.constructor.name,e.constructor.name])}}}};var Ko=Ia;var ds=xa;var Ds=function(n){return function(r){return Tl(function(t){if(t instanceof ce)return new ce(t.value0);if(t instanceof bt)return new bt(n(t.value0));if(t instanceof qe)return new qe(t.value0,t.value1);if(t instanceof Oe)return new Oe(t.value0,t.value1);throw new Error("Failed pattern match at Pha.Update (line 105, column 45 - line 109, column 38): "+[t.constructor.name])})(r)}},ys=function(n){var r=Vo(SD(n));return function(t){return r(Vl(t))}};var le=function(n){return function(r){return function(){return r[n]}}},PD=le("URL"),RD=le("documentURI"),WD=le("origin"),HD=le("compatMode"),$D=le("characterSet"),UD=le("contentType");var qD=le("documentElement");function zi(n){return function(r){return function(){return r.createTextNode(n)}}}function hs(n,r,t,e){if(typeof window<"u"){var a=window[t];if(a!=null&&e instanceof a)return r(e)}for(var u=e;u!=null;){var i=Object.getPrototypeOf(u),c=i.constructor.name;if(c===t)return r(e);if(c==="Object")return n;u=i}return n}var M=function(n){return function(r){return hs(D.value,d.create,n,r)}};var Yo=function(n){return function(r){return r[n]}},kD=Yo("namespaceURI"),JD=Yo("prefix"),GD=Yo("localName"),jD=Yo("tagName");var Xo=function(n){return function(r){return function(){return r[n]}}},QD=Xo("children"),KD=Xo("firstElementChild"),YD=Xo("lastElementChild"),XD=Xo("childElementCount");function Ts(n){return function(r){return function(){return r.querySelector(n)}}}var ny=m(tn);var Cs=function(n){var r=ny(An),t=Ts(n);return function(e){return r(t(e))}};var bs=h;var Jr=function(n){return function(r){return function(){return r[n]}}};var oy=Jr("baseURI"),uy=Jr("ownerDocument"),Ms=Jr("parentNode"),iy=Jr("parentElement");var fy=Jr("childNodes"),cy=Jr("firstChild"),ly=Jr("lastChild"),sy=Jr("previousSibling"),py=Jr("nextSibling"),my=Jr("nodeValue");var _y=Jr("textContent");function ki(n){return function(r){return function(){r.appendChild(n)}}}var yy=m(tn);var Es=function(){var n=yy(An);return function(r){return n(Ms(r))}}();var Fs=h;var Zo=function(){return window};var ws=h;var Ls=h;function Ji(n){return function(){return n.checked}}function Gi(n){return function(){return n.value}}var ji=M("HTMLInputElement");function Vi(n){return function(){return n.value}}var As=M("HTMLSelectElement");function nu(n){return function(){return n.document}}var Qi=R(eo),Mh=Kr(Yr),Wa=To(Xr)(Ta),Eh=De(Xr),ru=R(Aa),se=Zn(He),Ki=Mh(Aa),Yi=E(Sa),Fh=So(Ui),wh=To(Sa)(Ta),Lh=Ut(Ui),Ih=dl(vs(gi))(Kl),Xi=ar(tn),xh=m(tn),Nh=m(kn);var Ah=function(n){return Sr(n.state)},Sh=function(n){return function(){var t=Sr(n.freshId)();return rt(t+1|0)(n.freshId)(),t}},Ss=function(n){return n.update(n)},Ph=function(n){return function(r){return function(t){return function(){var a=t(r)();return Wa(a)(Ss(n))()}}}},Ps=function(n){return function(r){var t=function(e){var a=Ei(e);return Wa($e(e))(function(u){return function(){var c=Ci(u)(a)();return Ph(n)(e)(c)()}})};return function(){var a=Sr(n.vdom)(),u=Sr(n.node)(),i=Es(u)();return Wa(i)(function(c){var f=Pa(r);return function(){var _=bi(c)(u)(a)(f)(t)();return rt(_)(n.node)(),rt(f)(n.vdom)()}})()}}},Rh=function(n){return function(r){return function(){var e=Sr(n.state)();return Eh(Hi(e)(r))(function(){return rt(r)(n.state)(),Ps(n)(n.view(r))()})()}}},Rs=function(n){return function(r){return function(t){var e=function(a){if(a instanceof ce)return ru(se(Ah(r)))(function(u){var i=a.value0(u);return Ki(se(Rh(r)(i.value1)))(function(){return Yi(i.value0)})});if(a instanceof bt)return a.value0;if(a instanceof qe)return ru(se(a.value0(function(u){return Ti(Rs(n)(r)(n(u)))})))(function(u){return ru(se(Sh(r)))(function(i){return Ki(se(gc(Fh(i)(u))(r.subscriptions)))(function(){return Yi(a.value1(i))})})});if(a instanceof Oe)return ru(se(Sr(r.subscriptions)))(function(u){return Ki(wh(Lh(a.value0)(u))(se))(function(){return Yi(a.value1)})});throw new Error("Failed pattern match at Pha.App (line 114, column 3 - line 118, column 11): "+[a.constructor.name])};return Ih(e)(t)}}},Wh=function(n){return function(){var t=Xi(Qi(Zo)(nu))(ws)(),e=xh(Nh(bs))(Cs(n.selector)(t))();return Wa(e)(function(a){return function(){var i=tt(n.init.model)(),c=Xi(Qi(Xi(Qi(Zo)(nu))(Ls))(zi("")))(Fs)();ki(c)(a)();var f=tt(c)(),l=tt(Mi(c)(fn("")))(),_=tt(Pe)(),v=tt(0)(),C={view:n.view,update:n.update,state:i,node:f,vdom:l,subscriptions:_,freshId:v};return Ps(C)(n.view(n.init.model))(),Wa(n.init.msg)(Ss(C))()}})()}};var Ws=function(n){var r=function(t){return function(e){return Ti(Rs(n.update)(t)(n.update(e)))}};return Wh({init:n.init,view:n.view,selector:n.selector,update:r})};var Hs=function(n){return function(r){return function(t){return(t|0)===t?n(t):r}}},wn=function(n){return n},$s=function(n){return function(r){return function(t){var e;t<11?e="[0-"+(t-1).toString()+"]":t===11?e="[0-9a]":e="[0-9a-"+String.fromCharCode(86+t)+"]";var a=new RegExp("^[\\+\\-]?"+e+"+$","i");return function(u){if(a.test(u)){var i=parseInt(u,t);return(i|0)===i?n(i):r}else return r}}}};var tu=isFinite;var Ha=Math.floor;var $a=function(n){return function(r){return n%r}};var Zi=Math.sin;var Us=mt(ia),qs=xt(ia);var zh=function(){return $s(d.create)(D.value)}(),pe=zh(10),nf=function(){return Hs(d.create)(D.value)}(),kh=function(n){if(!tu(n))return 0;if(n>=wn(Us))return Us;if(n<=wn(qs))return qs;if(sr)return Jn(0)(nf(n));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[n.constructor.name])};var au=function(n){return kh(Ha(n))};var rf=Math.random;var Os=function(n){return function(r){return function(){var e=rf(),a=(wn(r)-wn(n)+1)*e+wn(n);return au(a)}}};var jh=Ce(be),Vh=Nr();var Bs=function(n){return n};var zs=1,tf=2147483647,ks=function(){return tf-1|0}(),Qh=function(n){var r=function(t){return function(e){return function(a){var u=e-t|0,i=jh(a)(u),c=i<t;return c?i+e|0:i}}};return r(zs)(ks)(n)},ef=m(tn)(Qh)(Os(zs)(ks)),Kh=0,Yh=48271,Js=function(n){return function(r){return Vh(nf($a(wn(Yh)*wn(r)+wn(n))(wn(tf))))}},Gs=Js(Kh);var tg=Br();var Ks=function(n){return function(r){return tg(n(r))}};var Wr=function(n){return function(r){for(var t=n>r?-1:1,e=new Array(t*(r-n)+1),a=n,u=0;a!==r;)e[u++]=a,a+=t;return e[u]=a,e}},ag=function(n){return function(r){if(n<1)return[];var t=new Array(n);return t.fill(r)}},og=function(n){return function(r){for(var t=[],e=0,a=0;a<n;a++)t[e++]=r;return t}},ze=typeof Array.prototype.fill=="function"?ag:og,ug=function(){function n(a,u){this.head=a,this.tail=u}var r={};function t(a){return function(u){return new n(a,u)}}function e(a){for(var u=[],i=0,c=a;c!==r;)u[i++]=c.head,c=c.tail;return u}return function(a){return function(u){return e(a(t)(r)(u))}}}(),qt=function(n){return n.length};var Ys=function(n){return function(r){return function(t){return function(e){return e<0||e>=t.length?r:n(t[e])}}}};var Xs=function(n){return function(r){return function(t){return function(e){for(var a=0,u=e.length;a<u;a++)if(t(e[a]))return n(a);return r}}}};var ou=function(n){if(n.length<=1e4)return Array.prototype.concat.apply([],n);for(var r=[],t=0,e=n.length;t<e;t++)for(var a=n[t],u=0,i=a.length;u<i;u++)r.push(a[u]);return r},me=function(n){return function(r){return r.filter(n)}};var Zs=function(){function n(r,t,e,a,u,i){var c,f,l,_,v,C,p;for(c=u+(i-u>>1),c-u>1&&n(r,t,a,e,u,c),i-c>1&&n(r,t,a,e,c,i),f=u,l=c,_=u;f<c&&l<i;)v=a[f],C=a[l],p=t(r(v)(C)),p>0?(e[_++]=C,++l):(e[_++]=v,++f);for(;f<c;)e[_++]=a[f++];for(;l<i;)e[_++]=a[l++]}return function(r){return function(t){return function(e){var a;return e.length<2?e:(a=e.slice(0),n(r,t,a,e.slice(0),0,e.length),a)}}}}();var ke=function(n){return function(r){for(var t=r.length,e=0;e<t;e++)if(!n(r[e]))return!1;return!0}},np=function(n){return function(r){return n[r]}};var af=function(n){return function(r){return function(){return r.push.apply(r,n)}}};var uu=function(n){return function(){return n}};function fg(n){return function(){return n.slice()}}var of=fg,cg=function(){function n(r,t,e,a,u,i){var c,f,l,_,v,C,p;for(c=u+(i-u>>1),c-u>1&&n(r,t,a,e,u,c),i-c>1&&n(r,t,a,e,c,i),f=u,l=c,_=u;f<c&&l<i;)v=a[f],C=a[l],p=t(r(v)(C)),p>0?(e[_++]=C,++l):(e[_++]=v,++f);for(;f<c;)e[_++]=a[f++];for(;l<i;)e[_++]=a[l++]}return function(r){return function(t){return function(e){return function(){return e.length<2||n(r,t,e,e.slice(0),0,e.length),e}}}}}();var ep=function(n){return function(r){return function(){var e=of(r)();return n(e)(),uu(e)()}}};var uf=function(n){return af([n])};var gg=m(kn);var Tg=U(st);var ip=function(){return np},Cg=ip();var cf=function(n){return Zs(n)(function(r){if(r instanceof J)return 1;if(r instanceof G)return 0;if(r instanceof q)return-1;throw new Error("Failed pattern match at Data.Array (line 870, column 31 - line 873, column 11): "+[r.constructor.name])})};var lf=function(n){var r=Q(n);return function(t){return cf(r)(t)}},sf=function(n){return function(r){return ep(uf(r))(n)()}};var pf=Pt(Ca);var Ua=function(){return Ys(d.create)(D.value)}();var fp=fr(zr);var mf=function(){return Xs(d.create)(D.value)}();var _f=function(n){return function(r){return gg(Cg(r))(mf(n)(r))}};var cp=function(n){var r=V(n);return function(t){return mf(function(e){return r(e)(t)})}};var qa=function(n){var r=cp(n);return function(t){return function(e){return $u(r(t)(e))}}};var iu=function(n){return function(r){return Tg([n])(r)}};var bg=function(){function n(i){this.fn=i}var r={},t=function(i,c){this.head=i,this.tail=c};function e(i){return new t(i,r)}function a(i){return function(c){return new t(i,c)}}function u(i){for(var c=[],f=i;f!==r;)c.push(f.head),f=f.tail;return c}return function(i){return function(c){return function(f){var l=function(v,C){return i(c(a)(f(v)))(C)},_=function(v,C,p){if(C===0)return v;var o=p[C-1];return new n(function(){var s=_(l(o,v),C-1,p);return s})};return function(v){for(var C=c(e)(f(v[v.length-1])),p=_(C,v.length-1,v);p instanceof n;)p=p.fn();return c(u)(p)}}}}}();var Ig=hr(no),xg=xr(no);var sp=function(n){return is(n)};var _e=function(n){return Ai(n)},pp=function(n){return Si(n)},Ng=function(n){return jo(n)},Ge=function(n){return Pi(n)};var Ag=function(n){return n};var mp=function(n){return Ks(Ag(n))};var Sg=function(n){var r=function(t){return new b(Bs(t.newSeed),function(){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.newSeed=Gs(t.newSeed),e}())};return Pr(fs(n))(r)};var Pg=function(n){var r=m(_e(n.Bind1().Apply0().Functor0())),t=Sg(n),e=yn(Ng(n));return function(a){return function(u){var i=wn(u),c=wn(a),f=function(v){return c+$a(v)(i-c+1)},l=r(wn)(t),_=e(r(Ig)(l))(r(xg(2))(l));return r(function(v){return au(f(v))})(_)}}},_p=function(n){var r=Pg(n);return function(t){return function(e){var a=t<=e;return a?r(t)(e):r(e)(t)}}};var Rg=E(Ge(qr)),Wg=m(_e(nt)),Hg=_p(qr);var vf=function(n){return n.length===0?Rg(D.value):Wg(function(r){return Ua(n)(r)})(Hg(0)(qt(n)-1|0))};var Ug=function(n,r,t){var e=0,a;return function(u){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+u+")",r,u);return e=1,a=t(),e=2,a}},cu=R(Ft),qg=Kr(Yr)(Ft),Og=Fi(rs),Dp=E(ye),Bg=Po(gn)(zr),lu=ar(zn),zg=z(vt),yp=E(Ge(qr)),kg=ar(_e(nt)),Jg=m(kn),Gg=Ao(xe),hp=ar(ut),jg=m(ut),Vg=Po(io(gn)(gn))(zr),Qg=Jt(gn),Kg=Ce(be),Yg=la(be),vp=V(Te(Za)),dp=R(dt),Xg=E(jt),Zg=m(zn),df=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),gp=function(n){return function(r){var t=function(e){return cu(r)(function(a){return qg(Og((e-a|0)>=0))(function(){return Dp({edge:a,dest:e-a|0})})})};return new df(Bg(lu(Wr(0)(n))(function(e){return new b(e,t(e))})),n)}},Tp=function(n){return{width:800,height:400,position:function(r){var t=r===0;if(t)return D.value;var e=r<=8;return e?new d({x:wn(r-1|0)*100,y:0}):new d({x:wn(r-9|0)*100,y:200})},edgeNames:lu(n)(function(r){return{edge:r,name:zg(r)}})}},Cp=function(n){return n.value1},Df=function(n){var r=Ut(n);return function(t){return function(e){var a=r(e)(t);if(a instanceof D)return yp(D.value);if(a instanceof d)return kg(vf(a.value0))(Jg(function(u){return{edge:u.edge,dest:u.dest}}));throw new Error("Failed pattern match at SM.Graph (line 104, column 3 - line 106, column 72): "+[a.constructor.name])}}},nT=function(n){var r=Po(n)(zr);return function(t){return function(e){var a=Gg(e.value0),u=lu(a)(function(i){return new b(t(i.value0),lu(i.value1)(function(c){return{edge:c.edge,dest:t(c.dest)}}))});return new df(r(u),t(e.value1))}}},rT=nT(gn),bp=function(n){var r=Ut(n);return function(t){return function(e){var a=Jn([])(r(e)(t));return vf(cu(a)(function(u){return ze(u.nbBalls)({dest:u.dest,edge:u.edge})}))}}},Mp=function(n){var r=Ut(n);return function(t){var e=Ug("t","SM.Graph",function(){return hp(t.value0)(function(u){return te(function(i){return ke(function(c){return Xn(!0)(function(f){return!ee(f)})(r(c.dest)(e(99)))})(u)})})}),a=e(98);return jg(ee)(a)}},tT=function(n){return function(r){var t=function(a){return function(u){return me(function(i){return i.dest.value0>=0&&i.dest.value1>=0})([{edge:0,dest:new b(a-1|0,u)},{edge:1,dest:new b(a-1|0,u-1|0)},{edge:2,dest:new b(a,u-1|0)}])}},e=Vg(cu(Wr(0)(n-1|0))(function(a){return cu(Wr(0)(r-1|0))(function(u){return Dp(new b(new b(a,u),t(a)(u)))})}));return new df(e,new b(n-1|0,r-1|0))}},Ep=function(n){return function(r){return rT(function(t){return t.value0+(t.value1*n|0)|0})(tT(n)(r))}},Fp=function(n){return function(r){var t=Qg(n)(r);return{width:180*t|0,height:180*t|0,position:function(e){var a=e===0;return a?D.value:new d({x:50+180*wn(Kg(e)(n)),y:10+180*wn((r-Yg(e)(n)|0)-1|0)})},edgeNames:[{edge:0,name:""}]}}},wp=function(n){var r=Ut(n),t=Df(n);return function(e){return function(a){return function(u){if(vp(r(u)(a))(new d(!0)))return t(e)(u);if(sr)return yp(dp(r(u)(e))(function(i){return dp(_f(function(c){return vp(r(c.dest)(a))(new d(!0))})(i))(function(c){return Xg({edge:c.edge,dest:c.dest})})}));throw new Error("Failed pattern match at SM.Graph (line 108, column 1 - line 109, column 92): "+[e.constructor.name,a.constructor.name,u.constructor.name])}}}},Lp=function(n){return function(r){return function(t){return hp(t.value0)(Zg(function(e){return{edge:e.edge,dest:e.dest,nbBalls:r}}))}}};var eT=qa(Lt),aT=lf(gn),Np=bp(gn),oT=Lp(gn),uT=Mp(gn),iT=Df(gn),fT=wp(gn),cT=R(pp(qr)),xp=E(Ge(qr)),lT=ur(sp(Tc)),sT=Jt(gn),pT=ar(ut),mT=xl(gn),_T=m(zn),vT=ar(zn),dT=ar(_e(nt)),Oa=function(){function n(){}return n.value=new n,n}(),su=function(){function n(){}return n.value=new n,n}(),Ot=function(){function n(){}return n.value=new n,n}(),Hr=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Gr=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),je=function(){function n(){}return n.value=new n,n}(),Ba=function(){function n(){}return n.value=new n,n}(),Ve=function(){function n(){}return n.value=new n,n}(),pu={eq:function(n){return function(r){return n instanceof Oa&&r instanceof Oa||n instanceof su&&r instanceof su||n instanceof Ot&&r instanceof Ot}}},DT={eq:function(n){return function(r){return n instanceof je&&r instanceof je||n instanceof Ba&&r instanceof Ba||n instanceof Ve&&r instanceof Ve}}},yT=kt(DT),Ap=function(n){return function(r){if(eT(n)(r))return me(function(t){return t!==n})(r);if(sr)return aT(iu(n)(r));throw new Error("Failed pattern match at SM.Model (line 67, column 1 - line 67, column 50): "+[n.constructor.name,r.constructor.name])}},hT=function(n){return Np(n.graphWithBalls)},yf=function(n){var r=function(){if(n.config.graphType instanceof Hr)return gp(n.config.graphType.value0)(n.config.graphType.value1);if(n.config.graphType instanceof Gr)return Ep(n.config.graphType.value0)(n.config.graphType.value1);throw new Error("Failed pattern match at SM.Model (line 136, column 13 - line 138, column 32): "+[n.config.graphType.constructor.name])}(),t=oT(n.config.ballsPerColor)(r),e=uT(r);return{config:n.config,source:Cp(r),nbVictories:0,nbLosses:0,graphWithBalls:t,losingPositions:e,status:Ot.value,gameResult:D.value}},Sp=function(){var n={graphType:new Hr(8,[1,2]),adversary:je.value,ballsPerColor:6,reward:3,penalty:-1,machineStarts:!0};return yf({config:n,source:0,nbVictories:0,nbLosses:0,graphWithBalls:Pe,losingPositions:Pe,status:Ot.value,gameResult:D.value})}(),Pp=function(n){if(n instanceof Ba)return"expert";if(n instanceof Ve)return"machine";if(n instanceof je)return"random";throw new Error("Failed pattern match at SM.Model (line 62, column 1 - line 62, column 39): "+[n.constructor.name])},gT=function(n){return function(r){if(n.config.adversary instanceof je)return iT(n.graphWithBalls)(r);if(n.config.adversary instanceof Ba)return fT(n.graphWithBalls)(n.losingPositions)(r);if(n.config.adversary instanceof Ve)return Np(n.graphWithBalls)(r);throw new Error("Failed pattern match at SM.Model (line 74, column 3 - line 77, column 52): "+[n.config.adversary.constructor.name])}},TT=function(n){var r=function(t){return cT(function(){return t.isMachineTurn?hT:gT}()(n)(t.pos))(function(e){if(e instanceof D)return xp(new Un({moves:t.moves,win:!t.isMachineTurn}));if(e instanceof d)return xp(new $n({moves:sf(t.moves)({pos:t.pos,edge:e.value0.edge,isMachineTurn:t.isMachineTurn}),isMachineTurn:!t.isMachineTurn,pos:e.value0.dest}));throw new Error("Failed pattern match at SM.Model (line 87, column 5 - line 93, column 10): "+[e.constructor.name])})};return lT(r)({moves:[],pos:n.source,isMachineTurn:n.config.machineStarts})},Rp=function(n){return n==="expert"?Ba.value:n==="machine"?Ve.value:je.value},CT=function(n){return function(r){var t=function(a){return function(u){return sT(0)(u+function(){var i=!a&&yT(n.config.adversary)(Ve.value);if(i)return 0;var c=r.win===a;return c?n.config.reward:n.config.penalty}()|0)}},e=pT(fp(function(a){return Cn(mT)(a.pos)(function(){var u=_T(function(i){var c=a.edge!==i.edge;return c?i:{nbBalls:t(a.isMachineTurn)(i.nbBalls),edge:i.edge,dest:i.dest}});return function(i){return d.create(u(i))}}())})(n.graphWithBalls)(r.moves))(function(a){var u=ke(function(i){return function(c){return c===0}(function(c){return c.nbBalls}(i))})(a);return u?vT(a)(function(i){return{nbBalls:n.config.ballsPerColor,dest:i.dest,edge:i.edge}}):a});return{config:n.config,source:n.source,nbVictories:n.nbVictories+function(){return r.win?1:0}()|0,nbLosses:n.nbLosses+function(){return r.win?0:1}()|0,graphWithBalls:e,losingPositions:n.losingPositions,status:n.status,gameResult:new d({moves:r.moves,win:r.win})}}},Wp=function(n){return dT(TT(n))(CT(n))};var bT=function(n){return function(r){var t=Re(r.Profunctor0()),e=Jo(r);return function(a){return t(n)(function(u){return u.value1(u.value0)})(e(a))}}},Hp=function(n){return function(r){return function(t){return bT(function(e){return new b(n(e),function(a){return r(e)(a)})})(t)}}};var Up=function(n){var r=Mr(n);return function(){return function(){return function(t){return function(e){return function(a){return lt(r(t))(e)(a)}}}}}};var qp=function(n){var r=Mr(n);return function(){return function(t){return function(e){return Vr(r(t))(e)}}}};var gf=function(n){var r=qp(n)(),t=Up(n)()();return function(){return function(){return function(e){return function(a){return Hp(r(e))(Cn(t(e)))(a)}}}}};var za=function(){function n(){}return n.value=new n,n}(),mu=function(){function n(){}return n.value=new n,n}(),_u=function(){function n(){}return n.value=new n,n}(),vu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),du=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Du=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),yu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),hu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),gu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Tu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Cu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),bu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Mu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var Fu=R(Ko),NT=Zr(_s(Ac(Na))),Bp=Zn(Oi(po(He))),ka=Kr(Yr)(Ko),Tf=E(ds),AT=gf({reflectSymbol:function(){return"graphType"}})()(),ST=gf({reflectSymbol:function(){return"config"}})()(),Cf=Fe(Qo),zp=da(Qo),PT=kt(pu),kp=va(Qo),RT=ys(ls(cs)),WT=ur(ms),HT=wt(Ko),$T=function(n){return Fu(NT)(function(r){return Fu(Bp(Sr(r.genModel)))(function(t){var e=mp(n)(t);return ka(Bp(rt(e.value1)(r.genModel)))(function(){return Tf(e.value0)})})})},UT=function(n){return AT(Vn.value)(n)},Eu=UT(ie),qT=function(n){return ST(Vn.value)(n)},OT=qT(ie),ft=function(n){return Cf(function(){var r=Ue(OT)(n);return function(t){return yf(r(t))}}())},bf=function(n){if(n instanceof mu){var r=function(t){return Fu(zp)(function(e){var a=PT(e.status)(Oa.value);return a?ka(kp(function(){var u={};for(var i in e)({}).hasOwnProperty.call(e,i)&&(u[i]=e[i]);return u.status=Ot.value,u}()))(function(){return Tf(new Un(void 0))}):ka(bf(za.value))(function(){return ka(RT(500))(function(){return Tf(new $n(void 0))})})})};return ka(Cf(function(t){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.status=Oa.value,e}))(function(){return WT(r)(void 0)})}if(n instanceof _u)return Cf(function(t){var e={};for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.status=su.value,e});if(n instanceof za)return Fu(zp)(function(t){return HT(kp)($T(Wp(t)))});if(n instanceof vu)return ft(function(t){return{graphType:function(){var e=n.value0==="sub";return e?new Hr(8,[1,2]):new Gr(3,3)}(),adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof du)return ft(Ue(Eu)(function(t){return t instanceof Hr?new Hr(Jn(8)(pe(n.value0)),t.value1):t}));if(n instanceof Du)return ft(Ue(Eu)(function(t){return t instanceof Hr?new Hr(t.value0,Ap(n.value0)(t.value1)):t}));if(n instanceof yu)return ft(Ue(Eu)(function(t){return t instanceof Gr?new Gr(Jn(3)(pe(n.value0)),t.value1):t}));if(n instanceof hu)return ft(Ue(Eu)(function(t){return t instanceof Gr?new Gr(t.value0,Jn(3)(pe(n.value0))):t}));if(n instanceof Tu)return ft(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:Jn(3)(pe(n.value0)),penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof Cu)return ft(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:Jn(-1)(pe(n.value0)),machineStarts:t.machineStarts}});if(n instanceof gu)return ft(function(t){return{graphType:t.graphType,adversary:Rp(n.value0),ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof bu)return ft(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:Jn(6)(pe(n.value0)),reward:t.reward,penalty:t.penalty,machineStarts:t.machineStarts}});if(n instanceof Mu)return ft(function(t){return{graphType:t.graphType,adversary:t.adversary,ballsPerColor:t.ballsPerColor,reward:t.reward,penalty:t.penalty,machineStarts:n.value0==="y"}});throw new Error("Failed pattern match at SM.Update (line 47, column 1 - line 47, column 38): "+[n.constructor.name])};var wu=z(fa),Qe=z(vt);var Jp=function(n){return function(r){return function(t){return function(e){return Dr("viewBox")(Qe(n)+(" "+(Qe(r)+(" "+(Qe(t)+(" "+Qe(e)))))))}}}},jn=Dr("value"),Ja=Dr("type");var Gp=function(){var n=Dr("stroke-width");return function(r){return n(wu(r))}}();var jp=Dr("stroke");var Vp=function(){var n=Dr("r");return function(r){return n(wu(r))}}();var Mf=function(){var n=Dr("min");return function(r){return n(Qe(r))}}();var Ef=function(){var n=Dr("max");return function(r){return n(Qe(r))}}();var Ff=Dr("fill");var Qp=Dr("d"),Kp=function(){var n=Dr("cy");return function(r){return n(wu(r))}}(),Yp=function(){var n=Dr("cx");return function(r){return n(wu(r))}}();var Xp=function(n){return Dr("checked")(n)};var Zp=Kn("svg"),Lu=Kn("span"),Ke=Kn("select");var nm=function(n){return Kn("path")(n)([])};var Bt=Kn("option");var rm=Kn("label"),Ga=function(n){return Kn("input")(n)([])};var wf=Kn("g");var Pn=Kn("div"),tm=function(n){return Kn("circle")(n)([])},Iu=Kn("button"),em=Kn("br")([])([]);var Nf=E(Xr),Lf=R(dt),If=m(tn),xf=m(jr);var Af=qo;var am=function(n){var r=function(t){var e=Lf($e(t))(ji);if(e instanceof D)return Nf(D.value);if(e instanceof d)return If(xf(d.create)(n))(Ji(e.value0));throw new Error("Failed pattern match at Pha.Html.Events (line 75, column 9 - line 77, column 66): "+[e.constructor.name])};return Af("change")(r)},xu=function(n){return Af("click")(function(r){return Nf(d.create(n(r)))})};var ct=function(n){var r=function(t){var e=Lf($e(t))(ji);if(e instanceof d)return If(xf(d.create)(n))(Gi(e.value0));if(e instanceof D){var a=Lf($e(t))(As);if(a instanceof D)return Nf(D.value);if(a instanceof d)return If(xf(d.create)(n))(Vi(a.value0));throw new Error("Failed pattern match at Pha.Html.Events (line 67, column 17 - line 69, column 73): "+[a.constructor.name])}throw new Error("Failed pattern match at Pha.Html.Events (line 64, column 9 - line 69, column 73): "+[e.constructor.name])};return Af("change")(r)};var om=z(fa),um=function(n){return function(r){return"translate("+(n+(","+(r+")")))}};var Sf=function(n){return om(n)+"px"},im=function(n){return om(n*100)+"%"};var Wf=U(st),jT=R(Ft),lr=z(vt),Xe=ar(zn),VT=to(gn),QT=Ao(xe),KT=qa(Lt),YT=V(pu),XT=function(n){return Wf(jT(n.moves)(function(r){return[fn(function(){return r.isMachineTurn?"la machine":"l'adversaire"}()+(" prend "+(lr(r.edge)+(" jeton"+function(){var t=r.edge>1;return t?"s":""}())))),em]}))([fn(function(){return n.win?"la machine":"l'adversaire"}()+" gagne")])},Ye="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",ZT=function(n){return function(r){return Pn([hn("flex flex-row justify-between mt-4 mb-2")])([Lu([hn("text-blue-600 font-bold")])([fn("Victoires: "+lr(n))]),Pn([hn("w-full bg-red-600 rounded-full h-6")])([Pn([hn("h-6 bg-blue-600 rounded-l-full"),Oo("width")(im(function(){var t=n+r|0,e=t===0;return e?.5:wn(n)/wn(t)}()))])([])]),Lu([hn("text-red-600 font-bold")])([fn("D\xE9faites: "+lr(r))])])}},fm=function(n){var r=100*Zi(wn(n+1|0));return r-Ha(r)},Pf="block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",nC=["yellow","red","cyan","lightgreen","magenta"],rC=function(n){return function(r){return function(t){return os(n.position(r))(function(e){return wf([Oo("transform")(um(Sf(e.x))(Sf(e.y)))])([nm([Qp("M1 1 L10 149 L90 149 L99 1"),Gp(3),jp("#000"),Ff("transparent")]),wf([])(function(){var a=ou(Xe(t)(function(i){return ze(i.nbBalls)(i.edge)})),u=VT(135)(qt(a));return pf(function(i){return function(c){return tm([Yp(15+fm(r+i|0)*71),Kp(140-fm((10+r|0)+i|0)*wn(u)),Vp(5),Ff(Jn("black")(Ua(nC)(c)))])}})(a)}())])})}}},tC=function(n){return function(r){return Pn([hn("w-[42vw]")])([Zp([Jp(0)(0)(n.width)(n.height)])(Xe(QT(r))(Ee(rC(n))))])}},eC="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",Rf="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",aC=function(n){return function(r){return Pn([hn("max-w rounded overflow-hidden shadow-lg p-4")])([Pn([hn("font-bold text-xl mb-2")])([fn("Choix des param\xE8tres")]),Pn([hn("grid grid-cols-2 gap-4")])(Wf([Pn([])([fn("type de jeu")]),Ke([hn(Ye),jn(function(){if(n.graphType instanceof Hr)return"sub";if(n.graphType instanceof Gr)return"king";throw new Error("Failed pattern match at SM.View (line 127, column 25 - line 129, column 35): "+[n.graphType.constructor.name])}()),ct(vu.create)])([Bt([jn("sub")])([fn("Soustraction")]),Bt([jn("king")])([fn("Roi")])])])(Wf(function(){if(n.graphType instanceof Hr)return[Pn([])([fn("Nombre de casiers")]),Ke([hn(Ye),jn(lr(n.graphType.value0)),ct(du.create)])(Xe(Wr(8)(16))(function(t){return Bt([jn(lr(t))])([fn(lr(t))])})),Pn([])([fn("Coups possibles")]),Pn([hn("flex flex-row justify-between")])(Xe(Wr(1)(5))(function(t){return rm([])([Ga([Ja("checkbox"),Xp(KT(t)(n.graphType.value1)),hn(eC),am(function(e){return new Du(t)})]),Lu([hn("ml-2 text-sm font-medium text-gray-900")])([fn(lr(t))])])}))];if(n.graphType instanceof Gr)return[Pn([])([fn("Hauteur de la grille")]),Ke([hn(Ye),jn(lr(n.graphType.value1)),ct(hu.create)])(Xe(Wr(3)(6))(function(t){return Bt([jn(lr(t))])([fn(lr(t))])})),Pn([])([fn("Largeur de la grille")]),Ke([hn(Ye),jn(lr(n.graphType.value0)),ct(yu.create)])(Xe(Wr(3)(6))(function(t){return Bt([jn(lr(t))])([fn(lr(t))])}))];throw new Error("Failed pattern match at SM.View (line 136, column 12 - line 174, column 16): "+[n.graphType.constructor.name])}())([Pn([])([fn("Adversaire")]),Kn("select")([hn(Ye),jn(Pp(n.adversary)),ct(gu.create)])([Kn("option")([jn("random")])([fn("Al\xE9atoire")]),Kn("option")([jn("expert")])([fn("Expert")]),Kn("option")([jn("machine")])([fn("Machine")])]),Pn([])([fn("Billes par couleur")]),Ga([Ja("number"),hn(Pf),Mf(2),Ef(10),jn(lr(n.ballsPerColor)),ct(bu.create)]),Pn([])([fn("R\xE9compense")]),Ga([Ja("number"),hn(Pf),Mf(1),jn(lr(n.reward)),ct(Tu.create)]),Pn([])([fn("P\xE9nalit\xE9")]),Ga([Ja("number"),hn(Pf),Ef(0),jn(lr(n.penalty)),ct(Cu.create)]),Pn([])([fn("La machine commence")]),Ke([hn(Ye),jn(function(){return n.machineStarts?"y":"n"}()),ct(Mu.create)])([Bt([jn("y")])([fn("Oui")]),Bt([jn("n")])([fn("Non")])]),function(){var t=YT(r)(Ot.value);return t?Iu([hn(Rf),xu(function(e){return mu.value})])([fn("Lancer la machine")]):Iu([hn(Rf),xu(function(e){return _u.value})])([fn("Arr\xEAter la machine")])}(),Iu([hn(Rf),xu(function(t){return za.value})])([fn("Pas \xE0 pas")])])))])}},cm=function(n){var r=function(){if(n.config.graphType instanceof Hr)return Tp(n.config.graphType.value1);if(n.config.graphType instanceof Gr)return Fp(n.config.graphType.value0)(n.config.graphType.value1);throw new Error("Failed pattern match at SM.View (line 242, column 15 - line 244, column 34): "+[n.config.graphType.constructor.name])}();return Pn([hn("flex flex-row")])([Pn([hn("max-w rounded overflow-hidden shadow-lg p-4 mr-4")])([Pn([hn("font-bold text-xl mb-2")])([fn("Visualisation de la machine")]),Pn([hn("flex flex-col")])([tC(r)(n.graphWithBalls),ZT(n.nbVictories)(n.nbLosses),Pn([])(Xn([])(XT)(n.gameResult))])]),aC(n.config)(n.status)])};var lm=function(){var r=ef(),t=tt({newSeed:r,size:0})();return Ws({init:{model:Sp,msg:D.value},view:cm,update:function(){var e=Ds(Cn(Lc)({genModel:t}));return function(a){return e(bf(a))}}(),selector:"#root"})()};lm();})();
