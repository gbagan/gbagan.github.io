(()=>{function p(){throw new Error("Failed pattern match")}var Mt=function(t){return t.toString()},ct=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var Mn=t=>({tag:t}),ft=Mn("LT"),mt=Mn("GT"),Bt=Mn("EQ");var A=(t,e)=>({tag:t,_1:e}),y=A("Nothing"),H=t=>A("Just",t);var Dt=function(t){return function(e){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o]);return r}};var Qe=t=>t;var lt=(t,e)=>({tag:t,_1:e}),In=t=>lt("Left",t),Ot=t=>lt("Right",t);var Ge=t=>t;var Ce={map:t=>e=>t(e)};var Ar={apply:t=>e=>t(e),Functor0:()=>Ce},Za={bind:t=>e=>e(t),Apply0:()=>Ar},ts={pure:Ge,Apply0:()=>Ar},Le={Applicative0:()=>ts,Bind1:()=>Za};var Sr=function(t){return function(){return t}};var es={apply:t=>e=>()=>{let n=t(),r=e();return En.pure(n(r))()},Functor0:()=>ns},En={pure:Sr,Apply0:()=>es},ns={map:t=>e=>()=>{let n=e();return t(n)}};var bt=(t,e)=>({tag:t,_1:e}),An=t=>bt("Loop",t),wr=t=>bt("Done",t);var Oe=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=o-1;a>=0;a--)r=t(n[a])(r);return r}}},de=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=0;a<o;a++)r=t(r)(n[a]);return r}}};var je=t=>{let e=t.Apply0(),n=e.Functor0().map;return r=>o=>r.foldr(a=>{let s=o(a);return i=>e.apply(n(c=>Qe)(s))(i)})(t.pure())},Sn=t=>{let e=je(t);return n=>{let r=e(n);return o=>a=>r(a)(o)}};var vr=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return A("Just",r);if(n.tag==="Just")return A("Just",e(n._1)(r).tag==="GT"?n._1:r);p()})(y);var Pr=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return A("Just",r);if(n.tag==="Just")return A("Just",e(n._1)(r).tag==="LT"?n._1:r);p()})(y);var Me={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);p()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);p()},foldMap:t=>{let e=t.mempty;return n=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return n(r._1);p()}}};var It={foldr:Oe,foldl:de,foldMap:t=>{let e=t.Semigroup0().append,n=t.mempty;return r=>It.foldr(o=>a=>e(r(o))(a))(n)}};var M=(t,e)=>({tag:"Tuple",_1:t,_2:e}),wt=t=>e=>M(t,e);var Xt=t=>t._1;var ut=(t,e,n)=>({tag:t,_1:e,_2:n});var S=ut("Nil");var Jr=(()=>(e=>n=>{let r=e,o=n,a=!0,s;for(;a;){let i=r,c=o;if(c.tag==="Nil"){a=!1,s=i;continue}if(c.tag==="Cons"){r=ut("Cons",c._1,i),o=c._2;continue}p()}return s})(S))();var Is=function(){function t(o){return[o]}function e(o){return function(a){return[o,a]}}function n(o){return function(a){return function(s){return[o,a,s]}}}function r(o){return function(a){return o.concat(a)}}return function(o){return function(a){return function(s){return function(i){return function(c){function d($,l){switch(l-$){case 0:return s([]);case 1:return a(t)(i(c[$]));case 2:return o(a(e)(i(c[$])))(i(c[$+1]));case 3:return o(o(a(n)(i(c[$])))(i(c[$+1])))(i(c[$+2]));default:var u=$+Math.floor((l-$)/4)*2;return o(a(r)(d($,u)))(d(u,l))}}return d(0,c.length)}}}}}}();var tt=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var eo=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){n=!1,r=y;continue}e=tt(Jr(o._2),S);continue}if(o._1.tag==="Cons"){n=!1,r=A("Just",M(o._1._1,tt(o._1._2,o._2)));continue}p()}return r};var st=(t,e,n)=>({tag:t,_1:e,_2:n}),z=st("CatNil");var rt=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return st("CatCons",t._1,tt(t._2._1,ut("Cons",e,t._2._2)));p()},ei=t=>e=>n=>{let r=a=>s=>i=>{let c=a,d=s,$=i,l=!0,u;for(;l;){let m=c,v=d,G=$;if(G.tag==="Nil"){l=!1,u=v;continue}if(G.tag==="Cons"){c=m,d=m(v)(G._1),$=G._2;continue}p()}return u};return(a=>s=>{let i=a,c=s,d=!0,$;for(;d;){let l=i,u=c,m=eo(l);if(m.tag==="Nothing"){d=!1,$=r(v=>G=>G(v))(e)(u);continue}if(m.tag==="Just"){i=m._1._2,c=ut("Cons",t(m._1._1),u);continue}p()}return $})(n)(S)},no=t=>{if(t.tag==="CatNil")return y;if(t.tag==="CatCons")return A("Just",M(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?z:ei(rt)(z)(t._2)));p()};var N=(t,e)=>({tag:"Free",_1:t,_2:e}),B=(t,e,n)=>({tag:t,_1:e,_2:n});var ro=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Return"){let a=no(o._2);if(a.tag==="Nothing"){n=!1,r=B("Return",o._1._1);continue}if(a.tag==="Just"){e=(()=>{let s=a._1._1(o._1._1);return N(s._1,rt(s._2)(a._1._2))})();continue}p()}if(o._1.tag==="Bind"){n=!1,r=B("Bind",o._1._1,a=>{let s=o._1._2(a);return N(s._1,rt(s._2)(o._2))});continue}p()}return r},oo=t=>e=>{let n=e.Monad0(),r=n.Bind1().Apply0().Functor0().map,o=n.Applicative0().pure;return a=>e.tailRecM(s=>{let i=ro(s);if(i.tag==="Return")return r(wr)(o(i._1));if(i.tag==="Bind")return r(An)(a(t.map(i._2)(i._1)));p()})};var ao={Applicative0:()=>Ke,Bind1:()=>Bn},so={map:t=>e=>Bn.bind(e)(n=>Ke.pure(t(n)))},Bn={bind:t=>e=>N(t._1,rt(t._2)(st("CatCons",e,tt(S,S)))),Apply0:()=>Un},Un={apply:t=>e=>N(t._1,rt(t._2)(st("CatCons",n=>N(e._1,rt(e._2)(st("CatCons",r=>Ke.pure(n(r)),tt(S,S)))),tt(S,S)))),Functor0:()=>so},Ke={pure:t=>N(B("Return",t),z),Apply0:()=>Un};var ni=t=>{let e=n=>{let r=ro(n);if(r.tag==="Return")return N(B("Return",r._1),z);if(r.tag==="Bind"){let o=t(r._1);return N(o._1,rt(o._2)(st("CatCons",a=>e(r._2(a)),tt(S,S))))}p()};return e},io=t=>ni(e=>N(B("Bind",t(e),n=>N(B("Return",n),z)),z));var uo=function(t){return function(e){return t===e}};var co=uo,lo=uo;var po={eq:lo},Gn={eq:co};var fo=function(t){return function(e){return function(n){return function(r){return function(o){return r<o?t:r===o?e:n}}}}};var mo=fo,go=fo;var Ve={compare:go(ft)(Bt)(mt),Eq0:()=>po},vt={compare:mo(ft)(Bt)(mt),Eq0:()=>Gn};var Ie=function(t){throw new Error(t)};var Xe=(t,e,n,r)=>({tag:"KickUp",_1:t,_2:e,_3:n,_4:r}),ot=(t,e,n,r,o,a,s,i)=>({tag:t,_1:e,_2:n,_3:r,_4:o,_5:a,_6:s,_7:i}),pe=(t,e,n,r,o,a,s)=>({tag:t,_1:e,_2:n,_3:r,_4:o,_5:a,_6:s});var Ze=ot("Leaf");var bo=t=>e=>r=>{let o=r,a=!0,s;for(;a;){let i=o;if(i.tag==="Leaf"){a=!1,s=y;continue}if(i.tag==="Two"){let c=t.compare(e)(i._2);if(c.tag==="EQ"){a=!1,s=A("Just",i._3);continue}if(c.tag==="LT"){o=i._1;continue}o=i._4;continue}if(i.tag==="Three"){let c=t.compare(e)(i._2);if(c.tag==="EQ"){a=!1,s=A("Just",i._3);continue}let d=t.compare(e)(i._5);if(d.tag==="EQ"){a=!1,s=A("Just",i._6);continue}if(c.tag==="LT"){o=i._1;continue}if(d.tag==="GT"){o=i._7;continue}o=i._4;continue}p()}return s};var Ee=t=>e=>n=>{let r=t,o=e,a=n,s=!0,i;for(;s;){let c=r,d=o,$=a;if(d.tag==="Nil"){s=!1,i=$;continue}if(d.tag==="Cons"){if(d._1.tag==="TwoLeft"){r=c,o=d._2,a=ot("Two",$,d._1._1,d._1._2,d._1._3);continue}if(d._1.tag==="TwoRight"){r=c,o=d._2,a=ot("Two",d._1._1,d._1._2,d._1._3,$);continue}if(d._1.tag==="ThreeLeft"){r=c,o=d._2,a=ot("Three",$,d._1._1,d._1._2,d._1._3,d._1._4,d._1._5,d._1._6);continue}if(d._1.tag==="ThreeMiddle"){r=c,o=d._2,a=ot("Three",d._1._1,d._1._2,d._1._3,$,d._1._4,d._1._5,d._1._6);continue}if(d._1.tag==="ThreeRight"){r=c,o=d._2,a=ot("Three",d._1._1,d._1._2,d._1._3,d._1._4,d._1._5,d._1._6,$);continue}p()}p()}return i},To=t=>e=>n=>{let r=a=>s=>{let i=a,c=s,d=!0,$;for(;d;){let l=i,u=c;if(l.tag==="Nil"){d=!1,$=ot("Two",u._1,u._2,u._3,u._4);continue}if(l.tag==="Cons"){if(l._1.tag==="TwoLeft"){d=!1,$=Ee(t)(l._2)(ot("Three",u._1,u._2,u._3,u._4,l._1._1,l._1._2,l._1._3));continue}if(l._1.tag==="TwoRight"){d=!1,$=Ee(t)(l._2)(ot("Three",l._1._1,l._1._2,l._1._3,u._1,u._2,u._3,u._4));continue}if(l._1.tag==="ThreeLeft"){i=l._2,c=Xe(ot("Two",u._1,u._2,u._3,u._4),l._1._1,l._1._2,ot("Two",l._1._3,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeMiddle"){i=l._2,c=Xe(ot("Two",l._1._1,l._1._2,l._1._3,u._1),u._2,u._3,ot("Two",u._4,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeRight"){i=l._2,c=Xe(ot("Two",l._1._1,l._1._2,l._1._3,l._1._4),l._1._5,l._1._6,ot("Two",u._1,u._2,u._3,u._4));continue}p()}p()}return $};return(a=>s=>{let i=a,c=s,d=!0,$;for(;d;){let l=i,u=c;if(u.tag==="Leaf"){d=!1,$=r(l)(Xe(Ze,e,n,Ze));continue}if(u.tag==="Two"){let m=t.compare(e)(u._2);if(m.tag==="EQ"){d=!1,$=Ee(t)(l)(ot("Two",u._1,e,n,u._4));continue}if(m.tag==="LT"){i=ut("Cons",pe("TwoLeft",u._2,u._3,u._4),l),c=u._1;continue}i=ut("Cons",pe("TwoRight",u._1,u._2,u._3),l),c=u._4;continue}if(u.tag==="Three"){let m=t.compare(e)(u._2);if(m.tag==="EQ"){d=!1,$=Ee(t)(l)(ot("Three",u._1,e,n,u._4,u._5,u._6,u._7));continue}let v=t.compare(e)(u._5);if(v.tag==="EQ"){d=!1,$=Ee(t)(l)(ot("Three",u._1,u._2,u._3,u._4,e,n,u._7));continue}if(m.tag==="LT"){i=ut("Cons",pe("ThreeLeft",u._2,u._3,u._4,u._5,u._6,u._7),l),c=u._1;continue}if(m.tag==="GT"){if(v.tag==="LT"){i=ut("Cons",pe("ThreeMiddle",u._1,u._2,u._3,u._5,u._6,u._7),l),c=u._4;continue}i=ut("Cons",pe("ThreeRight",u._1,u._2,u._3,u._4,u._5,u._6),l),c=u._7;continue}i=ut("Cons",pe("ThreeRight",u._1,u._2,u._3,u._4,u._5,u._6),l),c=u._7;continue}p()}return $})(S)};function Pt(t,e,n){return t==null?e:n(t)}var Tt=function(){var t={},e="Pure",n="Throw",r="Catch",o="Sync",a="Async",s="Bind",i="Bracket",c="Fork",d="Sequential",$="Map",l="Apply",u="Alt",m="Cons",v="Resume",G="Release",dt="Finalizer",C="Finalized",Q="Forked",_t="Fiber",yt="Thunk";function g(_,q,j,J){this.tag=_,this._1=q,this._2=j,this._3=J}function Z(_){var q=function(j,J,D){return new g(_,j,J,D)};return q.tag=_,q}function kt(_){return new g(e,void 0)}function Tn(_){try{_()}catch(q){setTimeout(function(){throw q},0)}}function ye(_,q,j){try{return q(j())}catch(J){return _(J)}}function Ja(_,q,j){try{return q(j)()}catch(J){return j(_(J))(),kt}}var Je=function(){var _=1024,q=0,j=0,J=new Array(_),D=!1;function f(){var P;for(D=!0;q!==0;)q--,P=J[j],J[j]=void 0,j=(j+1)%_,P();D=!1}return{isDraining:function(){return D},enqueue:function(P){var E,O;q===_&&(O=D,f(),D=O),J[(j+q)%_]=P,q++,D||f()}}}();function ka(_){var q={},j=0,J=0;return{register:function(D){var f=j++;D.onComplete({rethrow:!0,handler:function(P){return function(){J--,delete q[f]}}})(),q[f]=D,J++},isEmpty:function(){return J===0},killAll:function(D,f){return function(){if(J===0)return f();var P=0,E={};function O(U){E[U]=q[U].kill(D,function(X){return function(){delete E[U],P--,_.isLeft(X)&&_.fromLeft(X)&&setTimeout(function(){throw _.fromLeft(X)},0),P===0&&f()}})()}for(var nt in q)q.hasOwnProperty(nt)&&(P++,O(nt));return q={},j=0,J=0,function(U){return new g(o,function(){for(var X in E)E.hasOwnProperty(X)&&E[X]()})}}}}}var oe=0,$t=1,ke=2,Be=3,Ue=4,ht=5,he=6;function Cn(_,q,j){var J=0,D=oe,f=j,P=null,E=null,O=null,nt=null,U=null,X=0,Kt=0,Lt=null,Qt=!0;function Gt(b){for(var T,w,R;;)switch(T=null,w=null,R=null,D){case ke:D=$t;try{f=O(f),nt===null?O=null:(O=nt._1,nt=nt._2)}catch(at){D=ht,P=_.left(at),f=null}break;case Be:_.isLeft(f)?(D=ht,P=f,f=null):O===null?D=ht:(D=ke,f=_.fromRight(f));break;case $t:switch(f.tag){case s:O&&(nt=new g(m,O,nt)),O=f._2,D=$t,f=f._1;break;case e:O===null?(D=ht,f=_.right(f._1)):(D=ke,f=f._1);break;case o:D=Be,f=ye(_.left,_.right,f._1);break;case a:D=Ue,f=Ja(_.left,f._1,function(at){return function(){J===b&&(J++,Je.enqueue(function(){J===b+1&&(D=Be,f=at,Gt(J))}))}});return;case n:D=ht,P=_.left(f._1),f=null;break;case r:O===null?U=new g(m,f,U,E):U=new g(m,f,new g(m,new g(v,O,nt),U,E),E),O=null,nt=null,D=$t,f=f._1;break;case i:X++,O===null?U=new g(m,f,U,E):U=new g(m,f,new g(m,new g(v,O,nt),U,E),E),O=null,nt=null,D=$t,f=f._1;break;case c:D=Be,T=Cn(_,q,f._2),q&&q.register(T),f._1&&T.run(),f=_.right(T);break;case d:D=$t,f=Ua(_,q,f._1);break}break;case ht:if(O=null,nt=null,U===null)D=he,f=E||P||f;else switch(T=U._3,R=U._1,U=U._2,R.tag){case r:E&&E!==T&&X===0?D=ht:P&&(D=$t,f=R._2(_.fromLeft(P)),P=null);break;case v:E&&E!==T&&X===0||P?D=ht:(O=R._1,nt=R._2,D=ke,f=_.fromRight(f));break;case i:X--,P===null&&(w=_.fromRight(f),U=new g(m,new g(G,R._2,w),U,T),(E===T||X>0)&&(D=$t,f=R._3(w)));break;case G:U=new g(m,new g(C,f,P),U,E),D=$t,E&&E!==T&&X===0?f=R._1.killed(_.fromLeft(E))(R._2):P?f=R._1.failed(_.fromLeft(P))(R._2):f=R._1.completed(_.fromRight(f))(R._2),P=null,X++;break;case dt:X++,U=new g(m,new g(C,f,P),U,E),D=$t,f=R._1;break;case C:X--,D=ht,f=R._1,P=R._2;break}break;case he:for(var K in Lt)Lt.hasOwnProperty(K)&&(Qt=Qt&&Lt[K].rethrow,Tn(Lt[K].handler(f)));Lt=null,E&&P?setTimeout(function(){throw _.fromLeft(P)},0):_.isLeft(f)&&Qt&&setTimeout(function(){if(Qt)throw _.fromLeft(f)},0);return;case oe:D=$t;break;case Ue:return}}function Y(b){return function(){if(D===he)return Qt=Qt&&b.rethrow,b.handler(f)(),function(){};var T=Kt++;return Lt=Lt||{},Lt[T]=b,function(){Lt!==null&&delete Lt[T]}}}function L(b,T){return function(){if(D===he)return T(_.right(void 0))(),function(){};var w=Y({rethrow:!1,handler:function(){return T(_.right(void 0))}})();switch(D){case oe:E=_.left(b),D=he,f=E,Gt(J);break;case Ue:E===null&&(E=_.left(b)),X===0&&(D===Ue&&(U=new g(m,new g(dt,f(b)),U,E)),D=ht,f=null,P=null,Gt(++J));break;default:E===null&&(E=_.left(b)),X===0&&(D=ht,f=null,P=null)}return w}}function F(b){return function(){var T=Y({rethrow:!1,handler:b})();return D===oe&&Gt(J),T}}return{kill:L,join:F,onComplete:Y,isSuspended:function(){return D===oe},run:function(){D===oe&&(Je.isDraining()?Gt(J):Je.enqueue(function(){Gt(J)}))}}}function Ba(_,q,j,J){var D=0,f={},P=0,E={},O=new Error("[ParAff] Early exit"),nt=null,U=t;function X(Y,L,F){var b=L,T=null,w=null,R=0,K={},at,De;t:for(;;)switch(at=null,b.tag){case Q:if(b._3===t&&(at=f[b._1],K[R++]=at.kill(Y,function(Ha){return function(){R--,R===0&&F(Ha)()}})),T===null)break t;b=T._2,w===null?T=null:(T=w._1,w=w._2);break;case $:b=b._2;break;case l:case u:T&&(w=new g(m,T,w)),T=b,b=b._1;break}if(R===0)F(_.right(void 0))();else for(De=0,at=R;De<at;De++)K[De]=K[De]();return K}function Kt(Y,L,F){var b,T,w,R,K,at;_.isLeft(Y)?(b=Y,T=null):(T=Y,b=null);t:for(;;){if(w=null,R=null,K=null,at=null,nt!==null)return;if(L===null){J(b||T)();return}if(L._3!==t)return;switch(L.tag){case $:b===null?(L._3=_.right(L._1(_.fromRight(T))),T=L._3):L._3=b;break;case l:if(w=L._1._3,R=L._2._3,b){if(L._3=b,K=!0,at=P++,E[at]=X(O,b===w?L._2:L._1,function(){return function(){delete E[at],K?K=!1:F===null?Kt(b,null,null):Kt(b,F._1,F._2)}}),K){K=!1;return}}else{if(w===t||R===t)return;T=_.right(_.fromRight(w)(_.fromRight(R))),L._3=T}break;case u:if(w=L._1._3,R=L._2._3,w===t&&_.isLeft(R)||R===t&&_.isLeft(w))return;if(w!==t&&_.isLeft(w)&&R!==t&&_.isLeft(R))b=T===w?R:w,T=null,L._3=b;else if(L._3=T,K=!0,at=P++,E[at]=X(O,T===w?L._2:L._1,function(){return function(){delete E[at],K?K=!1:F===null?Kt(T,null,null):Kt(T,F._1,F._2)}}),K){K=!1;return}break}F===null?L=null:(L=F._1,F=F._2)}}function Lt(Y){return function(L){return function(){delete f[Y._1],Y._3=L,Kt(L,Y._2._1,Y._2._2)}}}function Qt(){var Y=$t,L=j,F=null,b=null,T,w;t:for(;;)switch(T=null,w=null,Y){case $t:switch(L.tag){case $:F&&(b=new g(m,F,b)),F=new g($,L._1,t,t),L=L._2;break;case l:F&&(b=new g(m,F,b)),F=new g(l,t,L._2,t),L=L._1;break;case u:F&&(b=new g(m,F,b)),F=new g(u,t,L._2,t),L=L._1;break;default:w=D++,Y=ht,T=L,L=new g(Q,w,new g(m,F,b),t),T=Cn(_,q,T),T.onComplete({rethrow:!1,handler:Lt(L)})(),f[w]=T,q&&q.register(T)}break;case ht:if(F===null)break t;F._1===t?(F._1=L,Y=$t,L=F._2,F._2=t):(F._2=L,L=F,b===null?F=null:(F=b._1,b=b._2))}for(U=L,w=0;w<D;w++)f[w].run()}function Gt(Y,L){nt=_.left(Y);var F;for(var b in E)if(E.hasOwnProperty(b)){F=E[b];for(b in F)F.hasOwnProperty(b)&&F[b]()}E=null;var T=X(Y,U,L);return function(w){return new g(a,function(R){return function(){for(var K in T)T.hasOwnProperty(K)&&T[K]();return kt}})}}return Qt(),function(Y){return new g(a,function(L){return function(){return Gt(Y,L)}})}}function Ua(_,q,j){return new g(a,function(J){return function(){return Ba(_,q,j,J)}})}return g.EMPTY=t,g.Pure=Z(e),g.Throw=Z(n),g.Catch=Z(r),g.Sync=Z(o),g.Async=Z(a),g.Bind=Z(s),g.Bracket=Z(i),g.Fork=Z(c),g.Seq=Z(d),g.ParMap=Z($),g.ParApply=Z(l),g.ParAlt=Z(u),g.Fiber=Cn,g.Supervisor=ka,g.Scheduler=Je,g.nonCanceler=kt,g}(),Ht=Tt.Pure,hi=Tt.Throw;function Lo(t){return function(e){return e.tag===Tt.Pure.tag?Tt.Pure(t(e._1)):Tt.Bind(e,function(n){return Tt.Pure(t(n))})}}function Ct(t){return function(e){return Tt.Bind(t,e)}}var zt=Tt.Sync;var Di=Tt.Async;function tn(t,e){return function(){return Tt.Fiber(t,null,e)}}var Kn=function(){function t(n,r){return n===0&&typeof setImmediate<"u"?setImmediate(r):setTimeout(r,n)}function e(n,r){return n===0&&typeof clearImmediate<"u"?clearImmediate(r):clearTimeout(r)}return function(n,r){return Tt.Async(function(o){return function(){var a=t(r,o(n()));return function(){return Tt.Sync(function(){return n(e(r,a))})}}})}}(),bi=Tt.Seq;var Vn={map:Lo};var Xn={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;p()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return Ie("unsafeFromLeft: Right");p()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return Ie("unsafeFromRight: Left");p()},left:In,right:Ot};var Mo={Applicative0:()=>en,Bind1:()=>Ti},Ti={bind:Ct,Apply0:()=>No},No={apply:t=>e=>Ct(t)(n=>Ct(e)(r=>en.pure(n(r)))),Functor0:()=>Vn},en={pure:Ht,Apply0:()=>No};var nn={liftEffect:zt,Monad0:()=>Mo};var Io={tailRecM:t=>{let e=n=>Ct(t(n))(r=>{if(r.tag==="Done")return Ht(r._1);if(r.tag==="Loop")return e(r._1);p()});return e},Monad0:()=>Mo};var Eo=(t,e)=>t&&e?n=>t(e(n)):t||e,xo=(t,e,n)=>{t[e]=n},Fo=(t,e,n)=>{n==null||e==="class"&&!n?t.removeAttribute(e):t.setAttribute(e,n)},Ao=(t,e,n,r,o,a)=>{t.actions||(t.actions={}),t.actions[e]=a&&r?a(r):r,r?n||t.addEventListener(e,o):t.removeEventListener(e,o)},rn=(t,e,n,r)=>{let o=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),a=t.props,s=t.attrs,i=t.events,c=Eo(r,t.mapf);for(let d in a)xo(o,d,a[d]);for(let d in s)Fo(o,d,s[d]);for(let d in i)Ao(o,d,null,i[d],e,c);for(let d=0,$=t.children.length;d<$;d++)o.appendChild(rn(ee(t.children[d]).html,e,n,c));return t.node=o,o},te=(t,e,n,r,o,a,s)=>{if(n!==r){if(n!=null&&n.type===3&&r.type===3)n.tag!==r.tag&&(e.nodeValue=r.tag);else if(n==null||n.tag!==r.tag)e=t.insertBefore(rn(r,o,a,s),e),n&&n.node.remove();else{let i=n.props,c=r.props;for(let C in{...i,...c})i[C]!==c[C]&&xo(e,C,c[C]);let d=n.attrs,$=r.attrs;for(let C in{...d,...$})d[C]!==$[C]&&Fo(e,C,$[C]);let l=n.events,u=r.events;for(let C in{...l,...u})l[C]!==u[C]&&Ao(e,C,l[C],u[C],o,s);let m=n.children,v=r.children,G=m.length-1,dt=v.length-1;if(s=Eo(s,r.mapf),a=a||r.tag==="svg",r.keyed){let C=0,Q=0;for(;Q<=dt&&C<=G;){let{key:_t,html:yt}=m[C];if(_t!==v[Q].key)break;let g=ee(v[Q],yt);te(e,yt.node,yt,g.html,o,a,s),Q++,C++}for(;Q<=dt&&C<=G;){let{key:_t,html:yt}=m[G];if(_t!==v[dt].key)break;let g=ee(v[dt],yt);te(e,yt.node,yt,g.html,o,a,s),dt--,G--}if(C>G)for(;Q<=dt;){let _t=ee(v[Q]).html;e.insertBefore(rn(_t,o,a,s),m[C]&&m[C].html.node),Q++}else if(Q>dt)for(;C<=G;)m[C].html.node.remove(),C++;else{let _t={},yt={};for(let g=C;g<=G;g++)_t[m[g].key]=m[g].html;for(;Q<=dt;){let{key:g,html:Z}=m[C]||{key:null,html:null},{key:kt,html:Tn}=ee(v[Q],Z);if(yt[g]||m[C+1]&&kt===m[C+1].key){C++;continue}if(g===kt)te(e,Z.node,Z,Tn,o,a,s),yt[kt]=!0,C++;else{let ye=_t[kt];ye!=null?(te(e,e.insertBefore(ye.node,Z.node),ye,v[Q].html,o,a,s),yt[kt]=!0):te(e,Z&&Z.node,null,v[Q].html,o,a,s)}Q++}for(let g in _t)yt[g]||_t[g].node.remove()}}else{for(let C=0;C<=G&&C<=dt;C++){let Q=m[C].html,_t=ee(v[C],Q).html;te(e,Q.node,Q,_t,o,a,s)}for(let C=G+1;C<=dt;C++){let Q=ee(v[C],n).html;e.appendChild(rn(Q,o,a,s))}for(let C=dt+1;C<=G;C++)m[C].html.node.remove()}}return r.node=e,e}},Ci=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},ee=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||Ci(e.memo,t.html.memo))&&(e=on(t.html.type(...t.html.memo)),e.memo=t.html.memo),t.html=e),t),on=t=>({...t,children:t.children&&t.children.map(({key:e,html:n})=>({key:e,html:on(n)}))}),So=(t,e)=>t.actions[e],wo=te,Wo=t=>e=>(e.node=t,e);var Mi=(t,e,n,r=!1)=>{let o=[],a={},s={},i={},c={tag:t,children:n,props:a,attrs:s,events:i,node:null,keyed:r},d=e.length;for(let l=0;l<d;l++){let[u,m,v]=e[l];u===0?a[m]=v:u===1?s[m]=v:u===2?i[m]=v:u===3?s.class=s.class?s.class+" "+m:m:u===4&&o.push(m+":"+v)}let $=o.join(";");return $&&(s.style=$),c},W=(t,e,n)=>Mi(t,e,n.map(r=>({key:null,html:r})));var Ni=t=>({tag:t,children:[],type:3});var I=(t,e)=>[1,t,e],an=(t,e)=>[2,t,e],Wt=t=>[3,t];var pt=(t,e)=>[4,t,e],it=Ni;var sn=it("");function un(t){return function(e){return t===e}}var et=(t,e,n)=>({tag:t,_1:e,_2:n});var er=t=>({liftEffect:e=>N(B("Bind",et("Lift",t.liftEffect(e)),n=>N(B("Return",n),z)),z),Monad0:()=>ao});var vo=t=>{let e=er(t.MonadEffect0());return{liftAff:n=>N(B("Bind",et("Lift",t.liftAff(n)),r=>N(B("Return",r),z)),z),MonadEffect0:()=>e}},Po=t=>({map:e=>n=>{if(n.tag==="State")return et("State",r=>{let o=n._1(r);return M(e(o._1),o._2)});if(n.tag==="Lift")return et("Lift",t.map(e)(n._1));if(n.tag==="Subscribe")return et("Subscribe",n._1,r=>e(n._2(r)));if(n.tag==="Unsubscribe")return et("Unsubscribe",n._1,e(n._2));p()}});var zo=t=>e=>io(n=>{if(n.tag==="State")return et("State",n._1);if(n.tag==="Lift")return et("Lift",t(n._1));if(n.tag==="Subscribe")return et("Subscribe",n._1,n._2);if(n.tag==="Unsubscribe")return et("Unsubscribe",n._1,n._2);p()})(e);var ne=function(t){return function(e){return function(){return e[t]}}},Np=ne("URL"),Ip=ne("documentURI"),Ep=ne("origin"),xp=ne("compatMode"),Fp=ne("characterSet"),Ap=ne("contentType");var Si=ne("documentElement");function Jo(t){return function(e){return function(){return e.createTextNode(t)}}}var Rt=function(t){return function(e){return function(){return e[t]}}};var Zp=Rt("baseURI"),Ri=Rt("ownerDocument"),or=Rt("parentNode"),qi=Rt("parentElement");var t$=Rt("childNodes"),vi=Rt("firstChild"),Pi=Rt("lastChild"),zi=Rt("previousSibling"),Ji=Rt("nextSibling"),ki=Rt("nodeValue");var e$=Rt("textContent");function Bo(t){return function(e){return function(){e.appendChild(t)}}}var dn=function(t){return function(e){return function(){return e[t]}}},I$=dn("children"),Ui=dn("firstElementChild"),Hi=dn("lastElementChild"),E$=dn("childElementCount");function Uo(t){return function(e){return function(){return e.querySelector(t)}}}var Ho=t=>{let e=Uo(t);return n=>{let r=e(n);return()=>{let o=r();return Pt(o,y,H)}}};function ar(t){return t.currentTarget}function Qo(t){return t.type}var sr=function(){return window};function ir(t){return function(){return t.document}}var xe=Sn(En)(Me),Vi=Sn(en)(Me),Xi=oo(Po(Vn))(Io),Zi=t=>e=>n=>{let r=n(e);return()=>{let o=r();return xe(o)(t.update(t))()}},Go=t=>e=>{let n=t.node,r=t.vdom;return()=>{let o=r.value,a=n.value,s=or(a)();return xe(Pt(s,y,H))(i=>{let c=on(e);return()=>{let d=wo(i,a,o,c,$=>{let l=Qo($);return xe(Pt(ar($),y,H))(u=>()=>{let m=So(u,l);return Zi(t)($)(m)()})()});return n.value=d,r.value=c}})()}},tu=t=>e=>{let n=t.state;return()=>{let r=n.value,o=un(r)(e);if(!o)return n.value=e,Go(t)(t.view(e))();o||p()}},Oo=t=>e=>n=>{let r=e.subscriptions;return Xi(o=>{if(o.tag==="State")return Ct(zt((()=>{let a=e.state;return()=>a.value})()))(a=>{let s=o._1(a),i=s._1;return Ct(zt(tu(e)(s._2)))(()=>Ht(i))});if(o.tag==="Lift")return o._1;if(o.tag==="Subscribe")return Ct(zt(o._1(a=>{let s=tn(Xn,Oo(t)(e)(t(a)));return()=>{s().run()}})))(a=>Ct(zt((()=>{let s=e.freshId;return()=>{let i=s.value;return s.value=i+1|0,i}})()))(s=>Ct(zt((()=>{let i=To(vt)(s)(a);return()=>{let c=r.value;r.value=i(c)}})()))(()=>Ht(o._2(s)))));if(o.tag==="Unsubscribe"){let a=o._2,s=o._1;return Ct(zt(()=>r.value))(i=>Ct(Vi(bo(vt)(s)(i))(zt))(()=>Ht(a)))}p()})(n)},eu=t=>{let e=t.init.model,n=t.init.msg,r=t.selector,o=t.update,a=t.view;return()=>{let s=sr(),i=ir(s)(),c=Ho(r)(i)();return xe(c.tag==="Just"?A("Just",c._1):y)(d=>()=>{let $={value:e},l=sr(),u=ir(l)(),m=Jo("")(u)();Bo(m)(d)();let v={value:m},G={value:Wo(m)(it(""))},Q={view:a,update:o,state:$,node:v,vdom:G,subscriptions:{value:Ze},freshId:{value:0}};return Go(Q)(a(e))(),xe(n)(Q.update(Q))()})()}};var jo=t=>{let e=t.update;return eu({init:t.init,view:t.view,selector:t.selector,update:n=>r=>{let o=tn(Xn,Oo(e)(n)(e(r)));return()=>{o().run()}}})};var Fe=function(t){return function(e){return t+e}};var cn=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},fe=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var dr=isFinite;var Ae=Math.floor;var Vo=function(t){return function(e){return Math.pow(t,e)}},ln=function(t){return function(e){return t%e}};var Xo=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},V=function(t){return t};var cr=Xo(H)(y),pn=t=>{if(!dr(t))return 0;if(t>=V(2147483647))return 2147483647;if(t<=V(-2147483648))return-2147483648;let e=cr(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;p()};var Zo=Math.random;var ta=t=>e=>()=>{let n=Zo();return pn(Ae((V(e)-V(t)+1)*n+V(t)))};var lr=(()=>{let t=ta(1)(2147483646);return()=>{let e=t();return(()=>{let n=fe(e)(2147483645);return n<1?n+2147483646|0:n})()}})();var ea=t=>e=>{let n=cr(ln(V(48271)*V(e)+V(t))(V(2147483647)));if(n.tag==="Just")return n._1;p()};var ra=function(t){return function(e){return function(){return t(e())}}},oa=function(t){return function(){return t}};var su={map:ra};var iu={apply:t=>e=>()=>{let n=t(),r=e();return pr.pure(n(r))()},Functor0:()=>su},pr={pure:oa,Apply0:()=>iu};var aa=function(e){return function(n){return function(){return e(n)}}};var sa=function(e){return function(n){return function(r){return function(o){return function(){return e(n,r,o)}}}}};var ia=function(t,e,n){var r=t>=0&&t<n.length;return r&&(n[t]=e),r};function cu(t){return t.slice()}var ua=cu,lu=function(){function t(e,n,r,o,a,s){var i,c,d,$,l,u,m;for(i=a+(s-a>>1),i-a>1&&t(e,n,o,r,a,i),s-i>1&&t(e,n,o,r,i,s),c=a,d=i,$=a;c<i&&d<s;)l=o[c],u=o[d],m=n(e(l)(u)),m>0?(r[$++]=u,++d):(r[$++]=l,++c);for(;c<i;)r[$++]=o[c++];for(;d<s;)r[$++]=o[d++]}return function(e,n,r){return r.length<2||t(e,n,r,r.slice(0),0,r.length),r}}();var $r=aa(ua);var da=sa(ia);var Jt=function(t){return function(e){for(var n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t(o)(e[o]);return r}};var re=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var We=function(t,e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),o=t,a=0;o!==e;)r[a++]=o,o+=n;return r[a]=o,r},fu=function(t,e){if(t<1)return[];var n=new Array(t);return n.fill(e)},mu=function(t,e){for(var n=[],r=0,o=0;o<t;o++)n[r++]=e;return n},fr=typeof Array.prototype.fill=="function"?fu:mu,gu=function(){function t(o,a){this.head=o,this.tail=a}var e={};function n(o){return function(a){return new t(o,a)}}function r(o){for(var a=[],s=0,i=o;i!==e;)a[s++]=i.head,i=i.tail;return a}return function(o,a){return r(o(n)(e)(a))}}();var mr=function(t,e,n){return n.length===0?t({}):e(n[0])(n.slice(1))},Ft=function(t,e,n,r){return r<0||r>=n.length?e:t(n[r])};var _e=function(t,e){return e.filter(t)};var _u=function(){function t(e,n,r,o,a,s){var i,c,d,$,l,u,m;for(i=a+(s-a>>1),i-a>1&&t(e,n,o,r,a,i),s-i>1&&t(e,n,o,r,i,s),c=a,d=i,$=a;c<i&&d<s;)l=o[c],u=o[d],m=n(e(l)(u)),m>0?(r[$++]=u,++d):(r[$++]=l,++c);for(;c<i;)r[$++]=o[c++];for(;d<s;)r[$++]=o[d++]}return function(e,n,r){var o;return r.length<2?r:(o=r.slice(0),t(e,n,o,r.slice(0),0,r.length),o)}}();var $n=function(t,e,n){for(var r=e.length<n.length?e.length:n.length,o=new Array(r),a=0;a<r;a++)o[a]=t(e[a])(n[a]);return o},fn=function(t,e){for(var n=e.length,r=0;r<n;r++)if(t(e[r]))return!0;return!1},Re=function(t,e){for(var n=e.length,r=0;r<n;r++)if(!t(e[r]))return!1;return!0};var Du=je(pr);var mn=t=>{let e=Du(t);return n=>r=>(()=>{let o=$r(r);return()=>{let a=o();return e(s=>da(s._1)(s._2)(a))(n)(),a}})()()};var gr=t=>e=>(()=>{let n=$r(t);return()=>{let r=n();return r.push(e),r}})()();var gn=t=>({tag:t}),_r=t=>({tag:t}),pa=(()=>Pr(It)(Ve.compare))(),bu=(()=>vr(It)(Ve.compare))(),Tu=de(Fe)(0),Cu=mn(It),Lu=_r("Empty"),ve=_r("X"),_n=_r("O"),Mu=gn("InProgress"),$a=gn("HasWon"),fa=gn("HasLost"),ma=gn("CannotWin");var ga=[[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14],[15,16,17,18,19],[20,21,22,23,24],[0,5,10,15,20],[1,6,11,16,21],[2,7,12,17,22],[3,8,13,18,23],[4,9,14,19,24],[0,6,12,18,24],[4,8,12,16,20]];var _a=t=>{let e=_e(s=>s<100,t),n=pa(e),r=(()=>{if(n.tag==="Nothing")return 0;if(n.tag==="Just")return n._1;p()})(),o=bu(e),a=(()=>{if(o.tag==="Nothing")return 0;if(o.tag==="Just")return o._1;p()})();return Dt(s=>s===100?-1:r===a?1:(s-r)/(a-r))(t)},yn={grid:fr(25,Lu),history:[],erdosTable:y,locked:!1,status:Mu,isStatusShown:!1},yr=t=>e=>fn(n=>Re(r=>{let o=Ft(H,y,e,r);return o.tag==="Nothing"?!1:o.tag==="Just"?o._1.tag==="Empty"?t.tag==="Empty":o._1.tag==="X"?t.tag==="X":o._1.tag==="O"?t.tag==="O":!1:!1},n),ga),hn=t=>Tu(Dt(e=>fn(n=>{let r=Ft(H,y,t,n);return r.tag==="Nothing"?!1:r.tag==="Just"?r._1.tag==="Empty"?!1:r._1.tag==="X":!1},e)?0:1/Vo(2)(V(_e(n=>{let r=Ft(H,y,t,n);return r.tag==="Nothing"?!1:r.tag==="Just"?r._1.tag==="Empty":!1},e).length)))(ga)),ya=t=>Jt(e=>n=>n.tag!=="Empty"?100:hn(Cu([M(e,ve)])(t)))(t),ha=t=>{let e=pa(t),n=(()=>{if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;p()})();return Dt(Xt)(_e(r=>r._2===n,Jt(r=>o=>M(r,o))(t)))};var Nu=t=>{let e=t.Apply0(),n=e.Functor0(),r={map:a=>{let s=n.map(a);return i=>c=>s(i(c))}},o={apply:a=>s=>i=>e.apply(a(i))(s(i)),Functor0:()=>r};return{bind:a=>s=>i=>t.bind(a(i))(c=>s(c)(i)),Apply0:()=>o}};var Iu=t=>{let e=t.Applicative0(),n=e.Apply0(),r=n.Functor0(),o={map:c=>{let d=r.map(c);return $=>l=>d($(l))}},a={apply:c=>d=>$=>n.apply(c($))(d($)),Functor0:()=>o},s={pure:c=>{let d=e.pure(c);return $=>d},Apply0:()=>a},i=Nu(t.Bind1());return{Applicative0:()=>s,Bind1:()=>i}};var Dn=t=>{let e=Iu(t.Monad0());return{liftEffect:n=>{let r=t.liftEffect(n);return o=>r},Monad0:()=>e}};var Pe=t=>({map:e=>n=>r=>t.map(o=>M(e(o._1),o._2))(n(r))});var hr=t=>{let e=t.Bind1().bind;return{bind:n=>r=>o=>e(n(o))(a=>r(a._1)(a._2)),Apply0:()=>bn(t)}},bn=t=>{let e=Pe(t.Bind1().Apply0().Functor0());return{apply:(()=>{let n=hr(t).bind,r=ze(t).pure;return o=>a=>n(o)(s=>n(a)(i=>r(s(i))))})(),Functor0:()=>e}},ze=t=>{let e=t.Applicative0().pure;return{pure:n=>r=>e(M(n,r)),Apply0:()=>bn(t)}};var Ta=t=>{let e=t.Applicative0().pure,n={Applicative0:()=>ze(t),Bind1:()=>hr(t)};return{state:r=>o=>e(r(o)),Monad0:()=>n}};var Ca={liftAff:t=>t,MonadEffect0:()=>nn};var La=t=>{let e=Dn(t.MonadEffect0());return{liftAff:n=>{let r=t.liftAff(n);return o=>r},MonadEffect0:()=>e}};var Gu=function(){function t(s){this.fn=s}var e={},n=function(s,i){this.head=s,this.tail=i};function r(s){return new n(s,e)}function o(s){return function(i){return new n(s,i)}}function a(s){for(var i=[],c=s;c!==e;)i.push(c.head),c=c.tail;return i}return function(s,i,c){var d=function(l,u){return s(i(o)(c(l)))(u)},$=function(l,u,m){if(u===0)return l;var v=m[u-1];return new t(function(){var G=$(d(v,l),u-1,m);return G})};return function(l){for(var u=i(r)(c(l[l.length-1])),m=$(u,l.length-1,l);m instanceof t;)m=m.fn();return i(a)(m)}}}();var ju=t=>Ta(t).state(e=>M(e.newSeed,{...e,newSeed:ea(0)(e.newSeed)}));var Yu=t=>{let e=Pe(t.Bind1().Apply0().Functor0()).map,n=ju(t),r=bn(t).apply;return o=>a=>{let s=V(a),i=V(o),c=e(V)(n);return e(d=>pn(Ae(i+ln(d)(s-i+1))))(r(e(Fe)(c))(e(d=>2*d)(c)))}},Na=t=>{let e=Yu(t);return n=>r=>n<=r?e(n)(r):e(r)(n)};var Vu=(()=>ze(Le).pure)(),Xu=(()=>Pe(Ce).map)(),Zu=Na(Le),Ia=t=>t.length===0?Vu(y):Xu(e=>Ft(H,y,t,e))(Zu(0)(t.length-1|0)),Ea=t=>{let e=mr(n=>y,n=>r=>A("Just",r),t);if(e.tag==="Nothing")return[];if(e.tag==="Just")return $n(wt,t,e._1);p()};var Wa=(()=>{let t=vo(La(Ca)).liftAff;return e=>t(Kn(Ot,e))})(),Fa=N(B("Bind",et("Lift",Ht),t=>N(B("Return",t),z)),z),Aa=(()=>er(Dn(nn)).liftEffect)(),Sa=N(B("Bind",et("State",t=>M(t,t)),t=>N(B("Return",t),z)),z),wa=mn(It),br=t=>N(B("Bind",et("State",e=>M(void 0,{isStatusShown:!0,erdosTable:t.erdosTable,grid:t.grid,history:t.history,locked:t.locked,status:t.status})),e=>N(B("Return",e),z)),rt(z)(st("CatCons",()=>{let e=Wa(1e3);return N(e._1,rt(e._2)(st("CatCons",()=>N(B("Bind",et("State",n=>M(void 0,{isStatusShown:!1,erdosTable:t.erdosTable,grid:t.grid,history:t.history,locked:t.locked,status:t.status})),n=>N(B("Return",n),z)),z),tt(S,S))))},tt(S,S)))),td=t=>N(Fa._1,rt(Fa._2)(st("CatCons",e=>{let n=e.genState,r=Aa(()=>n.value);return N(r._1,rt(r._2)(st("CatCons",o=>{let a=t(o),s=a._2,i=a._1,c=Aa(()=>n.value=s);return N(c._1,rt(c._2)(st("CatCons",()=>N(B("Return",i),z),tt(S,S))))},tt(S,S))))},tt(S,S)))),Ra=t=>{if(t.tag==="Play"){let e=t._1;return N(Sa._1,rt(Sa._2)(st("CatCons",n=>{if((()=>{let s=Ft(H,y,n.grid,e);return n.locked||(()=>s.tag==="Nothing"?!0:s.tag==="Just"?s._1.tag!=="Empty":!0)()||n.status.tag!=="InProgress"})())return N(B("Return",void 0),z);let r=wa([M(e,_n)])(n.grid),o=ya(r),a={grid:r,erdosTable:A("Just",_a(o)),history:gr(n.history)({square:e,symbol:ve,erdos:hn(r)}),locked:n.locked,status:n.status,isStatusShown:n.isStatusShown};return Re(s=>s.tag!=="Empty",r)?N(B("Bind",et("State",s=>M(void 0,a)),s=>N(B("Return",s),z)),z):yr(_n)(r)?br({grid:a.grid,erdosTable:a.erdosTable,history:a.history,status:$a,locked:a.locked,isStatusShown:a.isStatusShown}):N(B("Bind",et("State",s=>M(void 0,{locked:!0,erdosTable:a.erdosTable,grid:a.grid,history:a.history,isStatusShown:a.isStatusShown,status:a.status})),s=>N(B("Return",s),z)),rt(z)(st("CatCons",()=>{let s=Wa(2e3);return N(s._1,rt(s._2)(st("CatCons",()=>{let i=td(Ia(ha(o)));return N(i._1,rt(i._2)(st("CatCons",c=>{if(c.tag==="Nothing")return N(B("Return",void 0),z);if(c.tag==="Just"){let d=wa([M(c._1,ve)])(r),$=hn(d),l={grid:d,erdosTable:y,locked:!1,history:gr(a.history)({square:c._1,symbol:_n,erdos:$}),isStatusShown:a.isStatusShown,status:a.status};return $===0?br({grid:l.grid,erdosTable:l.erdosTable,history:l.history,status:ma,locked:l.locked,isStatusShown:l.isStatusShown}):yr(ve)(d)?br({grid:l.grid,erdosTable:l.erdosTable,history:l.history,status:fa,locked:l.locked,isStatusShown:l.isStatusShown}):N(B("Bind",et("State",u=>M(void 0,l)),u=>N(B("Return",u),z)),z)}p()},tt(S,S))))},tt(S,S))))},tt(S,S))))},tt(S,S))))}if(t.tag==="Reinit")return N(B("Bind",et("State",e=>M(void 0,e.locked?e:yn)),e=>N(B("Return",e),z)),z);p()};var qa=t=>e=>n=>r=>I("viewBox",ct(t)+" "+ct(e)+" "+ct(n)+" "+ct(r));var Tr=(t,e)=>({tag:t,_1:e});var va=Tr("Reinit");var od=t=>{let e=t.erdosTable;return W("div",[Wt("relative shadow-md shadow-slate-200 m-4 select-none"),pt("width","300px"),pt("height","300px")],Jt(n=>r=>{let o=(()=>{if(e.tag==="Just")return Ft(H,y,e._1,n);if(e.tag==="Nothing")return y;p()})(),a=(()=>{if(o.tag==="Nothing")return-1;if(o.tag==="Just")return o._1;p()})();return W("div",[Wt("absolute cursor-pointer flex items-center justify-center shadow text-4xl"),pt("height","20%"),pt("width","20%"),pt("left",ct(V(fe(n)(5))*20)+"%"),pt("top",ct(V(cn(n)(5))*20)+"%"),pt("background-color",a===-1?"white":"rgb(255,"+ct(255*a)+",0)"),an("click",s=>()=>A("Just",Tr("Play",n)))],[(()=>{if(r.tag==="X")return W("span",[pt("color","rgb(208,0,208)")],[it("X")]);if(r.tag==="O")return W("span",[pt("color","rgb(0,199,199)")],[it("O")]);if(r.tag==="Empty")return sn;p()})()])})(t.grid))},ad=t=>W("div",[Wt("w-full h-full flex items-center justify-center absolute z-50 pointer-events-none")],[W("div",[Wt(t.isStatusShown?"block bg-white rounded-2xl border-4 border-red-500 border-solid p-2 text-2xl text-red-500 opacity-1":"block bg-white rounded-2xl border-4 border-red-500 border-solid p-2 text-2xl text-red-500 opacity-0 transition transition-500")],[(()=>{if(t.status.tag==="HasWon")return W("span",[],[it("Bravo, vous avez gagn\xE9 !")]);if(t.status.tag==="HasLost")return W("span",[],[it("Dommage, vous avez perdu !")]);if(t.status.tag==="CannotWin")return W("span",[],[it("X a bloqu\xE9 tous les alignements, vous avez perdu !")]);if(t.status.tag==="InProgress")return sn;p()})()])]),sd=t=>Mt(cn(t)(10))+"."+Mt(fe(t)(10)),id=t=>W("div",[Wt("relative shadow-md shadow-slate-200 m-4 select-none"),pt("width","430px"),pt("height","300px")],[W("svg",[qa(-15)(-30)(340)(235)],[W("text",[I("x","-15"),I("y","-15"),I("stroke","black"),I("font-size","12")],[it("Danger")]),W("line",[I("x1","0"),I("x2","0"),I("y1","0"),I("y2","200"),I("stroke","black")],[]),W("g",[],Dt(e=>W("line",[I("x1","-3"),I("x2","3"),I("y1",Mt(e*20|0)),I("y2",Mt(e*20|0)),I("stroke","black")],[]))(We(0,10))),W("g",[],Dt(e=>W("text",[I("x","-15"),I("y",Mt(e*20|0)),I("stroke","black"),I("font-size","10")],[it(sd(10-e|0))]))(We(0,10))),W("line",[I("x1","0"),I("x2","300"),I("y1","200"),I("y2","200"),I("stroke","black")],[]),W("g",[],Dt(e=>W("line",[I("y1","197"),I("y2","203"),I("x1",Mt(e*10|0)),I("x2",Mt(e*10|0)),I("stroke","black")],[]))(We(0,25))),W("g",[],Jt(e=>n=>W("rect",[I("x",Mt((10*(e+1|0)|0)-2|0)),I("y",ct(198-300*n)),I("width","4"),I("height","4")],[]))(t)),W("g",[],Jt(e=>n=>W("line",[I("x1",ct(10*V(e+1|0))),I("x2",ct(10*V(e+2|0))),I("y1",ct(200-300*n._1)),I("y2",ct(200-300*n._2)),I("stroke-width","2.0"),I("stroke","blue")],[]))(Ea(t)))])]),ud=t=>e=>W("div",[Wt("rounded overflow-hidden shadow-lg p-4")],re([W("div",[Wt("font-bold text-xl mb-2")],[it(t)])])(e)),dd="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",Pa=t=>W("div",[pt("height","400px"),pt("width","830px")],[ud("Jeu M(5,5) : essayer d'aligner 5 ronds sur cette grille !")([W("div",[Wt("relative flex flex-row")],[W("div",[],[od(t),W("button",[Wt(dd),an("click",e=>()=>A("Just",va))],[it("Recommencer")])]),W("div",[],[id(Dt(e=>e.erdos)(t.history)),(()=>{if(t.status.tag==="HasWon")return W("span",[],[it("Bravo, vous avez gagn\xE9 !")]);if(t.status.tag==="HasLost")return W("span",[],[it("Dommage, vous avez perdu !")]);if(t.status.tag==="CannotWin")return W("span",[],[it("Dommage, X a bloqu\xE9 tous les alignements, vous avez perdu !")]);if(t.status.tag==="InProgress")return sn;p()})()]),ad(t)])])]);var za=()=>{let e={value:{newSeed:lr(),size:0}};return jo({init:{model:yn,msg:y},view:Pa,update:(()=>{let n=zo(r=>r({genState:e}));return r=>n(Ra(r))})(),selector:"#root"})()};za();})();
