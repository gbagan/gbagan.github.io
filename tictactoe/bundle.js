(()=>{function l(){throw new Error("Failed pattern match")}var rt=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var gn=t=>({tag:t}),pt=gn("LT"),ft=gn("GT"),zt=gn("EQ");var x=(t,e)=>({tag:t,_1:e}),y=x("Nothing"),J=t=>x("Just",t);var wt=function(t){return function(e){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o]);return r}};var Je=t=>t;var ut=(t,e)=>({tag:t,_1:e}),hn=t=>ut("Left",t),Ot=t=>ut("Right",t);var Be=t=>t;var he={map:t=>e=>t(e)};var Mr={apply:t=>e=>t(e),Functor0:()=>he},Qa={bind:t=>e=>e(t),Apply0:()=>Mr},Ga={pure:Be,Apply0:()=>Mr},De={Applicative0:()=>Ga,Bind1:()=>Qa};var Nr=function(t){return function(){return t}};var Oa={apply:t=>e=>()=>{let n=t(),r=e();return Dn.pure(n(r))()},Functor0:()=>ja},Dn={pure:Nr,Apply0:()=>Oa},ja={map:t=>e=>()=>{let n=e();return t(n)}};var ht=(t,e)=>({tag:t,_1:e}),Ln=t=>ht("Loop",t),Er=t=>ht("Done",t);var Ue=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=o-1;a>=0;a--)r=t(n[a])(r);return r}}},ie=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=0;a<o;a++)r=t(r)(n[a]);return r}}};var Qe=t=>{let e=t.Apply0(),n=e.Functor0().map;return r=>o=>r.foldr(a=>{let s=o(a);return i=>e.apply(n(d=>Je)(s))(i)})(t.pure())},Cn=t=>{let e=Qe(t);return n=>{let r=e(n);return o=>a=>r(a)(o)}};var Ar=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return x("Just",r);if(n.tag==="Just")return x("Just",e(n._1)(r).tag==="GT"?n._1:r);l()})(y);var Sr=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return x("Just",r);if(n.tag==="Just")return x("Just",e(n._1)(r).tag==="LT"?n._1:r);l()})(y);var be={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);l()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);l()},foldMap:t=>{let e=t.mempty;return n=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return n(r._1);l()}}};var Ct={foldr:Ue,foldl:ie,foldMap:t=>{let e=t.Semigroup0().append,n=t.mempty;return r=>Ct.foldr(o=>a=>e(r(o))(a))(n)}};var E=(t,e)=>({tag:"Tuple",_1:t,_2:e}),xt=t=>e=>E(t,e);var Vt=t=>t._1;var ot=(t,e,n)=>({tag:t,_1:e,_2:n});var R=ot("Nil");var Rr=(()=>(e=>n=>{let r=e,o=n,a=!0,s;for(;a;){let i=r,d=o;if(d.tag==="Nil"){a=!1,s=i;continue}if(d.tag==="Cons"){r=ot("Cons",d._1,i),o=d._2;continue}l()}return s})(R))();var ys=function(){function t(o){return[o]}function e(o){return function(a){return[o,a]}}function n(o){return function(a){return function(s){return[o,a,s]}}}function r(o){return function(a){return o.concat(a)}}return function(o){return function(a){return function(s){return function(i){return function(d){function c(f,p){switch(p-f){case 0:return s([]);case 1:return a(t)(i(d[f]));case 2:return o(a(e)(i(d[f])))(i(d[f+1]));case 3:return o(o(a(n)(i(d[f])))(i(d[f+1])))(i(d[f+2]));default:var u=f+Math.floor((p-f)/4)*2;return o(a(r)(c(f,u)))(c(u,p))}}return c(0,d.length)}}}}}}();var nt=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var Yr=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){n=!1,r=y;continue}e=nt(Rr(o._2),R);continue}if(o._1.tag==="Cons"){n=!1,r=x("Just",E(o._1._1,nt(o._1._2,o._2)));continue}l()}return r};var ct=(t,e,n)=>({tag:t,_1:e,_2:n}),B=ct("CatNil");var at=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return ct("CatCons",t._1,nt(t._2._1,ot("Cons",e,t._2._2)));l()},Os=t=>e=>n=>{let r=a=>s=>i=>{let d=a,c=s,f=i,p=!0,u;for(;p;){let m=d,W=c,Q=f;if(Q.tag==="Nil"){p=!1,u=W;continue}if(Q.tag==="Cons"){d=m,c=m(W)(Q._1),f=Q._2;continue}l()}return u};return(a=>s=>{let i=a,d=s,c=!0,f;for(;c;){let p=i,u=d,m=Yr(p);if(m.tag==="Nothing"){c=!1,f=r(W=>Q=>Q(W))(e)(u);continue}if(m.tag==="Just"){i=m._1._2,d=ot("Cons",t(m._1._1),u);continue}l()}return f})(n)(R)},Kr=t=>{if(t.tag==="CatNil")return y;if(t.tag==="CatCons")return x("Just",E(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?B:Os(at)(B)(t._2)));l()};var A=(t,e)=>({tag:"Free",_1:t,_2:e}),U=(t,e,n)=>({tag:t,_1:e,_2:n});var Vr=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Return"){let a=Kr(o._2);if(a.tag==="Nothing"){n=!1,r=U("Return",o._1._1);continue}if(a.tag==="Just"){e=(()=>{let s=a._1._1(o._1._1);return A(s._1,at(s._2)(a._1._2))})();continue}l()}if(o._1.tag==="Bind"){n=!1,r=U("Bind",o._1._1,a=>{let s=o._1._2(a);return A(s._1,at(s._2)(o._2))});continue}l()}return r},Xr=t=>e=>{let n=e.Monad0(),r=n.Bind1().Apply0().Functor0().map,o=n.Applicative0().pure;return a=>e.tailRecM(s=>{let i=Vr(s);if(i.tag==="Return")return r(Er)(o(i._1));if(i.tag==="Bind")return r(Ln)(a(t.map(i._2)(i._1)));l()})};var Zr={Applicative0:()=>Oe,Bind1:()=>Rn},to={map:t=>e=>Rn.bind(e)(n=>Oe.pure(t(n)))},Rn={bind:t=>e=>A(t._1,at(t._2)(ct("CatCons",e,nt(R,R)))),Apply0:()=>Wn},Wn={apply:t=>e=>A(t._1,at(t._2)(ct("CatCons",n=>A(e._1,at(e._2)(ct("CatCons",r=>Oe.pure(n(r)),nt(R,R)))),nt(R,R)))),Functor0:()=>to},Oe={pure:t=>A(U("Return",t),B),Apply0:()=>Wn};var js=t=>{let e=n=>{let r=Vr(n);if(r.tag==="Return")return A(U("Return",r._1),B);if(r.tag==="Bind"){let o=t(r._1);return A(o._1,at(o._2)(ct("CatCons",a=>e(r._2(a)),nt(R,R))))}l()};return e},eo=t=>js(e=>A(U("Bind",t(e),n=>A(U("Return",n),B)),B));var no=function(t){return function(e){return t===e}};var ro=no,oo=no;var ao={eq:oo},Pn={eq:ro};var io=function(t){return function(e){return function(n){return function(r){return function(o){return r<o?t:r===o?e:n}}}}};var uo=io,co=io;var je={compare:co(pt)(zt)(ft),Eq0:()=>ao},Rt={compare:uo(pt)(zt)(ft),Eq0:()=>Pn};var Le=function(t){throw new Error(t)};var He=(t,e,n,r)=>({tag:"KickUp",_1:t,_2:e,_3:n,_4:r}),tt=(t,e,n,r,o,a,s,i)=>({tag:t,_1:e,_2:n,_3:r,_4:o,_5:a,_6:s,_7:i}),de=(t,e,n,r,o,a,s)=>({tag:t,_1:e,_2:n,_3:r,_4:o,_5:a,_6:s});var Ye=tt("Leaf");var mo=t=>e=>r=>{let o=r,a=!0,s;for(;a;){let i=o;if(i.tag==="Leaf"){a=!1,s=y;continue}if(i.tag==="Two"){let d=t.compare(e)(i._2);if(d.tag==="EQ"){a=!1,s=x("Just",i._3);continue}if(d.tag==="LT"){o=i._1;continue}o=i._4;continue}if(i.tag==="Three"){let d=t.compare(e)(i._2);if(d.tag==="EQ"){a=!1,s=x("Just",i._3);continue}let c=t.compare(e)(i._5);if(c.tag==="EQ"){a=!1,s=x("Just",i._6);continue}if(d.tag==="LT"){o=i._1;continue}if(c.tag==="GT"){o=i._7;continue}o=i._4;continue}l()}return s};var Ce=t=>e=>n=>{let r=t,o=e,a=n,s=!0,i;for(;s;){let d=r,c=o,f=a;if(c.tag==="Nil"){s=!1,i=f;continue}if(c.tag==="Cons"){if(c._1.tag==="TwoLeft"){r=d,o=c._2,a=tt("Two",f,c._1._1,c._1._2,c._1._3);continue}if(c._1.tag==="TwoRight"){r=d,o=c._2,a=tt("Two",c._1._1,c._1._2,c._1._3,f);continue}if(c._1.tag==="ThreeLeft"){r=d,o=c._2,a=tt("Three",f,c._1._1,c._1._2,c._1._3,c._1._4,c._1._5,c._1._6);continue}if(c._1.tag==="ThreeMiddle"){r=d,o=c._2,a=tt("Three",c._1._1,c._1._2,c._1._3,f,c._1._4,c._1._5,c._1._6);continue}if(c._1.tag==="ThreeRight"){r=d,o=c._2,a=tt("Three",c._1._1,c._1._2,c._1._3,c._1._4,c._1._5,c._1._6,f);continue}l()}l()}return i},_o=t=>e=>n=>{let r=a=>s=>{let i=a,d=s,c=!0,f;for(;c;){let p=i,u=d;if(p.tag==="Nil"){c=!1,f=tt("Two",u._1,u._2,u._3,u._4);continue}if(p.tag==="Cons"){if(p._1.tag==="TwoLeft"){c=!1,f=Ce(t)(p._2)(tt("Three",u._1,u._2,u._3,u._4,p._1._1,p._1._2,p._1._3));continue}if(p._1.tag==="TwoRight"){c=!1,f=Ce(t)(p._2)(tt("Three",p._1._1,p._1._2,p._1._3,u._1,u._2,u._3,u._4));continue}if(p._1.tag==="ThreeLeft"){i=p._2,d=He(tt("Two",u._1,u._2,u._3,u._4),p._1._1,p._1._2,tt("Two",p._1._3,p._1._4,p._1._5,p._1._6));continue}if(p._1.tag==="ThreeMiddle"){i=p._2,d=He(tt("Two",p._1._1,p._1._2,p._1._3,u._1),u._2,u._3,tt("Two",u._4,p._1._4,p._1._5,p._1._6));continue}if(p._1.tag==="ThreeRight"){i=p._2,d=He(tt("Two",p._1._1,p._1._2,p._1._3,p._1._4),p._1._5,p._1._6,tt("Two",u._1,u._2,u._3,u._4));continue}l()}l()}return f};return(a=>s=>{let i=a,d=s,c=!0,f;for(;c;){let p=i,u=d;if(u.tag==="Leaf"){c=!1,f=r(p)(He(Ye,e,n,Ye));continue}if(u.tag==="Two"){let m=t.compare(e)(u._2);if(m.tag==="EQ"){c=!1,f=Ce(t)(p)(tt("Two",u._1,e,n,u._4));continue}if(m.tag==="LT"){i=ot("Cons",de("TwoLeft",u._2,u._3,u._4),p),d=u._1;continue}i=ot("Cons",de("TwoRight",u._1,u._2,u._3),p),d=u._4;continue}if(u.tag==="Three"){let m=t.compare(e)(u._2);if(m.tag==="EQ"){c=!1,f=Ce(t)(p)(tt("Three",u._1,e,n,u._4,u._5,u._6,u._7));continue}let W=t.compare(e)(u._5);if(W.tag==="EQ"){c=!1,f=Ce(t)(p)(tt("Three",u._1,u._2,u._3,u._4,e,n,u._7));continue}if(m.tag==="LT"){i=ot("Cons",de("ThreeLeft",u._2,u._3,u._4,u._5,u._6,u._7),p),d=u._1;continue}if(m.tag==="GT"){if(W.tag==="LT"){i=ot("Cons",de("ThreeMiddle",u._1,u._2,u._3,u._5,u._6,u._7),p),d=u._4;continue}i=ot("Cons",de("ThreeRight",u._1,u._2,u._3,u._4,u._5,u._6),p),d=u._7;continue}i=ot("Cons",de("ThreeRight",u._1,u._2,u._3,u._4,u._5,u._6),p),d=u._7;continue}l()}return f})(R)};function Wt(t,e,n){return t==null?e:n(t)}var Dt=function(){var t={},e="Pure",n="Throw",r="Catch",o="Sync",a="Async",s="Bind",i="Bracket",d="Fork",c="Sequential",f="Map",p="Apply",u="Alt",m="Cons",W="Resume",Q="Release",it="Finalizer",L="Finalized",k="Forked",_t="Fiber",gt="Thunk";function _(g,w,j,v){this.tag=g,this._1=w,this._2=j,this._3=v}function V(g){var w=function(j,v,D){return new _(g,j,v,D)};return w.tag=g,w}function Pt(g){return new _(e,void 0)}function $n(g){try{g()}catch(w){setTimeout(function(){throw w},0)}}function me(g,w,j){try{return w(j())}catch(v){return g(v)}}function Fa(g,w,j){try{return w(j)()}catch(v){return j(g(v))(),Pt}}var We=function(){var g=1024,w=0,j=0,v=new Array(g),D=!1;function $(){var q;for(D=!0;w!==0;)w--,q=v[j],v[j]=void 0,j=(j+1)%g,q();D=!1}return{isDraining:function(){return D},enqueue:function(q){var M,G;w===g&&(G=D,$(),D=G),v[(j+w)%g]=q,w++,D||$()}}}();function Aa(g){var w={},j=0,v=0;return{register:function(D){var $=j++;D.onComplete({rethrow:!0,handler:function(q){return function(){v--,delete w[$]}}})(),w[$]=D,v++},isEmpty:function(){return v===0},killAll:function(D,$){return function(){if(v===0)return $();var q=0,M={};function G(z){M[z]=w[z].kill(D,function(K){return function(){delete M[z],q--,g.isLeft(K)&&g.fromLeft(K)&&setTimeout(function(){throw g.fromLeft(K)},0),q===0&&$()}})()}for(var Z in w)w.hasOwnProperty(Z)&&(q++,G(Z));return w={},j=0,v=0,function(z){return new _(o,function(){for(var K in M)M.hasOwnProperty(K)&&M[K]()})}}}}}var ne=0,lt=1,qe=2,ve=3,Pe=4,yt=5,_e=6;function mn(g,w,j){var v=0,D=ne,$=j,q=null,M=null,G=null,Z=null,z=null,K=0,Yt=0,Tt=null,Qt=!0;function Gt(b){for(var T,F,S;;)switch(T=null,F=null,S=null,D){case qe:D=lt;try{$=G($),Z===null?G=null:(G=Z._1,Z=Z._2)}catch(et){D=yt,q=g.left(et),$=null}break;case ve:g.isLeft($)?(D=yt,q=$,$=null):G===null?D=yt:(D=qe,$=g.fromRight($));break;case lt:switch($.tag){case s:G&&(Z=new _(m,G,Z)),G=$._2,D=lt,$=$._1;break;case e:G===null?(D=yt,$=g.right($._1)):(D=qe,$=$._1);break;case o:D=ve,$=me(g.left,g.right,$._1);break;case a:D=Pe,$=Fa(g.left,$._1,function(et){return function(){v===b&&(v++,We.enqueue(function(){v===b+1&&(D=ve,$=et,Gt(v))}))}});return;case n:D=yt,q=g.left($._1),$=null;break;case r:G===null?z=new _(m,$,z,M):z=new _(m,$,new _(m,new _(W,G,Z),z,M),M),G=null,Z=null,D=lt,$=$._1;break;case i:K++,G===null?z=new _(m,$,z,M):z=new _(m,$,new _(m,new _(W,G,Z),z,M),M),G=null,Z=null,D=lt,$=$._1;break;case d:D=ve,T=mn(g,w,$._2),w&&w.register(T),$._1&&T.run(),$=g.right(T);break;case c:D=lt,$=wa(g,w,$._1);break}break;case yt:if(G=null,Z=null,z===null)D=_e,$=M||q||$;else switch(T=z._3,S=z._1,z=z._2,S.tag){case r:M&&M!==T&&K===0?D=yt:q&&(D=lt,$=S._2(g.fromLeft(q)),q=null);break;case W:M&&M!==T&&K===0||q?D=yt:(G=S._1,Z=S._2,D=qe,$=g.fromRight($));break;case i:K--,q===null&&(F=g.fromRight($),z=new _(m,new _(Q,S._2,F),z,T),(M===T||K>0)&&(D=lt,$=S._3(F)));break;case Q:z=new _(m,new _(L,$,q),z,M),D=lt,M&&M!==T&&K===0?$=S._1.killed(g.fromLeft(M))(S._2):q?$=S._1.failed(g.fromLeft(q))(S._2):$=S._1.completed(g.fromRight($))(S._2),q=null,K++;break;case it:K++,z=new _(m,new _(L,$,q),z,M),D=lt,$=S._1;break;case L:K--,D=yt,$=S._1,q=S._2;break}break;case _e:for(var Y in Tt)Tt.hasOwnProperty(Y)&&(Qt=Qt&&Tt[Y].rethrow,$n(Tt[Y].handler($)));Tt=null,M&&q?setTimeout(function(){throw g.fromLeft(q)},0):g.isLeft($)&&Qt&&setTimeout(function(){if(Qt)throw g.fromLeft($)},0);return;case ne:D=lt;break;case Pe:return}}function H(b){return function(){if(D===_e)return Qt=Qt&&b.rethrow,b.handler($)(),function(){};var T=Yt++;return Tt=Tt||{},Tt[T]=b,function(){Tt!==null&&delete Tt[T]}}}function C(b,T){return function(){if(D===_e)return T(g.right(void 0))(),function(){};var F=H({rethrow:!1,handler:function(){return T(g.right(void 0))}})();switch(D){case ne:M=g.left(b),D=_e,$=M,Gt(v);break;case Pe:M===null&&(M=g.left(b)),K===0&&(D===Pe&&(z=new _(m,new _(it,$(b)),z,M)),D=yt,$=null,q=null,Gt(++v));break;default:M===null&&(M=g.left(b)),K===0&&(D=yt,$=null,q=null)}return F}}function I(b){return function(){var T=H({rethrow:!1,handler:b})();return D===ne&&Gt(v),T}}return{kill:C,join:I,onComplete:H,isSuspended:function(){return D===ne},run:function(){D===ne&&(We.isDraining()?Gt(v):We.enqueue(function(){Gt(v)}))}}}function Sa(g,w,j,v){var D=0,$={},q=0,M={},G=new Error("[ParAff] Early exit"),Z=null,z=t;function K(H,C,I){var b=C,T=null,F=null,S=0,Y={},et,ge;t:for(;;)switch(et=null,b.tag){case k:if(b._3===t&&(et=$[b._1],Y[S++]=et.kill(H,function(Ra){return function(){S--,S===0&&I(Ra)()}})),T===null)break t;b=T._2,F===null?T=null:(T=F._1,F=F._2);break;case f:b=b._2;break;case p:case u:T&&(F=new _(m,T,F)),T=b,b=b._1;break}if(S===0)I(g.right(void 0))();else for(ge=0,et=S;ge<et;ge++)Y[ge]=Y[ge]();return Y}function Yt(H,C,I){var b,T,F,S,Y,et;g.isLeft(H)?(b=H,T=null):(T=H,b=null);t:for(;;){if(F=null,S=null,Y=null,et=null,Z!==null)return;if(C===null){v(b||T)();return}if(C._3!==t)return;switch(C.tag){case f:b===null?(C._3=g.right(C._1(g.fromRight(T))),T=C._3):C._3=b;break;case p:if(F=C._1._3,S=C._2._3,b){if(C._3=b,Y=!0,et=q++,M[et]=K(G,b===F?C._2:C._1,function(){return function(){delete M[et],Y?Y=!1:I===null?Yt(b,null,null):Yt(b,I._1,I._2)}}),Y){Y=!1;return}}else{if(F===t||S===t)return;T=g.right(g.fromRight(F)(g.fromRight(S))),C._3=T}break;case u:if(F=C._1._3,S=C._2._3,F===t&&g.isLeft(S)||S===t&&g.isLeft(F))return;if(F!==t&&g.isLeft(F)&&S!==t&&g.isLeft(S))b=T===F?S:F,T=null,C._3=b;else if(C._3=T,Y=!0,et=q++,M[et]=K(G,T===F?C._2:C._1,function(){return function(){delete M[et],Y?Y=!1:I===null?Yt(T,null,null):Yt(T,I._1,I._2)}}),Y){Y=!1;return}break}I===null?C=null:(C=I._1,I=I._2)}}function Tt(H){return function(C){return function(){delete $[H._1],H._3=C,Yt(C,H._2._1,H._2._2)}}}function Qt(){var H=lt,C=j,I=null,b=null,T,F;t:for(;;)switch(T=null,F=null,H){case lt:switch(C.tag){case f:I&&(b=new _(m,I,b)),I=new _(f,C._1,t,t),C=C._2;break;case p:I&&(b=new _(m,I,b)),I=new _(p,t,C._2,t),C=C._1;break;case u:I&&(b=new _(m,I,b)),I=new _(u,t,C._2,t),C=C._1;break;default:F=D++,H=yt,T=C,C=new _(k,F,new _(m,I,b),t),T=mn(g,w,T),T.onComplete({rethrow:!1,handler:Tt(C)})(),$[F]=T,w&&w.register(T)}break;case yt:if(I===null)break t;I._1===t?(I._1=C,H=lt,C=I._2,I._2=t):(I._2=C,C=I,b===null?I=null:(I=b._1,b=b._2))}for(z=C,F=0;F<D;F++)$[F].run()}function Gt(H,C){Z=g.left(H);var I;for(var b in M)if(M.hasOwnProperty(b)){I=M[b];for(b in I)I.hasOwnProperty(b)&&I[b]()}M=null;var T=K(H,z,C);return function(F){return new _(a,function(S){return function(){for(var Y in T)T.hasOwnProperty(Y)&&T[Y]();return Pt}})}}return Qt(),function(H){return new _(a,function(C){return function(){return Gt(H,C)}})}}function wa(g,w,j){return new _(a,function(v){return function(){return Sa(g,w,j,v)}})}return _.EMPTY=t,_.Pure=V(e),_.Throw=V(n),_.Catch=V(r),_.Sync=V(o),_.Async=V(a),_.Bind=V(s),_.Bracket=V(i),_.Fork=V(d),_.Seq=V(c),_.ParMap=V(f),_.ParApply=V(p),_.ParAlt=V(u),_.Fiber=mn,_.Supervisor=Aa,_.Scheduler=We,_.nonCanceler=Pt,_}(),kt=Dt.Pure,di=Dt.Throw;function yo(t){return function(e){return e.tag===Dt.Pure.tag?Dt.Pure(t(e._1)):Dt.Bind(e,function(n){return Dt.Pure(t(n))})}}function bt(t){return function(e){return Dt.Bind(t,e)}}var qt=Dt.Sync;var li=Dt.Async;function Ke(t,e){return function(){return Dt.Fiber(t,null,e)}}var Bn=function(){function t(n,r){return n===0&&typeof setImmediate<"u"?setImmediate(r):setTimeout(r,n)}function e(n,r){return n===0&&typeof clearImmediate<"u"?clearImmediate(r):clearTimeout(r)}return function(n,r){return Dt.Async(function(o){return function(){var a=t(r,o(n()));return function(){return Dt.Sync(function(){return n(e(r,a))})}}})}}(),pi=Dt.Seq;var Un={map:yo};var Qn={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;l()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return Le("unsafeFromLeft: Right");l()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return Le("unsafeFromRight: Left");l()},left:hn,right:Ot};var ho={Applicative0:()=>Ve,Bind1:()=>fi},fi={bind:bt,Apply0:()=>Do},Do={apply:t=>e=>bt(t)(n=>bt(e)(r=>Ve.pure(n(r)))),Functor0:()=>Un},Ve={pure:kt,Apply0:()=>Do};var Xe={liftEffect:qt,Monad0:()=>ho};var bo={tailRecM:t=>{let e=n=>bt(t(n))(r=>{if(r.tag==="Done")return kt(r._1);if(r.tag==="Loop")return e(r._1);l()});return e},Monad0:()=>ho};var To=(t,e)=>t&&e?n=>t(e(n)):t||e,Lo=(t,e,n)=>{t[e]=n},Co=(t,e,n)=>{n==null||e==="class"&&!n?t.removeAttribute(e):t.setAttribute(e,n)},Mo=(t,e,n,r,o,a)=>{t.actions||(t.actions={}),t.actions[e]=a&&r?a(r):r,r?n||t.addEventListener(e,o):t.removeEventListener(e,o)},Ze=(t,e,n,r)=>{let o=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),a=t.props,s=t.attrs,i=t.events,d=To(r,t.mapf);for(let c in a)Lo(o,c,a[c]);for(let c in s)Co(o,c,s[c]);for(let c in i)Mo(o,c,null,i[c],e,d);for(let c=0,f=t.children.length;c<f;c++)o.appendChild(Ze(te(t.children[c]).html,e,n,d));return t.node=o,o},Zt=(t,e,n,r,o,a,s)=>{if(n!==r){if(n!=null&&n.type===3&&r.type===3)n.tag!==r.tag&&(e.nodeValue=r.tag);else if(n==null||n.tag!==r.tag)e=t.insertBefore(Ze(r,o,a,s),e),n&&n.node.remove();else{let i=n.props,d=r.props;for(let L in{...i,...d})i[L]!==d[L]&&Lo(e,L,d[L]);let c=n.attrs,f=r.attrs;for(let L in{...c,...f})c[L]!==f[L]&&Co(e,L,f[L]);let p=n.events,u=r.events;for(let L in{...p,...u})p[L]!==u[L]&&Mo(e,L,p[L],u[L],o,s);let m=n.children,W=r.children,Q=m.length-1,it=W.length-1;if(s=To(s,r.mapf),a=a||r.tag==="svg",r.keyed){let L=0,k=0;for(;k<=it&&L<=Q;){let{key:_t,html:gt}=m[L];if(_t!==W[k].key)break;let _=te(W[k],gt);Zt(e,gt.node,gt,_.html,o,a,s),k++,L++}for(;k<=it&&L<=Q;){let{key:_t,html:gt}=m[Q];if(_t!==W[it].key)break;let _=te(W[it],gt);Zt(e,gt.node,gt,_.html,o,a,s),it--,Q--}if(L>Q)for(;k<=it;){let _t=te(W[k]).html;e.insertBefore(Ze(_t,o,a,s),m[L]&&m[L].html.node),k++}else if(k>it)for(;L<=Q;)m[L].html.node.remove(),L++;else{let _t={},gt={};for(let _=L;_<=Q;_++)_t[m[_].key]=m[_].html;for(;k<=it;){let{key:_,html:V}=m[L]||{key:null,html:null},{key:Pt,html:$n}=te(W[k],V);if(gt[_]||m[L+1]&&Pt===m[L+1].key){L++;continue}if(_===Pt)Zt(e,V.node,V,$n,o,a,s),gt[Pt]=!0,L++;else{let me=_t[Pt];me!=null?(Zt(e,e.insertBefore(me.node,V.node),me,W[k].html,o,a,s),gt[Pt]=!0):Zt(e,V&&V.node,null,W[k].html,o,a,s)}k++}for(let _ in _t)gt[_]||_t[_].node.remove()}}else{for(let L=0;L<=Q&&L<=it;L++){let k=m[L].html,_t=te(W[L],k).html;Zt(e,k.node,k,_t,o,a,s)}for(let L=Q+1;L<=it;L++){let k=te(W[L],n).html;e.appendChild(Ze(k,o,a,s))}for(let L=it+1;L<=Q;L++)m[L].html.node.remove()}}return r.node=e,e}},$i=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},te=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||$i(e.memo,t.html.memo))&&(e=tn(t.html.type(...t.html.memo)),e.memo=t.html.memo),t.html=e),t),tn=t=>({...t,children:t.children&&t.children.map(({key:e,html:n})=>({key:e,html:tn(n)}))}),No=(t,e)=>t.actions[e],Eo=Zt,Io=t=>e=>(e.node=t,e);var _i=(t,e,n,r=!1)=>{let o=[],a={},s={},i={},d={tag:t,children:n,props:a,attrs:s,events:i,node:null,keyed:r},c=e.length;for(let p=0;p<c;p++){let[u,m,W]=e[p];u===0?a[m]=W:u===1?s[m]=W:u===2?i[m]=W:u===3?s.class=s.class?s.class+" "+m:m:u===4&&o.push(m+":"+W)}let f=o.join(";");return f&&(s.style=f),d},X=(t,e,n)=>_i(t,e,n.map(r=>({key:null,html:r})));var gi=t=>({tag:t,children:[],type:3});var mt=(t,e)=>[1,t,e],en=(t,e)=>[2,t,e],Bt=t=>[3,t];var dt=(t,e)=>[4,t,e],Ut=gi;var xo=Ut("");function nn(t){return function(e){return t===e}}var st=(t,e,n)=>({tag:t,_1:e,_2:n});var jn=t=>({liftEffect:e=>A(U("Bind",st("Lift",t.liftEffect(e)),n=>A(U("Return",n),B)),B),Monad0:()=>Zr});var So=t=>{let e=jn(t.MonadEffect0());return{liftAff:n=>A(U("Bind",st("Lift",t.liftAff(n)),r=>A(U("Return",r),B)),B),MonadEffect0:()=>e}},wo=t=>({map:e=>n=>{if(n.tag==="State")return st("State",r=>{let o=n._1(r);return E(e(o._1),o._2)});if(n.tag==="Lift")return st("Lift",t.map(e)(n._1));if(n.tag==="Subscribe")return st("Subscribe",n._1,r=>e(n._2(r)));if(n.tag==="Unsubscribe")return st("Unsubscribe",n._1,e(n._2));l()}});var Ro=t=>e=>eo(n=>{if(n.tag==="State")return st("State",n._1);if(n.tag==="Lift")return st("Lift",t(n._1));if(n.tag==="Subscribe")return st("Subscribe",n._1,n._2);if(n.tag==="Unsubscribe")return st("Unsubscribe",n._1,n._2);l()})(e);var ee=function(t){return function(e){return function(){return e[t]}}},mp=ee("URL"),_p=ee("documentURI"),gp=ee("origin"),yp=ee("compatMode"),hp=ee("characterSet"),Dp=ee("contentType");var Li=ee("documentElement");function Wo(t){return function(e){return function(){return e.createTextNode(t)}}}var Ft=function(t){return function(e){return function(){return e[t]}}};var Bp=Ft("baseURI"),Ni=Ft("ownerDocument"),Kn=Ft("parentNode"),Ei=Ft("parentElement");var Up=Ft("childNodes"),Ii=Ft("firstChild"),xi=Ft("lastChild"),Fi=Ft("previousSibling"),Ai=Ft("nextSibling"),Si=Ft("nodeValue");var Qp=Ft("textContent");function vo(t){return function(e){return function(){e.appendChild(t)}}}var rn=function(t){return function(e){return function(){return e[t]}}},gf=rn("children"),Ri=rn("firstElementChild"),Wi=rn("lastElementChild"),yf=rn("childElementCount");function Po(t){return function(e){return function(){return e.querySelector(t)}}}var zo=t=>{let e=Po(t);return n=>{let r=e(n);return()=>{let o=r();return Wt(o,y,J)}}};function Vn(t){return t.currentTarget}function Jo(t){return t.type}var Xn=function(){return window};function Zn(t){return function(){return t.document}}var Me=Cn(Dn)(be),Bi=Cn(Ve)(be),Ui=Xr(wo(Un))(bo),Qi=t=>e=>n=>{let r=n(e);return()=>{let o=r();return Me(o)(t.update(t))()}},ko=t=>e=>{let n=t.node,r=t.vdom;return()=>{let o=r.value,a=n.value,s=Kn(a)();return Me(Wt(s,y,J))(i=>{let d=tn(e);return()=>{let c=Eo(i,a,o,d,f=>{let p=Jo(f);return Me(Wt(Vn(f),y,J))(u=>()=>{let m=No(u,p);return Qi(t)(f)(m)()})()});return n.value=c,r.value=d}})()}},Gi=t=>e=>{let n=t.state;return()=>{let r=n.value,o=nn(r)(e);if(!o)return n.value=e,ko(t)(t.view(e))();o||l()}},Bo=t=>e=>n=>{let r=e.subscriptions;return Ui(o=>{if(o.tag==="State")return bt(qt((()=>{let a=e.state;return()=>a.value})()))(a=>{let s=o._1(a),i=s._1;return bt(qt(Gi(e)(s._2)))(()=>kt(i))});if(o.tag==="Lift")return o._1;if(o.tag==="Subscribe")return bt(qt(o._1(a=>{let s=Ke(Qn,Bo(t)(e)(t(a)));return()=>{s().run()}})))(a=>bt(qt((()=>{let s=e.freshId;return()=>{let i=s.value;return s.value=i+1|0,i}})()))(s=>bt(qt((()=>{let i=_o(Rt)(s)(a);return()=>{let d=r.value;r.value=i(d)}})()))(()=>kt(o._2(s)))));if(o.tag==="Unsubscribe"){let a=o._2,s=o._1;return bt(qt(()=>r.value))(i=>bt(Bi(mo(Rt)(s)(i))(qt))(()=>kt(a)))}l()})(n)},Oi=t=>{let e=t.init.model,n=t.init.msg,r=t.selector,o=t.update,a=t.view;return()=>{let s=Xn(),i=Zn(s)(),d=zo(r)(i)();return Me(d.tag==="Just"?x("Just",d._1):y)(c=>()=>{let f={value:e},p=Xn(),u=Zn(p)(),m=Wo("")(u)();vo(m)(c)();let W={value:m},Q={value:Io(m)(Ut(""))},k={view:a,update:o,state:f,node:W,vdom:Q,subscriptions:{value:Ye},freshId:{value:0}};return ko(k)(a(e))(),Me(n)(k.update(k))()})()}};var Uo=t=>{let e=t.update;return Oi({init:t.init,view:t.view,selector:t.selector,update:n=>r=>{let o=Ke(Qn,Bo(e)(n)(e(r)));return()=>{o().run()}}})};var Ne=function(t){return function(e){return t+e}};var er=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},Ee=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var nr=isFinite;var Ie=Math.floor;var Oo=function(t){return function(e){return Math.pow(t,e)}},on=function(t){return function(e){return t%e}};var jo=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},O=function(t){return t};var rr=jo(J)(y),an=t=>{if(!nr(t))return 0;if(t>=O(2147483647))return 2147483647;if(t<=O(-2147483648))return-2147483648;let e=rr(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;l()};var Ho=Math.random;var Yo=t=>e=>()=>{let n=Ho();return an(Ie((O(e)-O(t)+1)*n+O(t)))};var or=(()=>{let t=Yo(1)(2147483646);return()=>{let e=t();return(()=>{let n=Ee(e)(2147483645);return n<1?n+2147483646|0:n})()}})();var Ko=t=>e=>{let n=rr(on(O(48271)*O(e)+O(t))(O(2147483647)));if(n.tag==="Just")return n._1;l()};var Xo=function(t){return function(e){return function(){return t(e())}}},Zo=function(t){return function(){return t}};var Vi={map:Xo};var Xi={apply:t=>e=>()=>{let n=t(),r=e();return ar.pure(n(r))()},Functor0:()=>Vi},ar={pure:Zo,Apply0:()=>Xi};var ta=function(e){return function(n){return function(){return e(n)}}};var ea=function(e){return function(n){return function(r){return function(o){return function(){return e(n,r,o)}}}}};var na=function(t,e,n){var r=t>=0&&t<n.length;return r&&(n[t]=e),r};function eu(t){return t.slice()}var ra=eu,nu=function(){function t(e,n,r,o,a,s){var i,d,c,f,p,u,m;for(i=a+(s-a>>1),i-a>1&&t(e,n,o,r,a,i),s-i>1&&t(e,n,o,r,i,s),d=a,c=i,f=a;d<i&&c<s;)p=o[d],u=o[c],m=n(e(p)(u)),m>0?(r[f++]=u,++c):(r[f++]=p,++d);for(;d<i;)r[f++]=o[d++];for(;c<s;)r[f++]=o[c++]}return function(e,n,r){return r.length<2||t(e,n,r,r.slice(0),0,r.length),r}}();var sr=ta(ra);var oa=ea(na);var vt=function(t){return function(e){for(var n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t(o)(e[o]);return r}};var fe=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var au=function(t,e){if(t<1)return[];var n=new Array(t);return n.fill(e)},su=function(t,e){for(var n=[],r=0,o=0;o<t;o++)n[r++]=e;return n},ir=typeof Array.prototype.fill=="function"?au:su,iu=function(){function t(o,a){this.head=o,this.tail=a}var e={};function n(o){return function(a){return new t(o,a)}}function r(o){for(var a=[],s=0,i=o;i!==e;)a[s++]=i.head,i=i.tail;return a}return function(o,a){return r(o(n)(e)(a))}}();var ur=function(t,e,n){return n.length===0?t({}):e(n[0])(n.slice(1))},At=function(t,e,n,r){return r<0||r>=n.length?e:t(n[r])};var $e=function(t,e){return e.filter(t)};var uu=function(){function t(e,n,r,o,a,s){var i,d,c,f,p,u,m;for(i=a+(s-a>>1),i-a>1&&t(e,n,o,r,a,i),s-i>1&&t(e,n,o,r,i,s),d=a,c=i,f=a;d<i&&c<s;)p=o[d],u=o[c],m=n(e(p)(u)),m>0?(r[f++]=u,++c):(r[f++]=p,++d);for(;d<i;)r[f++]=o[d++];for(;c<s;)r[f++]=o[c++]}return function(e,n,r){var o;return r.length<2?r:(o=r.slice(0),t(e,n,o,r.slice(0),0,r.length),o)}}();var sn=function(t,e,n){for(var r=e.length<n.length?e.length:n.length,o=new Array(r),a=0;a<r;a++)o[a]=t(e[a])(n[a]);return o},cr=function(t,e){for(var n=e.length,r=0;r<n;r++)if(t(e[r]))return!0;return!1},dr=function(t,e){for(var n=e.length,r=0;r<n;r++)if(!t(e[r]))return!1;return!0};var du=Qe(ar);var un=t=>{let e=du(t);return n=>r=>(()=>{let o=sr(r);return()=>{let a=o();return e(s=>oa(s._1)(s._2)(a))(n)(),a}})()()};var lr=t=>e=>(()=>{let n=sr(t);return()=>{let r=n();return r.push(e),r}})()();var pr=t=>({tag:t}),ia=(()=>Sr(Ct)(je.compare))(),lu=(()=>Ar(Ct)(je.compare))(),pu=ie(Ne)(0),fu=un(Ct),$u=pr("Empty"),fr=pr("X"),cn=pr("O");var mu=[[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14],[15,16,17,18,19],[20,21,22,23,24],[0,5,10,15,20],[1,6,11,16,21],[2,7,12,17,22],[3,8,13,18,23],[4,9,14,19,24],[0,6,12,18,24],[4,8,12,16,20]],ua=t=>{let e=$e(s=>s<100,t),n=ia(e),r=(()=>{if(n.tag==="Nothing")return 0;if(n.tag==="Just")return n._1;l()})(),o=lu(e),a=(()=>{if(o.tag==="Nothing")return 0;if(o.tag==="Just")return o._1;l()})();return wt(s=>s===100?-1:r===a?1:(s-r)/(a-r))(t)},dn={grid:ir(25,$u),history:[],erdosTable:y,locked:!1},ln=t=>pu(wt(e=>cr(n=>{let r=At(J,y,t,n);return r.tag==="Nothing"?!1:r.tag==="Just"?r._1.tag==="Empty"||r._1.tag==="X"?!1:r._1.tag==="O":!1},e)?0:1/Oo(2)(O($e(n=>{let r=At(J,y,t,n);return r.tag==="Nothing"?!1:r.tag==="Just"?r._1.tag==="Empty":!1},e).length)))(mu)),ca=t=>vt(e=>n=>n.tag!=="Empty"?100:ln(fu([E(e,cn)])(t)))(t),da=t=>{let e=ia(t),n=(()=>{if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;l()})();return wt(Vt)($e(r=>r._2===n,vt(r=>o=>E(r,o))(t)))};var _u=t=>{let e=t.Apply0(),n=e.Functor0(),r={map:a=>{let s=n.map(a);return i=>d=>s(i(d))}},o={apply:a=>s=>i=>e.apply(a(i))(s(i)),Functor0:()=>r};return{bind:a=>s=>i=>t.bind(a(i))(d=>s(d)(i)),Apply0:()=>o}};var gu=t=>{let e=t.Applicative0(),n=e.Apply0(),r=n.Functor0(),o={map:d=>{let c=r.map(d);return f=>p=>c(f(p))}},a={apply:d=>c=>f=>n.apply(d(f))(c(f)),Functor0:()=>o},s={pure:d=>{let c=e.pure(d);return f=>c},Apply0:()=>a},i=_u(t.Bind1());return{Applicative0:()=>s,Bind1:()=>i}};var pn=t=>{let e=gu(t.Monad0());return{liftEffect:n=>{let r=t.liftEffect(n);return o=>r},Monad0:()=>e}};var we=t=>({map:e=>n=>r=>t.map(o=>E(e(o._1),o._2))(n(r))});var $r=t=>{let e=t.Bind1().bind;return{bind:n=>r=>o=>e(n(o))(a=>r(a._1)(a._2)),Apply0:()=>fn(t)}},fn=t=>{let e=we(t.Bind1().Apply0().Functor0());return{apply:(()=>{let n=$r(t).bind,r=Re(t).pure;return o=>a=>n(o)(s=>n(a)(i=>r(s(i))))})(),Functor0:()=>e}},Re=t=>{let e=t.Applicative0().pure;return{pure:n=>r=>e(E(n,r)),Apply0:()=>fn(t)}};var fa=t=>{let e=t.Applicative0().pure,n={Applicative0:()=>Re(t),Bind1:()=>$r(t)};return{state:r=>o=>e(r(o)),Monad0:()=>n}};var $a={liftAff:t=>t,MonadEffect0:()=>Xe};var ma=t=>{let e=pn(t.MonadEffect0());return{liftAff:n=>{let r=t.liftAff(n);return o=>r},MonadEffect0:()=>e}};var qu=function(){function t(s){this.fn=s}var e={},n=function(s,i){this.head=s,this.tail=i};function r(s){return new n(s,e)}function o(s){return function(i){return new n(s,i)}}function a(s){for(var i=[],d=s;d!==e;)i.push(d.head),d=d.tail;return i}return function(s,i,d){var c=function(p,u){return s(i(o)(d(p)))(u)},f=function(p,u,m){if(u===0)return p;var W=m[u-1];return new t(function(){var Q=f(c(W,p),u-1,m);return Q})};return function(p){for(var u=i(r)(d(p[p.length-1])),m=f(u,p.length-1,p);m instanceof t;)m=m.fn();return i(a)(m)}}}();var Pu=t=>fa(t).state(e=>E(e.newSeed,{...e,newSeed:Ko(0)(e.newSeed)}));var zu=t=>{let e=we(t.Bind1().Apply0().Functor0()).map,n=Pu(t),r=fn(t).apply;return o=>a=>{let s=O(a),i=O(o),d=e(O)(n);return e(c=>an(Ie(i+on(c)(s-i+1))))(r(e(Ne)(d))(e(c=>2*c)(d)))}},ga=t=>{let e=zu(t);return n=>r=>n<=r?e(n)(r):e(r)(n)};var ku=(()=>Re(De).pure)(),Bu=(()=>we(he).map)(),Uu=ga(De),ya=t=>t.length===0?ku(y):Bu(e=>At(J,y,t,e))(Uu(0)(t.length-1|0)),ha=t=>{let e=ur(n=>y,n=>r=>x("Just",r),t);if(e.tag==="Nothing")return[];if(e.tag==="Just")return sn(xt,t,e._1);l()};var ba=A(U("Bind",st("Lift",kt),t=>A(U("Return",t),B)),B),Ta=(()=>jn(pn(Xe)).liftEffect)(),La=A(U("Bind",st("State",t=>E(t,t)),t=>A(U("Return",t),B)),B),Ca=un(Ct),Qu=(()=>{let t=So(ma($a)).liftAff;return e=>t(Bn(Ot,e))})(),Gu=t=>A(ba._1,at(ba._2)(ct("CatCons",e=>{let n=e.genState,r=Ta(()=>n.value);return A(r._1,at(r._2)(ct("CatCons",o=>{let a=t(o),s=a._2,i=a._1,d=Ta(()=>n.value=s);return A(d._1,at(d._2)(ct("CatCons",()=>A(U("Return",i),B),nt(R,R))))},nt(R,R))))},nt(R,R)))),Ma=t=>{if(t.tag==="Play"){let e=t._1;return A(La._1,at(La._2)(ct("CatCons",n=>{if((()=>{let s=At(J,y,n.grid,e);return s.tag==="Nothing"?!0:s.tag==="Just"?n.locked||s._1.tag!=="Empty":!0})())return A(U("Return",void 0),B);let r=Ca([E(e,fr)])(n.grid),o=ca(r),a={...n,grid:r,erdosTable:x("Just",ua(o)),locked:!0,history:lr(n.history)({square:e,symbol:fr,erdos:ln(r)})};return A(U("Bind",st("State",s=>E(void 0,a)),s=>A(U("Return",s),B)),at(B)(ct("CatCons",()=>{if(dr(i=>i.tag!=="Empty",r))return A(U("Return",void 0),B);let s=Qu(2e3);return A(s._1,at(s._2)(ct("CatCons",()=>{let i=Gu(ya(da(o)));return A(i._1,at(i._2)(ct("CatCons",d=>{if(d.tag==="Nothing")return A(U("Return",void 0),B);if(d.tag==="Just"){let c=Ca([E(d._1,cn)])(r),f={...a,grid:c,erdosTable:y,locked:!1,history:lr(a.history)({square:d._1,symbol:cn,erdos:ln(c)})};return A(U("Bind",st("State",p=>E(void 0,f)),p=>A(U("Return",p),B)),B)}l()},nt(R,R))))},nt(R,R))))},nt(R,R))))},nt(R,R))))}if(t.tag==="Reinit")return A(U("Bind",st("State",e=>E(void 0,e.locked?e:dn)),e=>A(U("Return",e),B)),B);l()};var Na=t=>e=>n=>r=>mt("viewBox",rt(t)+" "+rt(e)+" "+rt(n)+" "+rt(r));var _r=(t,e)=>({tag:t,_1:e});var Ea=_r("Reinit");var Yu=t=>{let e=t.erdosTable;return X("div",[Bt("relative shadow-md shadow-slate-200 m-4 select-none"),dt("width","300px"),dt("height","300px")],vt(n=>r=>{let o=(()=>{if(e.tag==="Just")return At(J,y,e._1,n);if(e.tag==="Nothing")return y;l()})(),a=(()=>{if(o.tag==="Nothing")return-1;if(o.tag==="Just")return o._1;l()})();return X("div",[Bt("absolute cursor-pointer flex items-center justify-center shadow text-4xl"),dt("height","20%"),dt("width","20%"),dt("left",rt(O(Ee(n)(5))*20)+"%"),dt("top",rt(O(er(n)(5))*20)+"%"),dt("background-color",a===-1?"white":"rgb(255,"+rt(255*a)+",0)"),en("click",s=>()=>x("Just",_r("Play",n)))],[(()=>{if(r.tag==="X")return X("span",[dt("color","blue")],[Ut("X")]);if(r.tag==="O")return X("span",[dt("color","red")],[Ut("O")]);if(r.tag==="Empty")return xo;l()})()])})(t.grid))},Ku=t=>X("div",[Bt("relative shadow-md shadow-slate-200 m-4 select-none"),dt("width","450px"),dt("height","300px")],[X("svg",[Na(-5)(-5)(325)(205)],[X("g",[],vt(e=>n=>X("rect",[mt("x",rt(10*O(e)-2)),mt("y",rt(198-300*n)),mt("width","4.0"),mt("height","4.0")],[]))(t)),X("g",[],vt(e=>n=>X("line",[mt("x1",rt(10*O(e))),mt("x2",rt(10*O(e+1|0))),mt("y1",rt(200-300*n._1)),mt("y2",rt(200-300*n._2)),mt("stroke-width","2.0"),mt("stroke","black")],[]))(ha(t)))])]),Vu=t=>e=>X("div",[Bt("rounded overflow-hidden shadow-lg p-4")],fe([X("div",[Bt("font-bold text-xl mb-2")],[Ut(t)])])(e)),Xu="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200",Ia=t=>X("div",[dt("height","400px"),dt("width","850px")],[Vu("Tic-Tac-Toe")([X("div",[Bt("flex flex-row")],[X("div",[],[Yu(t),X("button",[Bt(Xu),en("click",e=>()=>x("Just",Ea))],[Ut("Recommencer")])]),X("div",[],[Ku(wt(e=>e.erdos)(t.history))])])])]);var xa=()=>{let e={value:{newSeed:or(),size:0}};return Uo({init:{model:dn,msg:y},view:Ia,update:(()=>{let n=Ro(r=>r({genState:e}));return r=>n(Ma(r))})(),selector:"#root"})()};xa();})();
