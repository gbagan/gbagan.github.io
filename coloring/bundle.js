(()=>{function s(){throw new Error("Failed pattern match")}var Zt=function(t){return function(e){return e[t]}},Te=function(t){return function(e){return function(n){var r={};for(var a in n)({}).hasOwnProperty.call(n,a)&&(r[a]=n[a]);return r[t]=e,r}}};var hd=()=>({tag:"Proxy"}),Q=hd();var Vt=function(t){return t.toString()},gt=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var Hr=t=>t,lt=Hr("LT"),pt=Hr("GT"),St=Hr("EQ");var f=(t,e)=>({tag:t,_1:e}),$=f("Nothing"),F=t=>f("Just",t);var se={map:t=>e=>e.tag==="Just"?f("Just",t(e._1)):$};var Me=t=>{let e=t.Eq0(),n={eq:r=>a=>r.tag==="Nothing"?a.tag==="Nothing":r.tag==="Just"&&a.tag==="Just"&&e.eq(r._1)(a._1)};return{compare:r=>a=>{if(r.tag==="Nothing")return a.tag==="Nothing"?St:lt;if(a.tag==="Nothing")return pt;if(r.tag==="Just"&&a.tag==="Just")return t.compare(r._1)(a._1);s()},Eq0:()=>n}};var Ze={apply:t=>e=>{if(t.tag==="Just")return e.tag==="Just"?f("Just",t._1(e._1)):$;if(t.tag==="Nothing")return $;s()},Functor0:()=>se};var jr=t=>e=>t(e);var Vr={compose:t=>e=>n=>t(e(n))};var q=function(t){return function(e){for(var n=e.length,r=new Array(n),a=0;a<n;a++)r[a]=t(e[a]);return r}};var tn={map:q};var Qr=t=>t;var Kr=function(t){return function(e){for(var n=[],r=0,a=t.length;r<a;r++)Array.prototype.push.apply(n,e(t[r]));return n}};var _=(t,e)=>({tag:t,_1:e}),Ce=t=>_("Left",t),bt=t=>_("Right",t);var en={map:t=>e=>{if(e.tag==="Left")return _("Left",e._1);if(e.tag==="Right")return _("Right",t(e._1));s()}};var Ed={apply:t=>e=>{if(t.tag==="Left")return _("Left",t._1);if(t.tag==="Right"){if(e.tag==="Left")return _("Left",e._1);if(e.tag==="Right")return _("Right",t._1(e._1))}s()},Functor0:()=>en};var Xr={pure:bt,Apply0:()=>Ed};var eo=function(t){return function(){return t}};var Cd={apply:t=>e=>()=>{let n=t(),r=e();return Zr.pure(n(r))()},Functor0:()=>Ld},Zr={pure:eo,Apply0:()=>Cd},Ld={map:t=>e=>()=>{let n=e();return t(n)}};var zt=(t,e)=>({tag:t,_1:e}),na=t=>zt("Loop",t),no=t=>zt("Done",t);var ro=function(t){return function(e){return function(){return t(e())}}},ao=function(t){return function(){return t}};var Id={map:ro};var Ad={apply:t=>e=>()=>{let n=t(),r=e();return vn.pure(n(r))()},Functor0:()=>Id},vn={pure:ao,Apply0:()=>Ad};var oo=function(t){return function(e){return function(n){return function(r){return function(){return n>=0&&n<r.length?t(r[n]):e}}}}},we=function(t){return function(e){return function(n){return function(){var r=t>=0&&t<n.length;return r&&(n[t]=e),r}}}};var io=function(t){return function(e){return function(){return e.push.apply(e,t)}}};var nn=function(t){return function(){return t}};function Fd(t){return function(){return t.slice()}}var rn=Fd,Rd=function(){function t(e,n,r,a,o,i){var d,m,u,p,l,c,D;for(d=o+(i-o>>1),d-o>1&&t(e,n,a,r,o,d),i-d>1&&t(e,n,a,r,d,i),m=o,u=d,p=o;m<d&&u<i;)l=a[m],c=a[u],D=n(e(l)(c)),D>0?(r[p++]=c,++u):(r[p++]=l,++m);for(;m<d;)r[p++]=a[m++];for(;u<i;)r[p++]=a[u++]}return function(e){return function(n){return function(r){return function(){return r.length<2||t(e,n,r,r.slice(0),0,r.length),r}}}}}();var so=t=>io([t]);var uo=t=>e=>n=>{let r=oo(F)($)(t)(n);return()=>{let a=r();if(a.tag==="Just")return we(t)(e(a._1))(n)();if(a.tag==="Nothing")return!1;s()}};var de=function(t){return function(e){return function(n){for(var r=e,a=n.length,o=a-1;o>=0;o--)r=t(n[o])(r);return r}}},te=function(t){return function(e){return function(n){for(var r=e,a=n.length,o=0;o<a;o++)r=t(r)(n[o]);return r}}};var zn=t=>{let e=t.Apply0();return n=>r=>n.foldr(a=>{let o=r(a);return i=>e.apply(e.Functor0().map(d=>Qr)(o))(i)})(t.pure())},On=t=>{let e=zn(t);return n=>{let r=e(n);return a=>o=>r(o)(a)}};var We=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return f("Just",r);if(n.tag==="Just")return f("Just",e(n._1)(r)==="GT"?n._1:r);s()})($);var lo=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return f("Just",r);if(n.tag==="Just")return f("Just",e(n._1)(r)==="LT"?n._1:r);s()})($);var an={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);s()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);s()},foldMap:t=>{let e=t.mempty;return n=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return n(r._1);s()}}};var ht={foldr:de,foldl:te,foldMap:t=>{let e=t.mempty;return n=>ht.foldr(r=>a=>t.Semigroup0().append(n(r))(a))(e)}};var x=(t,e)=>({tag:"Tuple",_1:t,_2:e}),At=t=>e=>x(t,e);var Le=t=>t._2;var Un={map:t=>e=>x(e._1,t(e._2))};var xe=t=>t._1;var on=t=>{let e=t.Eq0();return n=>{let r=n.Eq0(),a={eq:o=>i=>e.eq(o._1)(i._1)&&r.eq(o._2)(i._2)};return{compare:o=>i=>{let d=t.compare(o._1)(i._1);return d==="LT"?lt:d==="GT"?pt:n.compare(o._2)(i._2)},Eq0:()=>a}}};var st=function(t){return function(e){for(var n=e.length,r=Array(n),a=0;a<n;a++)r[a]=t(a)(e[a]);return r}};var yo={mapWithIndex:st,Functor0:()=>tn};var _o=function(t){return function(e){return t===e}};var Gn=_o,Do=_o;var sn=function(t){return function(e){return function(n){if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!t(e[r])(n[r]))return!1;return!0}}};var bo={eq:Do},qe={eq:Gn};var To=function(t){return function(e){return function(n){return function(r){return function(a){return r<a?t:r===a?e:n}}}}};var Mo=To,Eo=To;var kn={compare:Eo(lt)(St)(pt),Eq0:()=>bo},Y={compare:Mo(lt)(St)(pt),Eq0:()=>qe};var Ao=function(){function t(a){return[a]}function e(a){return function(o){return[a,o]}}function n(a){return function(o){return function(i){return[a,o,i]}}}function r(a){return function(o){return a.concat(o)}}return function(a){return function(o){return function(i){return function(d){return function(m){function u(p,l){switch(l-p){case 0:return i([]);case 1:return o(t)(d(m[p]));case 2:return a(o(e)(d(m[p])))(d(m[p+1]));case 3:return a(a(o(n)(d(m[p])))(d(m[p+1])))(d(m[p+2]));default:var c=p+Math.floor((l-p)/4)*2;return a(o(r)(u(p,c)))(u(c,l))}}return u(0,m.length)}}}}}}();var oa=t=>t;var dn={traverse:t=>{let e=t.Apply0();return Ao(e.apply)(e.Functor0().map)(t.pure)},sequence:t=>dn.traverse(t)(oa),Functor0:()=>tn,Foldable1:()=>ht};var Ft=function(t){return function(e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),a=t,o=0;a!==e;)r[o++]=a,a+=n;return r[o]=a,r}},gu=function(t){return function(e){if(t<1)return[];var n=new Array(t);return n.fill(e)}},hu=function(t){return function(e){for(var n=[],r=0,a=0;a<t;a++)n[r++]=e;return n}},un=typeof Array.prototype.fill=="function"?gu:hu,ia=function(){function t(a,o){this.head=a,this.tail=o}var e={};function n(a){return function(o){return new t(a,o)}}function r(a){for(var o=[],i=0,d=a;d!==e;)o[i++]=d.head,d=d.tail;return o}return function(a){return function(o){return r(a(n)(e)(o))}}}();var Fo=function(t){return function(e){return function(n){return function(r){return r<0||r>=n.length?e:t(n[r])}}}};var Ro=function(t){return function(e){return function(n){return function(r){for(var a=0,o=r.length;a<o;a++)if(n(r[a]))return t(a);return e}}}};var So=function(t){return function(e){return function(n){return function(r){if(n<0||n>=r.length)return e;var a=r.slice();return a.splice(n,1),t(a)}}}},Po=function(t){return function(e){return function(n){return function(r){return function(a){if(n<0||n>=a.length)return e;var o=a.slice();return o[n]=r,t(o)}}}}};var ve=function(t){return function(e){return e.filter(t)}};var Jo=function(){function t(e,n,r,a,o,i){var d,m,u,p,l,c,D;for(d=o+(i-o>>1),d-o>1&&t(e,n,a,r,o,d),i-d>1&&t(e,n,a,r,d,i),m=o,u=d,p=o;m<d&&u<i;)l=a[m],c=a[u],D=n(e(l)(c)),D>0?(r[p++]=c,++u):(r[p++]=l,++m);for(;m<d;)r[p++]=a[m++];for(;u<i;)r[p++]=a[u++]}return function(e){return function(n){return function(r){var a;return r.length<2?r:(a=r.slice(0),t(e,n,a,r.slice(0),0,r.length),a)}}}}(),me=function(t){return function(e){return function(n){return n.slice(t,e)}}},cn=function(t){return function(e){return function(n){for(var r=e.length<n.length?e.length:n.length,a=new Array(r),o=0;o<r;o++)a[o]=t(e[o])(n[o]);return a}}};var wo=zn(vn);var Wo=cn(At),Hn=t=>{let e=wo(t);return n=>r=>(()=>{let a=rn(r);return()=>{let o=a();return e(i=>we(i._1)(i._2)(o))(n)(),o}})()()},jn=Po(F)($);var Vn=t=>Jo(t)(e=>{if(e==="GT")return 1;if(e==="EQ")return 0;if(e==="LT")return-1;s()}),$n=t=>e=>Vn(n=>r=>t.compare(e(n))(e(r)));var ln=t=>e=>(()=>{let n=so(e),r=rn(t);return()=>{let a=r();return n(a)(),a}})()();var qo=t=>{let e=wo(t);return n=>r=>a=>(()=>{let o=rn(a);return()=>{let i=o();return e(d=>uo(d)(r)(i))(n)(),i}})()()};var ct=Fo(F)($);var vo=t=>e=>{let n=Vn(a=>o=>t(a._2)(o._2))(st(At)(e)),r=ct(n)(0);if(r.tag==="Nothing")return[];if(r.tag==="Just")return q(Le)($n(Y)(xe)((()=>{let a=nn([r._1]);return()=>{let o=a();for(let i of n){let d=t((()=>{let u=ct(o)(o.length-1|0);if(u.tag==="Just")return u._1._2;s()})())(i._2);(d==="LT"||d==="GT"||d!=="EQ")&&(()=>o.push(i))()}return o}})()()));s()};var yu=Ro(F)($);var ge=t=>e=>n=>{let r=yu(a=>t.eq(a)(e))(n);if(r.tag==="Nothing")return!1;if(r.tag==="Just")return!0;s()};var zo=So(F)($);var _u=t=>e=>Kr(e)(t),ze=t=>_u(e=>{let n=t(e);if(n.tag==="Nothing")return[];if(n.tag==="Just")return[n._1];s()});var Nf=String.fromCharCode(65535),If=String.fromCharCode(0),Af=Number.POSITIVE_INFINITY,Ff=Number.NEGATIVE_INFINITY;function Qn(t){return t.charCodeAt(0)}function pn(t){return String.fromCharCode(t)}var sa={identity:t=>t,Semigroupoid0:()=>Vr};var Kn={dimap:t=>e=>n=>r=>e(n(t(r)))};var xu=t=>t,$e=(()=>({first:t=>e=>x(t(e._1),e._2),second:Un.map,Profunctor0:()=>Kn}))();var da=t=>{let e=t.identity,n=t.Semigroupoid0(),r=t.Semigroupoid0();return a=>o=>i=>n.compose(r.compose(a.second(i))(a.first(o)))(a.Profunctor0().dimap(xu)(d=>x(d,d))(e))};var Nu=da(sa)($e);var Zn=t=>e=>n=>r=>{let a=Nu(t)(e);return o=>r.Profunctor0().dimap(a)(i=>{if(i._2.tag==="Left")return i._2._1;if(i._2.tag==="Right")return i._1(i._2._1);s()})(n.second(r.right(o)))};var tr=t=>()=>()=>e=>n=>r=>n.Profunctor0().dimap(a=>x(Zt(t.reflectSymbol(e))(a),o=>Te(t.reflectSymbol(e))(o)(a)))(a=>a._2(a._1))(n.first(r));var jo=function(t){return t.join("")},Vo=function(t){return t.split("")},er=function(t){return t};var Qo=t=>e=>{let n=[],r=0,a=new Array(t.length);for(a.fill(!1);n.length<t.length;){let o=new Array(t.length);o.fill(!1);for(let i of e)if(!(a[i]||o[i])){n.push({vertex:i,color:r}),a[i]=!0;for(let d of t[i])o[d]=!0}r++}return n};var Ko=t=>t.length===0?[]:Qo(t)($n(Me(Y))(e=>{let n=ct(t)(e);return n.tag==="Just"?f("Just",-n._1.length):$})((()=>{let e=t.length-1|0;return 0>e?[]:Ft(0)(e)})())),Su=t=>e=>n=>{let r=q(o=>{let i=ct(e)(o);if(i.tag==="Nothing")return-1;if(i.tag==="Just")return i._1;s()})((()=>{let o=ct(t)(n);if(o.tag==="Nothing")return[];if(o.tag==="Just")return o._1;s()})());return(o=>{let i=o,d=!0,m;for(;d;){let u=i;if(ge(qe)(u)(r)){i=u+1|0;continue}d=!1,m=u}return m})(0)},Pu=t=>e=>{let n=We(ht)((()=>{let r=on(Y)(Y);return a=>o=>r.compare(x(a.saturation,a.degree))(x(o.saturation,o.degree))})())(ze(r=>r)(st(r=>a=>a._2===-1?f("Just",{vertex:r,saturation:vo(Y.compare)(ve(o=>o!==-1)(q(o=>{let i=ct(e)(o);if(i.tag==="Nothing")return-1;if(i.tag==="Just")return i._1;s()})(a._1))).length,degree:a._1.length}):$)(Wo(t)(e))));return n.tag==="Just"?f("Just",n._1.vertex):$},Yo=t=>e=>n=>()=>{let r=Su(t)(e)(n);return we(n)(r)(e)(),r},nr=t=>e=>{let n=nn(un(e.length)(-1)),r=(()=>{let a=n();for(let o of e)Yo(t)(a)(o)();return a})();return q(a=>({vertex:a,color:(()=>{let o=ct(r)(a);if(o.tag==="Nothing")return 0;if(o.tag==="Just")return o._1;s()})()}))(e)},Xo=t=>t.length===0?[]:nr(t)($n(Me(Y))(e=>{let n=ct(t)(e);return n.tag==="Just"?f("Just",-n._1.length):$})((()=>{let e=t.length-1|0;return 0>e?[]:Ft(0)(e)})())),Zo=t=>{let n=nn(un(t.length)(-1))(),r=[];for(let a of t){let o=Pu(t)(n);if(o.tag!=="Nothing"){if(o.tag==="Just"){let i=Yo(t)(n)(o._1)();r.push({vertex:o._1,color:i});continue}s()}}return r},ti=t=>t.length===0?[]:nr(t)((()=>{let e=t.length-1|0;return 0>e?[]:Ft(0)(e)})());var ca={foldrWithIndex:t=>e=>{let n=de(a=>{let o=a._1,i=a._2;return d=>t(o)(i)(d)})(e),r=st(At);return a=>n(r(a))},foldlWithIndex:t=>e=>{let n=te(a=>o=>t(o._1)(a)(o._2))(e),r=st(At);return a=>n(r(a))},foldMapWithIndex:t=>{let e=t.mempty;return n=>ca.foldrWithIndex(r=>a=>o=>t.Semigroup0().append(n(r)(a))(o))(e)},Foldable0:()=>ht};var rr={};function mn(t,e,n,r){return n in r?e(r[n]):t}function ni(t){return function(e){var n=[];for(var r in e)hasOwnProperty.call(e,r)&&n.push(t(r)(e[r]));return n}}var Sm=Object.keys||ni(function(t){return function(){return t}});var la=t=>e=>{let n={...e};return t(n)(),n};function ft(t){return t}function or(t){return JSON.stringify(t)}function he(t,e,n,r,a,o,i){return i==null?t():typeof i=="boolean"?e(i):typeof i=="number"?n(i):typeof i=="string"?r(i):Object.prototype.toString.call(i)==="[object Array]"?a(i):o(i)}var dt=(t,e,n)=>({tag:t,_1:e,_2:n});var ri=t=>e=>dt("AtIndex",t,e),pa=t=>e=>dt("AtKey",t,e),ai=t=>e=>dt("Named",t,e),fa=dt("MissingValue");var ga=isFinite;var oi=Math.cos;var Ue=Math.floor;var ir=Math.sin,gn=Math.sqrt;var ii=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},Jt=function(t){return t};var ha=ii(F)($),ya=t=>{if(!ga(t))return 0;if(t>=Jt(2147483647))return 2147483647;if(t<=Jt(-2147483648))return-2147483648;let e=ha(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;s()};var $t=(t,e,n)=>({tag:t,_1:e,_2:n});var xt=$t("Nil");var ci=(()=>(e=>n=>{let r=e,a=n,o=!0,i;for(;o;){let d=r,m=a;if(m.tag==="Nil"){o=!1,i=d;continue}if(m.tag==="Cons"){r=$t("Cons",m._1,d),a=m._2;continue}s()}return i})(xt))();var _n=function(t){throw new Error(t)};var cr=(t,e,n,r)=>({tag:"KickUp",_1:t,_2:e,_3:n,_4:r}),yt=(t,e,n,r,a,o,i,d)=>({tag:t,_1:e,_2:n,_3:r,_4:a,_5:o,_6:i,_7:d}),Dn=(t,e,n,r,a,o,i)=>({tag:t,_1:e,_2:n,_3:r,_4:a,_5:o,_6:i});var ke=yt("Leaf");var $r=t=>e=>r=>{let a=r,o=!0,i;for(;o;){let d=a;if(d.tag==="Leaf"){o=!1,i=$;continue}if(d.tag==="Two"){let m=t.compare(e)(d._2);if(m==="EQ"){o=!1,i=f("Just",d._3);continue}if(m==="LT"){a=d._1;continue}a=d._4;continue}if(d.tag==="Three"){let m=t.compare(e)(d._2);if(m==="EQ"){o=!1,i=f("Just",d._3);continue}let u=t.compare(e)(d._5);if(u==="EQ"){o=!1,i=f("Just",d._6);continue}if(m==="LT"){a=d._1;continue}if(u==="GT"){a=d._7;continue}a=d._4;continue}s()}return i};var bn=t=>e=>n=>{let r=t,a=e,o=n,i=!0,d;for(;i;){let m=r,u=a,p=o;if(u.tag==="Nil"){i=!1,d=p;continue}if(u.tag==="Cons"){if(u._1.tag==="TwoLeft"){r=m,a=u._2,o=yt("Two",p,u._1._1,u._1._2,u._1._3);continue}if(u._1.tag==="TwoRight"){r=m,a=u._2,o=yt("Two",u._1._1,u._1._2,u._1._3,p);continue}if(u._1.tag==="ThreeLeft"){r=m,a=u._2,o=yt("Three",p,u._1._1,u._1._2,u._1._3,u._1._4,u._1._5,u._1._6);continue}if(u._1.tag==="ThreeMiddle"){r=m,a=u._2,o=yt("Three",u._1._1,u._1._2,u._1._3,p,u._1._4,u._1._5,u._1._6);continue}if(u._1.tag==="ThreeRight"){r=m,a=u._2,o=yt("Three",u._1._1,u._1._2,u._1._3,u._1._4,u._1._5,u._1._6,p);continue}}s()}return d},lr=t=>e=>n=>{let r=o=>i=>{let d=o,m=i,u=!0,p;for(;u;){let l=d,c=m;if(l.tag==="Nil"){u=!1,p=yt("Two",c._1,c._2,c._3,c._4);continue}if(l.tag==="Cons"){if(l._1.tag==="TwoLeft"){u=!1,p=bn(t)(l._2)(yt("Three",c._1,c._2,c._3,c._4,l._1._1,l._1._2,l._1._3));continue}if(l._1.tag==="TwoRight"){u=!1,p=bn(t)(l._2)(yt("Three",l._1._1,l._1._2,l._1._3,c._1,c._2,c._3,c._4));continue}if(l._1.tag==="ThreeLeft"){d=l._2,m=cr(yt("Two",c._1,c._2,c._3,c._4),l._1._1,l._1._2,yt("Two",l._1._3,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeMiddle"){d=l._2,m=cr(yt("Two",l._1._1,l._1._2,l._1._3,c._1),c._2,c._3,yt("Two",c._4,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeRight"){d=l._2,m=cr(yt("Two",l._1._1,l._1._2,l._1._3,l._1._4),l._1._5,l._1._6,yt("Two",c._1,c._2,c._3,c._4));continue}}s()}return p};return(o=>i=>{let d=o,m=i,u=!0,p;for(;u;){let l=d,c=m;if(c.tag==="Leaf"){u=!1,p=r(l)(cr(ke,e,n,ke));continue}if(c.tag==="Two"){let D=t.compare(e)(c._2);if(D==="EQ"){u=!1,p=bn(t)(l)(yt("Two",c._1,e,n,c._4));continue}if(D==="LT"){d=$t("Cons",Dn("TwoLeft",c._2,c._3,c._4),l),m=c._1;continue}d=$t("Cons",Dn("TwoRight",c._1,c._2,c._3),l),m=c._4;continue}if(c.tag==="Three"){let D=t.compare(e)(c._2);if(D==="EQ"){u=!1,p=bn(t)(l)(yt("Three",c._1,e,n,c._4,c._5,c._6,c._7));continue}let k=t.compare(e)(c._5);if(k==="EQ"){u=!1,p=bn(t)(l)(yt("Three",c._1,c._2,c._3,c._4,e,n,c._7));continue}if(D==="LT"){d=$t("Cons",Dn("ThreeLeft",c._2,c._3,c._4,c._5,c._6,c._7),l),m=c._1;continue}if(D==="GT"&&k==="LT"){d=$t("Cons",Dn("ThreeMiddle",c._1,c._2,c._3,c._5,c._6,c._7),l),m=c._4;continue}d=$t("Cons",Dn("ThreeRight",c._1,c._2,c._3,c._4,c._5,c._6),l),m=c._7;continue}s()}return p})(xt)};var pr=function(t){return function(e){return t+e}};var ay=typeof Array.from=="function",oy=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",iy=typeof String.prototype.fromCodePoint=="function",sy=typeof String.prototype.codePointAt=="function";var fr={traverseWithIndex:t=>{let e=fr.Traversable2().sequence(t);return n=>{let r=fr.FunctorWithIndex0().mapWithIndex(n);return a=>e(r(a))}},FunctorWithIndex0:()=>yo,FoldableWithIndex1:()=>ca,Traversable2:()=>dn};var cc=(()=>fr.traverseWithIndex(Xr))();var $c=t=>{let e=he(n=>$,n=>$,n=>$,n=>$,F,n=>$,t);if(e.tag==="Nothing")return _("Left",dt("TypeMismatch","Array"));if(e.tag==="Just")return _("Right",e._1);s()};var mr=t=>{let e=he(n=>_("Left",dt("TypeMismatch","Number")),n=>_("Left",dt("TypeMismatch","Number")),bt,n=>_("Left",dt("TypeMismatch","Number")),n=>_("Left",dt("TypeMismatch","Number")),n=>_("Left",dt("TypeMismatch","Number")),t);if(e.tag==="Left")return _("Left",e._1);if(e.tag==="Right"){let n=ha(e._1);if(n.tag==="Nothing")return _("Left",dt("TypeMismatch","Integer"));if(n.tag==="Just")return _("Right",n._1)}s()};var Be=t=>{let e=ai("Array"),n=cc(r=>{let a=ri(r);return o=>{let i=t(o);if(i.tag==="Left")return _("Left",a(i._1));if(i.tag==="Right")return _("Right",i._1);s()}});return r=>{let a=$c(r);if(a.tag==="Left")return _("Left",a._1);if(a.tag==="Right"){let o=n(a._1);if(o.tag==="Left")return _("Left",e(o._1));if(o.tag==="Right")return _("Right",o._1)}s()}},Ta=t=>e=>n=>{let r=Be(bt)(n);return(()=>{if(r.tag==="Left"){let a=r._1;return o=>_("Left",a)}if(r.tag==="Right"){let a=r._1;return o=>o(a)}s()})()(a=>{if(a.length===2){let o=t(a[0]);if(o.tag==="Left")return _("Left",o._1);if(o.tag==="Right"){let i=e(a[1]);if(i.tag==="Left")return _("Left",i._1);if(i.tag==="Right")return _("Right",x(o._1,i._1))}s()}return _("Left",dt("TypeMismatch","Tuple"))})};function _t(t,e,n){return t==null?e:n(t)}function gr(t,e,n,r){if(typeof window<"u"){var a=window[n];if(a!=null&&r instanceof a)return e(r)}for(var o=r;o!=null;){var i=Object.getPrototypeOf(o),d=i.constructor.name;if(d===n)return e(r);if(d==="Object")return t;o=i}return t}var hr=function(t){return function(e){return e[t]}},lc=hr("namespaceURI"),pc=hr("prefix"),L_=hr("localName"),x_=hr("tagName");function yi(t){return function(){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}}function Ie(t){return t.currentTarget}function _i(t){return t.type}function Ea(t){return function(){return t.stopPropagation()}}var He=function(){return window};function Ca(t){return function(){return t.document}}function La(t){return function(){return t.localStorage}}function Ti(t){return function(e){return function(){return e.getItem(t)}}}function Mi(t){return function(e){return function(n){return function(){n.setItem(t,e)}}}}var Ei=t=>{let e=Ti(t);return n=>{let r=e(n);return()=>{let a=r();return _t(a,$,F)}}};function Ci(t){return t.clientX}function Li(t){return t.clientY}var xi=t=>e=>n=>t.MonadEffect0().liftEffect((()=>{let r=Mi(e)(n);return()=>{let a=He(),o=La(a)();return r(o)()}})()),Ni=t=>e=>t.MonadEffect0().liftEffect((()=>{let n=Ei(e);return()=>{let r=He(),a=La(r)();return n(a)()}})()),En=t=>e=>t===0?[]:q(e)((()=>{let n=t-1|0;return 0>n?[]:Ft(0)(n)})()),Cn=t=>{let e=100*ir(Jt(t+1|0));return e-Ue(e)},xa=t=>{let e=_t(Ie(t),$,F),n=(()=>{if(e.tag==="Just")return gr($,F,"Element",e._1);if(e.tag==="Nothing")return $;s()})();if(n.tag==="Just"){let r=yi(n._1);return()=>{let a=r();return f("Just",{x:(Jt(Ci(t))-a.left)/a.width,y:(Jt(Li(t))-a.top)/a.height})}}return()=>$};var g=(t,e)=>({tag:"Edge",_1:t,_2:e}),Ii=qo(ht),yc=Hn(ht);var Aa={eq:t=>e=>t._1===e._1&&t._2===e._2||t._1===e._2&&e._1===t._2},Ai={encodeJson:t=>[Jt(t._1),Jt(t._2)]},Fi={decodeJson:t=>{let e=Ta(mr)(mr)(t);return(()=>{if(e.tag==="Left"){let n=e._1;return r=>_("Left",n)}if(e.tag==="Right"){let n=e._1;return r=>r(n)}s()})()(n=>_("Right",g(n._1,n._2)))}},Ri=t=>de(e=>{let n=e._1,r=e._2,a=Ii([n])(i=>ln(i)(r)),o=Ii([r])(i=>ln(i)(n));return i=>a(o(i))})(q(e=>[])(t.layout))(t.edges),Fa=t=>e=>({...e,layout:(()=>{let n=zo(t)(e.layout);if(n.tag==="Nothing")return e.layout;if(n.tag==="Just")return n._1;s()})(),edges:ze(n=>n._1===t||n._2===t?$:f("Just",g(n._1>t?n._1-1|0:n._1,n._2>t?n._2-1|0:n._2)))(e.edges)}),Si=t=>e=>n=>({...n,edges:ve(r=>!(r._1===t&&r._2===e||r._1===e&&t===r._2))(n.edges)}),Pi=t=>e=>n=>({...n,layout:yc([x(t,e)])(n.layout)});var _c={layout:[{y:.4514285714285714,x:.03907143729073661},{y:.3385714285714286,x:.14478572300502232},{y:.45285714285714285,x:.2247857230050223},{y:.5657142857142857,x:.11621429443359375},{y:.25,x:.3376428658621652},{y:.06285714285714286,x:.4633571515764509},{y:.4828571428571429,x:.9533571515764508},{y:.9471428571428572,x:.4233571515764509},{y:.6885714285714286,x:.330500008719308},{y:.4742857142857143,x:.6733571515764509}],edges:[g(3,0),g(2,3),g(1,2),g(0,1),g(4,2),g(5,4),g(9,5),g(6,5),g(6,9),g(7,6),g(7,9),g(7,8),g(8,2),g(4,8),g(9,8),g(4,9)]},Dc={layout:[{y:.06714285714285714,x:.25050000871930805},{y:.17142857142857143,x:.09192858014787947},{y:.26571428571428574,x:.33621429443359374},{y:.05,x:.4490714372907366},{y:.15428571428571428,x:.5547857230050223},{y:.26571428571428574,x:.5747857230050223},{y:.45,x:.5762142944335937},{y:.4685714285714286,x:.32621429443359373},{y:.5714285714285714,x:.5733571515764508},{y:.7228571428571429,x:.5619285801478795},{y:.6614285714285715,x:.33192858014787946},{y:.8214285714285714,x:.3376428658621652},{y:.9342857142857143,x:.6662142944335937},{y:.9528571428571428,x:.09192858014787947},{y:.6385714285714286,x:.07764286586216518}],edges:[g(2,1),g(0,2),g(1,0),g(3,2),g(4,3),g(2,4),g(5,2),g(6,5),g(7,6),g(2,7),g(8,7),g(9,8),g(10,9),g(7,10),g(8,10),g(9,7),g(11,10),g(12,11),g(13,12),g(14,13),g(7,14)]},bc={layout:[{y:.41285714285714287,x:.3447857230050223},{y:.5842857142857143,x:.2333571515764509},{y:.5814285714285714,x:.049071437290736604},{y:.3628571428571429,x:.05192858014787947},{y:.5385714285714286,x:.8076428658621652},{y:.5985714285714285,x:.660500008719308},{y:.40714285714285714,x:.5247857230050224},{y:.5928571428571429,x:.5433571515764509},{y:.9285714285714286,x:.5347857230050224},{y:.4642857142857143,x:.9590714372907366},{y:.9014285714285715,x:.22050000871930803},{y:.11571428571428571,x:.6762142944335937}],edges:[g(1,0),g(6,0),g(7,6),g(9,11),g(5,11),g(11,0),g(3,11),g(9,6),g(8,9),g(4,5),g(9,4),g(1,7),g(10,1),g(8,10),g(7,8),g(10,6),g(2,3),g(10,2),g(8,5)]},Tc={layout:[{y:.08142857142857143,x:.18050000871930805},{y:.23285714285714285,x:.07621429443359375},{y:.23714285714285716,x:.2876428658621652},{y:.4757142857142857,x:.2676428658621652},{y:.6242857142857143,x:.08621429443359375},{y:.79,x:.08478572300502232},{y:.9514285714285714,x:.28192858014787947},{y:.9557142857142857,x:.680500008719308},{y:.5057142857142857,x:.9276428658621652},{y:.6942857142857143,x:.5047857230050223},{y:.7,x:.2776428658621652},{y:.4928571428571429,x:.49764286586216516},{y:.20285714285714285,x:.5019285801478794},{y:.7071428571428572,x:.6833571515764509}],edges:[g(1,0),g(2,1),g(3,2),g(4,3),g(5,4),g(6,5),g(7,6),g(8,7),g(9,8),g(10,9),g(11,10),g(3,11),g(12,11),g(12,0),g(13,9),g(7,13),g(10,5)]};var Ji=t=>e=>{let n=ct(t.layout)(e._1);if(n.tag==="Just"){let r=ct(t.layout)(e._2);if(r.tag==="Just")return f("Just",{x1:n._1.x,x2:r._1.x,y1:n._1.y,y2:r._1.y});if(r.tag==="Nothing")return $;s()}if(n.tag==="Nothing")return $;s()},Ia={layout:[],edges:[]},Mc={layout:En(100)(t=>({x:Cn(t*2|0),y:Cn((t*2|0)+1|0)})),edges:ve(t=>t._1!==t._2)(En(1e3)(t=>g(ya(Ue(100*Cn(t*2|0))),ya(Ue(100*Cn((t*2|0)+1|0))))))},wi=[Tc,bc,Dc,_c,Mc,Ia,Ia,Ia],Wi=t=>e=>({...e,layout:ln(e.layout)(t)}),qi=t=>e=>n=>({...n,edges:t===e||ge(Aa)(g(t,e))(n.edges)?n.edges:ln(n.edges)(g(t,e))});var Ae=(t,e)=>({tag:t,_1:e}),Ln=(t,e)=>({tag:t,_1:e}),Dr=t=>t,Ec=Hn(ht),Cc=sn(Gn);var Lc=tr({reflectSymbol:()=>"graphs"})()(),xn=Dr("MoveMode"),vi=Dr("VertexMode"),br=Dr("AddEMode"),zi=Dr("DeleteMode"),je=Ln("NoDialog");var Tr=Ae("Alphabetical"),Oi=Ae("DecreasingDegree"),Ui=Ae("IndependentSet"),Gi=Ae("DSatur");var ki={eq:t=>e=>t==="MoveMode"?e==="MoveMode":t==="VertexMode"?e==="VertexMode":t==="AddEMode"?e==="AddEMode":t==="DeleteMode"&&e==="DeleteMode"},Bi=t=>f("Just",q(e=>Qn(e)-65|0)(Vo(t))),Kt=t=>{let e=ct(t.graphs)(t.selectedGraphIdx);if(e.tag==="Nothing")return{layout:[],edges:[]};if(e.tag==="Just")return e._1;s()},Hi=t=>{let e=ct(t.results)(t.selectedResultIndex);if(e.tag==="Just"){let n=q(r=>r.vertex)(e._1.coloring);return t.currentStep<1?[]:me(0)(t.currentStep)(n)}if(e.tag==="Nothing")return[];s()},ji=t=>{let e=un(Kt(t).layout.length)(-1),n=ct(t.results)(t.selectedResultIndex);if(n.tag==="Just")return Ec(q(r=>x(r.vertex,r.color))(t.currentStep<1?[]:me(0)(t.currentStep)(n._1.coloring)))(e);if(n.tag==="Nothing")return e;s()},Mr=(()=>{let t=q(e=>{let n=e+65|0;return n>=0&&n<=65535?f("Just",pn(n)):$});return e=>jo(ze(n=>n)(t(e)))})();var Vi=t=>er((()=>{let e=t+65|0;return e>=0&&e<=65535?pn(e):"A"})()),xc=t=>e=>e.length===0?!0:Cc(Vn(Y.compare)(e))((()=>{let n=t-1|0;return 0>n?[]:Ft(0)(n)})()),Qi=t=>e=>{let n=Ri(t);if(e.tag==="Alphabetical")return f("Just",ti(n));if(e.tag==="DecreasingDegree")return f("Just",Xo(n));if(e.tag==="DSatur")return f("Just",Zo(n));if(e.tag==="IndependentSet")return f("Just",Ko(n));if(e.tag==="CustomAlgorithm")return xc(n.length)(e._1)?f("Just",nr(n)(e._1)):$;s()},Ki={selectedAlgorithm:Tr,results:[],currentStep:0,selectedResultIndex:0,graphs:wi,selectedGraphIdx:0,editmode:xn,selectedVertex:$,currentPosition:$,dialog:je},Yi=t=>{if(t.tag==="Alphabetical")return"Alphab\xE9tique";if(t.tag==="DecreasingDegree")return"Degr\xE9 d\xE9croissant";if(t.tag==="IndependentSet")return"Stables";if(t.tag==="DSatur")return"DSatur";if(t.tag==="CustomAlgorithm")return Mr(t._1);s()},Xi=t=>e=>Zn(n=>r=>({...n,graphs:(()=>{let a=jn(n.selectedGraphIdx)(r)(n.graphs);if(a.tag==="Nothing")return n.graphs;if(a.tag==="Just")return a._1;s()})()}))(n=>{let r=ct(n.graphs)(n.selectedGraphIdx);if(r.tag==="Nothing")return _("Left",n);if(r.tag==="Just")return _("Right",r._1);s()})(t)(e);var Zi=t=>Lc(Q)(t);var B=(t,e,n)=>({tag:t,_1:e,_2:n});var ts=t=>e=>B("SelectVertex",t,e);var es=t=>e=>B("DeleteVertex",t,e);var Ra=B("DropOrLeave");var ns=B("ClearGraph"),rs=B("AdjustGraph"),as=t=>B("SetGraph",t),os=t=>B("SetAlgo",t),is=t=>B("CustomAlgoTextChange",t);var ss=B("Save"),ds=B("Load"),us=B("OpenImportDialog"),cs=B("Export"),$s=t=>B("ChangeImportText",t),ls=B("ImportAndClose"),Sa=B("CloseDialog"),ps=B("Compute"),fs=B("PreviousStep"),ms=B("NextStep"),gs=B("FinishColoring");var ne=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var hs=t=>{let e=t,n=!0,r;for(;n;){let a=e;if(a._1.tag==="Nil"){if(a._2.tag==="Nil"){n=!1,r=$;continue}e=ne(ci(a._2),xt);continue}if(a._1.tag==="Cons"){n=!1,r=f("Just",x(a._1._1,ne(a._1._2,a._2)));continue}s()}return r};var _e=(t,e,n)=>({tag:t,_1:e,_2:n}),at=_e("CatNil");var Ic=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return _e("CatCons",t._1,ne(t._2._1,$t("Cons",e,t._2._2)));s()},Ac=t=>e=>n=>{let r=o=>i=>d=>{let m=o,u=i,p=d,l=!0,c;for(;l;){let D=m,k=u,ot=p;if(ot.tag==="Nil"){l=!1,c=k;continue}if(ot.tag==="Cons"){m=D,u=D(k)(ot._1),p=ot._2;continue}s()}return c};return(o=>i=>{let d=o,m=i,u=!0,p;for(;u;){let l=d,c=m,D=hs(l);if(D.tag==="Nothing"){u=!1,p=r(k=>ot=>ot(k))(e)(c);continue}if(D.tag==="Just"){d=D._1._2,m=$t("Cons",t(D._1._1),c);continue}s()}return p})(n)(xt)},_s=t=>{if(t.tag==="CatNil")return $;if(t.tag==="CatCons")return f("Just",x(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?at:Ac(Ic)(at)(t._2)));s()};var wt=t=>e=>{if(t.tag==="CatNil")return _e("CatCons",e,ne(xt,xt));if(t.tag==="CatCons")return _e("CatCons",t._1,ne(t._2._1,$t("Cons",_e("CatCons",e,ne(xt,xt)),t._2._2)));s()};var O=(t,e)=>({tag:"Free",_1:t,_2:e}),ut=(t,e,n)=>({tag:t,_1:e,_2:n});var Fc=t=>{let e=t,n=!0,r;for(;n;){let a=e;if(a._1.tag==="Return"){let o=_s(a._2);if(o.tag==="Nothing"){n=!1,r=ut("Return",a._1._1);continue}if(o.tag==="Just"){e=(()=>{let i=o._1._1(a._1._1);return O(i._1,(()=>{if(i._2.tag==="CatNil")return o._1._2;if(o._1._2.tag==="CatNil")return i._2;if(i._2.tag==="CatCons")return _e("CatCons",i._2._1,ne(i._2._2._1,$t("Cons",o._1._2,i._2._2._2)));s()})())})();continue}s()}if(a._1.tag==="Bind"){n=!1,r=ut("Bind",a._1._1,o=>{let i=a._1._2(o);return O(i._1,(()=>{if(i._2.tag==="CatNil")return a._2;if(a._2.tag==="CatNil")return i._2;if(i._2.tag==="CatCons")return _e("CatCons",i._2._1,ne(i._2._2._1,$t("Cons",a._2,i._2._2._2)));s()})())});continue}s()}return r},Ds=t=>e=>{let n=e.Monad0(),r=n.Bind1().Apply0().Functor0();return a=>e.tailRecM(o=>{let i=Fc(o);if(i.tag==="Return")return r.map(no)(n.Applicative0().pure(i._1));if(i.tag==="Bind")return r.map(na)(a(t.map(i._2)(i._1)));s()})};var bs={Applicative0:()=>Cr,Bind1:()=>wa},Ts={map:t=>e=>wa.bind(e)(n=>Cr.pure(t(n)))},wa={bind:t=>e=>O(t._1,wt(t._2)(e)),Apply0:()=>Wa},Wa={apply:t=>e=>O(t._1,wt(t._2)(n=>O(e._1,wt(e._2)(r=>Cr.pure(n(r)))))),Functor0:()=>Ts},Cr={pure:t=>O(ut("Return",t),at),Apply0:()=>Wa};var va={gDecodeJson:t=>e=>_("Right",{})};var za=t=>()=>({decodeJson:e=>{let n=he(r=>$,r=>$,r=>$,r=>$,r=>$,F,e);if(n.tag==="Just")return t.gDecodeJson(n._1)(Q);if(n.tag==="Nothing")return _("Left",dt("TypeMismatch","Object"));s()}});var Lr=t=>e=>n=>()=>()=>({gDecodeJson:r=>a=>{let o=n.reflectSymbol(Q),i=t.decodeJsonField(mn($,F,o,r));if(i.tag==="Just"){let d=pa(o);if(i._1.tag==="Left")return _("Left",d(i._1._1));if(i._1.tag==="Right"){let m=i._1._1,u=e.gDecodeJson(r)(Q);return(()=>{if(u.tag==="Left"){let p=u._1;return l=>_("Left",p)}if(u.tag==="Right"){let p=u._1;return l=>l(p)}s()})()(p=>_("Right",Te(n.reflectSymbol(Q))(m)(p)))}s()}if(i.tag==="Nothing")return _("Left",dt("AtKey",o,fa));s()}});var Oa={gEncodeJson:t=>e=>rr};var Ua={encodeJson:ft};var xr=t=>({encodeJson:(()=>{let e=q(t.encodeJson);return n=>e(n)})()});var Nn=t=>e=>n=>()=>({gEncodeJson:r=>a=>{let o=n.reflectSymbol(Q),i=t.encodeJson(Zt(n.reflectSymbol(Q))(r));return la(d=>()=>(d[o]=i,d))(e.gEncodeJson(r)(Q))}});function Nr(t,e,n){try{return e(JSON.parse(n))}catch(r){return t(r.message)}}var Ms={ix:t=>e=>n=>Zn(r=>a=>{let o=jn(t)(a)(r);if(o.tag==="Nothing")return r;if(o.tag==="Just")return o._1;s()})(r=>{let a=ct(r)(t);if(a.tag==="Nothing")return _("Left",r);if(a.tag==="Just")return _("Right",a._1);s()})(e)(n)};var Ga=(()=>({left:t=>e=>{if(e.tag==="Left")return _("Left",t(e._1));if(e.tag==="Right")return _("Right",e._1);s()},right:en.map,Profunctor0:()=>Kn}))();var Ut=function(){var t={},e="Pure",n="Throw",r="Catch",a="Sync",o="Async",i="Bind",d="Bracket",m="Fork",u="Sequential",p="Map",l="Apply",c="Alt",D="Cons",k="Resume",ot="Release",Nt="Finalizer",I="Finalized",V="Forked",Wt="Fiber",qt="Thunk";function b(M,v,et,U){this.tag=M,this._1=v,this._2=et,this._3=U}function mt(M){var v=function(et,U,C){return new b(M,et,U,C)};return v.tag=M,v}function ae(M){return new b(e,void 0)}function Or(M){try{M()}catch(v){setTimeout(function(){throw v},0)}}function Ke(M,v,et){try{return v(et())}catch(U){return M(U)}}function ld(M,v,et){try{return v(et)()}catch(U){return et(M(U))(),ae}}var Rn=function(){var M=1024,v=0,et=0,U=new Array(M),C=!1;function y(){var z;for(C=!0;v!==0;)v--,z=U[et],U[et]=void 0,et=(et+1)%M,z();C=!1}return{isDraining:function(){return C},enqueue:function(z){var R,Z;v===M&&(Z=C,y(),C=Z),U[(et+v)%M]=z,v++,C||y()}}}();function pd(M){var v={},et=0,U=0;return{register:function(C){var y=et++;C.onComplete({rethrow:!0,handler:function(z){return function(){U--,delete v[y]}}})(),v[y]=C,U++},isEmpty:function(){return U===0},killAll:function(C,y){return function(){if(U===0)return y();var z=0,R={};function Z(H){R[H]=v[H].kill(C,function(it){return function(){delete R[H],z--,M.isLeft(it)&&M.fromLeft(it)&&setTimeout(function(){throw M.fromLeft(it)},0),z===0&&y()}})()}for(var Dt in v)v.hasOwnProperty(Dt)&&(z++,Z(Dt));return v={},et=0,U=0,function(H){return new b(a,function(){for(var it in R)R.hasOwnProperty(it)&&R[it]()})}}}}}var Je=0,Rt=1,Sn=2,Pn=3,Jn=4,vt=5,Ye=6;function Ur(M,v,et){var U=0,C=Je,y=et,z=null,R=null,Z=null,Dt=null,H=null,it=0,be=0,kt=null,pe=!0;function fe(L){for(var N,w,W;;)switch(N=null,w=null,W=null,C){case Sn:C=Rt;try{y=Z(y),Dt===null?Z=null:(Z=Dt._1,Dt=Dt._2)}catch(Mt){C=vt,z=M.left(Mt),y=null}break;case Pn:M.isLeft(y)?(C=vt,z=y,y=null):Z===null?C=vt:(C=Sn,y=M.fromRight(y));break;case Rt:switch(y.tag){case i:Z&&(Dt=new b(D,Z,Dt)),Z=y._2,C=Rt,y=y._1;break;case e:Z===null?(C=vt,y=M.right(y._1)):(C=Sn,y=y._1);break;case a:C=Pn,y=Ke(M.left,M.right,y._1);break;case o:C=Jn,y=ld(M.left,y._1,function(Mt){return function(){U===L&&(U++,Rn.enqueue(function(){U===L+1&&(C=Pn,y=Mt,fe(U))}))}});return;case n:C=vt,z=M.left(y._1),y=null;break;case r:Z===null?H=new b(D,y,H,R):H=new b(D,y,new b(D,new b(k,Z,Dt),H,R),R),Z=null,Dt=null,C=Rt,y=y._1;break;case d:it++,Z===null?H=new b(D,y,H,R):H=new b(D,y,new b(D,new b(k,Z,Dt),H,R),R),Z=null,Dt=null,C=Rt,y=y._1;break;case m:C=Pn,N=Ur(M,v,y._2),v&&v.register(N),y._1&&N.run(),y=M.right(N);break;case u:C=Rt,y=md(M,v,y._1);break}break;case vt:if(Z=null,Dt=null,H===null)C=Ye,y=R||z||y;else switch(N=H._3,W=H._1,H=H._2,W.tag){case r:R&&R!==N&&it===0?C=vt:z&&(C=Rt,y=W._2(M.fromLeft(z)),z=null);break;case k:R&&R!==N&&it===0||z?C=vt:(Z=W._1,Dt=W._2,C=Sn,y=M.fromRight(y));break;case d:it--,z===null&&(w=M.fromRight(y),H=new b(D,new b(ot,W._2,w),H,N),(R===N||it>0)&&(C=Rt,y=W._3(w)));break;case ot:H=new b(D,new b(I,y,z),H,R),C=Rt,R&&R!==N&&it===0?y=W._1.killed(M.fromLeft(R))(W._2):z?y=W._1.failed(M.fromLeft(z))(W._2):y=W._1.completed(M.fromRight(y))(W._2),z=null,it++;break;case Nt:it++,H=new b(D,new b(I,y,z),H,R),C=Rt,y=W._1;break;case I:it--,C=vt,y=W._1,z=W._2;break}break;case Ye:for(var rt in kt)kt.hasOwnProperty(rt)&&(pe=pe&&kt[rt].rethrow,Or(kt[rt].handler(y)));kt=null,R&&z?setTimeout(function(){throw M.fromLeft(z)},0):M.isLeft(y)&&pe&&setTimeout(function(){if(pe)throw M.fromLeft(y)},0);return;case Je:C=Rt;break;case Jn:return}}function nt(L){return function(){if(C===Ye)return pe=pe&&L.rethrow,L.handler(y)(),function(){};var N=be++;return kt=kt||{},kt[N]=L,function(){kt!==null&&delete kt[N]}}}function A(L,N){return function(){if(C===Ye)return N(M.right(void 0))(),function(){};var w=nt({rethrow:!1,handler:function(){return N(M.right(void 0))}})();switch(C){case Je:R=M.left(L),C=Ye,y=R,fe(U);break;case Jn:R===null&&(R=M.left(L)),it===0&&(C===Jn&&(H=new b(D,new b(Nt,y(L)),H,R)),C=vt,y=null,z=null,fe(++U));break;default:R===null&&(R=M.left(L)),it===0&&(C=vt,y=null,z=null)}return w}}function S(L){return function(){var N=nt({rethrow:!1,handler:L})();return C===Je&&fe(U),N}}return{kill:A,join:S,onComplete:nt,isSuspended:function(){return C===Je},run:function(){C===Je&&(Rn.isDraining()?fe(U):Rn.enqueue(function(){fe(U)}))}}}function fd(M,v,et,U){var C=0,y={},z=0,R={},Z=new Error("[ParAff] Early exit"),Dt=null,H=t;function it(nt,A,S){var L=A,N=null,w=null,W=0,rt={},Mt,Xe;t:for(;;)switch(Mt=null,L.tag){case V:if(L._3===t&&(Mt=y[L._1],rt[W++]=Mt.kill(nt,function(gd){return function(){W--,W===0&&S(gd)()}})),N===null)break t;L=N._2,w===null?N=null:(N=w._1,w=w._2);break;case p:L=L._2;break;case l:case c:N&&(w=new b(D,N,w)),N=L,L=L._1;break}if(W===0)S(M.right(void 0))();else for(Xe=0,Mt=W;Xe<Mt;Xe++)rt[Xe]=rt[Xe]();return rt}function be(nt,A,S){var L,N,w,W,rt,Mt;for(M.isLeft(nt)?(L=nt,N=null):(N=nt,L=null);;){if(w=null,W=null,rt=null,Mt=null,Dt!==null)return;if(A===null){U(L||N)();return}if(A._3!==t)return;switch(A.tag){case p:L===null?(A._3=M.right(A._1(M.fromRight(N))),N=A._3):A._3=L;break;case l:if(w=A._1._3,W=A._2._3,L){if(A._3=L,rt=!0,Mt=z++,R[Mt]=it(Z,L===w?A._2:A._1,function(){return function(){delete R[Mt],rt?rt=!1:S===null?be(L,null,null):be(L,S._1,S._2)}}),rt){rt=!1;return}}else{if(w===t||W===t)return;N=M.right(M.fromRight(w)(M.fromRight(W))),A._3=N}break;case c:if(w=A._1._3,W=A._2._3,w===t&&M.isLeft(W)||W===t&&M.isLeft(w))return;if(w!==t&&M.isLeft(w)&&W!==t&&M.isLeft(W))L=N===w?W:w,N=null,A._3=L;else if(A._3=N,rt=!0,Mt=z++,R[Mt]=it(Z,N===w?A._2:A._1,function(){return function(){delete R[Mt],rt?rt=!1:S===null?be(N,null,null):be(N,S._1,S._2)}}),rt){rt=!1;return}break}S===null?A=null:(A=S._1,S=S._2)}}function kt(nt){return function(A){return function(){delete y[nt._1],nt._3=A,be(A,nt._2._1,nt._2._2)}}}function pe(){var nt=Rt,A=et,S=null,L=null,N,w;t:for(;;)switch(N=null,w=null,nt){case Rt:switch(A.tag){case p:S&&(L=new b(D,S,L)),S=new b(p,A._1,t,t),A=A._2;break;case l:S&&(L=new b(D,S,L)),S=new b(l,t,A._2,t),A=A._1;break;case c:S&&(L=new b(D,S,L)),S=new b(c,t,A._2,t),A=A._1;break;default:w=C++,nt=vt,N=A,A=new b(V,w,new b(D,S,L),t),N=Ur(M,v,N),N.onComplete({rethrow:!1,handler:kt(A)})(),y[w]=N,v&&v.register(N)}break;case vt:if(S===null)break t;S._1===t?(S._1=A,nt=Rt,A=S._2,S._2=t):(S._2=A,A=S,L===null?S=null:(S=L._1,L=L._2))}for(H=A,w=0;w<C;w++)y[w].run()}function fe(nt,A){Dt=M.left(nt);var S;for(var L in R)if(R.hasOwnProperty(L)){S=R[L];for(L in S)S.hasOwnProperty(L)&&S[L]()}R=null;var N=it(nt,H,A);return function(w){return new b(o,function(W){return function(){for(var rt in N)N.hasOwnProperty(rt)&&N[rt]();return ae}})}}return pe(),function(nt){return new b(o,function(A){return function(){return fe(nt,A)}})}}function md(M,v,et){return new b(o,function(U){return function(){return fd(M,v,et,U)}})}return b.EMPTY=t,b.Pure=mt(e),b.Throw=mt(n),b.Catch=mt(r),b.Sync=mt(a),b.Async=mt(o),b.Bind=mt(i),b.Bracket=mt(d),b.Fork=mt(m),b.Seq=mt(u),b.ParMap=mt(p),b.ParApply=mt(l),b.ParAlt=mt(c),b.Fiber=Ur,b.Supervisor=pd,b.Scheduler=Rn,b.nonCanceler=ae,b}(),Fe=Ut.Pure,Xc=Ut.Throw;function Ir(t){return function(e){return e.tag===Ut.Pure.tag?Ut.Pure(t(e._1)):Ut.Bind(e,function(n){return Ut.Pure(t(n))})}}function Gt(t){return function(e){return Ut.Bind(t,e)}}var re=Ut.Sync;var Zc=Ut.Async;function Ar(t,e){return function(){return Ut.Fiber(t,null,e)}}var t$=function(){function t(n,r){return n===0&&typeof setImmediate<"u"?setImmediate(r):setTimeout(r,n)}function e(n,r){return n===0&&typeof clearImmediate<"u"?clearImmediate(r):clearTimeout(r)}return function(n,r){return Ut.Async(function(a){return function(){var o=t(r,a(n()));return function(){return Ut.Sync(function(){return n(e(r,o))})}}})}}(),e$=Ut.Seq;var n$={map:Ir};var ka={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;s()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return _n("unsafeFromLeft: Right");s()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return _n("unsafeFromRight: Left");s()},left:Ce,right:bt};var Cs={Applicative0:()=>Fr,Bind1:()=>r$},r$={bind:Gt,Apply0:()=>Ls},Ls={apply:t=>e=>Gt(t)(n=>Gt(e)(r=>Fr.pure(n(r)))),Functor0:()=>n$},Fr={pure:Fe,Apply0:()=>Ls};var Rr={liftEffect:re,Monad0:()=>Cs};var xs={tailRecM:t=>{let e=n=>Gt(t(n))(r=>{if(r.tag==="Done")return Fe(r._1);if(r.tag==="Loop")return e(r._1);s()});return e},Monad0:()=>Cs};var Ns={liftAff:t=>t,MonadEffect0:()=>Rr};var Is=(()=>lo(ht)(kn.compare))(),As=(()=>We(ht)(kn.compare))(),p$=t=>{let e=Is(q(u=>u.y)(t)),n=(()=>{if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;s()})(),r=As(q(u=>u.y)(t)),a=(()=>{if(r.tag==="Nothing")return 0;if(r.tag==="Just")return r._1;s()})(),o=Is(q(u=>u.x)(t)),i=(()=>{if(o.tag==="Nothing")return 0;if(o.tag==="Just")return o._1;s()})(),d=As(q(u=>u.x)(t)),m=(()=>{if(d.tag==="Nothing")return 0;if(d.tag==="Just")return d._1;s()})();return q(u=>({x:.05+(u.x-i)*.9/(m-i),y:.05+(u.y-n)*.9/(a-n)}))(t)},f$=(()=>3.141592653589793*(3-gn(5)))(),m$=t=>t===0?[]:q(e=>{let n=10*gn(.5+Jt(e)),r=Jt(e)*f$;return{x:n*oi(r),y:n*ir(r)}})((()=>{let e=t-1|0;return 0>e?[]:Ft(0)(e)})()),g$=t=>e=>n=>r=>st(a=>o=>{let i=o.x,d=o.y,m=[...st(u=>p=>{if(a===u)return{x:0,y:0};let l=(i-p.x)*(i-p.x)+(d-p.y)*(d-p.y),c=t/l,D=gn(l);return{x:c*(i-p.x)/D,y:c*(d-p.y)/D}})(r),...st(u=>p=>{if(!ge(Aa)(g(a,u))(n))return{x:0,y:0};let l=gn((i-p.x)*(i-p.x)+(d-p.y)*(d-p.y)),c=e*(1-l);return{x:c*(i-p.x)/l,y:c*(d-p.y)/l}})(r)];return{x:i+te(pr)(0)(q(u=>u.x)(m)),y:d+te(pr)(0)(q(u=>u.y)(m))}})(r),Fs=t=>e=>p$(te(n=>r=>g$(.05)(.1)(e)(n))(m$(t))(Ft(1)(300)));function Sr(t){return function(e){return t===e}}var Yt=(t,e,n)=>({tag:t,_1:e,_2:n});var Ha=t=>({liftEffect:e=>O(ut("Bind",Yt("Lift",t.liftEffect(e)),n=>O(ut("Return",n),at)),at),Monad0:()=>bs});var Ss=t=>{let e=Ha(t.MonadEffect0());return{liftAff:n=>O(ut("Bind",Yt("Lift",t.liftAff(n)),r=>O(ut("Return",r),at)),at),MonadEffect0:()=>e}};var Pr=(()=>Ha(Rr).liftEffect)(),tt=t=>O(ut("Bind",Yt("State",e=>x(void 0,t(e))),e=>O(ut("Return",e),at)),at),le=Xi($e)(Ga),Jr=O(ut("Bind",Yt("State",t=>x(t,t)),t=>O(ut("Return",t),at)),at),Js=Ss(Ns),qs={reflectSymbol:()=>"y"},vs={reflectSymbol:()=>"x"},zs={reflectSymbol:()=>"layout"},Os={reflectSymbol:()=>"edges"},Us=(()=>{let t=Nn(xr(Ai))(Nn(xr((()=>{let e=Nn(Ua)(Nn(Ua)(Oa)(qs)())(vs)();return{encodeJson:n=>e.gEncodeJson(n)(Q)}})()))(Oa)(zs)())(Os)();return{encodeJson:e=>t.gEncodeJson(e)(Q)}})(),D$=(()=>xr(Us).encodeJson)(),ws=Lr({decodeJsonField:t=>t.tag==="Just"?f("Just",he(e=>_("Left",dt("TypeMismatch","Number")),e=>_("Left",dt("TypeMismatch","Number")),bt,e=>_("Left",dt("TypeMismatch","Number")),e=>_("Left",dt("TypeMismatch","Number")),e=>_("Left",dt("TypeMismatch","Number")),t._1)):$}),Gs=za(Lr((()=>{let t=Be(Fi.decodeJson);return{decodeJsonField:e=>e.tag==="Just"?f("Just",t(e._1)):$}})())(Lr((()=>{let t=Be(za(ws(ws(va)(qs)()())(vs)()())().decodeJson);return{decodeJsonField:e=>e.tag==="Just"?f("Just",t(e._1)):$}})())(va)(zs)()())(Os)()())(),b$=(()=>Be(Gs.decodeJson))(),T$=t=>e=>{let n=t(e);return O(ut("Bind",Yt("State",r=>{let a=n(r);return x(a,a)}),r=>O(ut("Return",r),at)),wt(at)(r=>O(ut("Return",void 0),at)))},M$=(()=>We(ht)(Y.compare))(),E$=t=>e=>{let n=Y.compare(t)(e);if(n==="LT")return e;if(n==="EQ"||n==="GT")return t;s()},C$=t=>e=>{let n=Y.compare(t)(e);if(n==="LT"||n==="EQ")return t;if(n==="GT")return e;s()},Ws=t=>t.currentStep!==Kt(t).layout.length?t:tr({reflectSymbol:()=>"results"})()()(Q)($e)(Ms.ix(t.selectedResultIndex)($e)(Ga)(e=>({...e,showNumber:!0})))(t);var ks=t=>{if(t.tag==="AddVertex"){let e=Pr(xa(t._1));return O(e._1,wt(e._2)(n=>{if(n.tag==="Nothing")return O(ut("Return",void 0),at);if(n.tag==="Just"){let r=n._1;return tt(a=>a.editmode==="VertexMode"?{...le(Wi(r))(a),results:[],selectedResultIndex:0,currentStep:0}:a)}s()}))}if(t.tag==="SelectVertex"){let e=t._1,n=Pr(Ea(t._2));return O(n._1,wt(n._2)(()=>tt(r=>ge(ki)(r.editmode)([br,xn])?{...r,selectedVertex:f("Just",e)}:r)))}if(t.tag==="GraphMove"){let e=Pr(xa(t._1));return O(e._1,wt(e._2)(n=>tt(r=>{if(n.tag==="Just"){if(r.selectedVertex.tag==="Just"&&r.editmode==="MoveMode")return le(Pi(r.selectedVertex._1)(n._1))(r);if(r.editmode==="AddEMode")return{...r,currentPosition:f("Just",n._1)}}return r})))}if(t.tag==="DropOrLeave")return tt(e=>e.editmode==="AddEMode"?{...e,selectedVertex:$}:e);if(t.tag==="PointerUp"){let e=t._1;return tt(n=>n.editmode==="MoveMode"?{...n,selectedVertex:$,currentPosition:$}:n.editmode==="AddEMode"&&n.selectedVertex.tag==="Just"?{...le(qi(e)(n.selectedVertex._1))(n),currentStep:0,results:[],selectedResultIndex:0,selectedVertex:$}:n)}if(t.tag==="DeleteVertex"){let e=t._2,n=t._1;return O(Jr._1,wt(Jr._2)(r=>{let a=Pr(Ea(e));return r.editmode==="MoveMode"?O(a._1,wt(a._2)(()=>tt(o=>o.editmode==="DeleteMode"?{...le(Fa(n))(o),results:[],selectedResultIndex:0,currentStep:0}:o))):O(ut("Return",void 0),wt(at)(()=>tt(o=>o.editmode==="DeleteMode"?{...le(Fa(n))(o),results:[],selectedResultIndex:0,currentStep:0}:o)))}))}if(t.tag==="DeleteEdge"){let e=t._1._1,n=t._1._2;return tt(r=>r.editmode==="DeleteMode"?{...le(Si(e)(n))(r),results:[],selectedResultIndex:0,currentStep:0}:r)}if(t.tag==="ClearGraph")return tt(e=>({...le(n=>({layout:[],edges:[]}))(e),results:[],selectedResultIndex:0,currentStep:0}));if(t.tag==="SetEditMode"){let e=t._1;return tt(n=>({...n,editmode:e}))}if(t.tag==="AdjustGraph")return tt(e=>le(n=>({...n,layout:Fs(n.layout.length)(n.edges)}))(e));if(t.tag==="SetGraph"){let e=t._1;return tt(n=>({...n,currentStep:0,results:[],selectedGraphIdx:(()=>e==="1"?0:e==="2"?1:e==="3"?2:e==="4"?3:e==="5"?4:e==="6"?5:e==="7"?6:e==="8"?7:0)(),selectedResultIndex:0}))}if(t.tag==="SetAlgo"){let e=t._1;return tt(n=>({...n,currentStep:0,selectedAlgorithm:(()=>e==="alpha"?Tr:e==="decdegree"?Oi:e==="indset"?Ui:e==="dsatur"?Gi:e==="custom"?Ae("CustomAlgorithm",(()=>{let r=Kt(n).layout.length-1|0;return 0>r?[]:Ft(0)(r)})()):Tr)()}))}if(t.tag==="CustomAlgoTextChange"){let e=t._1;return tt(n=>{let r=Bi(e);if(r.tag==="Nothing")return n;if(r.tag==="Just")return{...n,selectedAlgorithm:Ae("CustomAlgorithm",r._1)};s()})}if(t.tag==="SetResultIndex"){let e=t._1;return tt(n=>({...n,selectedResultIndex:e,currentStep:0}))}if(t.tag==="Save")return O(Jr._1,wt(Jr._2)(e=>xi(Js)("coloring-graphs")(or(D$(me(5)(e.graphs.length)(e.graphs))))));if(t.tag==="Load"){let e=Ni(Js)("coloring-graphs");return O(e._1,wt(e._2)(n=>{if(n.tag==="Nothing")return O(ut("Return",void 0),at);if(n.tag==="Just"){let r=Nr(Ce,bt,n._1);if(r.tag==="Left")return O(ut("Return",void 0),at);if(r.tag==="Right"){let a=b$(r._1);if(a.tag==="Left")return O(ut("Return",void 0),at);if(a.tag==="Right")return a._1.length!==3?O(ut("Return",void 0),at):T$(Zi($e))(o=>[...me(0)(5)(o),...a._1])}}s()}))}if(t.tag==="OpenImportDialog")return tt(e=>({...e,dialog:Ln("ImportDialog","")}));if(t.tag==="ChangeImportText"){let e=t._1;return tt(n=>({...n,dialog:Ln("ImportDialog",e)}))}if(t.tag==="ImportAndClose")return tt(e=>{if(e.dialog.tag==="ImportDialog"){let n=Nr(Ce,bt,e.dialog._1);if(n.tag==="Left")return{...e,dialog:je};if(n.tag==="Right"){let r=Gs.decodeJson(n._1);if(r.tag==="Left")return{...e,dialog:je};if(r.tag==="Right"){let a=r._1;return{...le(o=>a)(e),currentStep:0,dialog:je,results:[],selectedResultIndex:0}}}s()}return e});if(t.tag==="Export")return tt(e=>({...e,dialog:Ln("ExportDialog",or(Us.encodeJson(Kt(e))))}));if(t.tag==="CloseDialog")return tt(e=>({...e,dialog:je}));if(t.tag==="Compute")return tt(e=>{let n=Qi(Kt(e))(e.selectedAlgorithm);if(n.tag==="Nothing")return e;if(n.tag==="Just")return{...e,results:me(0)(5)([{algorithm:e.selectedAlgorithm,coloring:n._1,number:(()=>{let r=M$(q(a=>a.color)(n._1));if(r.tag==="Nothing")return 0;if(r.tag==="Just")return 1+r._1|0;s()})(),showNumber:!1},...e.results])};s()});if(t.tag==="PreviousStep")return tt(e=>({...e,currentStep:E$(0)(e.currentStep-1|0)}));if(t.tag==="NextStep")return tt(e=>Ws({...e,currentStep:C$(Kt(e).layout.length)(e.currentStep+1|0)}));if(t.tag==="FinishColoring")return tt(e=>Ws({...e,currentStep:Kt(e).layout.length}));s()};var x$=(t,e,n,r=!1)=>{let a=[],o={},i={},d={},m={tag:t,children:n,props:o,attrs:i,events:d,node:null,keyed:r},u=e.length;for(let l=0;l<u;l++){let[c,D,k]=e[l];c===0?o[D]=k:c===1?i[D]=k:c===2?d[D]=k:c===3?i.class=i.class?i.class+" "+D:D:c===4&&a.push(D+":"+k)}let p=a.join(";");return p&&(i.style=p),m},E=(t,e,n)=>x$(t,e,n.map(r=>({key:null,html:r})));var N$=t=>({tag:t,children:[],type:3});var X=(t,e)=>[0,t,e],j=(t,e)=>[1,t,e],Tt=(t,e)=>[2,t,e],J=t=>[3,t],Ve=[-1];var G=N$;var De=G("");var Va=t=>e=>E("div",[J("p-6 bg-white border border-gray-200 rounded-lg shadow")],[E("div",[J("text-xl mb-2")],[G(t)]),...e]),wr="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700",ja=(()=>wr+" rounded")(),Bs=t=>{let e=t.onClick;return E("button",[J(ja),Tt("click",n=>()=>f("Just",e)),...t.attrs],[G(t.name)])},Qa=t=>e=>n=>E("div",[J("absolute w-full h-full flex items-center justify-center bg-transp-grey inset-0 z-50")],[E("div",[J("bg-white text-black rounded block border-2")],[E("div",[J("p-4 min-h-8 border-b-2")],[E("div",[J("text-4xl font-medium inline-block")],[G(t)])]),E("div",[J("p-6 border-b-2")],e),E("div",[J("p-4 text-right")],st(r=>a=>{let o=a.onClick;return E("button",[J(r===0?ja+"":ja+" ml-4"),Tt("click",i=>()=>f("Just",o))],[G(a.name)])})(n))])]),In=t=>{let e=t.length;return E("div",[],st(n=>r=>{let a=r.onClick;return E("button",[J((()=>n===0?wr+" rounded-l":n===(e-1|0)?wr+" rounded-r":wr+"")()),Tt("click",o=>()=>f("Just",a)),...r.attrs],[G(r.name)])})(t))};var Wr=t=>e=>n=>r=>j("viewBox",gt(t)+" "+gt(e)+" "+gt(n)+" "+gt(r));var I$=t=>e=>E("line",[j("x1",gt(100*t.x)),j("y1",gt(100*t.y)),j("x2",gt(100*e.x)),j("y2",gt(100*e.y)),J("graphparams-graphview-edge pointer-events-none")],[]),Vs=t=>{let e=t.editmode,n=Kt(t).layout.length,r=Kt(t);return E("div",[],[E("div",[J("graphparams-graphview-board")],[E("svg",[J("block"),Wr(0)(0)(100)(100),Tt("click",a=>()=>f("Just",B("AddVertex",a))),Tt("pointerup",a=>()=>f("Just",Ra)),Tt("pointerleave",a=>()=>f("Just",Ra)),Tt("pointermove",a=>()=>f("Just",B("GraphMove",a)))],[E("g",[],q(a=>{let o=Ji(r)(a);if(o.tag==="Nothing")return De;if(o.tag==="Just")return E("line",[j("x1",gt(100*o._1.x1)),j("y1",gt(100*o._1.y1)),j("x2",gt(100*o._1.x2)),j("y2",gt(100*o._1.y2)),J("graphparams-graphview-edge"),e==="DeleteMode"?J("deletemode"):Ve,Tt("click",i=>()=>f("Just",B("DeleteEdge",a)))],[]);s()})(r.edges)),E("g",[],cn(jr)(st(a=>o=>{let i=o.x,d=o.y;return m=>E("circle",[j("cx",gt(100*i)),j("cy",gt(100*d)),j("r",Vt(n<=26?4:2)),j("stroke-width","0.5"),J("graphparams-graphview-vertex color"+Vt(m)),e==="DeleteMode"?J("deletemode"):Ve,(()=>{let u=es(a);return Tt("click",p=>{let l=f("Just",u(p));return()=>l})})(),(()=>{let u=ts(a);return Tt("pointerdown",p=>{let l=f("Just",u(p));return()=>l})})(),Tt("pointerup",u=>()=>f("Just",B("PointerUp",a)))],[])})(r.layout))(ji(t))),n<=26?E("g",[],st(a=>o=>E("text",[J("pointer-events-none select-none graphview-text"),j("x",gt(100*o.x-2)),j("y",gt(100*o.y+2))],[G(Vi(a))]))(r.layout)):De,(()=>{if(e==="AddEMode"){let a=t.selectedVertex.tag==="Just"?Ze.apply(t.currentPosition.tag==="Just"?f("Just",I$(t.currentPosition._1)):$)(ct(r.layout)(t.selectedVertex._1)):$;if(a.tag==="Nothing")return De;if(a.tag==="Just")return a._1;s()}return De})()])]),In([{name:"D\xE9placer",onClick:B("SetEditMode",xn),attrs:[X("selected",e==="MoveMode")]},{name:"Ajouter sommet",onClick:B("SetEditMode",vi),attrs:[X("selected",e==="VertexMode")]},{name:"Ajouter ar\xEAte",onClick:B("SetEditMode",br),attrs:[X("selected",e==="AddEMode")]},{name:"Retirer",onClick:B("SetEditMode",zi),attrs:[X("selected",e==="DeleteMode")]},{name:"Tout effacer",onClick:ns,attrs:[]},{name:"Ajuster",onClick:rs,attrs:[]}])])};var Qs=(t,e,n)=>typeof t.value=="string"?n(t.value):e;var An=t=>Tt("change",e=>{let n=_t(Ie(e),$,F);if(n.tag==="Just"){let r=n._1;return()=>{let a=Qs(r,$,F);return a.tag==="Just"?f("Just",t(a._1)):$}}if(n.tag==="Nothing")return()=>$;s()});var S$=t=>Qa("Importer les graphes")([E("textarea",[J("block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"),j("cols","150"),j("rows","30"),X("value",t),An($s)],[])])([{name:"Annuler",onClick:Sa},{name:"OK",onClick:ls}]),P$=t=>Qa("Exporter les graphes")([E("textarea",[J("block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"),j("cols","150"),j("rows","30"),X("value",t),X("selected",!0)],[])])([{name:"OK",onClick:Sa}]),Ks=t=>{let e=t.selectedResultIndex;return E("div",[J("flex flex-row justify-around")],[Va("Graphe")([Vs(t)]),Va("Ordre des couleurs")([E("div",[J("w-16")],[E("svg",[Wr(0)(0)(10)(100)],q(n=>E("rect",[j("x","0"),j("y",Vt(n*10|0)),j("width","10"),j("height","10"),J("color"+Vt(n))],[]))(Ft(0)(9)))])]),E("div",[J("flex flex-col")],[E("span",[J("mb-2 mt-4 text-2xl font-bold")],[G("Graphe")]),E("select",[J("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),X("value","1"),An(as)],[E("option",[X("value","1")],[G("Graphe 1")]),E("option",[X("value","2")],[G("Graphe 2")]),E("option",[X("value","3")],[G("Graphe 3")]),E("option",[X("value","4")],[G("Graphe 4")]),E("option",[X("value","5")],[G("Gros graphe")]),E("option",[X("value","6")],[G("Graphe personnalis\xE9 1")]),E("option",[X("value","7")],[G("Graphe personnalis\xE9 2")]),E("option",[X("value","8")],[G("Graphe personnalis\xE9 3")])]),In([{onClick:ss,name:"Sauvegarder",attrs:[]},{onClick:us,name:"Importer",attrs:[]},{onClick:cs,name:"Exporter",attrs:[]}]),E("span",[J("mb-2 mt-4 text-2xl font-bold")],[G("Algorithme")]),E("select",[J("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),j("name","dsatur"),An(os)],[E("option",[X("value","alpha")],[G("Alphabetique")]),E("option",[X("value","decdegree")],[G("Degr\xE9 d\xE9croissant")]),E("option",[X("value","indset")],[G("Stables")]),E("option",[X("value","dsatur")],[G("DSatur")]),E("option",[X("value","custom")],[G("Personnalis\xE9")])]),t.selectedAlgorithm.tag==="CustomAlgorithm"?E("input",[J("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),j("type","text"),X("value",Mr(t.selectedAlgorithm._1)),An(is)],[]):De,Bs({onClick:ps,name:"Choisir",attrs:[]}),E("span",[J("mb-2 mt-4 text-2xl font-bold")],[G("R\xE9sultats")]),E("ul",[J("ml-4 list-disc")],[...st(n=>r=>E("li",[e===n?J("text-blue-600"):Ve,Tt("click",a=>()=>f("Just",B("SetResultIndex",n)))],[G(Yi(r.algorithm)+(r.showNumber?" ("+Vt(r.number)+" couleurs)":""))]))(t.results),...En(5-t.results.length|0)(n=>E("li",[],[]))]),In([{onClick:fs,name:"Etape pr\xE9c\xE9dente",attrs:[]},{onClick:ms,name:"Etape suivante",attrs:[]},{onClick:gs,name:"Termine la coloration",attrs:[]}]),E("span",[J("text-xl")],[G(Mr(Hi(t)))])]),(()=>{if(t.dialog.tag==="NoDialog")return De;if(t.dialog.tag==="ExportDialog")return P$(t.dialog._1);if(t.dialog.tag==="ImportDialog")return S$(t.dialog._1);s()})()])};var Ys=(t,e)=>t&&e?n=>t(e(n)):t||e,Xs=(t,e,n)=>{t[e]=n},Zs=(t,e,n)=>{n==null||e==="class"&&!n?t.removeAttribute(e):t.setAttribute(e,n)},td=(t,e,n,r,a,o)=>{t.actions||(t.actions={}),t.actions[e]=o&&r?o(r):r,r?n||t.addEventListener(e,a):t.removeEventListener(e,a)},qr=(t,e,n,r)=>{let a=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),o=t.props,i=t.attrs,d=t.events,m=Ys(r,t.mapf);for(let u in o)Xs(a,u,o[u]);for(let u in i)Zs(a,u,i[u]);for(let u in d)td(a,u,null,d[u],e,m);for(let u=0,p=t.children.length;u<p;u++)a.appendChild(qr(Se(t.children[u]).html,e,n,m));return t.node=a,a},Re=(t,e,n,r,a,o,i)=>{if(n!==r){if(n!=null&&n.type===3&&r.type===3)n.tag!==r.tag&&(e.nodeValue=r.tag);else if(n==null||n.tag!==r.tag)e=t.insertBefore(qr(r,a,o,i),e),n&&n.node.remove();else{let d=n.props,m=r.props;for(let I in{...d,...m})d[I]!==m[I]&&Xs(e,I,m[I]);let u=n.attrs,p=r.attrs;for(let I in{...u,...p})u[I]!==p[I]&&Zs(e,I,p[I]);let l=n.events,c=r.events;for(let I in{...l,...c})l[I]!==c[I]&&td(e,I,l[I],c[I],a,i);let D=n.children,k=r.children,ot=D.length-1,Nt=k.length-1;if(i=Ys(i,r.mapf),o=o||r.tag==="svg",r.keyed){let I=0,V=0;for(;V<=Nt&&I<=ot;){let{key:Wt,html:qt}=D[I];if(Wt!==k[V].key)break;let b=Se(k[V],qt);Re(e,qt.node,qt,b.html,a,o,i),V++,I++}for(;V<=Nt&&I<=ot;){let{key:Wt,html:qt}=D[ot];if(Wt!==k[Nt].key)break;let b=Se(k[Nt],qt);Re(e,qt.node,qt,b.html,a,o,i),Nt--,ot--}if(I>ot)for(;V<=Nt;){let Wt=Se(k[V]).html;e.insertBefore(qr(Wt,a,o,i),D[I]&&D[I].html.node),V++}else if(V>Nt)for(;I<=ot;)D[I].html.node.remove(),I++;else{let Wt={},qt={};for(let b=I;b<=ot;b++)Wt[D[b].key]=D[b].html;for(;V<=Nt;){let{key:b,html:mt}=D[I]||{key:null,html:null},{key:ae,html:Or}=Se(k[V],mt);if(qt[b]||D[I+1]&&ae===D[I+1].key){I++;continue}if(b===ae)Re(e,mt.node,mt,Or,a,o,i),qt[ae]=!0,I++;else{let Ke=Wt[ae];Ke!=null?(Re(e,e.insertBefore(Ke.node,mt.node),Ke,k[V].html,a,o,i),qt[ae]=!0):Re(e,mt&&mt.node,null,k[V].html,a,o,i)}V++}for(let b in Wt)qt[b]||Wt[b].node.remove()}}else{for(let I=0;I<=ot&&I<=Nt;I++){let V=D[I].html,Wt=Se(k[I],V).html;Re(e,V.node,V,Wt,a,o,i)}for(let I=ot+1;I<=Nt;I++){let V=Se(k[I],n).html;e.appendChild(qr(V,a,o,i))}for(let I=Nt+1;I<=ot;I++)D[I].html.node.remove()}}return r.node=e,e}},w$=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},Se=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||w$(e.memo,t.html.memo))&&(e=vr(t.html.type(...t.html.memo)),e.memo=t.html.memo),t.html=e),t),vr=t=>({...t,children:t.children&&t.children.map(({key:e,html:n})=>({key:e,html:vr(n)}))}),ed=(t,e)=>t.actions[e],nd=Re,rd=t=>e=>(e.node=t,e);var Pe=function(t){return function(e){return function(){return e[t]}}},JM=Pe("URL"),wM=Pe("documentURI"),WM=Pe("origin"),qM=Pe("compatMode"),vM=Pe("characterSet"),zM=Pe("contentType");var q$=Pe("documentElement");function ad(t){return function(e){return function(){return e.createTextNode(t)}}}var Xt=function(t){return function(e){return function(){return e[t]}}};var dE=Xt("baseURI"),O$=Xt("ownerDocument"),Ka=Xt("parentNode"),U$=Xt("parentElement");var uE=Xt("childNodes"),G$=Xt("firstChild"),k$=Xt("lastChild"),B$=Xt("previousSibling"),H$=Xt("nextSibling"),j$=Xt("nodeValue");var cE=Xt("textContent");function od(t){return function(e){return function(){e.appendChild(t)}}}var zr=function(t){return function(e){return function(){return e[t]}}},wE=zr("children"),Q$=zr("firstElementChild"),K$=zr("lastElementChild"),WE=zr("childElementCount");function id(t){return function(e){return function(){return e.querySelector(t)}}}var sd=t=>{let e=id(t);return n=>{let r=e(n);return()=>{let a=r();return _t(a,$,F)}}};var Fn=On(Zr)(an),X$=On(Fr)(an),Z$=Ds({map:t=>e=>{if(e.tag==="State")return Yt("State",n=>{let r=e._1(n);return x(t(r._1),r._2)});if(e.tag==="Lift")return Yt("Lift",Ir(t)(e._1));if(e.tag==="Subscribe")return Yt("Subscribe",e._1,n=>t(e._2(n)));if(e.tag==="Unsubscribe")return Yt("Unsubscribe",e._1,t(e._2));s()}})(xs),tl=t=>e=>n=>{let r=n(e);return()=>{let a=r();return Fn(a)(t.update(t))()}},dd=t=>e=>{let n=t.node,r=t.vdom;return()=>{let a=r.value,o=n.value,i=Ka(o)();return Fn(_t(i,$,F))(d=>{let m=vr(e);return()=>{let u=nd(d,o,a,m,p=>{let l=_i(p);return Fn(_t(Ie(p),$,F))(c=>()=>{let D=ed(c,l);return tl(t)(p)(D)()})()});return n.value=u,r.value=m}})()}},el=t=>e=>{let n=t.state;return()=>{let r=n.value,a=Sr(r)(e);if(!a)return n.value=e,dd(t)(t.view(e))();a||s()}},ud=t=>e=>n=>{let r=e.subscriptions;return Z$(a=>{if(a.tag==="State")return Gt(re((()=>{let o=e.state;return()=>o.value})()))(o=>{let i=a._1(o),d=i._1;return Gt(re(el(e)(i._2)))(()=>Fe(d))});if(a.tag==="Lift")return a._1;if(a.tag==="Subscribe")return Gt(re(a._1(o=>{let i=Ar(ka,ud(t)(e)(t(o)));return()=>{i().run()}})))(o=>Gt(re((()=>{let i=e.freshId;return()=>{let d=i.value;return i.value=d+1|0,d}})()))(i=>Gt(re((()=>{let d=lr(Y)(i)(o);return()=>{let m=r.value;r.value=d(m)}})()))(()=>Fe(a._2(i)))));if(a.tag==="Unsubscribe"){let o=a._2,i=a._1;return Gt(re(()=>r.value))(d=>Gt(X$($r(Y)(i)(d))(re))(()=>Fe(o)))}s()})(n)},nl=t=>{let e=t.init.model,n=t.init.msg,r=t.selector,a=t.update,o=t.view;return()=>{let i=He(),d=Ca(i)(),m=sd(r)(d)();return Fn(m.tag==="Just"?f("Just",m._1):$)(u=>()=>{let p={value:e},l=He(),c=Ca(l)(),D=ad("")(c)();od(D)(u)();let k={value:D},ot={value:rd(D)(G(""))},V={view:o,update:a,state:p,node:k,vdom:ot,subscriptions:{value:ke},freshId:{value:0}};return dd(V)(o(e))(),Fn(n)(V.update(V))()})()}};var cd=t=>{let e=t.update;return nl({init:t.init,view:t.view,selector:t.selector,update:n=>r=>{let a=Ar(ka,ud(e)(n)(e(r)));return()=>{a().run()}}})};var $d=cd({init:{model:Ki,msg:f("Just",ds)},update:ks,view:Ks,selector:"#root"});$d();})();
