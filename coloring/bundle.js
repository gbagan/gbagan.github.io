(()=>{function s(){throw new Error("Failed pattern match")}var oe=function(t){return function(e){return e[t]}},Ae=function(t){return function(e){return function(n){var r={};for(var o in n)({}).hasOwnProperty.call(n,o)&&(r[o]=n[o]);return r[t]=e,r}}};var au=()=>({tag:"Proxy"}),K=au();var Vt=function(t){return t.toString()},ut=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var Pr=t=>t,dt=Pr("LT"),ct=Pr("GT"),At=Pr("EQ");var m=(t,e)=>({tag:t,_1:e}),l=m("Nothing"),I=t=>m("Just",t);var se={map:t=>e=>e.tag==="Just"?m("Just",t(e._1)):l};var he=t=>{let e=t.Eq0(),n={eq:r=>o=>r.tag==="Nothing"?o.tag==="Nothing":r.tag==="Just"&&o.tag==="Just"&&e.eq(r._1)(o._1)};return{compare:r=>o=>{if(r.tag==="Nothing")return o.tag==="Nothing"?At:dt;if(o.tag==="Nothing")return ct;if(r.tag==="Just"&&o.tag==="Just")return t.compare(r._1)(o._1);s()},Eq0:()=>n}};var Be={apply:t=>e=>{if(t.tag==="Just")return e.tag==="Just"?m("Just",t._1(e._1)):l;if(t.tag==="Nothing")return l;s()},Functor0:()=>se};var wr=t=>e=>t(e);var Jr={compose:t=>e=>n=>t(e(n))};var U=function(t){return function(e){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o]);return r}};var ke={map:U};var Wr=t=>t;var qr=function(t){return function(e){for(var n=[],r=0,o=t.length;r<o;r++)Array.prototype.push.apply(n,e(t[r]));return n}};var D=(t,e)=>({tag:t,_1:e}),ye=t=>D("Left",t),Dt=t=>D("Right",t);var He={map:t=>e=>{if(e.tag==="Left")return D("Left",e._1);if(e.tag==="Right")return D("Right",t(e._1));s()}};var $u={apply:t=>e=>{if(t.tag==="Left")return D("Left",t._1);if(t.tag==="Right"){if(e.tag==="Left")return D("Left",e._1);if(e.tag==="Right")return D("Right",t._1(e._1))}s()},Functor0:()=>He};var Bo={pure:Dt,Apply0:()=>$u};var ko=function(t){return function(){return t}};var pu={apply:t=>e=>()=>{let n=t(),r=e();return zr.pure(n(r))()},Functor0:()=>fu},zr={pure:ko,Apply0:()=>pu},fu={map:t=>e=>()=>{let n=e();return t(n)}};var wt=(t,e)=>({tag:t,_1:e}),Ur=t=>wt("Loop",t),Ho=t=>wt("Done",t);var jo=function(t){return function(e){return function(){return t(e())}}},Vo=function(t){return function(){return t}};var hu={map:jo};var yu={apply:t=>e=>()=>{let n=t(),r=e();return Ln.pure(n(r))()},Functor0:()=>hu},Ln={pure:Vo,Apply0:()=>yu};var Qo=function(t){return function(e){return function(n){return function(r){return function(){return n>=0&&n<r.length?t(r[n]):e}}}}},xn=function(t){return function(e){return function(n){return function(){var r=t>=0&&t<n.length;return r&&(n[t]=e),r}}}};var Ko=function(t){return function(e){return function(){return e.push.apply(e,t)}}};function _u(t){return function(){return t.slice()}}var je=_u,Du=function(){function t(e,n,r,o,a,i){var u,f,d,$,p,c,y;for(u=a+(i-a>>1),u-a>1&&t(e,n,o,r,a,u),i-u>1&&t(e,n,o,r,u,i),f=a,d=u,$=a;f<u&&d<i;)p=o[f],c=o[d],y=n(e(p)(c)),y>0?(r[$++]=c,++d):(r[$++]=p,++f);for(;f<u;)r[$++]=o[f++];for(;d<i;)r[$++]=o[d++]}return function(e){return function(n){return function(r){return function(){return r.length<2||t(e,n,r,r.slice(0),0,r.length),r}}}}}();var Yo=t=>Ko([t]);var Xo=t=>e=>n=>{let r=Qo(I)(l)(t)(n);return()=>{let o=r();if(o.tag==="Just")return xn(t)(e(o._1))(n)();if(o.tag==="Nothing")return!1;s()}};var ue=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=o-1;a>=0;a--)r=t(n[a])(r);return r}}},Qt=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=0;a<o;a++)r=t(r)(n[a]);return r}}};var Nn=t=>{let e=t.Apply0();return n=>r=>n.foldr(o=>{let a=r(o);return i=>e.apply(e.Functor0().map(u=>Wr)(a))(i)})(t.pure())},An=t=>{let e=Nn(t);return n=>{let r=e(n);return o=>a=>r(a)(o)}};var In=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return m("Just",r);if(n.tag==="Just")return m("Just",e(n._1)(r)==="GT"?n._1:r);s()})(l);var ta=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return m("Just",r);if(n.tag==="Just")return m("Just",e(n._1)(r)==="LT"?n._1:r);s()})(l);var Ve={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);s()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);s()},foldMap:t=>{let e=t.mempty;return n=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return n(r._1);s()}}};var bt={foldr:ue,foldl:Qt,foldMap:t=>{let e=t.mempty;return n=>bt.foldr(r=>o=>t.Semigroup0().append(n(r))(o))(e)}};var A=(t,e)=>({tag:"Tuple",_1:t,_2:e}),Jt=t=>e=>A(t,e);var Fn={map:t=>e=>A(e._1,t(e._2))};var lt=function(t){return function(e){for(var n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t(o)(e[o]);return r}};var ia={mapWithIndex:lt,Functor0:()=>ke};var sa=function(t){return function(e){return t===e}};var ua=sa,da=sa;var la={eq:da},Sn={eq:ua};var $a=function(t){return function(e){return function(n){return function(r){return function(o){return r<o?t:r===o?e:n}}}}};var pa=$a,fa=$a;var Rn={compare:fa(dt)(At)(ct),Eq0:()=>la},$t={compare:pa(dt)(At)(ct),Eq0:()=>Sn};var Da=function(){function t(o){return[o]}function e(o){return function(a){return[o,a]}}function n(o){return function(a){return function(i){return[o,a,i]}}}function r(o){return function(a){return o.concat(a)}}return function(o){return function(a){return function(i){return function(u){return function(f){function d($,p){switch(p-$){case 0:return i([]);case 1:return a(t)(u(f[$]));case 2:return o(a(e)(u(f[$])))(u(f[$+1]));case 3:return o(o(a(n)(u(f[$])))(u(f[$+1])))(u(f[$+2]));default:var c=$+Math.floor((p-$)/4)*2;return o(a(r)(d($,c)))(d(c,p))}}return d(0,f.length)}}}}}}();var Hr=t=>t;var Qe={traverse:t=>{let e=t.Apply0();return Da(e.apply)(e.Functor0().map)(t.pure)},sequence:t=>Qe.traverse(t)(Hr),Functor0:()=>ke,Foldable1:()=>bt};var Wt=function(t){return function(e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),o=t,a=0;o!==e;)r[a++]=o,o+=n;return r[a]=o,r}},ad=function(t){return function(e){if(t<1)return[];var n=new Array(t);return n.fill(e)}},id=function(t){return function(e){for(var n=[],r=0,o=0;o<t;o++)n[r++]=e;return n}},jr=typeof Array.prototype.fill=="function"?ad:id,Vr=function(){function t(o,a){this.head=o,this.tail=a}var e={};function n(o){return function(a){return new t(o,a)}}function r(o){for(var a=[],i=0,u=o;u!==e;)a[i++]=u.head,u=u.tail;return a}return function(o){return function(a){return r(o(n)(e)(a))}}}();var ba=function(t){return function(e){return function(n){return function(r){return r<0||r>=n.length?e:t(n[r])}}}};var Ta=function(t){return function(e){return function(n){return function(r){for(var o=0,a=r.length;o<a;o++)if(n(r[o]))return t(o);return e}}}};var Ma=function(t){return function(e){return function(n){return function(r){if(n<0||n>=r.length)return e;var o=r.slice();return o.splice(n,1),t(o)}}}},Ea=function(t){return function(e){return function(n){return function(r){return function(o){if(n<0||n>=o.length)return e;var a=o.slice();return a[n]=r,t(a)}}}}};var wn=function(t){return function(e){return e.filter(t)}};var Ca=function(){function t(e,n,r,o,a,i){var u,f,d,$,p,c,y;for(u=a+(i-a>>1),u-a>1&&t(e,n,o,r,a,u),i-u>1&&t(e,n,o,r,u,i),f=a,d=u,$=a;f<u&&d<i;)p=o[f],c=o[d],y=n(e(p)(c)),y>0?(r[$++]=c,++d):(r[$++]=p,++f);for(;f<u;)r[$++]=o[f++];for(;d<i;)r[$++]=o[d++]}return function(e){return function(n){return function(r){var o;return r.length<2?r:(o=r.slice(0),t(e,n,o,r.slice(0),0,r.length),o)}}}}(),Ke=function(t){return function(e){return function(n){return n.slice(t,e)}}},Jn=function(t){return function(e){return function(n){for(var r=e.length<n.length?e.length:n.length,o=new Array(r),a=0;a<r;a++)o[a]=t(e[a])(n[a]);return o}}};var La=Nn(Ln);var Wn=t=>{let e=La(t);return n=>r=>(()=>{let o=je(r);return()=>{let a=o();return e(i=>xn(i._1)(i._2)(a))(n)(),a}})()()},xa=Ea(I)(l);var sd=t=>Ca(t)(e=>{if(e==="GT")return 1;if(e==="EQ")return 0;if(e==="LT")return-1;s()}),qn=t=>e=>sd(n=>r=>t.compare(e(n))(e(r)));var Ze=t=>e=>(()=>{let n=Yo(e),r=je(t);return()=>{let o=r();return n(o)(),o}})()();var Na=t=>{let e=La(t);return n=>r=>o=>(()=>{let a=je(o);return()=>{let i=a();return e(u=>Xo(u)(r)(i))(n)(),i}})()()};var Gt=ba(I)(l);var ud=Ta(I)(l);var Fe=t=>e=>n=>{let r=ud(o=>t.eq(o)(e))(n);if(r.tag==="Nothing")return!1;if(r.tag==="Just")return!0;s()};var Aa=Ma(I)(l);var dd=t=>e=>qr(e)(t),vn=t=>dd(e=>{let n=t(e);if(n.tag==="Nothing")return[];if(n.tag==="Just")return[n._1];s()});var nf=String.fromCharCode(65535),rf=String.fromCharCode(0),of=Number.POSITIVE_INFINITY,af=Number.NEGATIVE_INFINITY;function zn(t){return t.charCodeAt(0)}function tn(t){return String.fromCharCode(t)}var Qr={identity:t=>t,Semigroupoid0:()=>Jr};var On={dimap:t=>e=>n=>r=>e(n(t(r)))};var hd=t=>t,Se=(()=>({first:t=>e=>A(t(e._1),e._2),second:Fn.map,Profunctor0:()=>On}))();var Kr=t=>{let e=t.identity,n=t.Semigroupoid0(),r=t.Semigroupoid0();return o=>a=>i=>n.compose(r.compose(o.second(i))(o.first(a)))(o.Profunctor0().dimap(hd)(u=>A(u,u))(e))};var yd=Kr(Qr)(Se);var wa=t=>e=>n=>r=>{let o=yd(t)(e);return a=>r.Profunctor0().dimap(o)(i=>{if(i._2.tag==="Left")return i._2._1;if(i._2.tag==="Right")return i._1(i._2._1);s()})(n.second(r.right(a)))};var Wa=function(t){return t.join("")},qa=function(t){return t.split("")},Un=function(t){return t};var va=(t,e,n)=>{let r=new Set(t[n].map(a=>e[a])),o=0;for(;r.has(o);)o++;return e[n]=o,o},en=t=>e=>{let n=new Array(e.length);n.fill(-1);for(let r of e)va(t,n,r);return e.map(r=>({vertex:r,color:n[r]}))},Cd=(t,e)=>{let n=null;for(let r=0;r<t.length;r++)e[r]===-1&&(degree=t[r].length,saturation=new Set(t[r].map(o=>e[o])).size,(n===null||n.saturation<saturation||n.saturation===saturation&&n.degree<degree)&&(n={vertex:r,saturation,degree}));return n.vertex},za=t=>{let e=new Array(t.length),n=[];e.fill(-1);for(let r=0;r<t.length;r++){let o=Cd(t,e),a=va(t,e,o);n.push({vertex:o,color:a})}return n},Oa=t=>e=>{let n=[],r=0,o=new Array(t.length);for(o.fill(!1);n.length<t.length;){let a=new Array(t.length);a.fill(!1);for(let i of e)if(!(o[i]||a[i])){n.push({vertex:i,color:r}),o[i]=!0;for(let u of t[i])a[u]=!0}r++}return n};var Ga=t=>t.length===0?[]:Oa(t)(qn(he($t))(e=>{let n=Gt(t)(e);return n.tag==="Just"?m("Just",-n._1.length):l})((()=>{let e=t.length-1|0;return 0>e?[]:Wt(0)(e)})())),Ua=t=>t.length===0?[]:en(t)(qn(he($t))(e=>{let n=Gt(t)(e);return n.tag==="Just"?m("Just",-n._1.length):l})((()=>{let e=t.length-1|0;return 0>e?[]:Wt(0)(e)})())),Ba=t=>t.length===0?[]:en(t)((()=>{let e=t.length-1|0;return 0>e?[]:Wt(0)(e)})());var Xr={foldrWithIndex:t=>e=>{let n=ue(o=>{let a=o._1,i=o._2;return u=>t(a)(i)(u)})(e),r=lt(Jt);return o=>n(r(o))},foldlWithIndex:t=>e=>{let n=Qt(o=>a=>t(a._1)(o)(a._2))(e),r=lt(Jt);return o=>n(r(o))},foldMapWithIndex:t=>{let e=t.mempty;return n=>Xr.foldrWithIndex(r=>o=>a=>t.Semigroup0().append(n(r)(o))(a))(e)},Foldable0:()=>bt};var Bn={};function kn(t,e,n,r){return n in r?e(r[n]):t}function Ha(t){return function(e){var n=[];for(var r in e)hasOwnProperty.call(e,r)&&n.push(t(r)(e[r]));return n}}var dm=Object.keys||Ha(function(t){return function(){return t}});var to=t=>e=>{let n={...e};return t(n)(),n};function it(t){return t}function jn(t){return JSON.stringify(t)}function $e(t,e,n,r,o,a,i){return i==null?t():typeof i=="boolean"?e(i):typeof i=="number"?n(i):typeof i=="string"?r(i):Object.prototype.toString.call(i)==="[object Array]"?o(i):a(i)}var rt=(t,e,n)=>({tag:t,_1:e,_2:n});var ja=t=>e=>rt("AtIndex",t,e),eo=t=>e=>rt("AtKey",t,e),Va=t=>e=>rt("Named",t,e),no=rt("MissingValue");var oo=isFinite;var Qa=Math.cos;var Re=Math.floor;var Vn=Math.sin,on=Math.sqrt;var Ka=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},It=function(t){return t};var ao=Ka(I)(l),io=t=>{if(!oo(t))return 0;if(t>=It(2147483647))return 2147483647;if(t<=It(-2147483648))return-2147483648;let e=ao(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;s()};var ot=(t,e,n)=>({tag:t,_1:e,_2:n});var Et=ot("Nil");var ti=(()=>(e=>n=>{let r=e,o=n,a=!0,i;for(;a;){let u=r,f=o;if(f.tag==="Nil"){a=!1,i=u;continue}if(f.tag==="Cons"){r=ot("Cons",f._1,u),o=f._2;continue}s()}return i})(Et))();var sn=function(t){throw new Error(t)};var Zn=(t,e,n,r)=>({tag:"KickUp",_1:t,_2:e,_3:n,_4:r}),pt=(t,e,n,r,o,a,i,u)=>({tag:t,_1:e,_2:n,_3:r,_4:o,_5:a,_6:i,_7:u}),un=(t,e,n,r,o,a,i)=>({tag:t,_1:e,_2:n,_3:r,_4:o,_5:a,_6:i});var we=pt("Leaf");var lo=t=>e=>r=>{let o=r,a=!0,i;for(;a;){let u=o;if(u.tag==="Leaf"){a=!1,i=l;continue}if(u.tag==="Two"){let f=t.compare(e)(u._2);if(f==="EQ"){a=!1,i=m("Just",u._3);continue}if(f==="LT"){o=u._1;continue}o=u._4;continue}if(u.tag==="Three"){let f=t.compare(e)(u._2);if(f==="EQ"){a=!1,i=m("Just",u._3);continue}let d=t.compare(e)(u._5);if(d==="EQ"){a=!1,i=m("Just",u._6);continue}if(f==="LT"){o=u._1;continue}if(d==="GT"){o=u._7;continue}o=u._4;continue}s()}return i};var dn=t=>e=>n=>{let r=t,o=e,a=n,i=!0,u;for(;i;){let f=r,d=o,$=a;if(d.tag==="Nil"){i=!1,u=$;continue}if(d.tag==="Cons"){if(d._1.tag==="TwoLeft"){r=f,o=d._2,a=pt("Two",$,d._1._1,d._1._2,d._1._3);continue}if(d._1.tag==="TwoRight"){r=f,o=d._2,a=pt("Two",d._1._1,d._1._2,d._1._3,$);continue}if(d._1.tag==="ThreeLeft"){r=f,o=d._2,a=pt("Three",$,d._1._1,d._1._2,d._1._3,d._1._4,d._1._5,d._1._6);continue}if(d._1.tag==="ThreeMiddle"){r=f,o=d._2,a=pt("Three",d._1._1,d._1._2,d._1._3,$,d._1._4,d._1._5,d._1._6);continue}if(d._1.tag==="ThreeRight"){r=f,o=d._2,a=pt("Three",d._1._1,d._1._2,d._1._3,d._1._4,d._1._5,d._1._6,$);continue}}s()}return u},tr=t=>e=>n=>{let r=a=>i=>{let u=a,f=i,d=!0,$;for(;d;){let p=u,c=f;if(p.tag==="Nil"){d=!1,$=pt("Two",c._1,c._2,c._3,c._4);continue}if(p.tag==="Cons"){if(p._1.tag==="TwoLeft"){d=!1,$=dn(t)(p._2)(pt("Three",c._1,c._2,c._3,c._4,p._1._1,p._1._2,p._1._3));continue}if(p._1.tag==="TwoRight"){d=!1,$=dn(t)(p._2)(pt("Three",p._1._1,p._1._2,p._1._3,c._1,c._2,c._3,c._4));continue}if(p._1.tag==="ThreeLeft"){u=p._2,f=Zn(pt("Two",c._1,c._2,c._3,c._4),p._1._1,p._1._2,pt("Two",p._1._3,p._1._4,p._1._5,p._1._6));continue}if(p._1.tag==="ThreeMiddle"){u=p._2,f=Zn(pt("Two",p._1._1,p._1._2,p._1._3,c._1),c._2,c._3,pt("Two",c._4,p._1._4,p._1._5,p._1._6));continue}if(p._1.tag==="ThreeRight"){u=p._2,f=Zn(pt("Two",p._1._1,p._1._2,p._1._3,p._1._4),p._1._5,p._1._6,pt("Two",c._1,c._2,c._3,c._4));continue}}s()}return $};return(a=>i=>{let u=a,f=i,d=!0,$;for(;d;){let p=u,c=f;if(c.tag==="Leaf"){d=!1,$=r(p)(Zn(we,e,n,we));continue}if(c.tag==="Two"){let y=t.compare(e)(c._2);if(y==="EQ"){d=!1,$=dn(t)(p)(pt("Two",c._1,e,n,c._4));continue}if(y==="LT"){u=ot("Cons",un("TwoLeft",c._2,c._3,c._4),p),f=c._1;continue}u=ot("Cons",un("TwoRight",c._1,c._2,c._3),p),f=c._4;continue}if(c.tag==="Three"){let y=t.compare(e)(c._2);if(y==="EQ"){d=!1,$=dn(t)(p)(pt("Three",c._1,e,n,c._4,c._5,c._6,c._7));continue}let O=t.compare(e)(c._5);if(O==="EQ"){d=!1,$=dn(t)(p)(pt("Three",c._1,c._2,c._3,c._4,e,n,c._7));continue}if(y==="LT"){u=ot("Cons",un("ThreeLeft",c._2,c._3,c._4,c._5,c._6,c._7),p),f=c._1;continue}if(y==="GT"&&O==="LT"){u=ot("Cons",un("ThreeMiddle",c._1,c._2,c._3,c._5,c._6,c._7),p),f=c._4;continue}u=ot("Cons",un("ThreeRight",c._1,c._2,c._3,c._4,c._5,c._6),p),f=c._7;continue}s()}return $})(Et)};var nr=function(t){return function(e){return t+e}};var Ph=typeof Array.from=="function",wh=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",Jh=typeof String.prototype.fromCodePoint=="function",Wh=typeof String.prototype.codePointAt=="function";var rr={traverseWithIndex:t=>{let e=rr.Traversable2().sequence(t);return n=>{let r=rr.FunctorWithIndex0().mapWithIndex(n);return o=>e(r(o))}},FunctorWithIndex0:()=>ia,FoldableWithIndex1:()=>Xr,Traversable2:()=>Qe};var ec=(()=>rr.traverseWithIndex(Bo))();var nc=t=>{let e=$e(n=>l,n=>l,n=>l,n=>l,I,n=>l,t);if(e.tag==="Nothing")return D("Left",rt("TypeMismatch","Array"));if(e.tag==="Just")return D("Right",e._1);s()};var or=t=>{let e=$e(n=>D("Left",rt("TypeMismatch","Number")),n=>D("Left",rt("TypeMismatch","Number")),Dt,n=>D("Left",rt("TypeMismatch","Number")),n=>D("Left",rt("TypeMismatch","Number")),n=>D("Left",rt("TypeMismatch","Number")),t);if(e.tag==="Left")return D("Left",e._1);if(e.tag==="Right"){let n=ao(e._1);if(n.tag==="Nothing")return D("Left",rt("TypeMismatch","Integer"));if(n.tag==="Just")return D("Right",n._1)}s()};var Je=t=>{let e=Va("Array"),n=ec(r=>{let o=ja(r);return a=>{let i=t(a);if(i.tag==="Left")return D("Left",o(i._1));if(i.tag==="Right")return D("Right",i._1);s()}});return r=>{let o=nc(r);if(o.tag==="Left")return D("Left",o._1);if(o.tag==="Right"){let a=n(o._1);if(a.tag==="Left")return D("Left",e(a._1));if(a.tag==="Right")return D("Right",a._1)}s()}},$o=t=>e=>n=>{let r=Je(Dt)(n);return(()=>{if(r.tag==="Left"){let o=r._1;return a=>D("Left",o)}if(r.tag==="Right"){let o=r._1;return a=>a(o)}s()})()(o=>{if(o.length===2){let a=t(o[0]);if(a.tag==="Left")return D("Left",a._1);if(a.tag==="Right"){let i=e(o[1]);if(i.tag==="Left")return D("Left",i._1);if(i.tag==="Right")return D("Right",A(a._1,i._1))}s()}return D("Left",rt("TypeMismatch","Tuple"))})};function ft(t,e,n){return t==null?e:n(t)}function ar(t,e,n,r){if(typeof window<"u"){var o=window[n];if(o!=null&&r instanceof o)return e(r)}for(var a=r;a!=null;){var i=Object.getPrototypeOf(a),u=i.constructor.name;if(u===n)return e(r);if(u==="Object")return t;a=i}return t}var ir=function(t){return function(e){return e[t]}},rc=ir("namespaceURI"),oc=ir("prefix"),n_=ir("localName"),r_=ir("tagName");function ui(t){return function(){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}}function be(t){return t.currentTarget}function di(t){return t.type}function fo(t){return function(){return t.stopPropagation()}}var We=function(){return window};function mo(t){return function(){return t.document}}function go(t){return function(){return t.localStorage}}function $i(t){return function(e){return function(){return e.getItem(t)}}}function pi(t){return function(e){return function(n){return function(){n.setItem(t,e)}}}}var fi=t=>{let e=$i(t);return n=>{let r=e(n);return()=>{let o=r();return ft(o,l,I)}}};function mi(t){return t.clientX}function gi(t){return t.clientY}var hi=t=>e=>n=>t.MonadEffect0().liftEffect((()=>{let r=pi(e)(n);return()=>{let o=We(),a=go(o)();return r(a)()}})()),yi=t=>e=>t.MonadEffect0().liftEffect((()=>{let n=fi(e);return()=>{let r=We(),o=go(r)();return n(o)()}})()),ln=t=>e=>t===0?[]:U(e)((()=>{let n=t-1|0;return 0>n?[]:Wt(0)(n)})()),$n=t=>{let e=100*Vn(It(t+1|0));return e-Re(e)},ho=t=>{let e=ft(be(t),l,I),n=(()=>{if(e.tag==="Just")return ar(l,I,"Element",e._1);if(e.tag==="Nothing")return l;s()})();if(n.tag==="Just"){let r=ui(n._1);return()=>{let o=r();return m("Just",{x:(It(mi(t))-o.left)/o.width,y:(It(gi(t))-o.top)/o.height})}}return()=>l};var Te=(t,e)=>({tag:"Edge",_1:t,_2:e}),_i=Na(bt),dc=Wn(bt);var _o={eq:t=>e=>t._1===e._1&&t._2===e._2||t._1===e._2&&e._1===t._2},Di={encodeJson:t=>[It(t._1),It(t._2)]},bi={decodeJson:t=>{let e=$o(or)(or)(t);return(()=>{if(e.tag==="Left"){let n=e._1;return r=>D("Left",n)}if(e.tag==="Right"){let n=e._1;return r=>r(n)}s()})()(n=>D("Right",Te(n._1,n._2)))}},Ti=t=>ue(e=>{let n=e._1,r=e._2,o=_i([n])(i=>Ze(i)(r)),a=_i([r])(i=>Ze(i)(n));return i=>o(a(i))})(U(e=>[])(t.layout))(t.edges),Do=t=>e=>({...e,layout:(()=>{let n=Aa(t)(e.layout);if(n.tag==="Nothing")return e.layout;if(n.tag==="Just")return n._1;s()})(),edges:vn(n=>n._1===t||n._2===t?l:m("Just",Te(n._1>t?n._1-1|0:n._1,n._2>t?n._2-1|0:n._2)))(e.edges)}),Mi=t=>e=>n=>({...n,edges:wn(r=>!(r._1===t&&r._2===e||r._1===e&&t===r._2))(n.edges)}),Ei=t=>e=>n=>({...n,layout:dc([A(t,e)])(n.layout)});var Ci=t=>e=>{let n=Gt(t.layout)(e._1);if(n.tag==="Just"){let r=Gt(t.layout)(e._2);if(r.tag==="Just")return m("Just",{x1:n._1.x,x2:r._1.x,y1:n._1.y,y2:r._1.y});if(r.tag==="Nothing")return l;s()}if(n.tag==="Nothing")return l;s()},Li={layout:ln(100)(t=>({x:$n(t*2|0),y:$n((t*2|0)+1|0)})),edges:wn(t=>t._1!==t._2)(ln(1e3)(t=>Te(io(Re(100*$n(t*2|0))),io(Re(100*$n((t*2|0)+1|0))))))},xi=t=>e=>({...e,layout:Ze(e.layout)(t)}),Ni=t=>e=>n=>({...n,edges:t===e||Fe(_o)(Te(t,e))(n.edges)?n.edges:Ze(n.edges)(Te(t,e))});var Me=(t,e)=>({tag:t,_1:e}),pn=(t,e)=>({tag:t,_1:e}),dr=t=>t,cc=Wn(bt);var fn=dr("MoveMode"),Ai=dr("VertexMode"),cr=dr("AddEMode"),Ii=dr("DeleteMode"),qe=pn("NoDialog");var lr=Me("Alphabetical"),Fi=Me("DecreasingDegree"),Si=Me("WelshPowell"),Ri=Me("DSatur");var Pi={eq:t=>e=>t==="MoveMode"?e==="MoveMode":t==="VertexMode"?e==="VertexMode":t==="AddEMode"?e==="AddEMode":t==="DeleteMode"&&e==="DeleteMode"},wi=t=>m("Just",U(e=>zn(e)-65|0)(qa(t))),Xt=t=>{let e=Gt(t.graphs)(t.selectedGraphIdx);if(e.tag==="Nothing")return{layout:[],edges:[]};if(e.tag==="Just")return e._1;s()},Ji=t=>e=>{let n=Ti(t);if(e.tag==="Alphabetical")return Ba(n);if(e.tag==="DecreasingDegree")return Ua(n);if(e.tag==="DSatur")return za(n);if(e.tag==="WelshPowell")return Ga(n);if(e.tag==="CustomAlgorithm")return en(n)(e._1);s()},Wi=t=>{let e=jr(Xt(t).layout.length)(-1),n=Gt(t.results)(t.selectedResultIndex);if(n.tag==="Just")return cc(U(r=>A(r.vertex,r.color))(t.currentStep<1?[]:Ke(0)(t.currentStep)(n._1.coloring)))(e);if(n.tag==="Nothing")return e;s()},bo=(()=>{let t=U(e=>{let n=e+65|0;return n>=0&&n<=65535?m("Just",tn(n)):l});return e=>Wa(vn(n=>n)(t(e)))})();var qi=t=>Un((()=>{let e=t+65|0;return e>=0&&e<=65535?tn(e):"A"})()),vi={selectedAlgorithm:lr,results:[],currentStep:0,selectedResultIndex:0,graphs:jr(4)({layout:[],edges:[]}),selectedGraphIdx:0,editmode:fn,selectedVertex:l,currentPosition:l,dialog:qe},zi=t=>{if(t.tag==="Alphabetical")return"Alphab\xE9tique";if(t.tag==="DecreasingDegree")return"Degr\xE9 d\xE9croissant";if(t.tag==="WelshPowell")return"Welsh and Powell";if(t.tag==="DSatur")return"DSatur";if(t.tag==="CustomAlgorithm")return bo(t._1);s()},Oi=t=>e=>wa(n=>r=>({...n,graphs:(()=>{let o=xa(n.selectedGraphIdx)(r)(n.graphs);if(o.tag==="Nothing")return n.graphs;if(o.tag==="Just")return o._1;s()})()}))(n=>{let r=Gt(n.graphs)(n.selectedGraphIdx);if(r.tag==="Nothing")return D("Left",n);if(r.tag==="Just")return D("Right",r._1);s()})(t)(e);var z=(t,e,n)=>({tag:t,_1:e,_2:n});var Gi=t=>e=>z("SelectVertex",t,e);var Ui=t=>e=>z("DeleteVertex",t,e);var To=z("DropOrLeave");var Bi=z("ClearGraph"),ki=z("AdjustGraph"),Hi=z("GenBigGraph"),ji=t=>z("SetGraph",t),Vi=t=>z("SetAlgo",t),Qi=t=>z("CustomAlgoTextChange",t);var Ki=z("Save"),Yi=z("Load"),Xi=z("OpenImportDialog"),Zi=z("Export"),ts=t=>z("ChangeImportText",t),es=z("ImportAndClose"),Mo=z("CloseDialog"),ns=z("Compute"),rs=z("PreviousStep"),os=z("NextStep"),as=z("FinishColoring");var Zt=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var is=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){n=!1,r=l;continue}e=Zt(ti(o._2),Et);continue}if(o._1.tag==="Cons"){n=!1,r=m("Just",A(o._1._1,Zt(o._1._2,o._2)));continue}s()}return r};var fe=(t,e,n)=>({tag:t,_1:e,_2:n}),mt=fe("CatNil");var $c=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return fe("CatCons",t._1,Zt(t._2._1,ot("Cons",e,t._2._2)));s()},pc=t=>e=>n=>{let r=a=>i=>u=>{let f=a,d=i,$=u,p=!0,c;for(;p;){let y=f,O=d,tt=$;if(tt.tag==="Nil"){p=!1,c=O;continue}if(tt.tag==="Cons"){f=y,d=y(O)(tt._1),$=tt._2;continue}s()}return c};return(a=>i=>{let u=a,f=i,d=!0,$;for(;d;){let p=u,c=f,y=is(p);if(y.tag==="Nothing"){d=!1,$=r(O=>tt=>tt(O))(e)(c);continue}if(y.tag==="Just"){u=y._1._2,f=ot("Cons",t(y._1._1),c);continue}s()}return $})(n)(Et)},us=t=>{if(t.tag==="CatNil")return l;if(t.tag==="CatCons")return m("Just",A(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?mt:pc($c)(mt)(t._2)));s()};var qt=t=>e=>{if(t.tag==="CatNil")return fe("CatCons",e,Zt(Et,Et));if(t.tag==="CatCons")return fe("CatCons",t._1,Zt(t._2._1,ot("Cons",fe("CatCons",e,Zt(Et,Et)),t._2._2)));s()};var k=(t,e)=>({tag:"Free",_1:t,_2:e}),ht=(t,e,n)=>({tag:t,_1:e,_2:n});var fc=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Return"){let a=us(o._2);if(a.tag==="Nothing"){n=!1,r=ht("Return",o._1._1);continue}if(a.tag==="Just"){e=(()=>{let i=a._1._1(o._1._1);return k(i._1,(()=>{if(i._2.tag==="CatNil")return a._1._2;if(a._1._2.tag==="CatNil")return i._2;if(i._2.tag==="CatCons")return fe("CatCons",i._2._1,Zt(i._2._2._1,ot("Cons",a._1._2,i._2._2._2)));s()})())})();continue}s()}if(o._1.tag==="Bind"){n=!1,r=ht("Bind",o._1._1,a=>{let i=o._1._2(a);return k(i._1,(()=>{if(i._2.tag==="CatNil")return o._2;if(o._2.tag==="CatNil")return i._2;if(i._2.tag==="CatCons")return fe("CatCons",i._2._1,Zt(i._2._2._1,ot("Cons",o._2,i._2._2._2)));s()})())});continue}s()}return r},ds=t=>e=>{let n=e.Monad0(),r=n.Bind1().Apply0().Functor0();return o=>e.tailRecM(a=>{let i=fc(a);if(i.tag==="Return")return r.map(Ho)(n.Applicative0().pure(i._1));if(i.tag==="Bind")return r.map(Ur)(o(t.map(i._2)(i._1)));s()})};var cs={Applicative0:()=>pr,Bind1:()=>Lo},ls={map:t=>e=>Lo.bind(e)(n=>pr.pure(t(n)))},Lo={bind:t=>e=>k(t._1,qt(t._2)(e)),Apply0:()=>xo},xo={apply:t=>e=>k(t._1,qt(t._2)(n=>k(e._1,qt(e._2)(r=>pr.pure(n(r)))))),Functor0:()=>ls},pr={pure:t=>k(ht("Return",t),mt),Apply0:()=>xo};var Ao={gDecodeJson:t=>e=>D("Right",{})};var Io=t=>()=>({decodeJson:e=>{let n=$e(r=>l,r=>l,r=>l,r=>l,r=>l,I,e);if(n.tag==="Just")return t.gDecodeJson(n._1)(K);if(n.tag==="Nothing")return D("Left",rt("TypeMismatch","Object"));s()}});var fr=t=>e=>n=>()=>()=>({gDecodeJson:r=>o=>{let a=n.reflectSymbol(K),i=t.decodeJsonField(kn(l,I,a,r));if(i.tag==="Just"){let u=eo(a);if(i._1.tag==="Left")return D("Left",u(i._1._1));if(i._1.tag==="Right"){let f=i._1._1,d=e.gDecodeJson(r)(K);return(()=>{if(d.tag==="Left"){let $=d._1;return p=>D("Left",$)}if(d.tag==="Right"){let $=d._1;return p=>p($)}s()})()($=>D("Right",Ae(n.reflectSymbol(K))(f)($)))}s()}if(i.tag==="Nothing")return D("Left",rt("AtKey",a,no));s()}});var Fo={gEncodeJson:t=>e=>Bn};var So={encodeJson:it};var mr=t=>({encodeJson:(()=>{let e=U(t.encodeJson);return n=>e(n)})()});var mn=t=>e=>n=>()=>({gEncodeJson:r=>o=>{let a=n.reflectSymbol(K),i=t.encodeJson(oe(n.reflectSymbol(K))(r));return to(u=>()=>(u[a]=i,u))(e.gEncodeJson(r)(K))}});function gr(t,e,n){try{return e(JSON.parse(n))}catch(r){return t(r.message)}}var $s=(()=>({left:t=>e=>{if(e.tag==="Left")return D("Left",t(e._1));if(e.tag==="Right")return D("Right",e._1);s()},right:He.map,Profunctor0:()=>On}))();var vt=function(){var t={},e="Pure",n="Throw",r="Catch",o="Sync",a="Async",i="Bind",u="Bracket",f="Fork",d="Sequential",$="Map",p="Apply",c="Alt",y="Cons",O="Resume",tt="Release",Ct="Finalizer",L="Finalized",H="Forked",Ft="Fiber",St="Thunk";function _(b,W,Y,v){this.tag=b,this._1=W,this._2=Y,this._3=v}function st(b){var W=function(Y,v,M){return new _(b,Y,v,M)};return W.tag=b,W}function re(b){return new _(e,void 0)}function Ar(b){try{b()}catch(W){setTimeout(function(){throw W},0)}}function Oe(b,W,Y){try{return W(Y())}catch(v){return b(v)}}function tu(b,W,Y){try{return W(Y)()}catch(v){return Y(b(v))(),re}}var _n=function(){var b=1024,W=0,Y=0,v=new Array(b),M=!1;function g(){var q;for(M=!0;W!==0;)W--,q=v[Y],v[Y]=void 0,Y=(Y+1)%b,q();M=!1}return{isDraining:function(){return M},enqueue:function(q){var F,Q;W===b&&(Q=M,g(),M=Q),v[(Y+W)%b]=q,W++,M||g()}}}();function eu(b){var W={},Y=0,v=0;return{register:function(M){var g=Y++;M.onComplete({rethrow:!0,handler:function(q){return function(){v--,delete W[g]}}})(),W[g]=M,v++},isEmpty:function(){return v===0},killAll:function(M,g){return function(){if(v===0)return g();var q=0,F={};function Q(G){F[G]=W[G].kill(M,function(et){return function(){delete F[G],q--,b.isLeft(et)&&b.fromLeft(et)&&setTimeout(function(){throw b.fromLeft(et)},0),q===0&&g()}})()}for(var gt in W)W.hasOwnProperty(gt)&&(q++,Q(gt));return W={},Y=0,v=0,function(G){return new _(o,function(){for(var et in F)F.hasOwnProperty(et)&&F[et]()})}}}}}var Ne=0,Nt=1,Dn=2,bn=3,Tn=4,Rt=5,Ge=6;function Ir(b,W,Y){var v=0,M=Ne,g=Y,q=null,F=null,Q=null,gt=null,G=null,et=0,ge=0,Ot=null,de=!0;function ce(E){for(var C,R,J;;)switch(C=null,R=null,J=null,M){case Dn:M=Nt;try{g=Q(g),gt===null?Q=null:(Q=gt._1,gt=gt._2)}catch(_t){M=Rt,q=b.left(_t),g=null}break;case bn:b.isLeft(g)?(M=Rt,q=g,g=null):Q===null?M=Rt:(M=Dn,g=b.fromRight(g));break;case Nt:switch(g.tag){case i:Q&&(gt=new _(y,Q,gt)),Q=g._2,M=Nt,g=g._1;break;case e:Q===null?(M=Rt,g=b.right(g._1)):(M=Dn,g=g._1);break;case o:M=bn,g=Oe(b.left,b.right,g._1);break;case a:M=Tn,g=tu(b.left,g._1,function(_t){return function(){v===E&&(v++,_n.enqueue(function(){v===E+1&&(M=bn,g=_t,ce(v))}))}});return;case n:M=Rt,q=b.left(g._1),g=null;break;case r:Q===null?G=new _(y,g,G,F):G=new _(y,g,new _(y,new _(O,Q,gt),G,F),F),Q=null,gt=null,M=Nt,g=g._1;break;case u:et++,Q===null?G=new _(y,g,G,F):G=new _(y,g,new _(y,new _(O,Q,gt),G,F),F),Q=null,gt=null,M=Nt,g=g._1;break;case f:M=bn,C=Ir(b,W,g._2),W&&W.register(C),g._1&&C.run(),g=b.right(C);break;case d:M=Nt,g=ru(b,W,g._1);break}break;case Rt:if(Q=null,gt=null,G===null)M=Ge,g=F||q||g;else switch(C=G._3,J=G._1,G=G._2,J.tag){case r:F&&F!==C&&et===0?M=Rt:q&&(M=Nt,g=J._2(b.fromLeft(q)),q=null);break;case O:F&&F!==C&&et===0||q?M=Rt:(Q=J._1,gt=J._2,M=Dn,g=b.fromRight(g));break;case u:et--,q===null&&(R=b.fromRight(g),G=new _(y,new _(tt,J._2,R),G,C),(F===C||et>0)&&(M=Nt,g=J._3(R)));break;case tt:G=new _(y,new _(L,g,q),G,F),M=Nt,F&&F!==C&&et===0?g=J._1.killed(b.fromLeft(F))(J._2):q?g=J._1.failed(b.fromLeft(q))(J._2):g=J._1.completed(b.fromRight(g))(J._2),q=null,et++;break;case Ct:et++,G=new _(y,new _(L,g,q),G,F),M=Nt,g=J._1;break;case L:et--,M=Rt,g=J._1,q=J._2;break}break;case Ge:for(var Z in Ot)Ot.hasOwnProperty(Z)&&(de=de&&Ot[Z].rethrow,Ar(Ot[Z].handler(g)));Ot=null,F&&q?setTimeout(function(){throw b.fromLeft(q)},0):b.isLeft(g)&&de&&setTimeout(function(){if(de)throw b.fromLeft(g)},0);return;case Ne:M=Nt;break;case Tn:return}}function X(E){return function(){if(M===Ge)return de=de&&E.rethrow,E.handler(g)(),function(){};var C=ge++;return Ot=Ot||{},Ot[C]=E,function(){Ot!==null&&delete Ot[C]}}}function x(E,C){return function(){if(M===Ge)return C(b.right(void 0))(),function(){};var R=X({rethrow:!1,handler:function(){return C(b.right(void 0))}})();switch(M){case Ne:F=b.left(E),M=Ge,g=F,ce(v);break;case Tn:F===null&&(F=b.left(E)),et===0&&(M===Tn&&(G=new _(y,new _(Ct,g(E)),G,F)),M=Rt,g=null,q=null,ce(++v));break;default:F===null&&(F=b.left(E)),et===0&&(M=Rt,g=null,q=null)}return R}}function S(E){return function(){var C=X({rethrow:!1,handler:E})();return M===Ne&&ce(v),C}}return{kill:x,join:S,onComplete:X,isSuspended:function(){return M===Ne},run:function(){M===Ne&&(_n.isDraining()?ce(v):_n.enqueue(function(){ce(v)}))}}}function nu(b,W,Y,v){var M=0,g={},q=0,F={},Q=new Error("[ParAff] Early exit"),gt=null,G=t;function et(X,x,S){var E=x,C=null,R=null,J=0,Z={},_t,Ue;t:for(;;)switch(_t=null,E.tag){case H:if(E._3===t&&(_t=g[E._1],Z[J++]=_t.kill(X,function(ou){return function(){J--,J===0&&S(ou)()}})),C===null)break t;E=C._2,R===null?C=null:(C=R._1,R=R._2);break;case $:E=E._2;break;case p:case c:C&&(R=new _(y,C,R)),C=E,E=E._1;break}if(J===0)S(b.right(void 0))();else for(Ue=0,_t=J;Ue<_t;Ue++)Z[Ue]=Z[Ue]();return Z}function ge(X,x,S){var E,C,R,J,Z,_t;for(b.isLeft(X)?(E=X,C=null):(C=X,E=null);;){if(R=null,J=null,Z=null,_t=null,gt!==null)return;if(x===null){v(E||C)();return}if(x._3!==t)return;switch(x.tag){case $:E===null?(x._3=b.right(x._1(b.fromRight(C))),C=x._3):x._3=E;break;case p:if(R=x._1._3,J=x._2._3,E){if(x._3=E,Z=!0,_t=q++,F[_t]=et(Q,E===R?x._2:x._1,function(){return function(){delete F[_t],Z?Z=!1:S===null?ge(E,null,null):ge(E,S._1,S._2)}}),Z){Z=!1;return}}else{if(R===t||J===t)return;C=b.right(b.fromRight(R)(b.fromRight(J))),x._3=C}break;case c:if(R=x._1._3,J=x._2._3,R===t&&b.isLeft(J)||J===t&&b.isLeft(R))return;if(R!==t&&b.isLeft(R)&&J!==t&&b.isLeft(J))E=C===R?J:R,C=null,x._3=E;else if(x._3=C,Z=!0,_t=q++,F[_t]=et(Q,C===R?x._2:x._1,function(){return function(){delete F[_t],Z?Z=!1:S===null?ge(C,null,null):ge(C,S._1,S._2)}}),Z){Z=!1;return}break}S===null?x=null:(x=S._1,S=S._2)}}function Ot(X){return function(x){return function(){delete g[X._1],X._3=x,ge(x,X._2._1,X._2._2)}}}function de(){var X=Nt,x=Y,S=null,E=null,C,R;t:for(;;)switch(C=null,R=null,X){case Nt:switch(x.tag){case $:S&&(E=new _(y,S,E)),S=new _($,x._1,t,t),x=x._2;break;case p:S&&(E=new _(y,S,E)),S=new _(p,t,x._2,t),x=x._1;break;case c:S&&(E=new _(y,S,E)),S=new _(c,t,x._2,t),x=x._1;break;default:R=M++,X=Rt,C=x,x=new _(H,R,new _(y,S,E),t),C=Ir(b,W,C),C.onComplete({rethrow:!1,handler:Ot(x)})(),g[R]=C,W&&W.register(C)}break;case Rt:if(S===null)break t;S._1===t?(S._1=x,X=Nt,x=S._2,S._2=t):(S._2=x,x=S,E===null?S=null:(S=E._1,E=E._2))}for(G=x,R=0;R<M;R++)g[R].run()}function ce(X,x){gt=b.left(X);var S;for(var E in F)if(F.hasOwnProperty(E)){S=F[E];for(E in S)S.hasOwnProperty(E)&&S[E]()}F=null;var C=et(X,G,x);return function(R){return new _(a,function(J){return function(){for(var Z in C)C.hasOwnProperty(Z)&&C[Z]();return re}})}}return de(),function(X){return new _(a,function(x){return function(){return ce(X,x)}})}}function ru(b,W,Y){return new _(a,function(v){return function(){return nu(b,W,Y,v)}})}return _.EMPTY=t,_.Pure=st(e),_.Throw=st(n),_.Catch=st(r),_.Sync=st(o),_.Async=st(a),_.Bind=st(i),_.Bracket=st(u),_.Fork=st(f),_.Seq=st(d),_.ParMap=st($),_.ParApply=st(p),_.ParAlt=st(c),_.Fiber=Ir,_.Supervisor=eu,_.Scheduler=_n,_.nonCanceler=re,_}(),Ee=vt.Pure,xc=vt.Throw;function hr(t){return function(e){return e.tag===vt.Pure.tag?vt.Pure(t(e._1)):vt.Bind(e,function(n){return vt.Pure(t(n))})}}function zt(t){return function(e){return vt.Bind(t,e)}}var te=vt.Sync;var Nc=vt.Async;function yr(t,e){return function(){return vt.Fiber(t,null,e)}}var Ac=function(){function t(n,r){return n===0&&typeof setImmediate<"u"?setImmediate(r):setTimeout(r,n)}function e(n,r){return n===0&&typeof clearImmediate<"u"?clearImmediate(r):clearTimeout(r)}return function(n,r){return vt.Async(function(o){return function(){var a=t(r,o(n()));return function(){return vt.Sync(function(){return n(e(r,a))})}}})}}(),Ic=vt.Seq;var Fc={map:hr};var Ro={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;s()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return sn("unsafeFromLeft: Right");s()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return sn("unsafeFromRight: Left");s()},left:ye,right:Dt};var fs={Applicative0:()=>_r,Bind1:()=>Sc},Sc={bind:zt,Apply0:()=>ms},ms={apply:t=>e=>zt(t)(n=>zt(e)(r=>_r.pure(n(r)))),Functor0:()=>Fc},_r={pure:Ee,Apply0:()=>ms};var Dr={liftEffect:te,Monad0:()=>fs};var gs={tailRecM:t=>{let e=n=>zt(t(n))(r=>{if(r.tag==="Done")return Ee(r._1);if(r.tag==="Loop")return e(r._1);s()});return e},Monad0:()=>fs};var hs={liftAff:t=>t,MonadEffect0:()=>Dr};var ys=(()=>ta(bt)(Rn.compare))(),_s=(()=>In(bt)(Rn.compare))(),Gc=t=>{let e=ys(U(d=>d.y)(t)),n=(()=>{if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;s()})(),r=_s(U(d=>d.y)(t)),o=(()=>{if(r.tag==="Nothing")return 0;if(r.tag==="Just")return r._1;s()})(),a=ys(U(d=>d.x)(t)),i=(()=>{if(a.tag==="Nothing")return 0;if(a.tag==="Just")return a._1;s()})(),u=_s(U(d=>d.x)(t)),f=(()=>{if(u.tag==="Nothing")return 0;if(u.tag==="Just")return u._1;s()})();return U(d=>({x:.05+(d.x-i)*.9/(f-i),y:.05+(d.y-n)*.9/(o-n)}))(t)},Uc=(()=>3.141592653589793*(3-on(5)))(),Bc=t=>t===0?[]:U(e=>{let n=10*on(.5+It(e)),r=It(e)*Uc;return{x:n*Qa(r),y:n*Vn(r)}})((()=>{let e=t-1|0;return 0>e?[]:Wt(0)(e)})()),kc=t=>e=>n=>r=>lt(o=>a=>{let i=a.x,u=a.y,f=[...lt(d=>$=>{if(o===d)return{x:0,y:0};let p=(i-$.x)*(i-$.x)+(u-$.y)*(u-$.y),c=t/p,y=on(p);return{x:c*(i-$.x)/y,y:c*(u-$.y)/y}})(r),...lt(d=>$=>{if(!Fe(_o)(Te(o,d))(n))return{x:0,y:0};let p=on((i-$.x)*(i-$.x)+(u-$.y)*(u-$.y)),c=e*(1-p);return{x:c*(i-$.x)/p,y:c*(u-$.y)/p}})(r)];return{x:i+Qt(nr)(0)(U(d=>d.x)(f)),y:u+Qt(nr)(0)(U(d=>d.y)(f))}})(r),Ds=t=>e=>Gc(Qt(n=>r=>kc(.05)(.1)(e)(n))(Bc(t))(Wt(1)(300)));function br(t){return function(e){return t===e}}var ee=(t,e,n)=>({tag:t,_1:e,_2:n});var wo=t=>({liftEffect:e=>k(ht("Bind",ee("Lift",t.liftEffect(e)),n=>k(ht("Return",n),mt)),mt),Monad0:()=>cs});var Ts=t=>{let e=wo(t.MonadEffect0());return{liftAff:n=>k(ht("Bind",ee("Lift",t.liftAff(n)),r=>k(ht("Return",r),mt)),mt),MonadEffect0:()=>e}};var Tr=(()=>wo(Dr).liftEffect)(),j=t=>k(ht("Bind",ee("State",e=>A(void 0,t(e))),e=>k(ht("Return",e),mt)),mt),ne=Oi(Se)($s),Mr=k(ht("Bind",ee("State",t=>A(t,t)),t=>k(ht("Return",t),mt)),mt),Es=Ts(hs),Ls={reflectSymbol:()=>"y"},xs={reflectSymbol:()=>"x"},Ns={reflectSymbol:()=>"layout"},As={reflectSymbol:()=>"edges"},Is=(()=>{let t=mn(mr(Di))(mn(mr((()=>{let e=mn(So)(mn(So)(Fo)(Ls)())(xs)();return{encodeJson:n=>e.gEncodeJson(n)(K)}})()))(Fo)(Ns)())(As)();return{encodeJson:e=>t.gEncodeJson(e)(K)}})(),Qc=(()=>mr(Is).encodeJson)(),Cs=fr({decodeJsonField:t=>t.tag==="Just"?m("Just",$e(e=>D("Left",rt("TypeMismatch","Number")),e=>D("Left",rt("TypeMismatch","Number")),Dt,e=>D("Left",rt("TypeMismatch","Number")),e=>D("Left",rt("TypeMismatch","Number")),e=>D("Left",rt("TypeMismatch","Number")),t._1)):l}),Fs=Io(fr((()=>{let t=Je(bi.decodeJson);return{decodeJsonField:e=>e.tag==="Just"?m("Just",t(e._1)):l}})())(fr((()=>{let t=Je(Io(Cs(Cs(Ao)(Ls)()())(xs)()())().decodeJson);return{decodeJsonField:e=>e.tag==="Just"?m("Just",t(e._1)):l}})())(Ao)(Ns)()())(As)()())(),Kc=(()=>Je(Fs.decodeJson))(),Yc=(()=>In(bt)($t.compare))(),Xc=t=>e=>{let n=$t.compare(t)(e);if(n==="LT")return e;if(n==="EQ"||n==="GT")return t;s()},Zc=t=>e=>{let n=$t.compare(t)(e);if(n==="LT"||n==="EQ")return t;if(n==="GT")return e;s()};var Ss=t=>{if(t.tag==="AddVertex"){let e=Tr(ho(t._1));return k(e._1,qt(e._2)(n=>{if(n.tag==="Nothing")return k(ht("Return",void 0),mt);if(n.tag==="Just"){let r=n._1;return j(o=>o.editmode==="VertexMode"?{...ne(xi(r))(o),results:[],selectedResultIndex:0,currentStep:0}:o)}s()}))}if(t.tag==="SelectVertex"){let e=t._1,n=Tr(fo(t._2));return k(n._1,qt(n._2)(()=>j(r=>Fe(Pi)(r.editmode)([cr,fn])?{...r,selectedVertex:m("Just",e)}:r)))}if(t.tag==="GraphMove"){let e=Tr(ho(t._1));return k(e._1,qt(e._2)(n=>j(r=>{if(n.tag==="Just"){if(r.selectedVertex.tag==="Just"&&r.editmode==="MoveMode")return{...ne(Ei(r.selectedVertex._1)(n._1))(r),results:[],selectedResultIndex:0,currentStep:0};if(r.editmode==="AddEMode")return{...r,currentPosition:m("Just",n._1)}}return r})))}if(t.tag==="DropOrLeave")return j(e=>e.editmode==="AddEMode"?{...e,selectedVertex:l}:e);if(t.tag==="PointerUp"){let e=t._1;return j(n=>n.editmode==="MoveMode"?{...n,selectedVertex:l,currentPosition:l}:n.editmode==="AddEMode"&&n.selectedVertex.tag==="Just"?{...ne(Ni(e)(n.selectedVertex._1))(n),currentStep:0,results:[],selectedResultIndex:0,selectedVertex:l}:n)}if(t.tag==="DeleteVertex"){let e=t._2,n=t._1;return k(Mr._1,qt(Mr._2)(r=>{let o=Tr(fo(e));return r.editmode==="MoveMode"?k(o._1,qt(o._2)(()=>j(a=>a.editmode==="DeleteMode"?{...ne(Do(n))(a),results:[],selectedResultIndex:0,currentStep:0}:a))):k(ht("Return",void 0),qt(mt)(()=>j(a=>a.editmode==="DeleteMode"?{...ne(Do(n))(a),results:[],selectedResultIndex:0,currentStep:0}:a)))}))}if(t.tag==="DeleteEdge"){let e=t._1._1,n=t._1._2;return j(r=>r.editmode==="DeleteMode"?{...ne(Mi(e)(n))(r),results:[],selectedResultIndex:0,currentStep:0}:r)}if(t.tag==="ClearGraph")return j(e=>({...ne(n=>({layout:[],edges:[]}))(e),results:[],selectedResultIndex:0,currentStep:0}));if(t.tag==="GenBigGraph")return j(e=>({...ne(n=>Li)(e),results:[],selectedResultIndex:0,currentStep:0}));if(t.tag==="SetEditMode"){let e=t._1;return j(n=>({...n,editmode:e}))}if(t.tag==="AdjustGraph")return j(e=>ne(n=>({...n,layout:Ds(n.layout.length)(n.edges)}))(e));if(t.tag==="SetGraph"){let e=t._1;return j(n=>({...n,currentStep:0,results:[],selectedGraphIdx:(()=>e==="1"?0:e==="2"?1:e==="3"?2:e==="4"?3:0)(),selectedResultIndex:0}))}if(t.tag==="SetAlgo"){let e=t._1;return j(n=>({...n,selectedAlgorithm:(()=>e==="alpha"?lr:e==="decdegree"?Fi:e==="welsh"?Si:e==="dsatur"?Ri:e==="custom"?Me("CustomAlgorithm",(()=>{let r=Xt(n).layout.length-1|0;return 0>r?[]:Wt(0)(r)})()):lr)()}))}if(t.tag==="CustomAlgoTextChange"){let e=t._1;return j(n=>{let r=wi(e);if(r.tag==="Nothing")return n;if(r.tag==="Just")return{...n,selectedAlgorithm:Me("CustomAlgorithm",r._1)};s()})}if(t.tag==="SetResultIndex"){let e=t._1;return j(n=>({...n,selectedResultIndex:e,currentStep:0}))}if(t.tag==="Save")return k(Mr._1,qt(Mr._2)(e=>hi(Es)("coloring-graphs")(jn(Qc(e.graphs)))));if(t.tag==="Load"){let e=yi(Es)("coloring-graphs");return k(e._1,qt(e._2)(n=>{if(n.tag==="Nothing")return k(ht("Return",void 0),mt);if(n.tag==="Just"){let r=gr(ye,Dt,n._1);if(r.tag==="Left")return k(ht("Return",void 0),mt);if(r.tag==="Right"){let o=Kc(r._1);if(o.tag==="Left")return k(ht("Return",void 0),mt);if(o.tag==="Right"){let a=o._1;return j(i=>({...i,graphs:a}))}}}s()}))}if(t.tag==="OpenImportDialog")return j(e=>({...e,dialog:pn("ImportDialog","")}));if(t.tag==="ChangeImportText"){let e=t._1;return j(n=>({...n,dialog:pn("ImportDialog",e)}))}if(t.tag==="ImportAndClose")return j(e=>{if(e.dialog.tag==="ImportDialog"){let n=gr(ye,Dt,e.dialog._1);if(n.tag==="Left")return{...e,dialog:qe};if(n.tag==="Right"){let r=Fs.decodeJson(n._1);if(r.tag==="Left")return{...e,dialog:qe};if(r.tag==="Right"){let o=r._1;return{...ne(a=>o)(e),currentStep:0,dialog:qe,results:[],selectedResultIndex:0}}}s()}return e});if(t.tag==="Export")return j(e=>({...e,dialog:pn("ExportDialog",jn(Is.encodeJson(Xt(e))))}));if(t.tag==="CloseDialog")return j(e=>({...e,dialog:qe}));if(t.tag==="Compute")return j(e=>{let n=Ji(Xt(e))(e.selectedAlgorithm);return{...e,results:Ke(0)(5)([{algorithm:e.selectedAlgorithm,coloring:n,number:(()=>{let r=Yc(U(o=>o.color)(n));if(r.tag==="Nothing")return 1;if(r.tag==="Just")return 1+r._1|0;s()})()},...e.results])}});if(t.tag==="PreviousStep")return j(e=>({...e,currentStep:Xc(0)(e.currentStep-1|0)}));if(t.tag==="NextStep")return j(e=>({...e,currentStep:Zc(Xt(e).layout.length)(e.currentStep+1|0)}));if(t.tag==="FinishColoring")return j(e=>({...e,currentStep:Xt(e).layout.length}));s()};var el=(t,e,n,r=!1)=>{let o=[],a={},i={},u={},f={tag:t,children:n,props:a,attrs:i,events:u,node:null,keyed:r},d=e.length;for(let p=0;p<d;p++){let[c,y,O]=e[p];c===0?a[y]=O:c===1?i[y]=O:c===2?u[y]=O:c===3?i.class=i.class?i.class+" "+y:y:c===4&&o.push(y+":"+O)}let $=o.join(";");return $&&(i.style=$),f},N=(t,e,n)=>el(t,e,n.map(r=>({key:null,html:r})));var nl=t=>({tag:t,children:[],type:3});var at=(t,e)=>[0,t,e],B=(t,e)=>[1,t,e],yt=(t,e)=>[2,t,e],P=t=>[3,t],ve=[-1];var V=nl;var me=V("");var Wo=t=>e=>N("div",[P("p-6 bg-white border border-gray-200 rounded-lg shadow")],[N("div",[P("text-xl mb-2")],[V(t)]),...e]),Er="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700",Jo=(()=>Er+" rounded")(),Rs=t=>{let e=t.onClick;return N("button",[P(Jo),yt("click",n=>()=>m("Just",e)),...t.attrs],[V(t.name)])},qo=t=>e=>n=>N("div",[P("absolute w-full h-full flex items-center justify-center bg-transp-grey inset-0 z-50")],[N("div",[P("bg-white text-black rounded block border-2")],[N("div",[P("p-4 min-h-8 border-b-2")],[N("div",[P("text-4xl font-medium inline-block")],[V(t)])]),N("div",[P("p-6 border-b-2")],e),N("div",[P("p-4 text-right")],lt(r=>o=>{let a=o.onClick;return N("button",[P(r===0?Jo+"":Jo+" ml-4"),yt("click",i=>()=>m("Just",a))],[V(o.name)])})(n))])]),gn=t=>{let e=t.length;return N("div",[],lt(n=>r=>{let o=r.onClick;return N("button",[P((()=>n===0?Er+" rounded-l":n===(e-1|0)?Er+" rounded-r":Er+"")()),yt("click",a=>()=>m("Just",o)),...r.attrs],[V(r.name)])})(t))};var Cr=t=>e=>n=>r=>B("viewBox",ut(t)+" "+ut(e)+" "+ut(n)+" "+ut(r));var rl=t=>e=>N("line",[B("x1",ut(100*t.x)),B("y1",ut(100*t.y)),B("x2",ut(100*e.x)),B("y2",ut(100*e.y)),P("graphparams-graphview-edge pointer-events-none")],[]),Js=t=>{let e=t.editmode,n=Xt(t);return N("div",[],[N("div",[P("graphparams-graphview-board")],[N("svg",[P("block"),Cr(0)(0)(100)(100),yt("click",r=>()=>m("Just",z("AddVertex",r))),yt("pointerup",r=>()=>m("Just",To)),yt("pointerleave",r=>()=>m("Just",To)),yt("pointermove",r=>()=>m("Just",z("GraphMove",r)))],[N("g",[],U(r=>{let o=Ci(n)(r);if(o.tag==="Nothing")return me;if(o.tag==="Just")return N("line",[B("x1",ut(100*o._1.x1)),B("y1",ut(100*o._1.y1)),B("x2",ut(100*o._1.x2)),B("y2",ut(100*o._1.y2)),P("graphparams-graphview-edge"),e==="DeleteMode"?P("deletemode"):ve,yt("click",a=>()=>m("Just",z("DeleteEdge",r)))],[]);s()})(n.edges)),N("g",[],Jn(wr)(lt(r=>o=>{let a=o.x,i=o.y;return u=>N("circle",[B("cx",ut(100*a)),B("cy",ut(100*i)),B("r","4"),B("stroke-width","0.5"),P("graphparams-graphview-vertex color"+Vt(u)),e==="DeleteMode"?P("deletemode"):ve,(()=>{let f=Ui(r);return yt("click",d=>{let $=m("Just",f(d));return()=>$})})(),(()=>{let f=Gi(r);return yt("pointerdown",d=>{let $=m("Just",f(d));return()=>$})})(),yt("pointerup",f=>()=>m("Just",z("PointerUp",r)))],[])})(n.layout))(Wi(t))),Xt(t).layout.length<=26?N("g",[],lt(r=>o=>N("text",[P("pointer-events-none graphview-text"),B("x",ut(100*o.x-2)),B("y",ut(100*o.y+2))],[V(qi(r))]))(n.layout)):me,(()=>{if(e==="AddEMode"){let r=t.selectedVertex.tag==="Just"?Be.apply(t.currentPosition.tag==="Just"?m("Just",rl(t.currentPosition._1)):l)(Gt(n.layout)(t.selectedVertex._1)):l;if(r.tag==="Nothing")return me;if(r.tag==="Just")return r._1;s()}return me})()])]),gn([{name:"D\xE9placer",onClick:z("SetEditMode",fn),attrs:[at("selected",e==="MoveMode")]},{name:"Ajouter sommet",onClick:z("SetEditMode",Ai),attrs:[at("selected",e==="VertexMode")]},{name:"Ajouter ar\xEAte",onClick:z("SetEditMode",cr),attrs:[at("selected",e==="AddEMode")]},{name:"Retirer",onClick:z("SetEditMode",Ii),attrs:[at("selected",e==="DeleteMode")]},{name:"Tout effacer",onClick:Bi,attrs:[]},{name:"Ajuster",onClick:ki,attrs:[]},{name:"Gros graphe",onClick:Hi,attrs:[]}])])};var Ws=(t,e,n)=>typeof t.value=="string"?n(t.value):e;var hn=t=>yt("change",e=>{let n=ft(be(e),l,I);if(n.tag==="Just"){let r=n._1;return()=>{let o=Ws(r,l,I);return o.tag==="Just"?m("Just",t(o._1)):l}}if(n.tag==="Nothing")return()=>l;s()});var sl=t=>qo("Importer les graphes")([N("textarea",[P("block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"),B("cols","150"),B("rows","30"),at("value",t),hn(ts)],[])])([{name:"Annuler",onClick:Mo},{name:"OK",onClick:es}]),ul=t=>qo("Exporter les graphes")([N("textarea",[P("block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"),B("cols","150"),B("rows","30"),at("value",t),at("selected",!0)],[])])([{name:"OK",onClick:Mo}]),qs=t=>{let e=t.selectedResultIndex;return N("div",[P("flex flex-row justify-around")],[Wo("Graphe")([Js(t)]),Wo("Ordre des couleurs")([N("div",[P("w-16")],[N("svg",[Cr(0)(0)(10)(100)],U(n=>N("rect",[B("x","0"),B("y",Vt(n*10|0)),B("width","10"),B("height","10"),P("color"+Vt(n))],[]))(Wt(0)(9)))])]),N("div",[P("flex flex-col")],[N("span",[P("mb-2 mt-4 text-2xl font-bold")],[V("Graphe")]),N("select",[P("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),at("value","1"),hn(ji)],[N("option",[at("value","1")],[V("Graphe 1")]),N("option",[at("value","2")],[V("Graphe 2")]),N("option",[at("value","3")],[V("Graphe 3")]),N("option",[at("value","4")],[V("Graphe 4")])]),gn([{onClick:Ki,name:"Sauvegarder",attrs:[]},{onClick:Xi,name:"Importer",attrs:[]},{onClick:Zi,name:"Exporter",attrs:[]}]),N("span",[P("mb-2 mt-4 text-2xl font-bold")],[V("Algorithme")]),N("select",[P("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),B("name","dsatur"),hn(Vi)],[N("option",[at("value","alpha")],[V("Alphabetique")]),N("option",[at("value","decdegree")],[V("Degr\xE9 d\xE9croissant")]),N("option",[at("value","welsh")],[V("Welsh and Powell")]),N("option",[at("value","dsatur")],[V("DSatur")]),N("option",[at("value","custom")],[V("Personnalis\xE9")])]),t.selectedAlgorithm.tag==="CustomAlgorithm"?N("input",[P("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),B("type","text"),at("value",bo(t.selectedAlgorithm._1)),hn(Qi)],[]):me,Rs({onClick:ns,name:"Calculer",attrs:[]}),N("span",[P("mb-2 mt-4 text-2xl font-bold")],[V("R\xE9sultats")]),N("ul",[P("ml-4 list-disc")],[...lt(n=>r=>N("li",[e===n?P("text-blue-600"):ve,yt("click",o=>()=>m("Just",z("SetResultIndex",n)))],[V(zi(r.algorithm)+" ("+Vt(r.number)+" couleurs)")]))(t.results),...ln(5-t.results.length|0)(n=>N("li",[],[]))]),gn([{onClick:rs,name:"Etape pr\xE9c\xE9dente",attrs:[]},{onClick:os,name:"Etape suivante",attrs:[]},{onClick:as,name:"Termine la coloration",attrs:[]}])]),(()=>{if(t.dialog.tag==="NoDialog")return me;if(t.dialog.tag==="ExportDialog")return ul(t.dialog._1);if(t.dialog.tag==="ImportDialog")return sl(t.dialog._1);s()})()])};var vs=(t,e)=>t&&e?n=>t(e(n)):t||e,zs=(t,e,n)=>{t[e]=n},Os=(t,e,n)=>{n==null||e==="class"&&!n?t.removeAttribute(e):t.setAttribute(e,n)},Gs=(t,e,n,r,o,a)=>{t.actions||(t.actions={}),t.actions[e]=a&&r?a(r):r,r?n||t.addEventListener(e,o):t.removeEventListener(e,o)},Lr=(t,e,n,r)=>{let o=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),a=t.props,i=t.attrs,u=t.events,f=vs(r,t.mapf);for(let d in a)zs(o,d,a[d]);for(let d in i)Os(o,d,i[d]);for(let d in u)Gs(o,d,null,u[d],e,f);for(let d=0,$=t.children.length;d<$;d++)o.appendChild(Lr(Le(t.children[d]).html,e,n,f));return t.node=o,o},Ce=(t,e,n,r,o,a,i)=>{if(n!==r){if(n!=null&&n.type===3&&r.type===3)n.tag!==r.tag&&(e.nodeValue=r.tag);else if(n==null||n.tag!==r.tag)e=t.insertBefore(Lr(r,o,a,i),e),n&&n.node.remove();else{let u=n.props,f=r.props;for(let L in{...u,...f})u[L]!==f[L]&&zs(e,L,f[L]);let d=n.attrs,$=r.attrs;for(let L in{...d,...$})d[L]!==$[L]&&Os(e,L,$[L]);let p=n.events,c=r.events;for(let L in{...p,...c})p[L]!==c[L]&&Gs(e,L,p[L],c[L],o,i);let y=n.children,O=r.children,tt=y.length-1,Ct=O.length-1;if(i=vs(i,r.mapf),a=a||r.tag==="svg",r.keyed){let L=0,H=0;for(;H<=Ct&&L<=tt;){let{key:Ft,html:St}=y[L];if(Ft!==O[H].key)break;let _=Le(O[H],St);Ce(e,St.node,St,_.html,o,a,i),H++,L++}for(;H<=Ct&&L<=tt;){let{key:Ft,html:St}=y[tt];if(Ft!==O[Ct].key)break;let _=Le(O[Ct],St);Ce(e,St.node,St,_.html,o,a,i),Ct--,tt--}if(L>tt)for(;H<=Ct;){let Ft=Le(O[H]).html;e.insertBefore(Lr(Ft,o,a,i),y[L]&&y[L].html.node),H++}else if(H>Ct)for(;L<=tt;)y[L].html.node.remove(),L++;else{let Ft={},St={};for(let _=L;_<=tt;_++)Ft[y[_].key]=y[_].html;for(;H<=Ct;){let{key:_,html:st}=y[L]||{key:null,html:null},{key:re,html:Ar}=Le(O[H],st);if(St[_]||y[L+1]&&re===y[L+1].key){L++;continue}if(_===re)Ce(e,st.node,st,Ar,o,a,i),St[re]=!0,L++;else{let Oe=Ft[re];Oe!=null?(Ce(e,e.insertBefore(Oe.node,st.node),Oe,O[H].html,o,a,i),St[re]=!0):Ce(e,st&&st.node,null,O[H].html,o,a,i)}H++}for(let _ in Ft)St[_]||Ft[_].node.remove()}}else{for(let L=0;L<=tt&&L<=Ct;L++){let H=y[L].html,Ft=Le(O[L],H).html;Ce(e,H.node,H,Ft,o,a,i)}for(let L=tt+1;L<=Ct;L++){let H=Le(O[L],n).html;e.appendChild(Lr(H,o,a,i))}for(let L=Ct+1;L<=tt;L++)y[L].html.node.remove()}}return r.node=e,e}},cl=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},Le=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||cl(e.memo,t.html.memo))&&(e=xr(t.html.type(...t.html.memo)),e.memo=t.html.memo),t.html=e),t),xr=t=>({...t,children:t.children&&t.children.map(({key:e,html:n})=>({key:e,html:xr(n)}))}),Us=(t,e)=>t.actions[e],Bs=Ce,ks=t=>e=>(e.node=t,e);var xe=function(t){return function(e){return function(){return e[t]}}},ZT=xe("URL"),tM=xe("documentURI"),eM=xe("origin"),nM=xe("compatMode"),rM=xe("characterSet"),oM=xe("contentType");var $l=xe("documentElement");function Hs(t){return function(e){return function(){return e.createTextNode(t)}}}var jt=function(t){return function(e){return function(){return e[t]}}};var LM=jt("baseURI"),ml=jt("ownerDocument"),vo=jt("parentNode"),gl=jt("parentElement");var xM=jt("childNodes"),hl=jt("firstChild"),yl=jt("lastChild"),_l=jt("previousSibling"),Dl=jt("nextSibling"),bl=jt("nodeValue");var NM=jt("textContent");function js(t){return function(e){return function(){e.appendChild(t)}}}var Nr=function(t){return function(e){return function(){return e[t]}}},tE=Nr("children"),Ml=Nr("firstElementChild"),El=Nr("lastElementChild"),eE=Nr("childElementCount");function Vs(t){return function(e){return function(){return e.querySelector(t)}}}var Qs=t=>{let e=Vs(t);return n=>{let r=e(n);return()=>{let o=r();return ft(o,l,I)}}};var yn=An(zr)(Ve),Ll=An(_r)(Ve),xl=ds({map:t=>e=>{if(e.tag==="State")return ee("State",n=>{let r=e._1(n);return A(t(r._1),r._2)});if(e.tag==="Lift")return ee("Lift",hr(t)(e._1));if(e.tag==="Subscribe")return ee("Subscribe",e._1,n=>t(e._2(n)));if(e.tag==="Unsubscribe")return ee("Unsubscribe",e._1,t(e._2));s()}})(gs),Nl=t=>e=>n=>{let r=n(e);return()=>{let o=r();return yn(o)(t.update(t))()}},Ks=t=>e=>{let n=t.node,r=t.vdom;return()=>{let o=r.value,a=n.value,i=vo(a)();return yn(ft(i,l,I))(u=>{let f=xr(e);return()=>{let d=Bs(u,a,o,f,$=>{let p=di($);return yn(ft(be($),l,I))(c=>()=>{let y=Us(c,p);return Nl(t)($)(y)()})()});return n.value=d,r.value=f}})()}},Al=t=>e=>{let n=t.state;return()=>{let r=n.value,o=br(r)(e);if(!o)return n.value=e,Ks(t)(t.view(e))();o||s()}},Ys=t=>e=>n=>{let r=e.subscriptions;return xl(o=>{if(o.tag==="State")return zt(te((()=>{let a=e.state;return()=>a.value})()))(a=>{let i=o._1(a),u=i._1;return zt(te(Al(e)(i._2)))(()=>Ee(u))});if(o.tag==="Lift")return o._1;if(o.tag==="Subscribe")return zt(te(o._1(a=>{let i=yr(Ro,Ys(t)(e)(t(a)));return()=>{i().run()}})))(a=>zt(te((()=>{let i=e.freshId;return()=>{let u=i.value;return i.value=u+1|0,u}})()))(i=>zt(te((()=>{let u=tr($t)(i)(a);return()=>{let f=r.value;r.value=u(f)}})()))(()=>Ee(o._2(i)))));if(o.tag==="Unsubscribe"){let a=o._2,i=o._1;return zt(te(()=>r.value))(u=>zt(Ll(lo($t)(i)(u))(te))(()=>Ee(a)))}s()})(n)},Il=t=>{let e=t.init.model,n=t.init.msg,r=t.selector,o=t.update,a=t.view;return()=>{let i=We(),u=mo(i)(),f=Qs(r)(u)();return yn(f.tag==="Just"?m("Just",f._1):l)(d=>()=>{let $={value:e},p=We(),c=mo(p)(),y=Hs("")(c)();js(y)(d)();let O={value:y},tt={value:ks(y)(V(""))},H={view:a,update:o,state:$,node:O,vdom:tt,subscriptions:{value:we},freshId:{value:0}};return Ks(H)(a(e))(),yn(n)(H.update(H))()})()}};var Xs=t=>{let e=t.update;return Il({init:t.init,view:t.view,selector:t.selector,update:n=>r=>{let o=yr(Ro,Ys(e)(n)(e(r)));return()=>{o().run()}}})};var Zs=Xs({init:{model:vi,msg:m("Just",Yi)},update:Ss,view:qs,selector:"#root"});Zs();})();
