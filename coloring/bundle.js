(()=>{function s(){throw new Error("Failed pattern match")}var te=function(t){return function(e){return e[t]}},pe=function(t){return function(e){return function(n){var r={};for(var o in n)({}).hasOwnProperty.call(n,o)&&(r[o]=n[o]);return r[t]=e,r}}};var pd=()=>({tag:"Proxy"}),Y=pd();var ee=function(t){return t.toString()},$t=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var zr=t=>({tag:t}),dt=zr("LT"),ut=zr("GT"),St=zr("EQ");var m=(t,e)=>({tag:t,_1:e}),l=m("Nothing"),S=t=>m("Just",t);var de={map:t=>e=>e.tag==="Just"?m("Just",t(e._1)):l};var be=t=>{let e=t.Eq0(),n={eq:r=>o=>r.tag==="Nothing"?o.tag==="Nothing":r.tag==="Just"&&o.tag==="Just"?e.eq(r._1)(o._1):!1};return{compare:r=>o=>{if(r.tag==="Nothing")return o.tag==="Nothing"?St:dt;if(o.tag==="Nothing")return ut;if(r.tag==="Just"){if(o.tag==="Just")return t.compare(r._1)(o._1);s()}s()},Eq0:()=>n}};var Ke={apply:t=>e=>{if(t.tag==="Just")return e.tag==="Just"?m("Just",t._1(e._1)):l;if(t.tag==="Nothing")return l;s()},Functor0:()=>de};var Ur=t=>e=>t(e);var Gr={compose:t=>e=>n=>t(e(n))};var j=function(t){return function(e){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o]);return r}};var Ye={map:j};var Br=t=>t;var Or=function(t){return function(e){for(var n=[],r=0,o=t.length;r<o;r++)Array.prototype.push.apply(n,e(t[r]));return n}};var E=(t,e)=>({tag:t,_1:e}),fe=t=>E("Left",t),yt=t=>E("Right",t);var Re={map:t=>e=>{if(e.tag==="Left")return E("Left",e._1);if(e.tag==="Right")return E("Right",t(e._1));s()}};var Fn={apply:t=>e=>{if(t.tag==="Left")return E("Left",t._1);if(t.tag==="Right"){if(e.tag==="Left")return E("Left",e._1);if(e.tag==="Right")return E("Right",t._1(e._1));s()}s()},Functor0:()=>Re},ue={bind:t=>{if(t.tag==="Left"){let e=t._1;return n=>E("Left",e)}if(t.tag==="Right"){let e=t._1;return n=>n(e)}s()},Apply0:()=>Fn};var Xo={pure:yt,Apply0:()=>Fn};var Zo=function(t){return function(){return t}};var Dd={apply:t=>e=>()=>{let n=t(),r=e();return Hr.pure(n(r))()},Functor0:()=>bd},Hr={pure:Zo,Apply0:()=>Dd},bd={map:t=>e=>()=>{let n=e();return t(n)}};var zt=(t,e)=>({tag:t,_1:e}),Qr=t=>zt("Loop",t),ta=t=>zt("Done",t);var ea=function(t){return function(e){return function(){return t(e())}}},na=function(t){return function(){return t}};var Cd={map:ea};var Ld={apply:t=>e=>()=>{let n=t(),r=e();return Sn.pure(n(r))()},Functor0:()=>Cd},Sn={pure:na,Apply0:()=>Ld};var ra=function(t){return function(e){return function(n){return function(r){return function(){return n>=0&&n<r.length?t(r[n]):e}}}}},Rn=function(t){return function(e){return function(n){return function(){var r=t>=0&&t<n.length;return r&&(n[t]=e),r}}}};function Ed(t){return function(){return t.slice()}}var Xe=Ed,xd=function(){function t(e,n,r,o,a,i){var d,$,u,f,p,c,T;for(d=a+(i-a>>1),d-a>1&&t(e,n,o,r,a,d),i-d>1&&t(e,n,o,r,d,i),$=a,u=d,f=a;$<d&&u<i;)p=o[$],c=o[u],T=n(e(p)(c)),T>0?(r[f++]=c,++u):(r[f++]=p,++$);for(;$<d;)r[f++]=o[$++];for(;u<i;)r[f++]=o[u++]}return function(e){return function(n){return function(r){return function(){return r.length<2||t(e,n,r,r.slice(0),0,r.length),r}}}}}();var Nd=ra(S)(l),oa=t=>e=>n=>{let r=Nd(t)(n);return()=>{let o=r();if(o.tag==="Just")return Rn(t)(e(o._1))(n)();if(o.tag==="Nothing")return!1;s()}};var ce=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=o-1;a>=0;a--)r=t(n[a])(r);return r}}},ne=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=0;a<o;a++)r=t(r)(n[a]);return r}}};var wn=t=>{let e=t.Apply0(),n=e.Functor0().map;return r=>o=>r.foldr(a=>{let i=o(a);return d=>e.apply(n($=>Br)(i))(d)})(t.pure())},Wn=t=>{let e=wn(t);return n=>{let r=e(n);return o=>a=>r(a)(o)}};var Jn=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return m("Just",r);if(n.tag==="Just")return m("Just",e(n._1)(r).tag==="GT"?n._1:r);s()})(l);var ia=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return m("Just",r);if(n.tag==="Just")return m("Just",e(n._1)(r).tag==="LT"?n._1:r);s()})(l);var Ze={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);s()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);s()},foldMap:t=>{let e=t.mempty;return n=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return n(r._1);s()}}};var Ct={foldr:ce,foldl:ne,foldMap:t=>{let e=t.Semigroup0().append,n=t.mempty;return r=>Ct.foldr(o=>a=>e(r(o))(a))(n)}};var D=(t,e)=>({tag:"Tuple",_1:t,_2:e}),At=t=>e=>D(t,e);var qn={map:t=>e=>D(e._1,t(e._2))};var we=t=>t;var me={bimap:t=>e=>n=>{if(n.tag==="Left")return E("Left",t(n._1));if(n.tag==="Right")return E("Right",e(n._1));s()}};var pt=function(t){return function(e){for(var n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t(o)(e[o]);return r}};var fa={mapWithIndex:pt,Functor0:()=>Ye};var ma=function(t){return function(e){return t===e}};var ga=ma,ha=ma;var _a={eq:ha},vn={eq:ga};var Da=function(t){return function(e){return function(n){return function(r){return function(o){return r<o?t:r===o?e:n}}}}};var ba=Da,Ta=Da;var zn={compare:Ta(dt)(St)(ut),Eq0:()=>_a},ft={compare:ba(dt)(St)(ut),Eq0:()=>vn};var Rt=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var xa=function(){function t(o){return[o]}function e(o){return function(a){return[o,a]}}function n(o){return function(a){return function(i){return[o,a,i]}}}function r(o){return function(a){return o.concat(a)}}return function(o){return function(a){return function(i){return function(d){return function($){function u(f,p){switch(p-f){case 0:return i([]);case 1:return a(t)(d($[f]));case 2:return o(a(e)(d($[f])))(d($[f+1]));case 3:return o(o(a(n)(d($[f])))(d($[f+1])))(d($[f+2]));default:var c=f+Math.floor((p-f)/4)*2;return o(a(r)(u(f,c)))(u(c,p))}}return u(0,$.length)}}}}}}();var Zr=t=>t;var en={traverse:t=>{let e=t.Apply0();return xa(e.apply)(e.Functor0().map)(t.pure)},sequence:t=>en.traverse(t)(Zr),Functor0:()=>Ye,Foldable1:()=>Ct};var Ut=function(t){return function(e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),o=t,a=0;o!==e;)r[a++]=o,o+=n;return r[a]=o,r}},mu=function(t){return function(e){if(t<1)return[];var n=new Array(t);return n.fill(e)}},gu=function(t){return function(e){for(var n=[],r=0,o=0;o<t;o++)n[r++]=e;return n}},to=typeof Array.prototype.fill=="function"?mu:gu,eo=function(){function t(o,a){this.head=o,this.tail=a}var e={};function n(o){return function(a){return new t(o,a)}}function r(o){for(var a=[],i=0,d=o;d!==e;)a[i++]=d.head,d=d.tail;return a}return function(o){return function(a){return r(o(n)(e)(a))}}}();var Na=function(t){return function(e){return function(n){return function(r){return r<0||r>=n.length?e:t(n[r])}}}};var Ia=function(t){return function(e){return function(n){return function(r){for(var o=0,a=r.length;o<a;o++)if(n(r[o]))return t(o);return e}}}};var Aa=function(t){return function(e){return function(n){return function(r){if(n<0||n>=r.length)return e;var o=r.slice();return o.splice(n,1),t(o)}}}},Fa=function(t){return function(e){return function(n){return function(r){return function(o){if(n<0||n>=o.length)return e;var a=o.slice();return a[n]=r,t(a)}}}}};var Gn=function(t){return function(e){return e.filter(t)}};var Pa=function(){function t(e,n,r,o,a,i){var d,$,u,f,p,c,T;for(d=a+(i-a>>1),d-a>1&&t(e,n,o,r,a,d),i-d>1&&t(e,n,o,r,d,i),$=a,u=d,f=a;$<d&&u<i;)p=o[$],c=o[u],T=n(e(p)(c)),T>0?(r[f++]=c,++u):(r[f++]=p,++$);for(;$<d;)r[f++]=o[$++];for(;u<i;)r[f++]=o[u++]}return function(e){return function(n){return function(r){var o;return r.length<2?r:(o=r.slice(0),t(e,n,o,r.slice(0),0,r.length),o)}}}}(),nn=function(t){return function(e){return function(n){return n.slice(t,e)}}},Bn=function(t){return function(e){return function(n){for(var r=e.length<n.length?e.length:n.length,o=new Array(r),a=0;a<r;a++)o[a]=t(e[a])(n[a]);return o}}};var Sa=wn(Sn);var On=t=>{let e=Sa(t);return n=>r=>(()=>{let o=Xe(r);return()=>{let a=o();return e(i=>Rn(i._1)(i._2)(a))(n)(),a}})()()},Ra=Fa(S)(l);var hu=t=>Pa(t)(e=>{if(e.tag==="GT")return 1;if(e.tag==="EQ")return 0;if(e.tag==="LT")return-1;s()}),kn=t=>e=>hu(n=>r=>t.compare(e(n))(e(r)));var an=t=>e=>(()=>{let n=Xe(t);return()=>{let r=n();return r.push(e),r}})()();var wa=t=>{let e=Sa(t);return n=>r=>o=>(()=>{let a=Xe(o);return()=>{let i=a();return e(d=>oa(d)(r)(i))(n)(),i}})()()};var Ht=Na(S)(l);var yu=Ia(S)(l);var We=t=>e=>n=>{let r=yu(o=>t.eq(o)(e))(n);if(r.tag==="Nothing")return!1;if(r.tag==="Just")return!0;s()};var Wa=Aa(S)(l);var _u=t=>e=>Or(e)(t),Hn=t=>_u(e=>{let n=t(e);if(n.tag==="Nothing")return[];if(n.tag==="Just")return[n._1];s()});var Ef=String.fromCharCode(65535),xf=String.fromCharCode(0),Du=Number.POSITIVE_INFINITY,bu=Number.NEGATIVE_INFINITY;function Vn(t){return t.charCodeAt(0)}function sn(t){return String.fromCharCode(t)}var no={identity:t=>t,Semigroupoid0:()=>Gr};var jn={dimap:t=>e=>n=>r=>e(n(t(r)))};var Iu=t=>t,Je=(()=>({first:t=>e=>D(t(e._1),e._2),second:qn.map,Profunctor0:()=>jn}))();var ro=t=>{let e=t.identity,n=t.Semigroupoid0(),r=t.Semigroupoid0();return o=>{let a=o.Profunctor0().dimap;return i=>d=>n.compose(r.compose(o.second(d))(o.first(i)))(a(Iu)($=>D($,$))(e))}};var Au=ro(no)(Je);var Ga=t=>e=>n=>r=>{let o=Au(t)(e),a=r.Profunctor0().dimap;return i=>a(o)(d=>{if(d._2.tag==="Left")return d._2._1;if(d._2.tag==="Right")return d._1(d._2._1);s()})(n.second(r.right(i)))};var Oa=function(t){return t.join("")},ka=function(t){return t.split("")},Kn=function(t){return t};var Ha=(t,e,n)=>{let r=new Set(t[n].map(a=>e[a])),o=0;for(;r.has(o);)o++;return e[n]=o,o},dn=t=>e=>{let n=new Array(e.length);n.fill(-1);for(let r of e)Ha(t,n,r);return e.map(r=>({vertex:r,color:n[r]}))},Gu=(t,e)=>{let n=null;for(let r=0;r<t.length;r++)e[r]===-1&&(degree=t[r].length,saturation=new Set(t[r].map(o=>e[o])).size,(n===null||n.saturation<saturation||n.saturation===saturation&&n.degree<degree)&&(n={vertex:r,saturation,degree}));return n.vertex},Va=t=>{let e=new Array(t.length),n=[];e.fill(-1);for(let r=0;r<t.length;r++){let o=Gu(t,e),a=Ha(t,e,o);n.push({vertex:o,color:a})}return n},ja=t=>e=>{let n=[],r=0;for(;n.length<t.length;){let o=new Array(t.length);o.fill(!1);for(let a of e)if(!o[a]){n.push({vertex:a,color:r});for(let i of t[a])o[i]=!0}r++}return n};var Qa=t=>t.length===0?[]:ja(t)(kn(be(ft))(e=>{let n=Ht(t)(e);return n.tag==="Just"?m("Just",-n._1.length):l})((()=>{let e=t.length-1|0;return 0>e?[]:Ut(0)(e)})())),Ka=t=>t.length===0?[]:dn(t)(kn(be(ft))(e=>{let n=Ht(t)(e);return n.tag==="Just"?m("Just",-n._1.length):l})((()=>{let e=t.length-1|0;return 0>e?[]:Ut(0)(e)})())),Ya=t=>t.length===0?[]:dn(t)((()=>{let e=t.length-1|0;return 0>e?[]:Ut(0)(e)})());var ao={foldrWithIndex:t=>e=>{let n=ce(o=>{let a=o._1,i=o._2;return d=>t(a)(i)(d)})(e),r=pt(At);return o=>n(r(o))},foldlWithIndex:t=>e=>{let n=ne(o=>a=>t(a._1)(o)(a._2))(e),r=pt(At);return o=>n(r(o))},foldMapWithIndex:t=>{let e=t.Semigroup0().append,n=t.mempty;return r=>ao.foldrWithIndex(o=>a=>i=>e(r(o)(a))(i))(n)},Foldable0:()=>Ct};var Yn={};function Xn(t,e,n,r){return n in r?e(r[n]):t}function Za(t){return function(e){var n=[];for(var r in e)hasOwnProperty.call(e,r)&&n.push(t(r)(e[r]));return n}}var wm=Object.keys||Za(function(t){return function(){return t}});var so=t=>e=>{let n={...e};return t(n)(),n};function ct(t){return t}function tr(t){return JSON.stringify(t)}function he(t,e,n,r,o,a,i){return i==null?t():typeof i=="boolean"?e(i):typeof i=="number"?n(i):typeof i=="string"?r(i):Object.prototype.toString.call(i)==="[object Array]"?o(i):a(i)}var it=(t,e,n)=>({tag:t,_1:e,_2:n});var ti=t=>e=>it("AtIndex",t,e),uo=t=>e=>it("AtKey",t,e),ei=t=>e=>it("Named",t,e),co=it("MissingValue");var $o=isFinite;var ni=Math.cos;var qe=Math.floor;var er=Math.sin,ln=Math.sqrt;var ri=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},wt=function(t){return t};var po=ri(S)(l),fo=t=>{if(!$o(t))return 0;if(t>=wt(2147483647))return 2147483647;if(t<=wt(-2147483648))return-2147483648;let e=po(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;s()};var _t=(t,e,n)=>({tag:t,_1:e,_2:n});var v=_t("Nil");var si=(()=>(e=>n=>{let r=e,o=n,a=!0,i;for(;a;){let d=r,$=o;if($.tag==="Nil"){a=!1,i=d;continue}if($.tag==="Cons"){r=_t("Cons",$._1,d),o=$._2;continue}s()}return i})(v))();var pn=function(t){throw new Error(t)};var ir=(t,e,n,r)=>({tag:"KickUp",_1:t,_2:e,_3:n,_4:r}),mt=(t,e,n,r,o,a,i,d)=>({tag:t,_1:e,_2:n,_3:r,_4:o,_5:a,_6:i,_7:d}),ze=(t,e,n,r,o,a,i)=>({tag:t,_1:e,_2:n,_3:r,_4:o,_5:a,_6:i});var Ue=mt("Leaf");var yo=t=>e=>r=>{let o=r,a=!0,i;for(;a;){let d=o;if(d.tag==="Leaf"){a=!1,i=l;continue}if(d.tag==="Two"){let $=t.compare(e)(d._2);if($.tag==="EQ"){a=!1,i=m("Just",d._3);continue}if($.tag==="LT"){o=d._1;continue}o=d._4;continue}if(d.tag==="Three"){let $=t.compare(e)(d._2);if($.tag==="EQ"){a=!1,i=m("Just",d._3);continue}let u=t.compare(e)(d._5);if(u.tag==="EQ"){a=!1,i=m("Just",d._6);continue}if($.tag==="LT"){o=d._1;continue}if(u.tag==="GT"){o=d._7;continue}o=d._4;continue}s()}return i};var fn=t=>e=>n=>{let r=t,o=e,a=n,i=!0,d;for(;i;){let $=r,u=o,f=a;if(u.tag==="Nil"){i=!1,d=f;continue}if(u.tag==="Cons"){if(u._1.tag==="TwoLeft"){r=$,o=u._2,a=mt("Two",f,u._1._1,u._1._2,u._1._3);continue}if(u._1.tag==="TwoRight"){r=$,o=u._2,a=mt("Two",u._1._1,u._1._2,u._1._3,f);continue}if(u._1.tag==="ThreeLeft"){r=$,o=u._2,a=mt("Three",f,u._1._1,u._1._2,u._1._3,u._1._4,u._1._5,u._1._6);continue}if(u._1.tag==="ThreeMiddle"){r=$,o=u._2,a=mt("Three",u._1._1,u._1._2,u._1._3,f,u._1._4,u._1._5,u._1._6);continue}if(u._1.tag==="ThreeRight"){r=$,o=u._2,a=mt("Three",u._1._1,u._1._2,u._1._3,u._1._4,u._1._5,u._1._6,f);continue}s()}s()}return d},sr=t=>e=>n=>{let r=a=>i=>{let d=a,$=i,u=!0,f;for(;u;){let p=d,c=$;if(p.tag==="Nil"){u=!1,f=mt("Two",c._1,c._2,c._3,c._4);continue}if(p.tag==="Cons"){if(p._1.tag==="TwoLeft"){u=!1,f=fn(t)(p._2)(mt("Three",c._1,c._2,c._3,c._4,p._1._1,p._1._2,p._1._3));continue}if(p._1.tag==="TwoRight"){u=!1,f=fn(t)(p._2)(mt("Three",p._1._1,p._1._2,p._1._3,c._1,c._2,c._3,c._4));continue}if(p._1.tag==="ThreeLeft"){d=p._2,$=ir(mt("Two",c._1,c._2,c._3,c._4),p._1._1,p._1._2,mt("Two",p._1._3,p._1._4,p._1._5,p._1._6));continue}if(p._1.tag==="ThreeMiddle"){d=p._2,$=ir(mt("Two",p._1._1,p._1._2,p._1._3,c._1),c._2,c._3,mt("Two",c._4,p._1._4,p._1._5,p._1._6));continue}if(p._1.tag==="ThreeRight"){d=p._2,$=ir(mt("Two",p._1._1,p._1._2,p._1._3,p._1._4),p._1._5,p._1._6,mt("Two",c._1,c._2,c._3,c._4));continue}s()}s()}return f};return(a=>i=>{let d=a,$=i,u=!0,f;for(;u;){let p=d,c=$;if(c.tag==="Leaf"){u=!1,f=r(p)(ir(Ue,e,n,Ue));continue}if(c.tag==="Two"){let T=t.compare(e)(c._2);if(T.tag==="EQ"){u=!1,f=fn(t)(p)(mt("Two",c._1,e,n,c._4));continue}if(T.tag==="LT"){d=_t("Cons",ze("TwoLeft",c._2,c._3,c._4),p),$=c._1;continue}d=_t("Cons",ze("TwoRight",c._1,c._2,c._3),p),$=c._4;continue}if(c.tag==="Three"){let T=t.compare(e)(c._2);if(T.tag==="EQ"){u=!1,f=fn(t)(p)(mt("Three",c._1,e,n,c._4,c._5,c._6,c._7));continue}let H=t.compare(e)(c._5);if(H.tag==="EQ"){u=!1,f=fn(t)(p)(mt("Three",c._1,c._2,c._3,c._4,e,n,c._7));continue}if(T.tag==="LT"){d=_t("Cons",ze("ThreeLeft",c._2,c._3,c._4,c._5,c._6,c._7),p),$=c._1;continue}if(T.tag==="GT"){if(H.tag==="LT"){d=_t("Cons",ze("ThreeMiddle",c._1,c._2,c._3,c._5,c._6,c._7),p),$=c._4;continue}d=_t("Cons",ze("ThreeRight",c._1,c._2,c._3,c._4,c._5,c._6),p),$=c._7;continue}d=_t("Cons",ze("ThreeRight",c._1,c._2,c._3,c._4,c._5,c._6),p),$=c._7;continue}s()}return f})(v)};var ur=function(t){return function(e){return t+e}};var iy=typeof Array.from=="function",sy=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",dy=typeof String.prototype.fromCodePoint=="function",uy=typeof String.prototype.codePointAt=="function";var cr={traverseWithIndex:t=>{let e=cr.FunctorWithIndex0().mapWithIndex,n=cr.Traversable2().sequence(t);return r=>{let o=e(r);return a=>n(o(a))}},FunctorWithIndex0:()=>fa,FoldableWithIndex1:()=>ao,Traversable2:()=>en};var Dc=(()=>cr.traverseWithIndex(Xo))();var bc=t=>{let e=he(n=>l,n=>l,n=>l,n=>l,S,n=>l,t);if(e.tag==="Nothing")return E("Left",it("TypeMismatch","Array"));if(e.tag==="Just")return E("Right",e._1);s()};var lr=t=>ue.bind(he(e=>E("Left",it("TypeMismatch","Number")),e=>E("Left",it("TypeMismatch","Number")),yt,e=>E("Left",it("TypeMismatch","Number")),e=>E("Left",it("TypeMismatch","Number")),e=>E("Left",it("TypeMismatch","Number")),t))(e=>{let n=po(e);if(n.tag==="Nothing")return E("Left",it("TypeMismatch","Integer"));if(n.tag==="Just")return E("Right",n._1);s()});var Ge=t=>{let e=me.bimap(ei("Array"))(we),n=Dc(r=>{let o=me.bimap(ti(r))(we);return a=>o(t(a))});return r=>ue.bind(bc(r))(o=>e(n(o)))},_o=t=>e=>n=>ue.bind(Ge(yt)(n))(r=>r.length===2?Fn.apply((()=>{let o=t(r[0]);if(o.tag==="Left")return E("Left",o._1);if(o.tag==="Right")return E("Right",At(o._1));s()})())(e(r[1])):E("Left",it("TypeMismatch","Tuple")));function gt(t,e,n){return t==null?e:n(t)}function $r(t,e,n,r){if(typeof window<"u"){var o=window[n];if(o!=null&&r instanceof o)return e(r)}for(var a=r;a!=null;){var i=Object.getPrototypeOf(a),d=i.constructor.name;if(d===n)return e(r);if(d==="Object")return t;a=i}return t}var pr=function(t){return function(e){return e[t]}},Tc=pr("namespaceURI"),Mc=pr("prefix"),A_=pr("localName"),F_=pr("tagName");function mi(t){return function(){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}}function Le(t){return t.currentTarget}function gi(t){return t.type}function bo(t){return function(){return t.stopPropagation()}}var Be=function(){return window};function To(t){return function(){return t.document}}function Mo(t){return function(){return t.localStorage}}function _i(t){return function(e){return function(){return e.getItem(t)}}}function Di(t){return function(e){return function(n){return function(){n.setItem(t,e)}}}}var bi=t=>{let e=_i(t);return n=>{let r=e(n);return()=>{let o=r();return gt(o,l,S)}}};function Ti(t){return t.clientX}function Mi(t){return t.clientY}var Ci=t=>{let e=t.MonadEffect0().liftEffect;return n=>r=>e((()=>{let o=Di(n)(r);return()=>{let a=Be(),i=Mo(a)();return o(i)()}})())},Li=t=>{let e=t.MonadEffect0().liftEffect;return n=>e((()=>{let r=bi(n);return()=>{let o=Be(),a=Mo(o)();return r(a)()}})())},gn=t=>e=>t===0?[]:j(e)((()=>{let n=t-1|0;return 0>n?[]:Ut(0)(n)})()),hn=t=>{let e=100*er(wt(t+1|0));return e-qe(e)},Co=t=>{let e=gt(Le(t),l,S),n=(()=>{if(e.tag==="Just")return $r(l,S,"Element",e._1);if(e.tag==="Nothing")return l;s()})();if(n.tag==="Just"){let r=mi(n._1);return()=>{let o=r();return m("Just",{x:(wt(Ti(t))-o.left)/o.width,y:(wt(Mi(t))-o.top)/o.height})}}return()=>l};var Ee=(t,e)=>({tag:"Edge",_1:t,_2:e}),Ei=wa(Ct),Nc=On(Ct);var Eo={eq:t=>e=>t._1===e._1&&t._2===e._2||t._1===e._2&&e._1===t._2},xi={encodeJson:t=>[wt(t._1),wt(t._2)]},Ni={decodeJson:t=>ue.bind(_o(lr)(lr)(t))(e=>E("Right",Ee(e._1,e._2)))},Ii=t=>ce(e=>{let n=e._1,r=e._2,o=Ei([n])(i=>an(i)(r)),a=Ei([r])(i=>an(i)(n));return i=>o(a(i))})(j(e=>[])(t.layout))(t.edges),xo=t=>e=>({layout:(()=>{let n=Wa(t)(e.layout);if(n.tag==="Nothing")return e.layout;if(n.tag==="Just")return n._1;s()})(),edges:Hn(n=>n._1===t||n._2===t?l:m("Just",Ee(n._1>t?n._1-1|0:n._1,n._2>t?n._2-1|0:n._2)))(e.edges)}),Ai=t=>e=>n=>({layout:n.layout,edges:Gn(r=>!(r._1===t&&r._2===e||r._1===e&&t===r._2))(n.edges)}),Fi=t=>e=>n=>({layout:Nc([D(t,e)])(n.layout),edges:n.edges});var Pi=t=>e=>{let n=Ht(t.layout)(e._1);if(n.tag==="Just"){let r=Ht(t.layout)(e._2);if(r.tag==="Just")return m("Just",{x1:n._1.x,x2:r._1.x,y1:n._1.y,y2:r._1.y});if(r.tag==="Nothing")return l;s()}if(n.tag==="Nothing")return l;s()},Si={layout:gn(100)(t=>({x:hn(t*2|0),y:hn((t*2|0)+1|0)})),edges:Gn(t=>t._1!==t._2)(gn(1e3)(t=>Ee(fo(qe(100*hn(t*2|0))),fo(qe(100*hn((t*2|0)+1|0))))))},Ri=t=>e=>({layout:an(e.layout)(t),edges:e.edges}),wi=t=>e=>n=>({layout:n.layout,edges:t===e||We(Eo)(Ee(t,e))(n.edges)?n.edges:an(n.edges)(Ee(t,e))});var xe=(t,e)=>({tag:t,_1:e}),yn=(t,e)=>({tag:t,_1:e}),gr=t=>({tag:t}),Ic=On(Ct),_n=gr("MoveMode"),Wi=gr("VertexMode"),hr=gr("AddEMode"),Ji=gr("DeleteMode"),Oe=yn("NoDialog");var yr=xe("Alphabetical"),qi=xe("DecreasingDegree"),vi=xe("WelshPowell"),zi=xe("DSatur");var Ui={eq:t=>e=>t.tag==="MoveMode"?e.tag==="MoveMode":t.tag==="VertexMode"?e.tag==="VertexMode":t.tag==="AddEMode"?e.tag==="AddEMode":t.tag==="DeleteMode"?e.tag==="DeleteMode":!1},Gi=t=>m("Just",j(e=>Vn(e)-65|0)(ka(t))),re=t=>{let e=Ht(t.graphs)(t.selectedGraphIdx);if(e.tag==="Nothing")return{layout:[],edges:[]};if(e.tag==="Just")return e._1;s()},Bi=t=>e=>{let n=Ii(t);if(e.tag==="Alphabetical")return Ya(n);if(e.tag==="DecreasingDegree")return Ka(n);if(e.tag==="DSatur")return Va(n);if(e.tag==="WelshPowell")return Qa(n);if(e.tag==="CustomAlgorithm")return dn(n)(e._1);s()},Oi=t=>{let e=to(re(t).layout.length)(-1),n=Ht(t.results)(t.selectedResultIndex);if(n.tag==="Just")return Ic(j(r=>D(r.vertex,r.color))(t.currentStep<1?[]:nn(0)(t.currentStep)(n._1.coloring)))(e);if(n.tag==="Nothing")return e;s()},No=(()=>{let t=j(e=>{let n=e+65|0;return n>=0&&n<=65535?m("Just",sn(n)):l});return e=>Oa(Hn(n=>n)(t(e)))})();var ki=t=>Kn((()=>{let e=t+65|0;return e>=0&&e<=65535?sn(e):"A"})()),Hi={selectedAlgorithm:yr,results:[],currentStep:0,selectedResultIndex:0,graphs:to(4)({layout:[],edges:[]}),selectedGraphIdx:0,editmode:_n,selectedVertex:l,currentPosition:l,dialog:Oe},Vi=t=>{if(t.tag==="Alphabetical")return"Alphab\xE9tique";if(t.tag==="DecreasingDegree")return"Degr\xE9 d\xE9croissant";if(t.tag==="WelshPowell")return"Welsh and Powell";if(t.tag==="DSatur")return"DSatur";if(t.tag==="CustomAlgorithm")return No(t._1);s()},ji=t=>e=>Ga(n=>r=>({selectedAlgorithm:n.selectedAlgorithm,results:n.results,currentStep:n.currentStep,selectedResultIndex:n.selectedResultIndex,graphs:(()=>{let o=Ra(n.selectedGraphIdx)(r)(n.graphs);if(o.tag==="Nothing")return n.graphs;if(o.tag==="Just")return o._1;s()})(),selectedGraphIdx:n.selectedGraphIdx,editmode:n.editmode,selectedVertex:n.selectedVertex,currentPosition:n.currentPosition,dialog:n.dialog}))(n=>{let r=Ht(n.graphs)(n.selectedGraphIdx);if(r.tag==="Nothing")return E("Left",n);if(r.tag==="Just")return E("Right",r._1);s()})(t)(e);var k=(t,e,n)=>({tag:t,_1:e,_2:n});var Qi=t=>e=>k("SelectVertex",t,e);var Ki=t=>e=>k("DeleteVertex",t,e);var Io=k("DropOrLeave");var Yi=k("ClearGraph"),Xi=k("AdjustGraph"),Zi=k("GenBigGraph"),ts=t=>k("SetGraph",t),es=t=>k("SetAlgo",t),ns=t=>k("CustomAlgoTextChange",t);var rs=k("Save"),os=k("Load"),as=k("OpenImportDialog"),is=k("Export"),ss=t=>k("ChangeImportText",t),ds=k("ImportAndClose"),Ao=k("CloseDialog"),us=k("Compute"),cs=k("PreviousStep"),ls=k("NextStep"),$s=k("FinishColoring");var Lt=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var ps=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){n=!1,r=l;continue}e=Lt(si(o._2),v);continue}if(o._1.tag==="Cons"){n=!1,r=m("Just",D(o._1._1,Lt(o._1._2,o._2)));continue}s()}return r};var Ft=(t,e,n)=>({tag:t,_1:e,_2:n}),_=Ft("CatNil");var xt=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return Ft("CatCons",t._1,Lt(t._2._1,_t("Cons",e,t._2._2)));s()},Fc=t=>e=>n=>{let r=a=>i=>d=>{let $=a,u=i,f=d,p=!0,c;for(;p;){let T=$,H=u,ot=f;if(ot.tag==="Nil"){p=!1,c=H;continue}if(ot.tag==="Cons"){$=T,u=T(H)(ot._1),f=ot._2;continue}s()}return c};return(a=>i=>{let d=a,$=i,u=!0,f;for(;u;){let p=d,c=$,T=ps(p);if(T.tag==="Nothing"){u=!1,f=r(H=>ot=>ot(H))(e)(c);continue}if(T.tag==="Just"){d=T._1._2,$=_t("Cons",t(T._1._1),c);continue}s()}return f})(n)(v)},fs=t=>{if(t.tag==="CatNil")return l;if(t.tag==="CatCons")return m("Just",D(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?_:Fc(xt)(_)(t._2)));s()};var g=(t,e)=>({tag:"Free",_1:t,_2:e}),b=(t,e,n)=>({tag:t,_1:e,_2:n});var Pc=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Return"){let a=fs(o._2);if(a.tag==="Nothing"){n=!1,r=b("Return",o._1._1);continue}if(a.tag==="Just"){e=(()=>{let i=a._1._1(o._1._1);return g(i._1,xt(i._2)(a._1._2))})();continue}s()}if(o._1.tag==="Bind"){n=!1,r=b("Bind",o._1._1,a=>{let i=o._1._2(a);return g(i._1,xt(i._2)(o._2))});continue}s()}return r},ms=t=>e=>{let n=e.Monad0(),r=n.Bind1().Apply0().Functor0().map,o=n.Applicative0().pure;return a=>e.tailRecM(i=>{let d=Pc(i);if(d.tag==="Return")return r(ta)(o(d._1));if(d.tag==="Bind")return r(Qr)(a(t.map(d._2)(d._1)));s()})};var gs={Applicative0:()=>Dr,Bind1:()=>Ro},hs={map:t=>e=>Ro.bind(e)(n=>Dr.pure(t(n)))},Ro={bind:t=>e=>g(t._1,xt(t._2)(Ft("CatCons",e,Lt(v,v)))),Apply0:()=>wo},wo={apply:t=>e=>g(t._1,xt(t._2)(Ft("CatCons",n=>g(e._1,xt(e._2)(Ft("CatCons",r=>Dr.pure(n(r)),Lt(v,v)))),Lt(v,v)))),Functor0:()=>hs},Dr={pure:t=>g(b("Return",t),_),Apply0:()=>wo};var Jo={gDecodeJson:t=>e=>E("Right",{})};var qo=t=>()=>({decodeJson:e=>{let n=he(r=>l,r=>l,r=>l,r=>l,r=>l,S,e);if(n.tag==="Just")return t.gDecodeJson(n._1)(Y);if(n.tag==="Nothing")return E("Left",it("TypeMismatch","Object"));s()}});var br=t=>e=>n=>()=>()=>({gDecodeJson:r=>o=>{let a=n.reflectSymbol(Y),i=t.decodeJsonField(Xn(l,S,a,r));if(i.tag==="Just")return ue.bind(me.bimap(uo(a))(we)(i._1))(d=>ue.bind(e.gDecodeJson(r)(Y))($=>E("Right",pe(n.reflectSymbol(Y))(d)($))));if(i.tag==="Nothing")return E("Left",it("AtKey",a,co));s()}});var vo={gEncodeJson:t=>e=>Yn};var zo={encodeJson:ct};var Tr=t=>({encodeJson:(()=>{let e=j(t.encodeJson);return n=>e(n)})()});var Dn=t=>e=>n=>()=>({gEncodeJson:r=>o=>{let a=n.reflectSymbol(Y),i=t.encodeJson(te(n.reflectSymbol(Y))(r));return so(d=>()=>(d[a]=i,d))(e.gEncodeJson(r)(Y))}});function Mr(t,e,n){try{return e(JSON.parse(n))}catch(r){return t(r.message)}}var ys=(()=>({left:t=>e=>{if(e.tag==="Left")return E("Left",t(e._1));if(e.tag==="Right")return E("Right",e._1);s()},right:Re.map,Profunctor0:()=>jn}))();var Gt=function(){var t={},e="Pure",n="Throw",r="Catch",o="Sync",a="Async",i="Bind",d="Bracket",$="Fork",u="Sequential",f="Map",p="Apply",c="Alt",T="Cons",H="Resume",ot="Release",Nt="Finalizer",A="Finalized",K="Forked",Wt="Fiber",Jt="Thunk";function M(C,U,tt,O){this.tag=C,this._1=U,this._2=tt,this._3=O}function lt(C){var U=function(tt,O,x){return new M(C,tt,O,x)};return U.tag=C,U}function ie(C){return new M(e,void 0)}function wr(C){try{C()}catch(U){setTimeout(function(){throw U},0)}}function Ve(C,U,tt){try{return U(tt())}catch(O){return C(O)}}function dd(C,U,tt){try{return U(tt)()}catch(O){return tt(C(O))(),ie}}var Cn=function(){var C=1024,U=0,tt=0,O=new Array(C),x=!1;function h(){var B;for(x=!0;U!==0;)U--,B=O[tt],O[tt]=void 0,tt=(tt+1)%C,B();x=!1}return{isDraining:function(){return x},enqueue:function(B){var R,Z;U===C&&(Z=x,h(),x=Z),O[(tt+U)%C]=B,U++,x||h()}}}();function ud(C){var U={},tt=0,O=0;return{register:function(x){var h=tt++;x.onComplete({rethrow:!0,handler:function(B){return function(){O--,delete U[h]}}})(),U[h]=x,O++},isEmpty:function(){return O===0},killAll:function(x,h){return function(){if(O===0)return h();var B=0,R={};function Z(V){R[V]=U[V].kill(x,function(at){return function(){delete R[V],B--,C.isLeft(at)&&C.fromLeft(at)&&setTimeout(function(){throw C.fromLeft(at)},0),B===0&&h()}})()}for(var ht in U)U.hasOwnProperty(ht)&&(B++,Z(ht));return U={},tt=0,O=0,function(V){return new M(o,function(){for(var at in R)R.hasOwnProperty(at)&&R[at]()})}}}}}var Pe=0,Pt=1,Ln=2,En=3,xn=4,qt=5,je=6;function Wr(C,U,tt){var O=0,x=Pe,h=tt,B=null,R=null,Z=null,ht=null,V=null,at=0,De=0,Ot=null,le=!0;function $e(N){for(var I,W,z;;)switch(I=null,W=null,z=null,x){case Ln:x=Pt;try{h=Z(h),ht===null?Z=null:(Z=ht._1,ht=ht._2)}catch(bt){x=qt,B=C.left(bt),h=null}break;case En:C.isLeft(h)?(x=qt,B=h,h=null):Z===null?x=qt:(x=Ln,h=C.fromRight(h));break;case Pt:switch(h.tag){case i:Z&&(ht=new M(T,Z,ht)),Z=h._2,x=Pt,h=h._1;break;case e:Z===null?(x=qt,h=C.right(h._1)):(x=Ln,h=h._1);break;case o:x=En,h=Ve(C.left,C.right,h._1);break;case a:x=xn,h=dd(C.left,h._1,function(bt){return function(){O===N&&(O++,Cn.enqueue(function(){O===N+1&&(x=En,h=bt,$e(O))}))}});return;case n:x=qt,B=C.left(h._1),h=null;break;case r:Z===null?V=new M(T,h,V,R):V=new M(T,h,new M(T,new M(H,Z,ht),V,R),R),Z=null,ht=null,x=Pt,h=h._1;break;case d:at++,Z===null?V=new M(T,h,V,R):V=new M(T,h,new M(T,new M(H,Z,ht),V,R),R),Z=null,ht=null,x=Pt,h=h._1;break;case $:x=En,I=Wr(C,U,h._2),U&&U.register(I),h._1&&I.run(),h=C.right(I);break;case u:x=Pt,h=ld(C,U,h._1);break}break;case qt:if(Z=null,ht=null,V===null)x=je,h=R||B||h;else switch(I=V._3,z=V._1,V=V._2,z.tag){case r:R&&R!==I&&at===0?x=qt:B&&(x=Pt,h=z._2(C.fromLeft(B)),B=null);break;case H:R&&R!==I&&at===0||B?x=qt:(Z=z._1,ht=z._2,x=Ln,h=C.fromRight(h));break;case d:at--,B===null&&(W=C.fromRight(h),V=new M(T,new M(ot,z._2,W),V,I),(R===I||at>0)&&(x=Pt,h=z._3(W)));break;case ot:V=new M(T,new M(A,h,B),V,R),x=Pt,R&&R!==I&&at===0?h=z._1.killed(C.fromLeft(R))(z._2):B?h=z._1.failed(C.fromLeft(B))(z._2):h=z._1.completed(C.fromRight(h))(z._2),B=null,at++;break;case Nt:at++,V=new M(T,new M(A,h,B),V,R),x=Pt,h=z._1;break;case A:at--,x=qt,h=z._1,B=z._2;break}break;case je:for(var nt in Ot)Ot.hasOwnProperty(nt)&&(le=le&&Ot[nt].rethrow,wr(Ot[nt].handler(h)));Ot=null,R&&B?setTimeout(function(){throw C.fromLeft(B)},0):C.isLeft(h)&&le&&setTimeout(function(){if(le)throw C.fromLeft(h)},0);return;case Pe:x=Pt;break;case xn:return}}function et(N){return function(){if(x===je)return le=le&&N.rethrow,N.handler(h)(),function(){};var I=De++;return Ot=Ot||{},Ot[I]=N,function(){Ot!==null&&delete Ot[I]}}}function F(N,I){return function(){if(x===je)return I(C.right(void 0))(),function(){};var W=et({rethrow:!1,handler:function(){return I(C.right(void 0))}})();switch(x){case Pe:R=C.left(N),x=je,h=R,$e(O);break;case xn:R===null&&(R=C.left(N)),at===0&&(x===xn&&(V=new M(T,new M(Nt,h(N)),V,R)),x=qt,h=null,B=null,$e(++O));break;default:R===null&&(R=C.left(N)),at===0&&(x=qt,h=null,B=null)}return W}}function w(N){return function(){var I=et({rethrow:!1,handler:N})();return x===Pe&&$e(O),I}}return{kill:F,join:w,onComplete:et,isSuspended:function(){return x===Pe},run:function(){x===Pe&&(Cn.isDraining()?$e(O):Cn.enqueue(function(){$e(O)}))}}}function cd(C,U,tt,O){var x=0,h={},B=0,R={},Z=new Error("[ParAff] Early exit"),ht=null,V=t;function at(et,F,w){var N=F,I=null,W=null,z=0,nt={},bt,Qe;t:for(;;)switch(bt=null,N.tag){case K:if(N._3===t&&(bt=h[N._1],nt[z++]=bt.kill(et,function($d){return function(){z--,z===0&&w($d)()}})),I===null)break t;N=I._2,W===null?I=null:(I=W._1,W=W._2);break;case f:N=N._2;break;case p:case c:I&&(W=new M(T,I,W)),I=N,N=N._1;break}if(z===0)w(C.right(void 0))();else for(Qe=0,bt=z;Qe<bt;Qe++)nt[Qe]=nt[Qe]();return nt}function De(et,F,w){var N,I,W,z,nt,bt;C.isLeft(et)?(N=et,I=null):(I=et,N=null);t:for(;;){if(W=null,z=null,nt=null,bt=null,ht!==null)return;if(F===null){O(N||I)();return}if(F._3!==t)return;switch(F.tag){case f:N===null?(F._3=C.right(F._1(C.fromRight(I))),I=F._3):F._3=N;break;case p:if(W=F._1._3,z=F._2._3,N){if(F._3=N,nt=!0,bt=B++,R[bt]=at(Z,N===W?F._2:F._1,function(){return function(){delete R[bt],nt?nt=!1:w===null?De(N,null,null):De(N,w._1,w._2)}}),nt){nt=!1;return}}else{if(W===t||z===t)return;I=C.right(C.fromRight(W)(C.fromRight(z))),F._3=I}break;case c:if(W=F._1._3,z=F._2._3,W===t&&C.isLeft(z)||z===t&&C.isLeft(W))return;if(W!==t&&C.isLeft(W)&&z!==t&&C.isLeft(z))N=I===W?z:W,I=null,F._3=N;else if(F._3=I,nt=!0,bt=B++,R[bt]=at(Z,I===W?F._2:F._1,function(){return function(){delete R[bt],nt?nt=!1:w===null?De(I,null,null):De(I,w._1,w._2)}}),nt){nt=!1;return}break}w===null?F=null:(F=w._1,w=w._2)}}function Ot(et){return function(F){return function(){delete h[et._1],et._3=F,De(F,et._2._1,et._2._2)}}}function le(){var et=Pt,F=tt,w=null,N=null,I,W;t:for(;;)switch(I=null,W=null,et){case Pt:switch(F.tag){case f:w&&(N=new M(T,w,N)),w=new M(f,F._1,t,t),F=F._2;break;case p:w&&(N=new M(T,w,N)),w=new M(p,t,F._2,t),F=F._1;break;case c:w&&(N=new M(T,w,N)),w=new M(c,t,F._2,t),F=F._1;break;default:W=x++,et=qt,I=F,F=new M(K,W,new M(T,w,N),t),I=Wr(C,U,I),I.onComplete({rethrow:!1,handler:Ot(F)})(),h[W]=I,U&&U.register(I)}break;case qt:if(w===null)break t;w._1===t?(w._1=F,et=Pt,F=w._2,w._2=t):(w._2=F,F=w,N===null?w=null:(w=N._1,N=N._2))}for(V=F,W=0;W<x;W++)h[W].run()}function $e(et,F){ht=C.left(et);var w;for(var N in R)if(R.hasOwnProperty(N)){w=R[N];for(N in w)w.hasOwnProperty(N)&&w[N]()}R=null;var I=at(et,V,F);return function(W){return new M(a,function(z){return function(){for(var nt in I)I.hasOwnProperty(nt)&&I[nt]();return ie}})}}return le(),function(et){return new M(a,function(F){return function(){return $e(et,F)}})}}function ld(C,U,tt){return new M(a,function(O){return function(){return cd(C,U,tt,O)}})}return M.EMPTY=t,M.Pure=lt(e),M.Throw=lt(n),M.Catch=lt(r),M.Sync=lt(o),M.Async=lt(a),M.Bind=lt(i),M.Bracket=lt(d),M.Fork=lt($),M.Seq=lt(u),M.ParMap=lt(f),M.ParApply=lt(p),M.ParAlt=lt(c),M.Fiber=Wr,M.Supervisor=ud,M.Scheduler=Cn,M.nonCanceler=ie,M}(),Ne=Gt.Pure,kc=Gt.Throw;function Ds(t){return function(e){return e.tag===Gt.Pure.tag?Gt.Pure(t(e._1)):Gt.Bind(e,function(n){return Gt.Pure(t(n))})}}function Bt(t){return function(e){return Gt.Bind(t,e)}}var oe=Gt.Sync;var Hc=Gt.Async;function Cr(t,e){return function(){return Gt.Fiber(t,null,e)}}var Vc=function(){function t(n,r){return n===0&&typeof setImmediate<"u"?setImmediate(r):setTimeout(r,n)}function e(n,r){return n===0&&typeof clearImmediate<"u"?clearImmediate(r):clearTimeout(r)}return function(n,r){return Gt.Async(function(o){return function(){var a=t(r,o(n()));return function(){return Gt.Sync(function(){return n(e(r,a))})}}})}}(),jc=Gt.Seq;var Uo={map:Ds};var Go={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;s()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return pn("unsafeFromLeft: Right");s()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return pn("unsafeFromRight: Left");s()},left:fe,right:yt};var bs={Applicative0:()=>Lr,Bind1:()=>Qc},Qc={bind:Bt,Apply0:()=>Ts},Ts={apply:t=>e=>Bt(t)(n=>Bt(e)(r=>Lr.pure(n(r)))),Functor0:()=>Uo},Lr={pure:Ne,Apply0:()=>Ts};var Er={liftEffect:oe,Monad0:()=>bs};var Ms={tailRecM:t=>{let e=n=>Bt(t(n))(r=>{if(r.tag==="Done")return Ne(r._1);if(r.tag==="Loop")return e(r._1);s()});return e},Monad0:()=>bs};var Cs={liftAff:t=>t,MonadEffect0:()=>Er};var Ls=(()=>ia(Ct)(zn.compare))(),Es=(()=>Jn(Ct)(zn.compare))(),al=t=>{let e=Ls(j(u=>u.y)(t)),n=(()=>{if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;s()})(),r=Es(j(u=>u.y)(t)),o=(()=>{if(r.tag==="Nothing")return 0;if(r.tag==="Just")return r._1;s()})(),a=Ls(j(u=>u.x)(t)),i=(()=>{if(a.tag==="Nothing")return 0;if(a.tag==="Just")return a._1;s()})(),d=Es(j(u=>u.x)(t)),$=(()=>{if(d.tag==="Nothing")return 0;if(d.tag==="Just")return d._1;s()})();return j(u=>({x:.05+(u.x-i)*.9/($-i),y:.05+(u.y-n)*.9/(o-n)}))(t)},il=(()=>3.141592653589793*(3-ln(5)))(),sl=t=>t===0?[]:j(e=>{let n=10*ln(.5+wt(e)),r=wt(e)*il;return{x:n*ni(r),y:n*er(r)}})((()=>{let e=t-1|0;return 0>e?[]:Ut(0)(e)})()),dl=t=>e=>n=>r=>pt(o=>a=>{let i=a.x,d=a.y,$=Rt(pt(u=>f=>{if(o===u)return{x:0,y:0};let p=(i-f.x)*(i-f.x)+(d-f.y)*(d-f.y),c=t/p,T=ln(p);return{x:c*(i-f.x)/T,y:c*(d-f.y)/T}})(r))(pt(u=>f=>{if(!We(Eo)(Ee(o,u))(n))return{x:0,y:0};let p=ln((i-f.x)*(i-f.x)+(d-f.y)*(d-f.y)),c=e*(1-p);return{x:c*(i-f.x)/p,y:c*(d-f.y)/p}})(r));return{x:i+ne(ur)(0)(j(u=>u.x)($)),y:d+ne(ur)(0)(j(u=>u.y)($))}})(r),xs=t=>e=>al(ne(n=>r=>dl(.05)(.1)(e)(n))(sl(t))(Ut(1)(300)));function xr(t){return function(e){return t===e}}var G=(t,e,n)=>({tag:t,_1:e,_2:n});var Oo=t=>({liftEffect:e=>g(b("Bind",G("Lift",t.liftEffect(e)),n=>g(b("Return",n),_)),_),Monad0:()=>gs});var Is=t=>{let e=Oo(t.MonadEffect0());return{liftAff:n=>g(b("Bind",G("Lift",t.liftAff(n)),r=>g(b("Return",r),_)),_),MonadEffect0:()=>e}},As=t=>({map:e=>n=>{if(n.tag==="State")return G("State",r=>{let o=n._1(r);return D(e(o._1),o._2)});if(n.tag==="Lift")return G("Lift",t.map(e)(n._1));if(n.tag==="Subscribe")return G("Subscribe",n._1,r=>e(n._2(r)));if(n.tag==="Unsubscribe")return G("Unsubscribe",n._1,e(n._2));s()}});var Nr=(()=>Oo(Er).liftEffect)(),ae=ji(Je)(ys),Ir=g(b("Bind",G("State",t=>D(t,t)),t=>g(b("Return",t),_)),_),Ss=Is(Cs),$l=Ci(Ss),Rs={reflectSymbol:()=>"y"},ws={reflectSymbol:()=>"x"},Ws={reflectSymbol:()=>"layout"},Js={reflectSymbol:()=>"edges"},qs=(()=>{let t=Dn(Tr(xi))(Dn(Tr((()=>{let e=Dn(zo)(Dn(zo)(vo)(Rs)())(ws)();return{encodeJson:n=>e.gEncodeJson(n)(Y)}})()))(vo)(Ws)())(Js)();return{encodeJson:e=>t.gEncodeJson(e)(Y)}})(),pl=(()=>Tr(qs).encodeJson)(),fl=Li(Ss),Ps=br({decodeJsonField:t=>t.tag==="Just"?m("Just",he(e=>E("Left",it("TypeMismatch","Number")),e=>E("Left",it("TypeMismatch","Number")),yt,e=>E("Left",it("TypeMismatch","Number")),e=>E("Left",it("TypeMismatch","Number")),e=>E("Left",it("TypeMismatch","Number")),t._1)):l}),vs=qo(br((()=>{let t=Ge(Ni.decodeJson);return{decodeJsonField:e=>e.tag==="Just"?m("Just",t(e._1)):l}})())(br((()=>{let t=Ge(qo(Ps(Ps(Jo)(Rs)()())(ws)()())().decodeJson);return{decodeJsonField:e=>e.tag==="Just"?m("Just",t(e._1)):l}})())(Jo)(Ws)()())(Js)()())(),ml=(()=>Ge(vs.decodeJson))(),gl=(()=>Jn(Ct)(ft.compare))(),hl=t=>e=>{let n=ft.compare(t)(e);if(n.tag==="LT")return e;if(n.tag==="EQ"||n.tag==="GT")return t;s()},yl=t=>e=>{let n=ft.compare(t)(e);if(n.tag==="LT"||n.tag==="EQ")return t;if(n.tag==="GT")return e;s()};var zs=t=>{if(t.tag==="AddVertex"){let e=Nr(Co(t._1));return g(e._1,xt(e._2)(Ft("CatCons",n=>{if(n.tag==="Nothing")return g(b("Return",void 0),_);if(n.tag==="Just"){let r=n._1;return g(b("Bind",G("State",o=>D(void 0,(()=>{if(o.editmode.tag!=="MoveMode"&&o.editmode.tag==="VertexMode"){let a=ae(Ri(r))(o);return{selectedAlgorithm:a.selectedAlgorithm,results:[],currentStep:0,selectedResultIndex:0,graphs:a.graphs,selectedGraphIdx:a.selectedGraphIdx,editmode:a.editmode,selectedVertex:a.selectedVertex,currentPosition:a.currentPosition,dialog:a.dialog}}return o})())),o=>g(b("Return",o),_)),_)}s()},Lt(v,v))))}if(t.tag==="SelectVertex"){let e=t._1,n=Nr(bo(t._2));return g(n._1,xt(n._2)(Ft("CatCons",()=>g(b("Bind",G("State",r=>D(void 0,We(Ui)(r.editmode)([hr,_n])?{...r,selectedVertex:m("Just",e)}:r)),r=>g(b("Return",r),_)),_),Lt(v,v))))}if(t.tag==="GraphMove"){let e=Nr(Co(t._1));return g(e._1,xt(e._2)(Ft("CatCons",n=>g(b("Bind",G("State",r=>D(void 0,(()=>{let o=a=>({currentPosition:m("Just",a),currentStep:r.currentStep,dialog:r.dialog,editmode:r.editmode,graphs:r.graphs,results:r.results,selectedAlgorithm:r.selectedAlgorithm,selectedGraphIdx:r.selectedGraphIdx,selectedResultIndex:r.selectedResultIndex,selectedVertex:r.selectedVertex});if(n.tag==="Just"){if(r.selectedVertex.tag==="Just"){if(r.editmode.tag==="MoveMode"){let a=ae(Fi(r.selectedVertex._1)(n._1))(r);return{selectedAlgorithm:a.selectedAlgorithm,results:[],currentStep:0,selectedResultIndex:0,graphs:a.graphs,selectedGraphIdx:a.selectedGraphIdx,editmode:a.editmode,selectedVertex:a.selectedVertex,currentPosition:a.currentPosition,dialog:a.dialog}}return r.editmode.tag==="AddEMode"?o(n._1):r}return r.editmode.tag==="AddEMode"?o(n._1):r}return r})())),r=>g(b("Return",r),_)),_),Lt(v,v))))}if(t.tag==="DropOrLeave")return g(b("Bind",G("State",e=>D(void 0,(()=>e.editmode.tag==="MoveMode"||e.editmode.tag==="VertexMode"?!1:e.editmode.tag==="AddEMode")()?{...e,selectedVertex:l}:e)),e=>g(b("Return",e),_)),_);if(t.tag==="PointerUp"){let e=t._1;return g(b("Bind",G("State",n=>D(void 0,(()=>{if(n.editmode.tag==="MoveMode")return{selectedVertex:l,currentPosition:l,editmode:n.editmode,currentStep:n.currentStep,dialog:n.dialog,graphs:n.graphs,results:n.results,selectedAlgorithm:n.selectedAlgorithm,selectedGraphIdx:n.selectedGraphIdx,selectedResultIndex:n.selectedResultIndex};if(n.editmode.tag==="AddEMode"){if(n.selectedVertex.tag==="Just"){let r=ae(wi(e)(n.selectedVertex._1))(n);return{selectedAlgorithm:r.selectedAlgorithm,results:[],currentStep:0,selectedResultIndex:0,graphs:r.graphs,selectedGraphIdx:r.selectedGraphIdx,editmode:r.editmode,selectedVertex:l,currentPosition:r.currentPosition,dialog:r.dialog}}return n}return n})())),n=>g(b("Return",n),_)),_)}if(t.tag==="DeleteVertex"){let e=t._2,n=t._1;return g(Ir._1,xt(Ir._2)(Ft("CatCons",r=>{let o=Nr(bo(e));return r.editmode.tag==="MoveMode"?g(o._1,xt(o._2)(Ft("CatCons",()=>g(b("Bind",G("State",a=>D(void 0,(()=>{if((()=>a.editmode.tag==="MoveMode"||a.editmode.tag==="VertexMode"||a.editmode.tag==="AddEMode"?!1:a.editmode.tag==="DeleteMode")()){let i=ae(xo(n))(a);return{selectedAlgorithm:i.selectedAlgorithm,results:[],currentStep:0,selectedResultIndex:0,graphs:i.graphs,selectedGraphIdx:i.selectedGraphIdx,editmode:i.editmode,selectedVertex:i.selectedVertex,currentPosition:i.currentPosition,dialog:i.dialog}}return a})())),a=>g(b("Return",a),_)),_),Lt(v,v)))):g(b("Return",void 0),xt(_)(Ft("CatCons",()=>g(b("Bind",G("State",a=>D(void 0,(()=>{if((()=>a.editmode.tag==="MoveMode"||a.editmode.tag==="VertexMode"||a.editmode.tag==="AddEMode"?!1:a.editmode.tag==="DeleteMode")()){let i=ae(xo(n))(a);return{selectedAlgorithm:i.selectedAlgorithm,results:[],currentStep:0,selectedResultIndex:0,graphs:i.graphs,selectedGraphIdx:i.selectedGraphIdx,editmode:i.editmode,selectedVertex:i.selectedVertex,currentPosition:i.currentPosition,dialog:i.dialog}}return a})())),a=>g(b("Return",a),_)),_),Lt(v,v))))},Lt(v,v))))}if(t.tag==="DeleteEdge"){let e=t._1._1,n=t._1._2;return g(b("Bind",G("State",r=>D(void 0,(()=>{if((()=>r.editmode.tag==="MoveMode"||r.editmode.tag==="VertexMode"||r.editmode.tag==="AddEMode"?!1:r.editmode.tag==="DeleteMode")()){let o=ae(Ai(e)(n))(r);return{selectedAlgorithm:o.selectedAlgorithm,results:[],currentStep:0,selectedResultIndex:0,graphs:o.graphs,selectedGraphIdx:o.selectedGraphIdx,editmode:o.editmode,selectedVertex:o.selectedVertex,currentPosition:o.currentPosition,dialog:o.dialog}}return r})())),r=>g(b("Return",r),_)),_)}if(t.tag==="ClearGraph")return g(b("Bind",G("State",e=>D(void 0,(()=>{let n=ae(r=>({layout:[],edges:[]}))(e);return{selectedAlgorithm:n.selectedAlgorithm,results:[],currentStep:0,selectedResultIndex:0,graphs:n.graphs,selectedGraphIdx:n.selectedGraphIdx,editmode:n.editmode,selectedVertex:n.selectedVertex,currentPosition:n.currentPosition,dialog:n.dialog}})())),e=>g(b("Return",e),_)),_);if(t.tag==="GenBigGraph")return g(b("Bind",G("State",e=>D(void 0,(()=>{let n=ae(r=>Si)(e);return{selectedAlgorithm:n.selectedAlgorithm,results:[],currentStep:0,selectedResultIndex:0,graphs:n.graphs,selectedGraphIdx:n.selectedGraphIdx,editmode:n.editmode,selectedVertex:n.selectedVertex,currentPosition:n.currentPosition,dialog:n.dialog}})())),e=>g(b("Return",e),_)),_);if(t.tag==="SetEditMode"){let e=t._1;return g(b("Bind",G("State",n=>D(void 0,{...n,editmode:e})),n=>g(b("Return",n),_)),_)}if(t.tag==="AdjustGraph")return g(b("Bind",G("State",e=>D(void 0,ae(n=>({layout:xs(n.layout.length)(n.edges),edges:n.edges}))(e))),e=>g(b("Return",e),_)),_);if(t.tag==="SetGraph"){let e=t._1;return g(b("Bind",G("State",n=>D(void 0,{selectedAlgorithm:n.selectedAlgorithm,results:[],currentStep:0,selectedResultIndex:0,graphs:n.graphs,selectedGraphIdx:(()=>e==="1"?0:e==="2"?1:e==="3"?2:e==="4"?3:0)(),editmode:n.editmode,selectedVertex:n.selectedVertex,currentPosition:n.currentPosition,dialog:n.dialog})),n=>g(b("Return",n),_)),_)}if(t.tag==="SetAlgo"){let e=t._1;return g(b("Bind",G("State",n=>D(void 0,{selectedAlgorithm:(()=>e==="alpha"?yr:e==="decdegree"?qi:e==="welsh"?vi:e==="dsatur"?zi:e==="custom"?xe("CustomAlgorithm",(()=>{let r=re(n).layout.length-1|0;return 0>r?[]:Ut(0)(r)})()):yr)(),currentPosition:n.currentPosition,currentStep:n.currentStep,dialog:n.dialog,editmode:n.editmode,graphs:n.graphs,results:n.results,selectedGraphIdx:n.selectedGraphIdx,selectedResultIndex:n.selectedResultIndex,selectedVertex:n.selectedVertex})),n=>g(b("Return",n),_)),_)}if(t.tag==="CustomAlgoTextChange"){let e=t._1;return g(b("Bind",G("State",n=>D(void 0,(()=>{let r=Gi(e);if(r.tag==="Nothing")return n;if(r.tag==="Just")return{...n,selectedAlgorithm:xe("CustomAlgorithm",r._1)};s()})())),n=>g(b("Return",n),_)),_)}if(t.tag==="SetResultIndex"){let e=t._1;return g(b("Bind",G("State",n=>D(void 0,{...n,selectedResultIndex:e,currentStep:0})),n=>g(b("Return",n),_)),_)}if(t.tag==="Save")return g(Ir._1,xt(Ir._2)(Ft("CatCons",e=>$l("coloring-graphs")(tr(pl(e.graphs))),Lt(v,v))));if(t.tag==="Load"){let e=fl("coloring-graphs");return g(e._1,xt(e._2)(Ft("CatCons",n=>{if(n.tag==="Nothing")return g(b("Return",void 0),_);if(n.tag==="Just"){let r=Mr(fe,yt,n._1);if(r.tag==="Left")return g(b("Return",void 0),_);if(r.tag==="Right"){let o=ml(r._1);if(o.tag==="Left")return g(b("Return",void 0),_);if(o.tag==="Right"){let a=o._1;return g(b("Bind",G("State",i=>D(void 0,{...i,graphs:a})),i=>g(b("Return",i),_)),_)}s()}s()}s()},Lt(v,v))))}if(t.tag==="OpenImportDialog")return g(b("Bind",G("State",e=>D(void 0,{...e,dialog:yn("ImportDialog","")})),e=>g(b("Return",e),_)),_);if(t.tag==="ChangeImportText"){let e=t._1;return g(b("Bind",G("State",n=>D(void 0,{...n,dialog:yn("ImportDialog",e)})),n=>g(b("Return",n),_)),_)}if(t.tag==="ImportAndClose")return g(b("Bind",G("State",e=>D(void 0,(()=>{if(e.dialog.tag==="ImportDialog"){let n=Mr(fe,yt,e.dialog._1);if(n.tag==="Left")return{dialog:Oe,currentPosition:e.currentPosition,currentStep:e.currentStep,editmode:e.editmode,graphs:e.graphs,results:e.results,selectedAlgorithm:e.selectedAlgorithm,selectedGraphIdx:e.selectedGraphIdx,selectedResultIndex:e.selectedResultIndex,selectedVertex:e.selectedVertex};if(n.tag==="Right"){let r=vs.decodeJson(n._1);if(r.tag==="Left")return{dialog:Oe,currentPosition:e.currentPosition,currentStep:e.currentStep,editmode:e.editmode,graphs:e.graphs,results:e.results,selectedAlgorithm:e.selectedAlgorithm,selectedGraphIdx:e.selectedGraphIdx,selectedResultIndex:e.selectedResultIndex,selectedVertex:e.selectedVertex};if(r.tag==="Right"){let o=r._1,a=ae(i=>o)(e);return{dialog:Oe,currentPosition:a.currentPosition,currentStep:a.currentStep,editmode:a.editmode,graphs:a.graphs,results:a.results,selectedAlgorithm:a.selectedAlgorithm,selectedGraphIdx:a.selectedGraphIdx,selectedResultIndex:a.selectedResultIndex,selectedVertex:a.selectedVertex}}s()}s()}return e})())),e=>g(b("Return",e),_)),_);if(t.tag==="Export")return g(b("Bind",G("State",e=>D(void 0,{dialog:yn("ExportDialog",tr(qs.encodeJson(re(e)))),currentPosition:e.currentPosition,currentStep:e.currentStep,editmode:e.editmode,graphs:e.graphs,results:e.results,selectedAlgorithm:e.selectedAlgorithm,selectedGraphIdx:e.selectedGraphIdx,selectedResultIndex:e.selectedResultIndex,selectedVertex:e.selectedVertex})),e=>g(b("Return",e),_)),_);if(t.tag==="CloseDialog")return g(b("Bind",G("State",e=>D(void 0,{...e,dialog:Oe})),e=>g(b("Return",e),_)),_);if(t.tag==="Compute")return g(b("Bind",G("State",e=>D(void 0,(()=>{let n=Bi(re(e))(e.selectedAlgorithm);return{results:nn(0)(5)(Rt([{algorithm:e.selectedAlgorithm,coloring:n,number:(()=>{let r=gl(j(o=>o.color)(n));if(r.tag==="Nothing")return 1;if(r.tag==="Just")return 1+r._1|0;s()})()}])(e.results)),currentPosition:e.currentPosition,currentStep:e.currentStep,dialog:e.dialog,editmode:e.editmode,graphs:e.graphs,selectedAlgorithm:e.selectedAlgorithm,selectedGraphIdx:e.selectedGraphIdx,selectedResultIndex:e.selectedResultIndex,selectedVertex:e.selectedVertex}})())),e=>g(b("Return",e),_)),_);if(t.tag==="PreviousStep")return g(b("Bind",G("State",e=>D(void 0,{...e,currentStep:hl(0)(e.currentStep-1|0)})),e=>g(b("Return",e),_)),_);if(t.tag==="NextStep")return g(b("Bind",G("State",e=>D(void 0,{currentStep:yl(re(e).layout.length)(e.currentStep+1|0),currentPosition:e.currentPosition,dialog:e.dialog,editmode:e.editmode,graphs:e.graphs,results:e.results,selectedAlgorithm:e.selectedAlgorithm,selectedGraphIdx:e.selectedGraphIdx,selectedResultIndex:e.selectedResultIndex,selectedVertex:e.selectedVertex})),e=>g(b("Return",e),_)),_);if(t.tag==="FinishColoring")return g(b("Bind",G("State",e=>D(void 0,{currentStep:re(e).layout.length,currentPosition:e.currentPosition,dialog:e.dialog,editmode:e.editmode,graphs:e.graphs,results:e.results,selectedAlgorithm:e.selectedAlgorithm,selectedGraphIdx:e.selectedGraphIdx,selectedResultIndex:e.selectedResultIndex,selectedVertex:e.selectedVertex})),e=>g(b("Return",e),_)),_);s()};var Dl=(t,e,n,r=!1)=>{let o=[],a={},i={},d={},$={tag:t,children:n,props:a,attrs:i,events:d,node:null,keyed:r},u=e.length;for(let p=0;p<u;p++){let[c,T,H]=e[p];c===0?a[T]=H:c===1?i[T]=H:c===2?d[T]=H:c===3?i.class=i.class?i.class+" "+T:T:c===4&&o.push(T+":"+H)}let f=o.join(";");return f&&(i.style=f),$},P=(t,e,n)=>Dl(t,e,n.map(r=>({key:null,html:r})));var bl=t=>({tag:t,children:[],type:3});var st=(t,e)=>[0,t,e],Q=(t,e)=>[1,t,e],Dt=(t,e)=>[2,t,e],J=t=>[3,t],ke=[-1];var X=bl;var _e=X("");var Ho=t=>e=>P("div",[J("p-6 bg-white border border-gray-200 rounded-lg shadow")],Rt([P("div",[J("text-xl mb-2")],[X(t)])])(e)),Ar="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700",ko=(()=>Ar+" rounded")(),Us=t=>{let e=t.onClick;return P("button",Rt([J(ko),Dt("click",n=>()=>m("Just",e))])(t.attrs),[X(t.name)])},Vo=t=>e=>n=>P("div",[J("absolute w-full h-full flex items-center justify-center bg-transp-grey inset-0 z-50")],[P("div",[J("bg-white text-black rounded block border-2")],[P("div",[J("p-4 min-h-8 border-b-2")],[P("div",[J("text-4xl font-medium inline-block")],[X(t)])]),P("div",[J("p-6 border-b-2")],e),P("div",[J("p-4 text-right")],pt(r=>o=>{let a=o.onClick;return P("button",[J(r===0?ko+"":ko+" ml-4"),Dt("click",i=>()=>m("Just",a))],[X(o.name)])})(n))])]),bn=t=>{let e=t.length;return P("div",[],pt(n=>r=>{let o=r.onClick;return P("button",Rt([J((()=>n===0?Ar+" rounded-l":n===(e-1|0)?Ar+" rounded-r":Ar+"")()),Dt("click",a=>()=>m("Just",o))])(r.attrs),[X(r.name)])})(t))};var Fr=t=>e=>n=>r=>Q("viewBox",$t(t)+" "+$t(e)+" "+$t(n)+" "+$t(r));var Tl=t=>e=>P("line",[Q("x1",$t(100*t.x)),Q("y1",$t(100*t.y)),Q("x2",$t(100*e.x)),Q("y2",$t(100*e.y)),J("graphparams-graphview-edge pointer-events-none")],[]),Os=t=>{let e=t.editmode,n=re(t);return P("div",[],[P("div",[J("graphparams-graphview-board")],[P("svg",[J("block"),Fr(0)(0)(100)(100),Dt("click",r=>()=>m("Just",k("AddVertex",r))),Dt("pointerup",r=>()=>m("Just",Io)),Dt("pointerleave",r=>()=>m("Just",Io)),Dt("pointermove",r=>()=>m("Just",k("GraphMove",r)))],[P("g",[],j(r=>{let o=Pi(n)(r);if(o.tag==="Nothing")return _e;if(o.tag==="Just")return P("line",[Q("x1",$t(100*o._1.x1)),Q("y1",$t(100*o._1.y1)),Q("x2",$t(100*o._1.x2)),Q("y2",$t(100*o._1.y2)),J("graphparams-graphview-edge"),e.tag==="DeleteMode"?J("deletemode"):ke,Dt("click",a=>()=>m("Just",k("DeleteEdge",r)))],[]);s()})(n.edges)),P("g",[],Bn(Ur)(pt(r=>o=>{let a=o.x,i=o.y;return d=>P("circle",[Q("cx",$t(100*a)),Q("cy",$t(100*i)),Q("r","4"),Q("stroke-width","0.5"),J("graphparams-graphview-vertex color"+ee(d)),e.tag==="DeleteMode"?J("deletemode"):ke,(()=>{let $=Ki(r);return Dt("click",u=>{let f=m("Just",$(u));return()=>f})})(),(()=>{let $=Qi(r);return Dt("pointerdown",u=>{let f=m("Just",$(u));return()=>f})})(),Dt("pointerup",$=>()=>m("Just",k("PointerUp",r)))],[])})(n.layout))(Oi(t))),re(t).layout.length<=26?P("g",[],pt(r=>o=>P("text",[J("pointer-events-none graphview-text"),Q("x",$t(100*o.x-2)),Q("y",$t(100*o.y+2))],[X(ki(r))]))(n.layout)):_e,(()=>{if(e.tag==="AddEMode"){let r=t.selectedVertex.tag==="Just"?Ke.apply(t.currentPosition.tag==="Just"?m("Just",Tl(t.currentPosition._1)):l)(Ht(n.layout)(t.selectedVertex._1)):l;if(r.tag==="Nothing")return _e;if(r.tag==="Just")return r._1;s()}return _e})()])]),bn([{name:"D\xE9placer",onClick:k("SetEditMode",_n),attrs:[st("selected",e.tag==="MoveMode")]},{name:"Ajouter sommet",onClick:k("SetEditMode",Wi),attrs:[st("selected",e.tag==="VertexMode")]},{name:"Ajouter ar\xEAte",onClick:k("SetEditMode",hr),attrs:[st("selected",e.tag==="AddEMode")]},{name:"Retirer",onClick:k("SetEditMode",Ji),attrs:[st("selected",e.tag==="DeleteMode")]},{name:"Tout effacer",onClick:Yi,attrs:[]},{name:"Ajuster",onClick:Xi,attrs:[]},{name:"Gros graphe",onClick:Zi,attrs:[]}])])};var ks=(t,e,n)=>typeof t.value=="string"?n(t.value):e;var Tn=t=>Dt("change",e=>{let n=gt(Le(e),l,S);if(n.tag==="Just"){let r=n._1;return()=>{let o=ks(r,l,S);return o.tag==="Just"?m("Just",t(o._1)):l}}if(n.tag==="Nothing")return()=>l;s()});var El=t=>Vo("Importer les graphes")([P("textarea",[J("block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"),Q("cols","150"),Q("rows","30"),st("value",t),Tn(ss)],[])])([{name:"Annuler",onClick:Ao},{name:"OK",onClick:ds}]),xl=t=>Vo("Exporter les graphes")([P("textarea",[J("block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"),Q("cols","150"),Q("rows","30"),st("value",t),st("selected",!0)],[])])([{name:"OK",onClick:Ao}]),Hs=t=>{let e=t.selectedResultIndex;return P("div",[J("flex flex-row justify-around")],[Ho("Graphe")([Os(t)]),Ho("Ordre des couleurs")([P("div",[J("w-16")],[P("svg",[Fr(0)(0)(10)(100)],j(n=>P("rect",[Q("x","0"),Q("y",ee(n*10|0)),Q("width","10"),Q("height","10"),J("color"+ee(n))],[]))(Ut(0)(9)))])]),P("div",[J("flex flex-col graphparams-help-container")],[P("span",[J("mb-2 mt-4 text-2xl font-bold")],[X("Graphe")]),P("select",[J("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),st("value","1"),Tn(ts)],[P("option",[st("value","1")],[X("Graphe 1")]),P("option",[st("value","2")],[X("Graphe 2")]),P("option",[st("value","3")],[X("Graphe 3")]),P("option",[st("value","4")],[X("Graphe 4")])]),bn([{onClick:rs,name:"Sauvegarder",attrs:[]},{onClick:as,name:"Importer",attrs:[]},{onClick:is,name:"Exporter",attrs:[]}]),P("span",[J("mb-2 mt-4 text-2xl font-bold")],[X("Algorithme")]),P("select",[J("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Q("name","dsatur"),Tn(es)],[P("option",[st("value","alpha")],[X("Alphabetique")]),P("option",[st("value","decdegree")],[X("Degr\xE9 d\xE9croissant")]),P("option",[st("value","welsh")],[X("Welsh and Powell")]),P("option",[st("value","dsatur")],[X("DSatur")]),P("option",[st("value","custom")],[X("Personnalis\xE9")])]),t.selectedAlgorithm.tag==="CustomAlgorithm"?P("input",[J("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),Q("type","text"),st("value",No(t.selectedAlgorithm._1)),Tn(ns)],[]):_e,Us({onClick:us,name:"Calculer",attrs:[]}),P("span",[J("mb-2 mt-4 text-2xl font-bold")],[X("R\xE9sultats")]),P("ul",[J("ml-4 list-disc")],Rt(pt(n=>r=>P("li",[e===n?J("text-blue-600"):ke,Dt("click",o=>()=>m("Just",k("SetResultIndex",n)))],[X(Vi(r.algorithm)+" ("+ee(r.number)+" couleurs)")]))(t.results))(gn(5-t.results.length|0)(n=>P("li",[],[])))),bn([{onClick:cs,name:"Etape pr\xE9c\xE9dente",attrs:[]},{onClick:ls,name:"Etape suivante",attrs:[]},{onClick:$s,name:"Termine la coloration",attrs:[]}])]),(()=>{if(t.dialog.tag==="NoDialog")return _e;if(t.dialog.tag==="ExportDialog")return xl(t.dialog._1);if(t.dialog.tag==="ImportDialog")return El(t.dialog._1);s()})()])};var Vs=(t,e)=>t&&e?n=>t(e(n)):t||e,js=(t,e,n)=>{t[e]=n},Qs=(t,e,n)=>{n==null||e==="class"&&!n?t.removeAttribute(e):t.setAttribute(e,n)},Ks=(t,e,n,r,o,a)=>{t.actions||(t.actions={}),t.actions[e]=a&&r?a(r):r,r?n||t.addEventListener(e,o):t.removeEventListener(e,o)},Pr=(t,e,n,r)=>{let o=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),a=t.props,i=t.attrs,d=t.events,$=Vs(r,t.mapf);for(let u in a)js(o,u,a[u]);for(let u in i)Qs(o,u,i[u]);for(let u in d)Ks(o,u,null,d[u],e,$);for(let u=0,f=t.children.length;u<f;u++)o.appendChild(Pr(Ae(t.children[u]).html,e,n,$));return t.node=o,o},Ie=(t,e,n,r,o,a,i)=>{if(n!==r){if(n!=null&&n.type===3&&r.type===3)n.tag!==r.tag&&(e.nodeValue=r.tag);else if(n==null||n.tag!==r.tag)e=t.insertBefore(Pr(r,o,a,i),e),n&&n.node.remove();else{let d=n.props,$=r.props;for(let A in{...d,...$})d[A]!==$[A]&&js(e,A,$[A]);let u=n.attrs,f=r.attrs;for(let A in{...u,...f})u[A]!==f[A]&&Qs(e,A,f[A]);let p=n.events,c=r.events;for(let A in{...p,...c})p[A]!==c[A]&&Ks(e,A,p[A],c[A],o,i);let T=n.children,H=r.children,ot=T.length-1,Nt=H.length-1;if(i=Vs(i,r.mapf),a=a||r.tag==="svg",r.keyed){let A=0,K=0;for(;K<=Nt&&A<=ot;){let{key:Wt,html:Jt}=T[A];if(Wt!==H[K].key)break;let M=Ae(H[K],Jt);Ie(e,Jt.node,Jt,M.html,o,a,i),K++,A++}for(;K<=Nt&&A<=ot;){let{key:Wt,html:Jt}=T[ot];if(Wt!==H[Nt].key)break;let M=Ae(H[Nt],Jt);Ie(e,Jt.node,Jt,M.html,o,a,i),Nt--,ot--}if(A>ot)for(;K<=Nt;){let Wt=Ae(H[K]).html;e.insertBefore(Pr(Wt,o,a,i),T[A]&&T[A].html.node),K++}else if(K>Nt)for(;A<=ot;)T[A].html.node.remove(),A++;else{let Wt={},Jt={};for(let M=A;M<=ot;M++)Wt[T[M].key]=T[M].html;for(;K<=Nt;){let{key:M,html:lt}=T[A]||{key:null,html:null},{key:ie,html:wr}=Ae(H[K],lt);if(Jt[M]||T[A+1]&&ie===T[A+1].key){A++;continue}if(M===ie)Ie(e,lt.node,lt,wr,o,a,i),Jt[ie]=!0,A++;else{let Ve=Wt[ie];Ve!=null?(Ie(e,e.insertBefore(Ve.node,lt.node),Ve,H[K].html,o,a,i),Jt[ie]=!0):Ie(e,lt&&lt.node,null,H[K].html,o,a,i)}K++}for(let M in Wt)Jt[M]||Wt[M].node.remove()}}else{for(let A=0;A<=ot&&A<=Nt;A++){let K=T[A].html,Wt=Ae(H[A],K).html;Ie(e,K.node,K,Wt,o,a,i)}for(let A=ot+1;A<=Nt;A++){let K=Ae(H[A],n).html;e.appendChild(Pr(K,o,a,i))}for(let A=Nt+1;A<=ot;A++)T[A].html.node.remove()}}return r.node=e,e}},Il=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},Ae=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||Il(e.memo,t.html.memo))&&(e=Sr(t.html.type(...t.html.memo)),e.memo=t.html.memo),t.html=e),t),Sr=t=>({...t,children:t.children&&t.children.map(({key:e,html:n})=>({key:e,html:Sr(n)}))}),Ys=(t,e)=>t.actions[e],Xs=Ie,Zs=t=>e=>(e.node=t,e);var Fe=function(t){return function(e){return function(){return e[t]}}},PM=Fe("URL"),SM=Fe("documentURI"),RM=Fe("origin"),wM=Fe("compatMode"),WM=Fe("characterSet"),JM=Fe("contentType");var Fl=Fe("documentElement");function td(t){return function(e){return function(){return e.createTextNode(t)}}}var Zt=function(t){return function(e){return function(){return e[t]}}};var aC=Zt("baseURI"),Rl=Zt("ownerDocument"),jo=Zt("parentNode"),wl=Zt("parentElement");var iC=Zt("childNodes"),Wl=Zt("firstChild"),Jl=Zt("lastChild"),ql=Zt("previousSibling"),vl=Zt("nextSibling"),zl=Zt("nodeValue");var sC=Zt("textContent");function ed(t){return function(e){return function(){e.appendChild(t)}}}var Rr=function(t){return function(e){return function(){return e[t]}}},SC=Rr("children"),Gl=Rr("firstElementChild"),Bl=Rr("lastElementChild"),RC=Rr("childElementCount");function nd(t){return function(e){return function(){return e.querySelector(t)}}}var rd=t=>{let e=nd(t);return n=>{let r=e(n);return()=>{let o=r();return gt(o,l,S)}}};var Mn=Wn(Hr)(Ze),kl=Wn(Lr)(Ze),Hl=ms(As(Uo))(Ms),Vl=t=>e=>n=>{let r=n(e);return()=>{let o=r();return Mn(o)(t.update(t))()}},od=t=>e=>{let n=t.node,r=t.vdom;return()=>{let o=r.value,a=n.value,i=jo(a)();return Mn(gt(i,l,S))(d=>{let $=Sr(e);return()=>{let u=Xs(d,a,o,$,f=>{let p=gi(f);return Mn(gt(Le(f),l,S))(c=>()=>{let T=Ys(c,p);return Vl(t)(f)(T)()})()});return n.value=u,r.value=$}})()}},jl=t=>e=>{let n=t.state;return()=>{let r=n.value,o=xr(r)(e);if(!o)return n.value=e,od(t)(t.view(e))();o||s()}},ad=t=>e=>n=>{let r=e.subscriptions;return Hl(o=>{if(o.tag==="State")return Bt(oe((()=>{let a=e.state;return()=>a.value})()))(a=>{let i=o._1(a),d=i._1;return Bt(oe(jl(e)(i._2)))(()=>Ne(d))});if(o.tag==="Lift")return o._1;if(o.tag==="Subscribe")return Bt(oe(o._1(a=>{let i=Cr(Go,ad(t)(e)(t(a)));return()=>{i().run()}})))(a=>Bt(oe((()=>{let i=e.freshId;return()=>{let d=i.value;return i.value=d+1|0,d}})()))(i=>Bt(oe((()=>{let d=sr(ft)(i)(a);return()=>{let $=r.value;r.value=d($)}})()))(()=>Ne(o._2(i)))));if(o.tag==="Unsubscribe"){let a=o._2,i=o._1;return Bt(oe(()=>r.value))(d=>Bt(kl(yo(ft)(i)(d))(oe))(()=>Ne(a)))}s()})(n)},Ql=t=>{let e=t.init.model,n=t.init.msg,r=t.selector,o=t.update,a=t.view;return()=>{let i=Be(),d=To(i)(),$=rd(r)(d)();return Mn($.tag==="Just"?m("Just",$._1):l)(u=>()=>{let f={value:e},p=Be(),c=To(p)(),T=td("")(c)();ed(T)(u)();let H={value:T},ot={value:Zs(T)(X(""))},K={view:a,update:o,state:f,node:H,vdom:ot,subscriptions:{value:Ue},freshId:{value:0}};return od(K)(a(e))(),Mn(n)(K.update(K))()})()}};var id=t=>{let e=t.update;return Ql({init:t.init,view:t.view,selector:t.selector,update:n=>r=>{let o=Cr(Go,ad(e)(n)(e(r)));return()=>{o().run()}}})};var sd=id({init:{model:Hi,msg:m("Just",os)},update:zs,view:Hs,selector:"#root"});sd();})();
