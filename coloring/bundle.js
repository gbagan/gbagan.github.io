(()=>{function s(){throw new Error("Failed pattern match")}var Zt=function(t){return function(e){return e[t]}},Te=function(t){return function(e){return function(n){var r={};for(var a in n)({}).hasOwnProperty.call(n,a)&&(r[a]=n[a]);return r[t]=e,r}}};var hd=()=>({tag:"Proxy"}),Q=hd();var zt=function(t){return t.toString()},gt=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var Qr=t=>t,lt=Qr("LT"),pt=Qr("GT"),St=Qr("EQ");var p=(t,e)=>({tag:t,_1:e}),$=p("Nothing"),F=t=>p("Just",t);var se={map:t=>e=>e.tag==="Just"?p("Just",t(e._1)):$};var Me=t=>{let e=t.Eq0(),n={eq:r=>a=>r.tag==="Nothing"?a.tag==="Nothing":r.tag==="Just"&&a.tag==="Just"&&e.eq(r._1)(a._1)};return{compare:r=>a=>{if(r.tag==="Nothing")return a.tag==="Nothing"?St:lt;if(a.tag==="Nothing")return pt;if(r.tag==="Just"&&a.tag==="Just")return t.compare(r._1)(a._1);s()},Eq0:()=>n}};var tn={apply:t=>e=>{if(t.tag==="Just")return e.tag==="Just"?p("Just",t._1(e._1)):$;if(t.tag==="Nothing")return $;s()},Functor0:()=>se};var Kr=t=>e=>t(e);var Yr={compose:t=>e=>n=>t(e(n))};var v=function(t){return function(e){for(var n=e.length,r=new Array(n),a=0;a<n;a++)r[a]=t(e[a]);return r}};var en={map:v};var Xr=t=>t;var nn=function(t){return function(e){for(var n=[],r=0,a=t.length;r<a;r++)Array.prototype.push.apply(n,e(t[r]));return n}};var _=(t,e)=>({tag:t,_1:e}),Ce=t=>_("Left",t),bt=t=>_("Right",t);var rn={map:t=>e=>{if(e.tag==="Left")return _("Left",e._1);if(e.tag==="Right")return _("Right",t(e._1));s()}};var Ed={apply:t=>e=>{if(t.tag==="Left")return _("Left",t._1);if(t.tag==="Right"){if(e.tag==="Left")return _("Left",e._1);if(e.tag==="Right")return _("Right",t._1(e._1))}s()},Functor0:()=>rn};var Zr={pure:bt,Apply0:()=>Ed};var no=function(t){return function(){return t}};var Cd={apply:t=>e=>()=>{let n=t(),r=e();return ta.pure(n(r))()},Functor0:()=>Ld},ta={pure:no,Apply0:()=>Cd},Ld={map:t=>e=>()=>{let n=e();return t(n)}};var Gt=(t,e)=>({tag:t,_1:e}),ra=t=>Gt("Loop",t),ro=t=>Gt("Done",t);var ao=function(t){return function(e){return function(){return t(e())}}},oo=function(t){return function(){return t}};var Id={map:ao};var Ad={apply:t=>e=>()=>{let n=t(),r=e();return Gn.pure(n(r))()},Functor0:()=>Id},Gn={pure:oo,Apply0:()=>Ad};var io=function(t){return function(e){return function(n){return function(r){return function(){return n>=0&&n<r.length?t(r[n]):e}}}}},we=function(t){return function(e){return function(n){return function(){var r=t>=0&&t<n.length;return r&&(n[t]=e),r}}}};var so=function(t){return function(e){return function(){return e.push.apply(e,t)}}};var an=function(t){return function(){return t}};function Fd(t){return function(){return t.slice()}}var on=Fd,Pd=function(){function t(e,n,r,a,o,i){var d,m,u,f,l,c,D;for(d=o+(i-o>>1),d-o>1&&t(e,n,a,r,o,d),i-d>1&&t(e,n,a,r,d,i),m=o,u=d,f=o;m<d&&u<i;)l=a[m],c=a[u],D=n(e(l)(c)),D>0?(r[f++]=c,++u):(r[f++]=l,++m);for(;m<d;)r[f++]=a[m++];for(;u<i;)r[f++]=a[u++]}return function(e){return function(n){return function(r){return function(){return r.length<2||t(e,n,r,r.slice(0),0,r.length),r}}}}}();var uo=t=>so([t]);var co=t=>e=>n=>{let r=io(F)($)(t)(n);return()=>{let a=r();if(a.tag==="Just")return we(t)(e(a._1))(n)();if(a.tag==="Nothing")return!1;s()}};var de=function(t){return function(e){return function(n){for(var r=e,a=n.length,o=a-1;o>=0;o--)r=t(n[o])(r);return r}}},te=function(t){return function(e){return function(n){for(var r=e,a=n.length,o=0;o<a;o++)r=t(r)(n[o]);return r}}};var Un=t=>{let e=t.Apply0();return n=>r=>n.foldr(a=>{let o=r(a);return i=>e.apply(e.Functor0().map(d=>Xr)(o))(i)})(t.pure())},Bn=t=>{let e=Un(t);return n=>{let r=e(n);return a=>o=>r(o)(a)}};var We=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return p("Just",r);if(n.tag==="Just")return p("Just",e(n._1)(r)==="GT"?n._1:r);s()})($);var po=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return p("Just",r);if(n.tag==="Just")return p("Just",e(n._1)(r)==="LT"?n._1:r);s()})($);var sn={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);s()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);s()},foldMap:t=>{let e=t.mempty;return n=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return n(r._1);s()}}};var ht={foldr:de,foldl:te,foldMap:t=>{let e=t.mempty;return n=>ht.foldr(r=>a=>t.Semigroup0().append(n(r))(a))(e)}};var x=(t,e)=>({tag:"Tuple",_1:t,_2:e}),At=t=>e=>x(t,e);var Le=t=>t._2;var kn={map:t=>e=>x(e._1,t(e._2))};var xe=t=>t._1;var dn=t=>{let e=t.Eq0();return n=>{let r=n.Eq0(),a={eq:o=>i=>e.eq(o._1)(i._1)&&r.eq(o._2)(i._2)};return{compare:o=>i=>{let d=t.compare(o._1)(i._1);return d==="LT"?lt:d==="GT"?pt:n.compare(o._2)(i._2)},Eq0:()=>a}}};var st=function(t){return function(e){for(var n=e.length,r=Array(n),a=0;a<n;a++)r[a]=t(a)(e[a]);return r}};var _o={mapWithIndex:st,Functor0:()=>en};var Do=function(t){return function(e){return t===e}};var Hn=Do,bo=Do;var un=function(t){return function(e){return function(n){if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!t(e[r])(n[r]))return!1;return!0}}};var To={eq:bo},qe={eq:Hn};var Mo=function(t){return function(e){return function(n){return function(r){return function(a){return r<a?t:r===a?e:n}}}}};var Eo=Mo,Co=Mo;var jn={compare:Co(lt)(St)(pt),Eq0:()=>To},Y={compare:Eo(lt)(St)(pt),Eq0:()=>qe};var Fo=function(){function t(a){return[a]}function e(a){return function(o){return[a,o]}}function n(a){return function(o){return function(i){return[a,o,i]}}}function r(a){return function(o){return a.concat(o)}}return function(a){return function(o){return function(i){return function(d){return function(m){function u(f,l){switch(l-f){case 0:return i([]);case 1:return o(t)(d(m[f]));case 2:return a(o(e)(d(m[f])))(d(m[f+1]));case 3:return a(a(o(n)(d(m[f])))(d(m[f+1])))(d(m[f+2]));default:var c=f+Math.floor((l-f)/4)*2;return a(o(r)(u(f,c)))(u(c,l))}}return u(0,m.length)}}}}}}();var ia=t=>t;var cn={traverse:t=>{let e=t.Apply0();return Fo(e.apply)(e.Functor0().map)(t.pure)},sequence:t=>cn.traverse(t)(ia),Functor0:()=>en,Foldable1:()=>ht};var Ft=function(t){return function(e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),a=t,o=0;a!==e;)r[o++]=a,a+=n;return r[o]=a,r}},gu=function(t){return function(e){if(t<1)return[];var n=new Array(t);return n.fill(e)}},hu=function(t){return function(e){for(var n=[],r=0,a=0;a<t;a++)n[r++]=e;return n}},$n=typeof Array.prototype.fill=="function"?gu:hu,sa=function(){function t(a,o){this.head=a,this.tail=o}var e={};function n(a){return function(o){return new t(a,o)}}function r(a){for(var o=[],i=0,d=a;d!==e;)o[i++]=d.head,d=d.tail;return o}return function(a){return function(o){return r(a(n)(e)(o))}}}();var Po=function(t){return function(e){return function(n){return function(r){return r<0||r>=n.length?e:t(n[r])}}}};var So=function(t){return function(e){return function(n){return function(r){for(var a=0,o=r.length;a<o;a++)if(n(r[a]))return t(a);return e}}}};var Ro=function(t){return function(e){return function(n){return function(r){if(n<0||n>=r.length)return e;var a=r.slice();return a.splice(n,1),t(a)}}}},Jo=function(t){return function(e){return function(n){return function(r){return function(a){if(n<0||n>=a.length)return e;var o=a.slice();return o[n]=r,t(o)}}}}};var ve=function(t){return function(e){return e.filter(t)}};var wo=function(){function t(e,n,r,a,o,i){var d,m,u,f,l,c,D;for(d=o+(i-o>>1),d-o>1&&t(e,n,a,r,o,d),i-d>1&&t(e,n,a,r,d,i),m=o,u=d,f=o;m<d&&u<i;)l=a[m],c=a[u],D=n(e(l)(c)),D>0?(r[f++]=c,++u):(r[f++]=l,++m);for(;m<d;)r[f++]=a[m++];for(;u<i;)r[f++]=a[u++]}return function(e){return function(n){return function(r){var a;return r.length<2?r:(a=r.slice(0),t(e,n,a,r.slice(0),0,r.length),a)}}}}(),ge=function(t){return function(e){return function(n){return n.slice(t,e)}}},ln=function(t){return function(e){return function(n){for(var r=e.length<n.length?e.length:n.length,a=new Array(r),o=0;o<r;o++)a[o]=t(e[o])(n[o]);return a}}};var Wo=Un(Gn);var qo=ln(At),Qn=t=>{let e=Wo(t);return n=>r=>(()=>{let a=on(r);return()=>{let o=a();return e(i=>we(i._1)(i._2)(o))(n)(),o}})()()},Kn=Jo(F)($);var Yn=t=>wo(t)(e=>{if(e==="GT")return 1;if(e==="EQ")return 0;if(e==="LT")return-1;s()}),pn=t=>e=>Yn(n=>r=>t.compare(e(n))(e(r)));var fn=t=>e=>(()=>{let n=uo(e),r=on(t);return()=>{let a=r();return n(a)(),a}})()();var vo=t=>{let e=Wo(t);return n=>r=>a=>(()=>{let o=on(a);return()=>{let i=o();return e(d=>co(d)(r)(i))(n)(),i}})()()};var ct=Po(F)($);var zo=t=>e=>{let n=Yn(a=>o=>t(a._2)(o._2))(st(At)(e)),r=ct(n)(0);if(r.tag==="Nothing")return[];if(r.tag==="Just")return v(Le)(pn(Y)(xe)((()=>{let a=an([r._1]);return()=>{let o=a();for(let i of n){let d=t((()=>{let u=ct(o)(o.length-1|0);if(u.tag==="Just")return u._1._2;s()})())(i._2);(d==="LT"||d==="GT"||d!=="EQ")&&(()=>o.push(i))()}return o}})()()));s()};var yu=So(F)($);var he=t=>e=>n=>{let r=yu(a=>t.eq(a)(e))(n);if(r.tag==="Nothing")return!1;if(r.tag==="Just")return!0;s()};var Oo=Ro(F)($);var _u=t=>e=>nn(e)(t),ze=t=>_u(e=>{let n=t(e);if(n.tag==="Nothing")return[];if(n.tag==="Just")return[n._1];s()});var If=String.fromCharCode(65535),Af=String.fromCharCode(0),Ff=Number.POSITIVE_INFINITY,Pf=Number.NEGATIVE_INFINITY;function Xn(t){return t.charCodeAt(0)}function mn(t){return String.fromCharCode(t)}var da={identity:t=>t,Semigroupoid0:()=>Yr};var Zn={dimap:t=>e=>n=>r=>e(n(t(r)))};var xu=t=>t,$e=(()=>({first:t=>e=>x(t(e._1),e._2),second:kn.map,Profunctor0:()=>Zn}))();var ua=t=>{let e=t.identity,n=t.Semigroupoid0(),r=t.Semigroupoid0();return a=>o=>i=>n.compose(r.compose(a.second(i))(a.first(o)))(a.Profunctor0().dimap(xu)(d=>x(d,d))(e))};var Nu=ua(da)($e);var nr=t=>e=>n=>r=>{let a=Nu(t)(e);return o=>r.Profunctor0().dimap(a)(i=>{if(i._2.tag==="Left")return i._2._1;if(i._2.tag==="Right")return i._1(i._2._1);s()})(n.second(r.right(o)))};var rr=t=>()=>()=>e=>n=>r=>n.Profunctor0().dimap(a=>x(Zt(t.reflectSymbol(e))(a),o=>Te(t.reflectSymbol(e))(o)(a)))(a=>a._2(a._1))(n.first(r));var Vo=function(t){return t.join("")},Qo=function(t){return t.split("")},ar=function(t){return t};var Ko=t=>e=>{let n=[],r=0,a=new Array(t.length);for(a.fill(!1);n.length<t.length;){let o=new Array(t.length);o.fill(!1);for(let i of e)if(!(a[i]||o[i])){n.push({vertex:i,color:r}),a[i]=!0;for(let d of t[i])o[d]=!0}r++}return n};var Yo=t=>t.length===0?[]:Ko(t)(pn(Me(Y))(e=>{let n=ct(t)(e);return n.tag==="Just"?p("Just",-n._1.length):$})((()=>{let e=t.length-1|0;return 0>e?[]:Ft(0)(e)})())),Su=t=>e=>n=>{let r=v(o=>{let i=ct(e)(o);if(i.tag==="Nothing")return-1;if(i.tag==="Just")return i._1;s()})((()=>{let o=ct(t)(n);if(o.tag==="Nothing")return[];if(o.tag==="Just")return o._1;s()})());return(o=>{let i=o,d=!0,m;for(;d;){let u=i;if(he(qe)(u)(r)){i=u+1|0;continue}d=!1,m=u}return m})(0)},Ru=t=>e=>{let n=We(ht)((()=>{let r=dn(Y)(Y);return a=>o=>r.compare(x(a.saturation,a.degree))(x(o.saturation,o.degree))})())(ze(r=>r)(st(r=>a=>a._2===-1?p("Just",{vertex:r,saturation:zo(Y.compare)(ve(o=>o!==-1)(v(o=>{let i=ct(e)(o);if(i.tag==="Nothing")return-1;if(i.tag==="Just")return i._1;s()})(a._1))).length,degree:a._1.length}):$)(qo(t)(e))));return n.tag==="Just"?p("Just",n._1.vertex):$},Xo=t=>e=>n=>()=>{let r=Su(t)(e)(n);return we(n)(r)(e)(),r},Oe=t=>e=>{let n=an($n(e.length)(-1)),r=(()=>{let a=n();for(let o of e)Xo(t)(a)(o)();return a})();return v(a=>({vertex:a,color:(()=>{let o=ct(r)(a);if(o.tag==="Nothing")return 0;if(o.tag==="Just")return o._1;s()})()}))(e)},Zo=t=>t.length===0?[]:Oe(t)(pn(Me(Y))(e=>{let n=ct(t)(e);return n.tag==="Just"?p("Just",-n._1.length):$})((()=>{let e=t.length-1|0;return 0>e?[]:Ft(0)(e)})())),ti=t=>{let n=an($n(t.length)(-1))(),r=[];for(let a of t){let o=Ru(t)(n);if(o.tag!=="Nothing"){if(o.tag==="Just"){let i=Xo(t)(n)(o._1)();r.push({vertex:o._1,color:i});continue}s()}}return r},ei=t=>t.length===0?[]:Oe(t)((()=>{let e=t.length-1|0;return 0>e?[]:Ft(0)(e)})());var $a={foldrWithIndex:t=>e=>{let n=de(a=>{let o=a._1,i=a._2;return d=>t(o)(i)(d)})(e),r=st(At);return a=>n(r(a))},foldlWithIndex:t=>e=>{let n=te(a=>o=>t(o._1)(a)(o._2))(e),r=st(At);return a=>n(r(a))},foldMapWithIndex:t=>{let e=t.mempty;return n=>$a.foldrWithIndex(r=>a=>o=>t.Semigroup0().append(n(r)(a))(o))(e)},Foldable0:()=>ht};var or={};function hn(t,e,n,r){return n in r?e(r[n]):t}function ri(t){return function(e){var n=[];for(var r in e)hasOwnProperty.call(e,r)&&n.push(t(r)(e[r]));return n}}var Rm=Object.keys||ri(function(t){return function(){return t}});var pa=t=>e=>{let n={...e};return t(n)(),n};function ft(t){return t}function sr(t){return JSON.stringify(t)}function ye(t,e,n,r,a,o,i){return i==null?t():typeof i=="boolean"?e(i):typeof i=="number"?n(i):typeof i=="string"?r(i):Object.prototype.toString.call(i)==="[object Array]"?a(i):o(i)}var dt=(t,e,n)=>({tag:t,_1:e,_2:n});var ai=t=>e=>dt("AtIndex",t,e),fa=t=>e=>dt("AtKey",t,e),oi=t=>e=>dt("Named",t,e),ma=dt("MissingValue");var ha=isFinite;var ii=Math.cos;var Ue=Math.floor;var dr=Math.sin,yn=Math.sqrt;var si=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},Rt=function(t){return t};var ya=si(F)($),_a=t=>{if(!ha(t))return 0;if(t>=Rt(2147483647))return 2147483647;if(t<=Rt(-2147483648))return-2147483648;let e=ya(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;s()};var $t=(t,e,n)=>({tag:t,_1:e,_2:n});var xt=$t("Nil");var $i=(()=>(e=>n=>{let r=e,a=n,o=!0,i;for(;o;){let d=r,m=a;if(m.tag==="Nil"){o=!1,i=d;continue}if(m.tag==="Cons"){r=$t("Cons",m._1,d),a=m._2;continue}s()}return i})(xt))();var bn=function(t){throw new Error(t)};var lr=(t,e,n,r)=>({tag:"KickUp",_1:t,_2:e,_3:n,_4:r}),yt=(t,e,n,r,a,o,i,d)=>({tag:t,_1:e,_2:n,_3:r,_4:a,_5:o,_6:i,_7:d}),Tn=(t,e,n,r,a,o,i)=>({tag:t,_1:e,_2:n,_3:r,_4:a,_5:o,_6:i});var ke=yt("Leaf");var pr=t=>e=>r=>{let a=r,o=!0,i;for(;o;){let d=a;if(d.tag==="Leaf"){o=!1,i=$;continue}if(d.tag==="Two"){let m=t.compare(e)(d._2);if(m==="EQ"){o=!1,i=p("Just",d._3);continue}if(m==="LT"){a=d._1;continue}a=d._4;continue}if(d.tag==="Three"){let m=t.compare(e)(d._2);if(m==="EQ"){o=!1,i=p("Just",d._3);continue}let u=t.compare(e)(d._5);if(u==="EQ"){o=!1,i=p("Just",d._6);continue}if(m==="LT"){a=d._1;continue}if(u==="GT"){a=d._7;continue}a=d._4;continue}s()}return i};var Mn=t=>e=>n=>{let r=t,a=e,o=n,i=!0,d;for(;i;){let m=r,u=a,f=o;if(u.tag==="Nil"){i=!1,d=f;continue}if(u.tag==="Cons"){if(u._1.tag==="TwoLeft"){r=m,a=u._2,o=yt("Two",f,u._1._1,u._1._2,u._1._3);continue}if(u._1.tag==="TwoRight"){r=m,a=u._2,o=yt("Two",u._1._1,u._1._2,u._1._3,f);continue}if(u._1.tag==="ThreeLeft"){r=m,a=u._2,o=yt("Three",f,u._1._1,u._1._2,u._1._3,u._1._4,u._1._5,u._1._6);continue}if(u._1.tag==="ThreeMiddle"){r=m,a=u._2,o=yt("Three",u._1._1,u._1._2,u._1._3,f,u._1._4,u._1._5,u._1._6);continue}if(u._1.tag==="ThreeRight"){r=m,a=u._2,o=yt("Three",u._1._1,u._1._2,u._1._3,u._1._4,u._1._5,u._1._6,f);continue}}s()}return d},fr=t=>e=>n=>{let r=o=>i=>{let d=o,m=i,u=!0,f;for(;u;){let l=d,c=m;if(l.tag==="Nil"){u=!1,f=yt("Two",c._1,c._2,c._3,c._4);continue}if(l.tag==="Cons"){if(l._1.tag==="TwoLeft"){u=!1,f=Mn(t)(l._2)(yt("Three",c._1,c._2,c._3,c._4,l._1._1,l._1._2,l._1._3));continue}if(l._1.tag==="TwoRight"){u=!1,f=Mn(t)(l._2)(yt("Three",l._1._1,l._1._2,l._1._3,c._1,c._2,c._3,c._4));continue}if(l._1.tag==="ThreeLeft"){d=l._2,m=lr(yt("Two",c._1,c._2,c._3,c._4),l._1._1,l._1._2,yt("Two",l._1._3,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeMiddle"){d=l._2,m=lr(yt("Two",l._1._1,l._1._2,l._1._3,c._1),c._2,c._3,yt("Two",c._4,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeRight"){d=l._2,m=lr(yt("Two",l._1._1,l._1._2,l._1._3,l._1._4),l._1._5,l._1._6,yt("Two",c._1,c._2,c._3,c._4));continue}}s()}return f};return(o=>i=>{let d=o,m=i,u=!0,f;for(;u;){let l=d,c=m;if(c.tag==="Leaf"){u=!1,f=r(l)(lr(ke,e,n,ke));continue}if(c.tag==="Two"){let D=t.compare(e)(c._2);if(D==="EQ"){u=!1,f=Mn(t)(l)(yt("Two",c._1,e,n,c._4));continue}if(D==="LT"){d=$t("Cons",Tn("TwoLeft",c._2,c._3,c._4),l),m=c._1;continue}d=$t("Cons",Tn("TwoRight",c._1,c._2,c._3),l),m=c._4;continue}if(c.tag==="Three"){let D=t.compare(e)(c._2);if(D==="EQ"){u=!1,f=Mn(t)(l)(yt("Three",c._1,e,n,c._4,c._5,c._6,c._7));continue}let k=t.compare(e)(c._5);if(k==="EQ"){u=!1,f=Mn(t)(l)(yt("Three",c._1,c._2,c._3,c._4,e,n,c._7));continue}if(D==="LT"){d=$t("Cons",Tn("ThreeLeft",c._2,c._3,c._4,c._5,c._6,c._7),l),m=c._1;continue}if(D==="GT"&&k==="LT"){d=$t("Cons",Tn("ThreeMiddle",c._1,c._2,c._3,c._5,c._6,c._7),l),m=c._4;continue}d=$t("Cons",Tn("ThreeRight",c._1,c._2,c._3,c._4,c._5,c._6),l),m=c._7;continue}s()}return f})(xt)};var mr=function(t){return function(e){return t+e}};var oy=typeof Array.from=="function",iy=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",sy=typeof String.prototype.fromCodePoint=="function",dy=typeof String.prototype.codePointAt=="function";var gr={traverseWithIndex:t=>{let e=gr.Traversable2().sequence(t);return n=>{let r=gr.FunctorWithIndex0().mapWithIndex(n);return a=>e(r(a))}},FunctorWithIndex0:()=>_o,FoldableWithIndex1:()=>$a,Traversable2:()=>cn};var cc=(()=>gr.traverseWithIndex(Zr))();var $c=t=>{let e=ye(n=>$,n=>$,n=>$,n=>$,F,n=>$,t);if(e.tag==="Nothing")return _("Left",dt("TypeMismatch","Array"));if(e.tag==="Just")return _("Right",e._1);s()};var hr=t=>{let e=ye(n=>_("Left",dt("TypeMismatch","Number")),n=>_("Left",dt("TypeMismatch","Number")),bt,n=>_("Left",dt("TypeMismatch","Number")),n=>_("Left",dt("TypeMismatch","Number")),n=>_("Left",dt("TypeMismatch","Number")),t);if(e.tag==="Left")return _("Left",e._1);if(e.tag==="Right"){let n=ya(e._1);if(n.tag==="Nothing")return _("Left",dt("TypeMismatch","Integer"));if(n.tag==="Just")return _("Right",n._1)}s()};var He=t=>{let e=oi("Array"),n=cc(r=>{let a=ai(r);return o=>{let i=t(o);if(i.tag==="Left")return _("Left",a(i._1));if(i.tag==="Right")return _("Right",i._1);s()}});return r=>{let a=$c(r);if(a.tag==="Left")return _("Left",a._1);if(a.tag==="Right"){let o=n(a._1);if(o.tag==="Left")return _("Left",e(o._1));if(o.tag==="Right")return _("Right",o._1)}s()}},Ma=t=>e=>n=>{let r=He(bt)(n);return(()=>{if(r.tag==="Left"){let a=r._1;return o=>_("Left",a)}if(r.tag==="Right"){let a=r._1;return o=>o(a)}s()})()(a=>{if(a.length===2){let o=t(a[0]);if(o.tag==="Left")return _("Left",o._1);if(o.tag==="Right"){let i=e(a[1]);if(i.tag==="Left")return _("Left",i._1);if(i.tag==="Right")return _("Right",x(o._1,i._1))}s()}return _("Left",dt("TypeMismatch","Tuple"))})};function _t(t,e,n){return t==null?e:n(t)}function yr(t,e,n,r){if(typeof window<"u"){var a=window[n];if(a!=null&&r instanceof a)return e(r)}for(var o=r;o!=null;){var i=Object.getPrototypeOf(o),d=i.constructor.name;if(d===n)return e(r);if(d==="Object")return t;o=i}return t}var _r=function(t){return function(e){return e[t]}},lc=_r("namespaceURI"),pc=_r("prefix"),x_=_r("localName"),N_=_r("tagName");function _i(t){return function(){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}}function Ie(t){return t.currentTarget}function Di(t){return t.type}function Ca(t){return function(){return t.stopPropagation()}}var je=function(){return window};function La(t){return function(){return t.document}}function xa(t){return function(){return t.localStorage}}function Mi(t){return function(e){return function(){return e.getItem(t)}}}function Ei(t){return function(e){return function(n){return function(){n.setItem(t,e)}}}}var Ci=t=>{let e=Mi(t);return n=>{let r=e(n);return()=>{let a=r();return _t(a,$,F)}}};function Li(t){return t.clientX}function xi(t){return t.clientY}var Ni=t=>e=>n=>t.MonadEffect0().liftEffect((()=>{let r=Ei(e)(n);return()=>{let a=je(),o=xa(a)();return r(o)()}})()),Ii=t=>e=>t.MonadEffect0().liftEffect((()=>{let n=Ci(e);return()=>{let r=je(),a=xa(r)();return n(a)()}})()),Ln=t=>e=>t===0?[]:v(e)((()=>{let n=t-1|0;return 0>n?[]:Ft(0)(n)})()),xn=t=>{let e=100*dr(Rt(t+1|0));return e-Ue(e)},Na=t=>{let e=_t(Ie(t),$,F),n=(()=>{if(e.tag==="Just")return yr($,F,"Element",e._1);if(e.tag==="Nothing")return $;s()})();if(n.tag==="Just"){let r=_i(n._1);return()=>{let a=r();return p("Just",{x:(Rt(Li(t))-a.left)/a.width,y:(Rt(xi(t))-a.top)/a.height})}}return()=>$};var g=(t,e)=>({tag:"Edge",_1:t,_2:e}),Ai=vo(ht),yc=Qn(ht);var Fa={eq:t=>e=>t._1===e._1&&t._2===e._2||t._1===e._2&&e._1===t._2},Fi={encodeJson:t=>[Rt(t._1),Rt(t._2)]},Pi={decodeJson:t=>{let e=Ma(hr)(hr)(t);return(()=>{if(e.tag==="Left"){let n=e._1;return r=>_("Left",n)}if(e.tag==="Right"){let n=e._1;return r=>r(n)}s()})()(n=>_("Right",g(n._1,n._2)))}},br=t=>de(e=>{let n=e._1,r=e._2,a=Ai([n])(i=>fn(i)(r)),o=Ai([r])(i=>fn(i)(n));return i=>a(o(i))})(v(e=>[])(t.layout))(t.edges),Pa=t=>e=>({...e,layout:(()=>{let n=Oo(t)(e.layout);if(n.tag==="Nothing")return e.layout;if(n.tag==="Just")return n._1;s()})(),edges:ze(n=>n._1===t||n._2===t?$:p("Just",g(n._1>t?n._1-1|0:n._1,n._2>t?n._2-1|0:n._2)))(e.edges)}),Si=t=>e=>n=>({...n,edges:ve(r=>!(r._1===t&&r._2===e||r._1===e&&t===r._2))(n.edges)}),Ri=t=>e=>n=>({...n,layout:yc([x(t,e)])(n.layout)});var _c={layout:[{y:.4514285714285714,x:.03907143729073661},{y:.3385714285714286,x:.14478572300502232},{y:.45285714285714285,x:.2247857230050223},{y:.5657142857142857,x:.11621429443359375},{y:.25,x:.3376428658621652},{y:.06285714285714286,x:.4633571515764509},{y:.4828571428571429,x:.9533571515764508},{y:.9471428571428572,x:.4233571515764509},{y:.6885714285714286,x:.330500008719308},{y:.4742857142857143,x:.6733571515764509}],edges:[g(3,0),g(2,3),g(1,2),g(0,1),g(4,2),g(5,4),g(9,5),g(6,5),g(6,9),g(7,6),g(7,9),g(7,8),g(8,2),g(4,8),g(9,8),g(4,9)]},Dc={layout:[{y:.06714285714285714,x:.25050000871930805},{y:.17142857142857143,x:.09192858014787947},{y:.26571428571428574,x:.33621429443359374},{y:.05,x:.4490714372907366},{y:.15428571428571428,x:.5547857230050223},{y:.26571428571428574,x:.5747857230050223},{y:.45,x:.5762142944335937},{y:.4685714285714286,x:.32621429443359373},{y:.5714285714285714,x:.5733571515764508},{y:.7228571428571429,x:.5619285801478795},{y:.6614285714285715,x:.33192858014787946},{y:.8214285714285714,x:.3376428658621652},{y:.9342857142857143,x:.6662142944335937},{y:.9528571428571428,x:.09192858014787947},{y:.6385714285714286,x:.07764286586216518}],edges:[g(2,1),g(0,2),g(1,0),g(3,2),g(4,3),g(2,4),g(5,2),g(6,5),g(7,6),g(2,7),g(8,7),g(9,8),g(10,9),g(7,10),g(8,10),g(9,7),g(11,10),g(12,11),g(13,12),g(14,13),g(7,14)]},bc={layout:[{y:.41285714285714287,x:.3447857230050223},{y:.5842857142857143,x:.2333571515764509},{y:.5814285714285714,x:.049071437290736604},{y:.3628571428571429,x:.05192858014787947},{y:.5385714285714286,x:.8076428658621652},{y:.5985714285714285,x:.660500008719308},{y:.40714285714285714,x:.5247857230050224},{y:.5928571428571429,x:.5433571515764509},{y:.9285714285714286,x:.5347857230050224},{y:.4642857142857143,x:.9590714372907366},{y:.9014285714285715,x:.22050000871930803},{y:.11571428571428571,x:.6762142944335937}],edges:[g(1,0),g(1,3),g(6,0),g(7,6),g(9,11),g(5,11),g(11,0),g(3,11),g(9,6),g(8,9),g(4,5),g(9,4),g(1,7),g(10,1),g(8,10),g(7,8),g(10,6),g(2,3),g(10,2),g(8,5)]},Tc={layout:[{y:.08142857142857143,x:.18050000871930805},{y:.23285714285714285,x:.07621429443359375},{y:.23714285714285716,x:.2876428658621652},{y:.4757142857142857,x:.2676428658621652},{y:.6242857142857143,x:.08621429443359375},{y:.79,x:.08478572300502232},{y:.9514285714285714,x:.28192858014787947},{y:.9557142857142857,x:.680500008719308},{y:.5057142857142857,x:.9276428658621652},{y:.6942857142857143,x:.5047857230050223},{y:.7,x:.2776428658621652},{y:.4928571428571429,x:.49764286586216516},{y:.20285714285714285,x:.5019285801478794},{y:.7071428571428572,x:.6833571515764509}],edges:[g(1,0),g(2,1),g(3,2),g(4,3),g(5,4),g(6,5),g(7,6),g(8,7),g(9,8),g(10,9),g(11,10),g(3,11),g(12,11),g(12,0),g(13,9),g(7,13),g(10,5)]};var Ji=t=>e=>{let n=ct(t.layout)(e._1);if(n.tag==="Just"){let r=ct(t.layout)(e._2);if(r.tag==="Just")return p("Just",{x1:n._1.x,x2:r._1.x,y1:n._1.y,y2:r._1.y});if(r.tag==="Nothing")return $;s()}if(n.tag==="Nothing")return $;s()},Aa={layout:[],edges:[]},Mc={layout:Ln(100)(t=>({x:xn(t*2|0),y:xn((t*2|0)+1|0)})),edges:ve(t=>t._1!==t._2)(Ln(1e3)(t=>g(_a(Ue(100*xn(t*2|0))),_a(Ue(100*xn((t*2|0)+1|0))))))},wi=[Tc,bc,Dc,_c,Mc,Aa,Aa,Aa],Wi=t=>e=>({...e,layout:fn(e.layout)(t)}),qi=t=>e=>n=>({...n,edges:t===e||he(Fa)(g(t,e))(n.edges)?n.edges:fn(n.edges)(g(t,e))});var Ae=(t,e)=>({tag:t,_1:e}),Nn=(t,e)=>({tag:t,_1:e}),Mr=t=>t,Ec=Qn(ht),Cc=un(Hn);var Lc=rr({reflectSymbol:()=>"graphs"})()(),In=Mr("MoveMode"),vi=Mr("VertexMode"),Er=Mr("AddEMode"),zi=Mr("DeleteMode"),Ve=Nn("NoDialog");var Cr=Ae("Alphabetical"),Oi=Ae("DecreasingDegree"),Gi=Ae("IndependentSet"),Ui=Ae("DSatur");var Bi={eq:t=>e=>t==="MoveMode"?e==="MoveMode":t==="VertexMode"?e==="VertexMode":t==="AddEMode"?e==="AddEMode":t==="DeleteMode"&&e==="DeleteMode"},ki=t=>p("Just",v(e=>Xn(e)-65|0)(Qo(t))),Jt=t=>{let e=ct(t.graphs)(t.selectedGraphIdx);if(e.tag==="Nothing")return{layout:[],edges:[]};if(e.tag==="Just")return e._1;s()},Hi=t=>{let e=ct(t.results)(t.selectedResultIndex);if(e.tag==="Just"){let n=v(r=>r.vertex)(e._1.coloring);return t.currentStep<1?[]:ge(0)(t.currentStep)(n)}if(e.tag==="Nothing")return[];s()},ji=t=>{let e=$n(Jt(t).layout.length)(-1),n=ct(t.results)(t.selectedResultIndex);if(n.tag==="Just")return Ec(v(r=>x(r.vertex,r.color))(t.currentStep<1?[]:ge(0)(t.currentStep)(n._1.coloring)))(e);if(n.tag==="Nothing")return e;s()},Lr=(()=>{let t=v(e=>{let n=e+65|0;return n>=0&&n<=65535?p("Just",mn(n)):$});return e=>Vo(ze(n=>n)(t(e)))})();var Vi=t=>ar((()=>{let e=t+65|0;return e>=0&&e<=65535?mn(e):"A"})()),xc=t=>e=>e.length===0?!0:Cc(Yn(Y.compare)(e))((()=>{let n=t-1|0;return 0>n?[]:Ft(0)(n)})()),Nc=t=>e=>{let n=br(t);if(e.tag==="Alphabetical")return p("Just",ei(n));if(e.tag==="DecreasingDegree")return p("Just",Zo(n));if(e.tag==="DSatur")return p("Just",ti(n));if(e.tag==="IndependentSet")return p("Just",Yo(n));if(e.tag==="CustomAlgorithm")return xc(n.length)(e._1)?p("Just",Oe(n)(e._1)):$;s()},Qi=t=>e=>n=>{if(t===1){if(n.tag==="DecreasingDegree")return p("Just",Oe(br(e))([11,10,1,9,8,6,3,0,7,5,2,4]));if(n.tag==="IndependentSet")return p("Just",Oe(br(e))([11,10,7,4,1,6,8,2,9,5,3,0]))}return Nc(e)(n)},Ki={selectedAlgorithm:Cr,results:[],currentStep:0,selectedResultIndex:0,graphs:wi,selectedGraphIdx:0,editmode:In,selectedVertex:$,currentPosition:$,dialog:Ve},Yi=t=>{if(t.tag==="Alphabetical")return"Alphab\xE9tique";if(t.tag==="DecreasingDegree")return"Degr\xE9 d\xE9croissant";if(t.tag==="IndependentSet")return"Stables";if(t.tag==="DSatur")return"DSatur";if(t.tag==="CustomAlgorithm")return Lr(t._1);s()},Xi=t=>e=>nr(n=>r=>({...n,graphs:(()=>{let a=Kn(n.selectedGraphIdx)(r)(n.graphs);if(a.tag==="Nothing")return n.graphs;if(a.tag==="Just")return a._1;s()})()}))(n=>{let r=ct(n.graphs)(n.selectedGraphIdx);if(r.tag==="Nothing")return _("Left",n);if(r.tag==="Just")return _("Right",r._1);s()})(t)(e);var Zi=t=>Lc(Q)(t);var H=(t,e,n)=>({tag:t,_1:e,_2:n});var ts=t=>e=>H("SelectVertex",t,e);var es=t=>e=>H("DeleteVertex",t,e);var Sa=H("DropOrLeave");var ns=H("ClearGraph"),rs=H("AdjustGraph"),as=t=>H("SetGraph",t),os=t=>H("SetAlgo",t),is=t=>H("CustomAlgoTextChange",t);var ss=H("Save"),ds=H("Load"),us=H("OpenImportDialog"),cs=H("Export"),$s=t=>H("ChangeImportText",t),ls=H("ImportAndClose"),Ra=H("CloseDialog"),ps=H("Compute"),fs=H("PreviousStep"),ms=H("NextStep"),gs=H("FinishColoring");var ne=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var hs=t=>{let e=t,n=!0,r;for(;n;){let a=e;if(a._1.tag==="Nil"){if(a._2.tag==="Nil"){n=!1,r=$;continue}e=ne($i(a._2),xt);continue}if(a._1.tag==="Cons"){n=!1,r=p("Just",x(a._1._1,ne(a._1._2,a._2)));continue}s()}return r};var De=(t,e,n)=>({tag:t,_1:e,_2:n}),at=De("CatNil");var Ac=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return De("CatCons",t._1,ne(t._2._1,$t("Cons",e,t._2._2)));s()},Fc=t=>e=>n=>{let r=o=>i=>d=>{let m=o,u=i,f=d,l=!0,c;for(;l;){let D=m,k=u,ot=f;if(ot.tag==="Nil"){l=!1,c=k;continue}if(ot.tag==="Cons"){m=D,u=D(k)(ot._1),f=ot._2;continue}s()}return c};return(o=>i=>{let d=o,m=i,u=!0,f;for(;u;){let l=d,c=m,D=hs(l);if(D.tag==="Nothing"){u=!1,f=r(k=>ot=>ot(k))(e)(c);continue}if(D.tag==="Just"){d=D._1._2,m=$t("Cons",t(D._1._1),c);continue}s()}return f})(n)(xt)},_s=t=>{if(t.tag==="CatNil")return $;if(t.tag==="CatCons")return p("Just",x(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?at:Fc(Ac)(at)(t._2)));s()};var wt=t=>e=>{if(t.tag==="CatNil")return De("CatCons",e,ne(xt,xt));if(t.tag==="CatCons")return De("CatCons",t._1,ne(t._2._1,$t("Cons",De("CatCons",e,ne(xt,xt)),t._2._2)));s()};var O=(t,e)=>({tag:"Free",_1:t,_2:e}),ut=(t,e,n)=>({tag:t,_1:e,_2:n});var Pc=t=>{let e=t,n=!0,r;for(;n;){let a=e;if(a._1.tag==="Return"){let o=_s(a._2);if(o.tag==="Nothing"){n=!1,r=ut("Return",a._1._1);continue}if(o.tag==="Just"){e=(()=>{let i=o._1._1(a._1._1);return O(i._1,(()=>{if(i._2.tag==="CatNil")return o._1._2;if(o._1._2.tag==="CatNil")return i._2;if(i._2.tag==="CatCons")return De("CatCons",i._2._1,ne(i._2._2._1,$t("Cons",o._1._2,i._2._2._2)));s()})())})();continue}s()}if(a._1.tag==="Bind"){n=!1,r=ut("Bind",a._1._1,o=>{let i=a._1._2(o);return O(i._1,(()=>{if(i._2.tag==="CatNil")return a._2;if(a._2.tag==="CatNil")return i._2;if(i._2.tag==="CatCons")return De("CatCons",i._2._1,ne(i._2._2._1,$t("Cons",a._2,i._2._2._2)));s()})())});continue}s()}return r},Ds=t=>e=>{let n=e.Monad0(),r=n.Bind1().Apply0().Functor0();return a=>e.tailRecM(o=>{let i=Pc(o);if(i.tag==="Return")return r.map(ro)(n.Applicative0().pure(i._1));if(i.tag==="Bind")return r.map(ra)(a(t.map(i._2)(i._1)));s()})};var bs={Applicative0:()=>Nr,Bind1:()=>Wa},Ts={map:t=>e=>Wa.bind(e)(n=>Nr.pure(t(n)))},Wa={bind:t=>e=>O(t._1,wt(t._2)(e)),Apply0:()=>qa},qa={apply:t=>e=>O(t._1,wt(t._2)(n=>O(e._1,wt(e._2)(r=>Nr.pure(n(r)))))),Functor0:()=>Ts},Nr={pure:t=>O(ut("Return",t),at),Apply0:()=>qa};var za={gDecodeJson:t=>e=>_("Right",{})};var Oa=t=>()=>({decodeJson:e=>{let n=ye(r=>$,r=>$,r=>$,r=>$,r=>$,F,e);if(n.tag==="Just")return t.gDecodeJson(n._1)(Q);if(n.tag==="Nothing")return _("Left",dt("TypeMismatch","Object"));s()}});var Ir=t=>e=>n=>()=>()=>({gDecodeJson:r=>a=>{let o=n.reflectSymbol(Q),i=t.decodeJsonField(hn($,F,o,r));if(i.tag==="Just"){let d=fa(o);if(i._1.tag==="Left")return _("Left",d(i._1._1));if(i._1.tag==="Right"){let m=i._1._1,u=e.gDecodeJson(r)(Q);return(()=>{if(u.tag==="Left"){let f=u._1;return l=>_("Left",f)}if(u.tag==="Right"){let f=u._1;return l=>l(f)}s()})()(f=>_("Right",Te(n.reflectSymbol(Q))(m)(f)))}s()}if(i.tag==="Nothing")return _("Left",dt("AtKey",o,ma));s()}});var Ga={gEncodeJson:t=>e=>or};var Ua={encodeJson:ft};var Ar=t=>({encodeJson:(()=>{let e=v(t.encodeJson);return n=>e(n)})()});var An=t=>e=>n=>()=>({gEncodeJson:r=>a=>{let o=n.reflectSymbol(Q),i=t.encodeJson(Zt(n.reflectSymbol(Q))(r));return pa(d=>()=>(d[o]=i,d))(e.gEncodeJson(r)(Q))}});function Fr(t,e,n){try{return e(JSON.parse(n))}catch(r){return t(r.message)}}var Ms={ix:t=>e=>n=>nr(r=>a=>{let o=Kn(t)(a)(r);if(o.tag==="Nothing")return r;if(o.tag==="Just")return o._1;s()})(r=>{let a=ct(r)(t);if(a.tag==="Nothing")return _("Left",r);if(a.tag==="Just")return _("Right",a._1);s()})(e)(n)};var Ba=(()=>({left:t=>e=>{if(e.tag==="Left")return _("Left",t(e._1));if(e.tag==="Right")return _("Right",e._1);s()},right:rn.map,Profunctor0:()=>Zn}))();var Bt=function(){var t={},e="Pure",n="Throw",r="Catch",a="Sync",o="Async",i="Bind",d="Bracket",m="Fork",u="Sequential",f="Map",l="Apply",c="Alt",D="Cons",k="Resume",ot="Release",Nt="Finalizer",I="Finalized",V="Forked",Wt="Fiber",qt="Thunk";function b(M,q,et,U){this.tag=M,this._1=q,this._2=et,this._3=U}function mt(M){var q=function(et,U,C){return new b(M,et,U,C)};return q.tag=M,q}function ae(M){return new b(e,void 0)}function Br(M){try{M()}catch(q){setTimeout(function(){throw q},0)}}function Ye(M,q,et){try{return q(et())}catch(U){return M(U)}}function ld(M,q,et){try{return q(et)()}catch(U){return et(M(U))(),ae}}var Rn=function(){var M=1024,q=0,et=0,U=new Array(M),C=!1;function y(){var z;for(C=!0;q!==0;)q--,z=U[et],U[et]=void 0,et=(et+1)%M,z();C=!1}return{isDraining:function(){return C},enqueue:function(z){var P,Z;q===M&&(Z=C,y(),C=Z),U[(et+q)%M]=z,q++,C||y()}}}();function pd(M){var q={},et=0,U=0;return{register:function(C){var y=et++;C.onComplete({rethrow:!0,handler:function(z){return function(){U--,delete q[y]}}})(),q[y]=C,U++},isEmpty:function(){return U===0},killAll:function(C,y){return function(){if(U===0)return y();var z=0,P={};function Z(j){P[j]=q[j].kill(C,function(it){return function(){delete P[j],z--,M.isLeft(it)&&M.fromLeft(it)&&setTimeout(function(){throw M.fromLeft(it)},0),z===0&&y()}})()}for(var Dt in q)q.hasOwnProperty(Dt)&&(z++,Z(Dt));return q={},et=0,U=0,function(j){return new b(a,function(){for(var it in P)P.hasOwnProperty(it)&&P[it]()})}}}}}var Je=0,Pt=1,Jn=2,wn=3,Wn=4,vt=5,Xe=6;function kr(M,q,et){var U=0,C=Je,y=et,z=null,P=null,Z=null,Dt=null,j=null,it=0,be=0,Ht=null,fe=!0;function me(L){for(var N,w,W;;)switch(N=null,w=null,W=null,C){case Jn:C=Pt;try{y=Z(y),Dt===null?Z=null:(Z=Dt._1,Dt=Dt._2)}catch(Mt){C=vt,z=M.left(Mt),y=null}break;case wn:M.isLeft(y)?(C=vt,z=y,y=null):Z===null?C=vt:(C=Jn,y=M.fromRight(y));break;case Pt:switch(y.tag){case i:Z&&(Dt=new b(D,Z,Dt)),Z=y._2,C=Pt,y=y._1;break;case e:Z===null?(C=vt,y=M.right(y._1)):(C=Jn,y=y._1);break;case a:C=wn,y=Ye(M.left,M.right,y._1);break;case o:C=Wn,y=ld(M.left,y._1,function(Mt){return function(){U===L&&(U++,Rn.enqueue(function(){U===L+1&&(C=wn,y=Mt,me(U))}))}});return;case n:C=vt,z=M.left(y._1),y=null;break;case r:Z===null?j=new b(D,y,j,P):j=new b(D,y,new b(D,new b(k,Z,Dt),j,P),P),Z=null,Dt=null,C=Pt,y=y._1;break;case d:it++,Z===null?j=new b(D,y,j,P):j=new b(D,y,new b(D,new b(k,Z,Dt),j,P),P),Z=null,Dt=null,C=Pt,y=y._1;break;case m:C=wn,N=kr(M,q,y._2),q&&q.register(N),y._1&&N.run(),y=M.right(N);break;case u:C=Pt,y=md(M,q,y._1);break}break;case vt:if(Z=null,Dt=null,j===null)C=Xe,y=P||z||y;else switch(N=j._3,W=j._1,j=j._2,W.tag){case r:P&&P!==N&&it===0?C=vt:z&&(C=Pt,y=W._2(M.fromLeft(z)),z=null);break;case k:P&&P!==N&&it===0||z?C=vt:(Z=W._1,Dt=W._2,C=Jn,y=M.fromRight(y));break;case d:it--,z===null&&(w=M.fromRight(y),j=new b(D,new b(ot,W._2,w),j,N),(P===N||it>0)&&(C=Pt,y=W._3(w)));break;case ot:j=new b(D,new b(I,y,z),j,P),C=Pt,P&&P!==N&&it===0?y=W._1.killed(M.fromLeft(P))(W._2):z?y=W._1.failed(M.fromLeft(z))(W._2):y=W._1.completed(M.fromRight(y))(W._2),z=null,it++;break;case Nt:it++,j=new b(D,new b(I,y,z),j,P),C=Pt,y=W._1;break;case I:it--,C=vt,y=W._1,z=W._2;break}break;case Xe:for(var rt in Ht)Ht.hasOwnProperty(rt)&&(fe=fe&&Ht[rt].rethrow,Br(Ht[rt].handler(y)));Ht=null,P&&z?setTimeout(function(){throw M.fromLeft(z)},0):M.isLeft(y)&&fe&&setTimeout(function(){if(fe)throw M.fromLeft(y)},0);return;case Je:C=Pt;break;case Wn:return}}function nt(L){return function(){if(C===Xe)return fe=fe&&L.rethrow,L.handler(y)(),function(){};var N=be++;return Ht=Ht||{},Ht[N]=L,function(){Ht!==null&&delete Ht[N]}}}function A(L,N){return function(){if(C===Xe)return N(M.right(void 0))(),function(){};var w=nt({rethrow:!1,handler:function(){return N(M.right(void 0))}})();switch(C){case Je:P=M.left(L),C=Xe,y=P,me(U);break;case Wn:P===null&&(P=M.left(L)),it===0&&(C===Wn&&(j=new b(D,new b(Nt,y(L)),j,P)),C=vt,y=null,z=null,me(++U));break;default:P===null&&(P=M.left(L)),it===0&&(C=vt,y=null,z=null)}return w}}function S(L){return function(){var N=nt({rethrow:!1,handler:L})();return C===Je&&me(U),N}}return{kill:A,join:S,onComplete:nt,isSuspended:function(){return C===Je},run:function(){C===Je&&(Rn.isDraining()?me(U):Rn.enqueue(function(){me(U)}))}}}function fd(M,q,et,U){var C=0,y={},z=0,P={},Z=new Error("[ParAff] Early exit"),Dt=null,j=t;function it(nt,A,S){var L=A,N=null,w=null,W=0,rt={},Mt,Ze;t:for(;;)switch(Mt=null,L.tag){case V:if(L._3===t&&(Mt=y[L._1],rt[W++]=Mt.kill(nt,function(gd){return function(){W--,W===0&&S(gd)()}})),N===null)break t;L=N._2,w===null?N=null:(N=w._1,w=w._2);break;case f:L=L._2;break;case l:case c:N&&(w=new b(D,N,w)),N=L,L=L._1;break}if(W===0)S(M.right(void 0))();else for(Ze=0,Mt=W;Ze<Mt;Ze++)rt[Ze]=rt[Ze]();return rt}function be(nt,A,S){var L,N,w,W,rt,Mt;for(M.isLeft(nt)?(L=nt,N=null):(N=nt,L=null);;){if(w=null,W=null,rt=null,Mt=null,Dt!==null)return;if(A===null){U(L||N)();return}if(A._3!==t)return;switch(A.tag){case f:L===null?(A._3=M.right(A._1(M.fromRight(N))),N=A._3):A._3=L;break;case l:if(w=A._1._3,W=A._2._3,L){if(A._3=L,rt=!0,Mt=z++,P[Mt]=it(Z,L===w?A._2:A._1,function(){return function(){delete P[Mt],rt?rt=!1:S===null?be(L,null,null):be(L,S._1,S._2)}}),rt){rt=!1;return}}else{if(w===t||W===t)return;N=M.right(M.fromRight(w)(M.fromRight(W))),A._3=N}break;case c:if(w=A._1._3,W=A._2._3,w===t&&M.isLeft(W)||W===t&&M.isLeft(w))return;if(w!==t&&M.isLeft(w)&&W!==t&&M.isLeft(W))L=N===w?W:w,N=null,A._3=L;else if(A._3=N,rt=!0,Mt=z++,P[Mt]=it(Z,N===w?A._2:A._1,function(){return function(){delete P[Mt],rt?rt=!1:S===null?be(N,null,null):be(N,S._1,S._2)}}),rt){rt=!1;return}break}S===null?A=null:(A=S._1,S=S._2)}}function Ht(nt){return function(A){return function(){delete y[nt._1],nt._3=A,be(A,nt._2._1,nt._2._2)}}}function fe(){var nt=Pt,A=et,S=null,L=null,N,w;t:for(;;)switch(N=null,w=null,nt){case Pt:switch(A.tag){case f:S&&(L=new b(D,S,L)),S=new b(f,A._1,t,t),A=A._2;break;case l:S&&(L=new b(D,S,L)),S=new b(l,t,A._2,t),A=A._1;break;case c:S&&(L=new b(D,S,L)),S=new b(c,t,A._2,t),A=A._1;break;default:w=C++,nt=vt,N=A,A=new b(V,w,new b(D,S,L),t),N=kr(M,q,N),N.onComplete({rethrow:!1,handler:Ht(A)})(),y[w]=N,q&&q.register(N)}break;case vt:if(S===null)break t;S._1===t?(S._1=A,nt=Pt,A=S._2,S._2=t):(S._2=A,A=S,L===null?S=null:(S=L._1,L=L._2))}for(j=A,w=0;w<C;w++)y[w].run()}function me(nt,A){Dt=M.left(nt);var S;for(var L in P)if(P.hasOwnProperty(L)){S=P[L];for(L in S)S.hasOwnProperty(L)&&S[L]()}P=null;var N=it(nt,j,A);return function(w){return new b(o,function(W){return function(){for(var rt in N)N.hasOwnProperty(rt)&&N[rt]();return ae}})}}return fe(),function(nt){return new b(o,function(A){return function(){return me(nt,A)}})}}function md(M,q,et){return new b(o,function(U){return function(){return fd(M,q,et,U)}})}return b.EMPTY=t,b.Pure=mt(e),b.Throw=mt(n),b.Catch=mt(r),b.Sync=mt(a),b.Async=mt(o),b.Bind=mt(i),b.Bracket=mt(d),b.Fork=mt(m),b.Seq=mt(u),b.ParMap=mt(f),b.ParApply=mt(l),b.ParAlt=mt(c),b.Fiber=kr,b.Supervisor=pd,b.Scheduler=Rn,b.nonCanceler=ae,b}(),Fe=Bt.Pure,Zc=Bt.Throw;function Pr(t){return function(e){return e.tag===Bt.Pure.tag?Bt.Pure(t(e._1)):Bt.Bind(e,function(n){return Bt.Pure(t(n))})}}function kt(t){return function(e){return Bt.Bind(t,e)}}var re=Bt.Sync;var t$=Bt.Async;function Sr(t,e){return function(){return Bt.Fiber(t,null,e)}}var e$=function(){function t(n,r){return n===0&&typeof setImmediate<"u"?setImmediate(r):setTimeout(r,n)}function e(n,r){return n===0&&typeof clearImmediate<"u"?clearImmediate(r):clearTimeout(r)}return function(n,r){return Bt.Async(function(a){return function(){var o=t(r,a(n()));return function(){return Bt.Sync(function(){return n(e(r,o))})}}})}}(),n$=Bt.Seq;var r$={map:Pr};var ka={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;s()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return bn("unsafeFromLeft: Right");s()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return bn("unsafeFromRight: Left");s()},left:Ce,right:bt};var Cs={Applicative0:()=>Rr,Bind1:()=>a$},a$={bind:kt,Apply0:()=>Ls},Ls={apply:t=>e=>kt(t)(n=>kt(e)(r=>Rr.pure(n(r)))),Functor0:()=>r$},Rr={pure:Fe,Apply0:()=>Ls};var Jr={liftEffect:re,Monad0:()=>Cs};var xs={tailRecM:t=>{let e=n=>kt(t(n))(r=>{if(r.tag==="Done")return Fe(r._1);if(r.tag==="Loop")return e(r._1);s()});return e},Monad0:()=>Cs};var Ns={liftAff:t=>t,MonadEffect0:()=>Jr};var Is=(()=>po(ht)(jn.compare))(),As=(()=>We(ht)(jn.compare))(),f$=t=>{let e=Is(v(u=>u.y)(t)),n=(()=>{if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;s()})(),r=As(v(u=>u.y)(t)),a=(()=>{if(r.tag==="Nothing")return 0;if(r.tag==="Just")return r._1;s()})(),o=Is(v(u=>u.x)(t)),i=(()=>{if(o.tag==="Nothing")return 0;if(o.tag==="Just")return o._1;s()})(),d=As(v(u=>u.x)(t)),m=(()=>{if(d.tag==="Nothing")return 0;if(d.tag==="Just")return d._1;s()})();return v(u=>({x:.05+(u.x-i)*.9/(m-i),y:.05+(u.y-n)*.9/(a-n)}))(t)},m$=(()=>3.141592653589793*(3-yn(5)))(),g$=t=>t===0?[]:v(e=>{let n=10*yn(.5+Rt(e)),r=Rt(e)*m$;return{x:n*ii(r),y:n*dr(r)}})((()=>{let e=t-1|0;return 0>e?[]:Ft(0)(e)})()),h$=t=>e=>n=>r=>st(a=>o=>{let i=o.x,d=o.y,m=[...st(u=>f=>{if(a===u)return{x:0,y:0};let l=(i-f.x)*(i-f.x)+(d-f.y)*(d-f.y),c=t/l,D=yn(l);return{x:c*(i-f.x)/D,y:c*(d-f.y)/D}})(r),...st(u=>f=>{if(!he(Fa)(g(a,u))(n))return{x:0,y:0};let l=yn((i-f.x)*(i-f.x)+(d-f.y)*(d-f.y)),c=e*(1-l);return{x:c*(i-f.x)/l,y:c*(d-f.y)/l}})(r)];return{x:i+te(mr)(0)(v(u=>u.x)(m)),y:d+te(mr)(0)(v(u=>u.y)(m))}})(r),Fs=t=>e=>f$(te(n=>r=>h$(.05)(.1)(e)(n))(g$(t))(Ft(1)(300)));function wr(t){return function(e){return t===e}}var Yt=(t,e,n)=>({tag:t,_1:e,_2:n});var ja=t=>({liftEffect:e=>O(ut("Bind",Yt("Lift",t.liftEffect(e)),n=>O(ut("Return",n),at)),at),Monad0:()=>bs});var Ss=t=>{let e=ja(t.MonadEffect0());return{liftAff:n=>O(ut("Bind",Yt("Lift",t.liftAff(n)),r=>O(ut("Return",r),at)),at),MonadEffect0:()=>e}};var Wr=(()=>ja(Jr).liftEffect)(),tt=t=>O(ut("Bind",Yt("State",e=>x(void 0,t(e))),e=>O(ut("Return",e),at)),at),le=Xi($e)(Ba),qr=O(ut("Bind",Yt("State",t=>x(t,t)),t=>O(ut("Return",t),at)),at),Js=Ss(Ns),qs={reflectSymbol:()=>"y"},vs={reflectSymbol:()=>"x"},zs={reflectSymbol:()=>"layout"},Os={reflectSymbol:()=>"edges"},Gs=(()=>{let t=An(Ar(Fi))(An(Ar((()=>{let e=An(Ua)(An(Ua)(Ga)(qs)())(vs)();return{encodeJson:n=>e.gEncodeJson(n)(Q)}})()))(Ga)(zs)())(Os)();return{encodeJson:e=>t.gEncodeJson(e)(Q)}})(),b$=(()=>Ar(Gs).encodeJson)(),ws=Ir({decodeJsonField:t=>t.tag==="Just"?p("Just",ye(e=>_("Left",dt("TypeMismatch","Number")),e=>_("Left",dt("TypeMismatch","Number")),bt,e=>_("Left",dt("TypeMismatch","Number")),e=>_("Left",dt("TypeMismatch","Number")),e=>_("Left",dt("TypeMismatch","Number")),t._1)):$}),Us=Oa(Ir((()=>{let t=He(Pi.decodeJson);return{decodeJsonField:e=>e.tag==="Just"?p("Just",t(e._1)):$}})())(Ir((()=>{let t=He(Oa(ws(ws(za)(qs)()())(vs)()())().decodeJson);return{decodeJsonField:e=>e.tag==="Just"?p("Just",t(e._1)):$}})())(za)(zs)()())(Os)()())(),T$=(()=>He(Us.decodeJson))(),M$=t=>e=>{let n=t(e);return O(ut("Bind",Yt("State",r=>{let a=n(r);return x(a,a)}),r=>O(ut("Return",r),at)),wt(at)(r=>O(ut("Return",void 0),at)))},E$=(()=>We(ht)(Y.compare))(),C$=t=>e=>{let n=Y.compare(t)(e);if(n==="LT")return e;if(n==="EQ"||n==="GT")return t;s()},L$=t=>e=>{let n=Y.compare(t)(e);if(n==="LT"||n==="EQ")return t;if(n==="GT")return e;s()},Ws=t=>t.currentStep!==Jt(t).layout.length?t:rr({reflectSymbol:()=>"results"})()()(Q)($e)(Ms.ix(t.selectedResultIndex)($e)(Ba)(e=>({...e,showNumber:!0})))(t);var Bs=t=>{if(t.tag==="AddVertex"){let e=Wr(Na(t._1));return O(e._1,wt(e._2)(n=>{if(n.tag==="Nothing")return O(ut("Return",void 0),at);if(n.tag==="Just"){let r=n._1;return tt(a=>a.editmode==="VertexMode"?{...le(Wi(r))(a),results:[],selectedResultIndex:0,currentStep:0}:a)}s()}))}if(t.tag==="SelectVertex"){let e=t._1,n=Wr(Ca(t._2));return O(n._1,wt(n._2)(()=>tt(r=>he(Bi)(r.editmode)([Er,In])?{...r,selectedVertex:p("Just",e)}:r)))}if(t.tag==="GraphMove"){let e=Wr(Na(t._1));return O(e._1,wt(e._2)(n=>tt(r=>{if(n.tag==="Just"){if(r.selectedVertex.tag==="Just"&&r.editmode==="MoveMode")return le(Ri(r.selectedVertex._1)(n._1))(r);if(r.editmode==="AddEMode")return{...r,currentPosition:p("Just",n._1)}}return r})))}if(t.tag==="DropOrLeave")return tt(e=>e.editmode==="AddEMode"?{...e,selectedVertex:$}:e);if(t.tag==="PointerUp"){let e=t._1;return tt(n=>n.editmode==="MoveMode"?{...n,selectedVertex:$,currentPosition:$}:n.editmode==="AddEMode"&&n.selectedVertex.tag==="Just"?{...le(qi(e)(n.selectedVertex._1))(n),currentStep:0,results:[],selectedResultIndex:0,selectedVertex:$}:n)}if(t.tag==="DeleteVertex"){let e=t._2,n=t._1;return O(qr._1,wt(qr._2)(r=>{let a=Wr(Ca(e));return r.editmode==="MoveMode"?O(a._1,wt(a._2)(()=>tt(o=>o.editmode==="DeleteMode"?{...le(Pa(n))(o),results:[],selectedResultIndex:0,currentStep:0}:o))):O(ut("Return",void 0),wt(at)(()=>tt(o=>o.editmode==="DeleteMode"?{...le(Pa(n))(o),results:[],selectedResultIndex:0,currentStep:0}:o)))}))}if(t.tag==="DeleteEdge"){let e=t._1._1,n=t._1._2;return tt(r=>r.editmode==="DeleteMode"?{...le(Si(e)(n))(r),results:[],selectedResultIndex:0,currentStep:0}:r)}if(t.tag==="ClearGraph")return tt(e=>({...le(n=>({layout:[],edges:[]}))(e),results:[],selectedResultIndex:0,currentStep:0}));if(t.tag==="SetEditMode"){let e=t._1;return tt(n=>({...n,editmode:e}))}if(t.tag==="AdjustGraph")return tt(e=>le(n=>({...n,layout:Fs(n.layout.length)(n.edges)}))(e));if(t.tag==="SetGraph"){let e=t._1;return tt(n=>({...n,currentStep:0,results:[],selectedGraphIdx:(()=>e==="1"?0:e==="2"?1:e==="3"?2:e==="4"?3:e==="5"?4:e==="6"?5:e==="7"?6:e==="8"?7:0)(),selectedResultIndex:0}))}if(t.tag==="SetAlgo"){let e=t._1;return tt(n=>({...n,currentStep:0,selectedAlgorithm:(()=>e==="alpha"?Cr:e==="decdegree"?Oi:e==="indset"?Gi:e==="dsatur"?Ui:e==="custom"?Ae("CustomAlgorithm",(()=>{let r=Jt(n).layout.length-1|0;return 0>r?[]:Ft(0)(r)})()):Cr)()}))}if(t.tag==="CustomAlgoTextChange"){let e=t._1;return tt(n=>{let r=ki(e);if(r.tag==="Nothing")return n;if(r.tag==="Just")return{...n,selectedAlgorithm:Ae("CustomAlgorithm",r._1)};s()})}if(t.tag==="SetResultIndex"){let e=t._1;return tt(n=>({...n,selectedResultIndex:e,currentStep:0}))}if(t.tag==="Save")return O(qr._1,wt(qr._2)(e=>Ni(Js)("coloring-graphs")(sr(b$(ge(5)(e.graphs.length)(e.graphs))))));if(t.tag==="Load"){let e=Ii(Js)("coloring-graphs");return O(e._1,wt(e._2)(n=>{if(n.tag==="Nothing")return O(ut("Return",void 0),at);if(n.tag==="Just"){let r=Fr(Ce,bt,n._1);if(r.tag==="Left")return O(ut("Return",void 0),at);if(r.tag==="Right"){let a=T$(r._1);if(a.tag==="Left")return O(ut("Return",void 0),at);if(a.tag==="Right")return a._1.length!==3?O(ut("Return",void 0),at):M$(Zi($e))(o=>[...ge(0)(5)(o),...a._1])}}s()}))}if(t.tag==="OpenImportDialog")return tt(e=>({...e,dialog:Nn("ImportDialog","")}));if(t.tag==="ChangeImportText"){let e=t._1;return tt(n=>({...n,dialog:Nn("ImportDialog",e)}))}if(t.tag==="ImportAndClose")return tt(e=>{if(e.dialog.tag==="ImportDialog"){let n=Fr(Ce,bt,e.dialog._1);if(n.tag==="Left")return{...e,dialog:Ve};if(n.tag==="Right"){let r=Us.decodeJson(n._1);if(r.tag==="Left")return{...e,dialog:Ve};if(r.tag==="Right"){let a=r._1;return{...le(o=>a)(e),currentStep:0,dialog:Ve,results:[],selectedResultIndex:0}}}s()}return e});if(t.tag==="Export")return tt(e=>({...e,dialog:Nn("ExportDialog",sr(Gs.encodeJson(Jt(e))))}));if(t.tag==="CloseDialog")return tt(e=>({...e,dialog:Ve}));if(t.tag==="Compute")return tt(e=>{let n=Qi(e.selectedGraphIdx)(Jt(e))(e.selectedAlgorithm);if(n.tag==="Nothing")return e;if(n.tag==="Just")return{...e,results:ge(0)(5)([{algorithm:e.selectedAlgorithm,coloring:n._1,number:(()=>{let r=E$(v(a=>a.color)(n._1));if(r.tag==="Nothing")return 0;if(r.tag==="Just")return 1+r._1|0;s()})(),showNumber:!1},...e.results])};s()});if(t.tag==="PreviousStep")return tt(e=>({...e,currentStep:C$(0)(e.currentStep-1|0)}));if(t.tag==="NextStep")return tt(e=>Ws({...e,currentStep:L$(Jt(e).layout.length)(e.currentStep+1|0)}));if(t.tag==="FinishColoring")return tt(e=>Ws({...e,currentStep:Jt(e).layout.length}));s()};var N$=(t,e,n,r=!1)=>{let a=[],o={},i={},d={},m={tag:t,children:n,props:o,attrs:i,events:d,node:null,keyed:r},u=e.length;for(let l=0;l<u;l++){let[c,D,k]=e[l];c===0?o[D]=k:c===1?i[D]=k:c===2?d[D]=k:c===3?i.class=i.class?i.class+" "+D:D:c===4&&a.push(D+":"+k)}let f=a.join(";");return f&&(i.style=f),m},E=(t,e,n)=>N$(t,e,n.map(r=>({key:null,html:r})));var I$=t=>({tag:t,children:[],type:3});var X=(t,e)=>[0,t,e],B=(t,e)=>[1,t,e],Tt=(t,e)=>[2,t,e],J=t=>[3,t],Qe=[-1];var G=I$;var pe=G("");var Qa=t=>e=>E("div",[J("p-6 bg-white border border-gray-200 rounded-lg shadow")],[E("div",[J("text-xl mb-2")],[G(t)]),...e]),vr="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700",Va=(()=>vr+" rounded")(),ks=t=>{let e=t.onClick;return E("button",[J(Va),Tt("click",n=>()=>p("Just",e)),...t.attrs],[G(t.name)])},Ka=t=>e=>n=>E("div",[J("absolute w-full h-full flex items-center justify-center bg-transp-grey inset-0 z-50")],[E("div",[J("bg-white text-black rounded block border-2")],[E("div",[J("p-4 min-h-8 border-b-2")],[E("div",[J("text-4xl font-medium inline-block")],[G(t)])]),E("div",[J("p-6 border-b-2")],e),E("div",[J("p-4 text-right")],st(r=>a=>{let o=a.onClick;return E("button",[J(r===0?Va+"":Va+" ml-4"),Tt("click",i=>()=>p("Just",o))],[G(a.name)])})(n))])]),Fn=t=>{let e=t.length;return E("div",[],st(n=>r=>{let a=r.onClick;return E("button",[J((()=>n===0?vr+" rounded-l":n===(e-1|0)?vr+" rounded-r":vr+"")()),Tt("click",o=>()=>p("Just",a)),...r.attrs],[G(r.name)])})(t))};var zr=t=>e=>n=>r=>B("viewBox",gt(t)+" "+gt(e)+" "+gt(n)+" "+gt(r));var A$=t=>e=>E("line",[B("x1",gt(100*t.x)),B("y1",gt(100*t.y)),B("x2",gt(100*e.x)),B("y2",gt(100*e.y)),J("graphparams-graphview-edge pointer-events-none")],[]),Vs=t=>{let e=t.editmode,n=Jt(t).layout.length,r=Jt(t);return E("div",[],[E("div",[J("graphparams-graphview-board")],[E("svg",[J("block"),zr(0)(0)(100)(100),Tt("click",a=>()=>p("Just",H("AddVertex",a))),Tt("pointerup",a=>()=>p("Just",Sa)),Tt("pointerleave",a=>()=>p("Just",Sa)),Tt("pointermove",a=>()=>p("Just",H("GraphMove",a)))],[E("g",[],v(a=>{let o=Ji(r)(a);if(o.tag==="Nothing")return pe;if(o.tag==="Just")return E("line",[B("x1",gt(100*o._1.x1)),B("y1",gt(100*o._1.y1)),B("x2",gt(100*o._1.x2)),B("y2",gt(100*o._1.y2)),J("graphparams-graphview-edge"),e==="DeleteMode"?J("deletemode"):Qe,Tt("click",i=>()=>p("Just",H("DeleteEdge",a)))],[]);s()})(r.edges)),E("g",[],ln(Kr)(st(a=>o=>{let i=o.x,d=o.y;return m=>E("circle",[B("cx",gt(100*i)),B("cy",gt(100*d)),B("r",zt(n<=26?4:2)),B("stroke-width","0.5"),J("graphparams-graphview-vertex color"+zt(m)),e==="DeleteMode"?J("deletemode"):Qe,(()=>{let u=es(a);return Tt("click",f=>{let l=p("Just",u(f));return()=>l})})(),(()=>{let u=ts(a);return Tt("pointerdown",f=>{let l=p("Just",u(f));return()=>l})})(),Tt("pointerup",u=>()=>p("Just",H("PointerUp",a)))],[])})(r.layout))(ji(t))),n<=26?E("g",[],st(a=>o=>E("text",[J("pointer-events-none select-none graphview-text"),B("x",gt(100*o.x-2)),B("y",gt(100*o.y+2))],[G(Vi(a))]))(r.layout)):pe,(()=>{if(e==="AddEMode"){let a=t.selectedVertex.tag==="Just"?tn.apply(t.currentPosition.tag==="Just"?p("Just",A$(t.currentPosition._1)):$)(ct(r.layout)(t.selectedVertex._1)):$;if(a.tag==="Nothing")return pe;if(a.tag==="Just")return a._1;s()}return pe})()])]),Fn([{name:"D\xE9placer",onClick:H("SetEditMode",In),attrs:[X("selected",e==="MoveMode")]},{name:"Ajouter sommet",onClick:H("SetEditMode",vi),attrs:[X("selected",e==="VertexMode")]},{name:"Ajouter ar\xEAte",onClick:H("SetEditMode",Er),attrs:[X("selected",e==="AddEMode")]},{name:"Retirer",onClick:H("SetEditMode",zi),attrs:[X("selected",e==="DeleteMode")]},{name:"Tout effacer",onClick:ns,attrs:[]},{name:"Ajuster",onClick:rs,attrs:[]}])])};var Qs=(t,e,n)=>typeof t.value=="string"?n(t.value):e;var Pn=t=>Tt("change",e=>{let n=_t(Ie(e),$,F);if(n.tag==="Just"){let r=n._1;return()=>{let a=Qs(r,$,F);return a.tag==="Just"?p("Just",t(a._1)):$}}if(n.tag==="Nothing")return()=>$;s()});var R$=t=>Ka("Importer les graphes")([E("textarea",[J("block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"),B("cols","150"),B("rows","30"),X("value",t),Pn($s)],[])])([{name:"Annuler",onClick:Ra},{name:"OK",onClick:ls}]),J$=t=>Ka("Exporter les graphes")([E("textarea",[J("block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"),B("cols","150"),B("rows","30"),X("value",t),X("selected",!0)],[])])([{name:"OK",onClick:Ra}]),Ks=t=>{let e=t.selectedResultIndex;return E("div",[J("flex flex-row justify-around")],[Qa("Graphe")([Vs(t)]),Qa("Ordre des couleurs")([E("div",[J("w-32")],[E("svg",[zr(0)(0)(20)(100)],nn(Ft(0)(9))(n=>[E("rect",[B("x","0"),B("y",zt(n*10|0)),B("width","10"),B("height","10"),J("color"+zt(n))],[]),E("text",[B("x","12"),B("y",zt((n*10|0)+8|0)),J("graphview-text")],[G(zt(n+1|0))])]))])]),E("div",[J("flex flex-col")],[E("span",[J("mb-2 mt-4 text-2xl font-bold")],[G("Graphe")]),E("select",[J("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),X("value","1"),Pn(as)],[E("option",[X("value","1")],[G("Cygne")]),E("option",[X("value","2")],[G("Confluence")]),E("option",[X("value","3")],[G("Lapin")]),E("option",[X("value","4")],[G("Poisson")]),E("option",[X("value","5")],[G("Gros graphe")]),E("option",[X("value","6")],[G("Graphe personnalis\xE9 1")]),E("option",[X("value","7")],[G("Graphe personnalis\xE9 2")]),E("option",[X("value","8")],[G("Graphe personnalis\xE9 3")])]),Fn([{onClick:ss,name:"Sauvegarder",attrs:[]},{onClick:us,name:"Importer",attrs:[]},{onClick:cs,name:"Exporter",attrs:[]}]),E("span",[J("mb-2 mt-4 text-2xl font-bold")],[G("Ordre")]),E("select",[J("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),B("name","dsatur"),Pn(os)],[E("option",[X("value","alpha")],[G("Alphabetique")]),E("option",[X("value","decdegree")],[G("Degr\xE9 d\xE9croissant")]),E("option",[X("value","indset")],[G("Stables")]),E("option",[X("value","dsatur")],[G("DSatur")]),E("option",[X("value","custom")],[G("Personnalis\xE9")])]),t.selectedAlgorithm.tag==="CustomAlgorithm"&&Jt(t).layout.length<=26?E("input",[J("bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"),B("type","text"),X("value",Lr(t.selectedAlgorithm._1)),Pn(is)],[]):pe,ks({onClick:ps,name:"Choisir",attrs:[]}),E("span",[J("mb-2 mt-4 text-2xl font-bold")],[G("R\xE9sultats")]),E("ul",[J("ml-4 list-disc")],[...st(n=>r=>E("li",[e===n?J("text-blue-600"):Qe,Tt("click",a=>()=>p("Just",H("SetResultIndex",n)))],[G(Yi(r.algorithm)+(r.showNumber?" ("+zt(r.number)+" couleurs)":""))]))(t.results),...Ln(5-t.results.length|0)(n=>E("li",[],[]))]),Fn([{onClick:fs,name:"Etape pr\xE9c\xE9dente",attrs:[]},{onClick:ms,name:"Etape suivante",attrs:[]},{onClick:gs,name:"Termine la coloration",attrs:[]}]),Jt(t).layout.length<=26?E("span",[J("text-xl")],[G(Lr(Hi(t)))]):pe]),(()=>{if(t.dialog.tag==="NoDialog")return pe;if(t.dialog.tag==="ExportDialog")return J$(t.dialog._1);if(t.dialog.tag==="ImportDialog")return R$(t.dialog._1);s()})()])};var Ys=(t,e)=>t&&e?n=>t(e(n)):t||e,Xs=(t,e,n)=>{t[e]=n},Zs=(t,e,n)=>{n==null||e==="class"&&!n?t.removeAttribute(e):t.setAttribute(e,n)},td=(t,e,n,r,a,o)=>{t.actions||(t.actions={}),t.actions[e]=o&&r?o(r):r,r?n||t.addEventListener(e,a):t.removeEventListener(e,a)},Or=(t,e,n,r)=>{let a=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),o=t.props,i=t.attrs,d=t.events,m=Ys(r,t.mapf);for(let u in o)Xs(a,u,o[u]);for(let u in i)Zs(a,u,i[u]);for(let u in d)td(a,u,null,d[u],e,m);for(let u=0,f=t.children.length;u<f;u++)a.appendChild(Or(Se(t.children[u]).html,e,n,m));return t.node=a,a},Pe=(t,e,n,r,a,o,i)=>{if(n!==r){if(n!=null&&n.type===3&&r.type===3)n.tag!==r.tag&&(e.nodeValue=r.tag);else if(n==null||n.tag!==r.tag)e=t.insertBefore(Or(r,a,o,i),e),n&&n.node.remove();else{let d=n.props,m=r.props;for(let I in{...d,...m})d[I]!==m[I]&&Xs(e,I,m[I]);let u=n.attrs,f=r.attrs;for(let I in{...u,...f})u[I]!==f[I]&&Zs(e,I,f[I]);let l=n.events,c=r.events;for(let I in{...l,...c})l[I]!==c[I]&&td(e,I,l[I],c[I],a,i);let D=n.children,k=r.children,ot=D.length-1,Nt=k.length-1;if(i=Ys(i,r.mapf),o=o||r.tag==="svg",r.keyed){let I=0,V=0;for(;V<=Nt&&I<=ot;){let{key:Wt,html:qt}=D[I];if(Wt!==k[V].key)break;let b=Se(k[V],qt);Pe(e,qt.node,qt,b.html,a,o,i),V++,I++}for(;V<=Nt&&I<=ot;){let{key:Wt,html:qt}=D[ot];if(Wt!==k[Nt].key)break;let b=Se(k[Nt],qt);Pe(e,qt.node,qt,b.html,a,o,i),Nt--,ot--}if(I>ot)for(;V<=Nt;){let Wt=Se(k[V]).html;e.insertBefore(Or(Wt,a,o,i),D[I]&&D[I].html.node),V++}else if(V>Nt)for(;I<=ot;)D[I].html.node.remove(),I++;else{let Wt={},qt={};for(let b=I;b<=ot;b++)Wt[D[b].key]=D[b].html;for(;V<=Nt;){let{key:b,html:mt}=D[I]||{key:null,html:null},{key:ae,html:Br}=Se(k[V],mt);if(qt[b]||D[I+1]&&ae===D[I+1].key){I++;continue}if(b===ae)Pe(e,mt.node,mt,Br,a,o,i),qt[ae]=!0,I++;else{let Ye=Wt[ae];Ye!=null?(Pe(e,e.insertBefore(Ye.node,mt.node),Ye,k[V].html,a,o,i),qt[ae]=!0):Pe(e,mt&&mt.node,null,k[V].html,a,o,i)}V++}for(let b in Wt)qt[b]||Wt[b].node.remove()}}else{for(let I=0;I<=ot&&I<=Nt;I++){let V=D[I].html,Wt=Se(k[I],V).html;Pe(e,V.node,V,Wt,a,o,i)}for(let I=ot+1;I<=Nt;I++){let V=Se(k[I],n).html;e.appendChild(Or(V,a,o,i))}for(let I=Nt+1;I<=ot;I++)D[I].html.node.remove()}}return r.node=e,e}},W$=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},Se=(t,e)=>(typeof t.html.type=="function"&&((!e||e.memo==null||W$(e.memo,t.html.memo))&&(e=Gr(t.html.type(...t.html.memo)),e.memo=t.html.memo),t.html=e),t),Gr=t=>({...t,children:t.children&&t.children.map(({key:e,html:n})=>({key:e,html:Gr(n)}))}),ed=(t,e)=>t.actions[e],nd=Pe,rd=t=>e=>(e.node=t,e);var Re=function(t){return function(e){return function(){return e[t]}}},wM=Re("URL"),WM=Re("documentURI"),qM=Re("origin"),vM=Re("compatMode"),zM=Re("characterSet"),OM=Re("contentType");var v$=Re("documentElement");function ad(t){return function(e){return function(){return e.createTextNode(t)}}}var Xt=function(t){return function(e){return function(){return e[t]}}};var uE=Xt("baseURI"),G$=Xt("ownerDocument"),Ya=Xt("parentNode"),U$=Xt("parentElement");var cE=Xt("childNodes"),B$=Xt("firstChild"),k$=Xt("lastChild"),H$=Xt("previousSibling"),j$=Xt("nextSibling"),V$=Xt("nodeValue");var $E=Xt("textContent");function od(t){return function(e){return function(){e.appendChild(t)}}}var Ur=function(t){return function(e){return function(){return e[t]}}},WE=Ur("children"),K$=Ur("firstElementChild"),Y$=Ur("lastElementChild"),qE=Ur("childElementCount");function id(t){return function(e){return function(){return e.querySelector(t)}}}var sd=t=>{let e=id(t);return n=>{let r=e(n);return()=>{let a=r();return _t(a,$,F)}}};var Sn=Bn(ta)(sn),Z$=Bn(Rr)(sn),tl=Ds({map:t=>e=>{if(e.tag==="State")return Yt("State",n=>{let r=e._1(n);return x(t(r._1),r._2)});if(e.tag==="Lift")return Yt("Lift",Pr(t)(e._1));if(e.tag==="Subscribe")return Yt("Subscribe",e._1,n=>t(e._2(n)));if(e.tag==="Unsubscribe")return Yt("Unsubscribe",e._1,t(e._2));s()}})(xs),el=t=>e=>n=>{let r=n(e);return()=>{let a=r();return Sn(a)(t.update(t))()}},dd=t=>e=>{let n=t.node,r=t.vdom;return()=>{let a=r.value,o=n.value,i=Ya(o)();return Sn(_t(i,$,F))(d=>{let m=Gr(e);return()=>{let u=nd(d,o,a,m,f=>{let l=Di(f);return Sn(_t(Ie(f),$,F))(c=>()=>{let D=ed(c,l);return el(t)(f)(D)()})()});return n.value=u,r.value=m}})()}},nl=t=>e=>{let n=t.state;return()=>{let r=n.value,a=wr(r)(e);if(!a)return n.value=e,dd(t)(t.view(e))();a||s()}},ud=t=>e=>n=>{let r=e.subscriptions;return tl(a=>{if(a.tag==="State")return kt(re((()=>{let o=e.state;return()=>o.value})()))(o=>{let i=a._1(o),d=i._1;return kt(re(nl(e)(i._2)))(()=>Fe(d))});if(a.tag==="Lift")return a._1;if(a.tag==="Subscribe")return kt(re(a._1(o=>{let i=Sr(ka,ud(t)(e)(t(o)));return()=>{i().run()}})))(o=>kt(re((()=>{let i=e.freshId;return()=>{let d=i.value;return i.value=d+1|0,d}})()))(i=>kt(re((()=>{let d=fr(Y)(i)(o);return()=>{let m=r.value;r.value=d(m)}})()))(()=>Fe(a._2(i)))));if(a.tag==="Unsubscribe"){let o=a._2,i=a._1;return kt(re(()=>r.value))(d=>kt(Z$(pr(Y)(i)(d))(re))(()=>Fe(o)))}s()})(n)},rl=t=>{let e=t.init.model,n=t.init.msg,r=t.selector,a=t.update,o=t.view;return()=>{let i=je(),d=La(i)(),m=sd(r)(d)();return Sn(m.tag==="Just"?p("Just",m._1):$)(u=>()=>{let f={value:e},l=je(),c=La(l)(),D=ad("")(c)();od(D)(u)();let k={value:D},ot={value:rd(D)(G(""))},V={view:o,update:a,state:f,node:k,vdom:ot,subscriptions:{value:ke},freshId:{value:0}};return dd(V)(o(e))(),Sn(n)(V.update(V))()})()}};var cd=t=>{let e=t.update;return rl({init:t.init,view:t.view,selector:t.selector,update:n=>r=>{let a=Sr(ka,ud(e)(n)(e(r)));return()=>{a().run()}}})};var $d=cd({init:{model:Ki,msg:p("Just",ds)},update:Bs,view:Ks,selector:"#root"});$d();})();
