(()=>{function We(t){let e=0,n;return()=>{if(e===2)return n;if(e===1)throw new Error("Binding demanded before initialized");return e=1,n=t(),e=2,n}}function*Ur(t,e){for(let n=t;n<e;n++)yield n}function u(){throw new Error("Failed pattern match")}var Gt=function(t){return function(e){return e[t]}},ue=function(t){return function(e){return function(n){var r={};for(var o in n)({}).hasOwnProperty.call(n,o)&&(r[o]=n[o]);return r[t]=e,r}}};var Es=()=>({tag:"Proxy"}),et=Es();var _t=function(t){return t.toString()},Y=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"};var jn=t=>({tag:t}),Tt=jn("LT"),Lt=jn("GT"),Yt=jn("EQ");var L=(t,e)=>({tag:t,_1:e}),p=L("Nothing"),z=t=>L("Just",t);var Z=(t,e)=>({tag:t,_1:e}),ze=t=>Z("Left",t),At=t=>Z("Right",t);var Je={map:t=>e=>{if(e.tag==="Left")return Z("Left",e._1);if(e.tag==="Right")return Z("Right",t(e._1));u()}};var Gr=function(t){return function(){return t}};var Fs={apply:t=>e=>()=>{let n=t(),r=e();return On.pure(n(r))()},Functor0:()=>ws},On={pure:Gr,Apply0:()=>Fs},ws={map:t=>e=>()=>{let n=e();return t(n)}};var Vn={compose:t=>e=>n=>t(e(n))};var F=function(t){return function(e){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o]);return r}};var fn=t=>t;var De=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=o-1;a>=0;a--)r=t(n[a])(r);return r}}},Jt=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=0;a<o;a++)r=t(r)(n[a]);return r}}};var Yn=t=>{let e=t.Apply0(),n=e.Functor0().map;return r=>o=>r.foldr(a=>{let s=o(a);return i=>e.apply(n($=>fn)(s))(i)})(t.pure())},Kn=t=>{let e=Yn(t);return n=>{let r=e(n);return o=>a=>r(a)(o)}};var eo=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return L("Just",r);if(n.tag==="Just")return L("Just",e(n._1)(r).tag==="GT"?n._1:r);u()})(p);var no=t=>e=>t.foldl(n=>r=>{if(n.tag==="Nothing")return L("Just",r);if(n.tag==="Just")return L("Just",e(n._1)(r).tag==="LT"?n._1:r);u()})(p);var gn={foldr:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(n._1)(e);u()},foldl:t=>e=>n=>{if(n.tag==="Nothing")return e;if(n.tag==="Just")return t(e)(n._1);u()},foldMap:t=>{let e=t.mempty;return n=>r=>{if(r.tag==="Nothing")return e;if(r.tag==="Just")return n(r._1);u()}}};var Rt={foldr:De,foldl:Jt,foldMap:t=>{let e=t.Semigroup0().append,n=t.mempty;return r=>Rt.foldr(o=>a=>e(r(o))(a))(n)}};var He=function(t){throw new Error(t)};var Nt=function(){var t={},e="Pure",n="Throw",r="Catch",o="Sync",a="Async",s="Bind",i="Bracket",$="Fork",c="Sequential",f="Map",_="Apply",D="Alt",N="Cons",J="Resume",C="Release",U="Finalizer",G="Finalized",V="Forked",yt="Fiber",S="Thunk";function d(g,v,nt,B){this.tag=g,this._1=v,this._2=nt,this._3=B}function at(g){var v=function(nt,B,y){return new d(g,nt,B,y)};return v.tag=g,v}function _e(g){return new d(e,void 0)}function Bn(g){try{g()}catch(v){setTimeout(function(){throw v},0)}}function kr(g,v,nt){try{return v(nt())}catch(B){return g(B)}}function Ls(g,v,nt){try{return v(nt)()}catch(B){return nt(g(B))(),_e}}var cn=function(){var g=1024,v=0,nt=0,B=new Array(g),y=!1;function l(){var H;for(y=!0;v!==0;)v--,H=B[nt],B[nt]=void 0,nt=(nt+1)%g,H();y=!1}return{isDraining:function(){return y},enqueue:function(H){var A,tt;v===g&&(tt=y,l(),y=tt),B[(nt+v)%g]=H,v++,y||l()}}}();function Cs(g){var v={},nt=0,B=0;return{register:function(y){var l=nt++;y.onComplete({rethrow:!0,handler:function(H){return function(){B--,delete v[l]}}})(),v[l]=y,B++},isEmpty:function(){return B===0},killAll:function(y,l){return function(){if(B===0)return l();var H=0,A={};function tt(j){A[j]=v[j].kill(y,function(st){return function(){delete A[j],H--,g.isLeft(st)&&g.fromLeft(st)&&setTimeout(function(){throw g.fromLeft(st)},0),H===0&&l()}})()}for(var ft in v)v.hasOwnProperty(ft)&&(H++,tt(ft));return v={},nt=0,B=0,function(j){return new d(o,function(){for(var st in A)A.hasOwnProperty(st)&&A[st]()})}}}}}var ye=0,bt=1,dn=2,ln=3,pn=4,Mt=5,Se=6;function kn(g,v,nt){var B=0,y=ye,l=nt,H=null,A=null,tt=null,ft=null,j=null,st=0,ie=0,Et=null,te=!0;function ee(h){for(var b,q,W;;)switch(b=null,q=null,W=null,y){case dn:y=bt;try{l=tt(l),ft===null?tt=null:(tt=ft._1,ft=ft._2)}catch(mt){y=Mt,H=g.left(mt),l=null}break;case ln:g.isLeft(l)?(y=Mt,H=l,l=null):tt===null?y=Mt:(y=dn,l=g.fromRight(l));break;case bt:switch(l.tag){case s:tt&&(ft=new d(N,tt,ft)),tt=l._2,y=bt,l=l._1;break;case e:tt===null?(y=Mt,l=g.right(l._1)):(y=dn,l=l._1);break;case o:y=ln,l=kr(g.left,g.right,l._1);break;case a:y=pn,l=Ls(g.left,l._1,function(mt){return function(){B===h&&(B++,cn.enqueue(function(){B===h+1&&(y=ln,l=mt,ee(B))}))}});return;case n:y=Mt,H=g.left(l._1),l=null;break;case r:tt===null?j=new d(N,l,j,A):j=new d(N,l,new d(N,new d(J,tt,ft),j,A),A),tt=null,ft=null,y=bt,l=l._1;break;case i:st++,tt===null?j=new d(N,l,j,A):j=new d(N,l,new d(N,new d(J,tt,ft),j,A),A),tt=null,ft=null,y=bt,l=l._1;break;case $:y=ln,b=kn(g,v,l._2),v&&v.register(b),l._1&&b.run(),l=g.right(b);break;case c:y=bt,l=Ns(g,v,l._1);break}break;case Mt:if(tt=null,ft=null,j===null)y=Se,l=A||H||l;else switch(b=j._3,W=j._1,j=j._2,W.tag){case r:A&&A!==b&&st===0?y=Mt:H&&(y=bt,l=W._2(g.fromLeft(H)),H=null);break;case J:A&&A!==b&&st===0||H?y=Mt:(tt=W._1,ft=W._2,y=dn,l=g.fromRight(l));break;case i:st--,H===null&&(q=g.fromRight(l),j=new d(N,new d(C,W._2,q),j,b),(A===b||st>0)&&(y=bt,l=W._3(q)));break;case C:j=new d(N,new d(G,l,H),j,A),y=bt,A&&A!==b&&st===0?l=W._1.killed(g.fromLeft(A))(W._2):H?l=W._1.failed(g.fromLeft(H))(W._2):l=W._1.completed(g.fromRight(l))(W._2),H=null,st++;break;case U:st++,j=new d(N,new d(G,l,H),j,A),y=bt,l=W._1;break;case G:st--,y=Mt,l=W._1,H=W._2;break}break;case Se:for(var ot in Et)Et.hasOwnProperty(ot)&&(te=te&&Et[ot].rethrow,Bn(Et[ot].handler(l)));Et=null,A&&H?setTimeout(function(){throw g.fromLeft(H)},0):g.isLeft(l)&&te&&setTimeout(function(){if(te)throw g.fromLeft(l)},0);return;case ye:y=bt;break;case pn:return}}function rt(h){return function(){if(y===Se)return te=te&&h.rethrow,h.handler(l)(),function(){};var b=ie++;return Et=Et||{},Et[b]=h,function(){Et!==null&&delete Et[b]}}}function T(h,b){return function(){if(y===Se)return b(g.right(void 0))(),function(){};var q=rt({rethrow:!1,handler:function(){return b(g.right(void 0))}})();switch(y){case ye:A=g.left(h),y=Se,l=A,ee(B);break;case pn:A===null&&(A=g.left(h)),st===0&&(y===pn&&(j=new d(N,new d(U,l(h)),j,A)),y=Mt,l=null,H=null,ee(++B));break;default:A===null&&(A=g.left(h)),st===0&&(y=Mt,l=null,H=null)}return q}}function R(h){return function(){var b=rt({rethrow:!1,handler:h})();return y===ye&&ee(B),b}}return{kill:T,join:R,onComplete:rt,isSuspended:function(){return y===ye},run:function(){y===ye&&(cn.isDraining()?ee(B):cn.enqueue(function(){ee(B)}))}}}function Ms(g,v,nt,B){var y=0,l={},H=0,A={},tt=new Error("[ParAff] Early exit"),ft=null,j=t;function st(rt,T,R){var h=T,b=null,q=null,W=0,ot={},mt,qe;t:for(;;)switch(mt=null,h.tag){case V:if(h._3===t&&(mt=l[h._1],ot[W++]=mt.kill(rt,function(xs){return function(){W--,W===0&&R(xs)()}})),b===null)break t;h=b._2,q===null?b=null:(b=q._1,q=q._2);break;case f:h=h._2;break;case _:case D:b&&(q=new d(N,b,q)),b=h,h=h._1;break}if(W===0)R(g.right(void 0))();else for(qe=0,mt=W;qe<mt;qe++)ot[qe]=ot[qe]();return ot}function ie(rt,T,R){var h,b,q,W,ot,mt;g.isLeft(rt)?(h=rt,b=null):(b=rt,h=null);t:for(;;){if(q=null,W=null,ot=null,mt=null,ft!==null)return;if(T===null){B(h||b)();return}if(T._3!==t)return;switch(T.tag){case f:h===null?(T._3=g.right(T._1(g.fromRight(b))),b=T._3):T._3=h;break;case _:if(q=T._1._3,W=T._2._3,h){if(T._3=h,ot=!0,mt=H++,A[mt]=st(tt,h===q?T._2:T._1,function(){return function(){delete A[mt],ot?ot=!1:R===null?ie(h,null,null):ie(h,R._1,R._2)}}),ot){ot=!1;return}}else{if(q===t||W===t)return;b=g.right(g.fromRight(q)(g.fromRight(W))),T._3=b}break;case D:if(q=T._1._3,W=T._2._3,q===t&&g.isLeft(W)||W===t&&g.isLeft(q))return;if(q!==t&&g.isLeft(q)&&W!==t&&g.isLeft(W))h=b===q?W:q,b=null,T._3=h;else if(T._3=b,ot=!0,mt=H++,A[mt]=st(tt,b===q?T._2:T._1,function(){return function(){delete A[mt],ot?ot=!1:R===null?ie(b,null,null):ie(b,R._1,R._2)}}),ot){ot=!1;return}break}R===null?T=null:(T=R._1,R=R._2)}}function Et(rt){return function(T){return function(){delete l[rt._1],rt._3=T,ie(T,rt._2._1,rt._2._2)}}}function te(){var rt=bt,T=nt,R=null,h=null,b,q;t:for(;;)switch(b=null,q=null,rt){case bt:switch(T.tag){case f:R&&(h=new d(N,R,h)),R=new d(f,T._1,t,t),T=T._2;break;case _:R&&(h=new d(N,R,h)),R=new d(_,t,T._2,t),T=T._1;break;case D:R&&(h=new d(N,R,h)),R=new d(D,t,T._2,t),T=T._1;break;default:q=y++,rt=Mt,b=T,T=new d(V,q,new d(N,R,h),t),b=kn(g,v,b),b.onComplete({rethrow:!1,handler:Et(T)})(),l[q]=b,v&&v.register(b)}break;case Mt:if(R===null)break t;R._1===t?(R._1=T,rt=bt,T=R._2,R._2=t):(R._2=T,T=R,h===null?R=null:(R=h._1,h=h._2))}for(j=T,q=0;q<y;q++)l[q].run()}function ee(rt,T){ft=g.left(rt);var R;for(var h in A)if(A.hasOwnProperty(h)){R=A[h];for(h in R)R.hasOwnProperty(h)&&R[h]()}A=null;var b=st(rt,j,T);return function(q){return new d(a,function(W){return function(){for(var ot in b)b.hasOwnProperty(ot)&&b[ot]();return _e}})}}return te(),function(rt){return new d(a,function(T){return function(){return ee(rt,T)}})}}function Ns(g,v,nt){return new d(a,function(B){return function(){return Ms(g,v,nt,B)}})}return d.EMPTY=t,d.Pure=at(e),d.Throw=at(n),d.Catch=at(r),d.Sync=at(o),d.Async=at(a),d.Bind=at(s),d.Bracket=at(i),d.Fork=at($),d.Seq=at(c),d.ParMap=at(f),d.ParApply=at(_),d.ParAlt=at(D),d.Fiber=kn,d.Supervisor=Cs,d.Scheduler=cn,d.nonCanceler=_e,d}(),Be=Nt.Pure,Gs=Nt.Throw;function oo(t){return function(e){return e.tag===Nt.Pure.tag?Nt.Pure(t(e._1)):Nt.Bind(e,function(n){return Nt.Pure(t(n))})}}function re(t){return function(e){return Nt.Bind(t,e)}}var ke=Nt.Sync;var Vs=Nt.Async;function Zn(t,e){return function(){return Nt.Fiber(t,null,e)}}var _n=function(){function t(n,r){return n===0&&typeof setImmediate<"u"?setImmediate(r):setTimeout(r,n)}function e(n,r){return n===0&&typeof clearImmediate<"u"?clearImmediate(r):clearTimeout(r)}return function(n,r){return Nt.Async(function(o){return function(){var a=t(r,o(n()));return function(){return Nt.Sync(function(){return n(e(r,a))})}}})}}(),Ys=Nt.Seq;var Ks={map:oo};var ao={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;u()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return He("unsafeFromLeft: Right");u()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return He("unsafeFromRight: Left");u()},left:ze,right:At};var yn={Applicative0:()=>io,Bind1:()=>Zs},Zs={bind:re,Apply0:()=>so},so={apply:t=>e=>re(t)(n=>re(e)(r=>io.pure(n(r)))),Functor0:()=>Ks},io={pure:Be,Apply0:()=>so};var uo={liftEffect:ke,Monad0:()=>yn};var co={tailRecM:t=>{let e=n=>re(t(n))(r=>{if(r.tag==="Done")return Be(r._1);if(r.tag==="Loop")return e(r._1);u()});return e},Monad0:()=>yn};var je=function(t){return function(e){for(var n=[],r=0,o=t.length;r<o;r++)Array.prototype.push.apply(n,e(t[r]));return n}};var wt=(t,e)=>({tag:t,_1:e}),tr=t=>wt("Loop",t),lo=t=>wt("Done",t);function oi(t){return function(){return t.slice()}}var er=oi,ai=function(){function t(e,n,r,o,a,s){var i,$,c,f,_,D,N;for(i=a+(s-a>>1),i-a>1&&t(e,n,o,r,a,i),s-i>1&&t(e,n,o,r,i,s),$=a,c=i,f=a;$<i&&c<s;)_=o[$],D=o[c],N=n(e(_)(D)),N>0?(r[f++]=D,++c):(r[f++]=_,++$);for(;$<i;)r[f++]=o[$++];for(;c<s;)r[f++]=o[c++]}return function(e){return function(n){return function(r){return function(){return r.length<2||t(e,n,r,r.slice(0),0,r.length),r}}}}}();var M=(t,e)=>({tag:"Tuple",_1:t,_2:e}),Bt=t=>e=>M(t,e);var Dn={map:t=>e=>M(e._1,t(e._2))};var dt=function(t){return function(e){for(var n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t(o)(e[o]);return r}};var To=function(t){return function(e){return t===e}};var Lo=To,Co=To;var No={eq:Co},be={eq:Lo};var xo=function(t){return function(e){return function(n){return function(r){return function(o){return r<o?t:r===o?e:n}}}}};var Eo=xo,Po=xo;var Le={compare:Po(Tt)(Yt)(Lt),Eq0:()=>No},ce={compare:Eo(Tt)(Yt)(Lt),Eq0:()=>be};var Ci=function(){function t(o){return[o]}function e(o){return function(a){return[o,a]}}function n(o){return function(a){return function(s){return[o,a,s]}}}function r(o){return function(a){return o.concat(a)}}return function(o){return function(a){return function(s){return function(i){return function($){function c(f,_){switch(_-f){case 0:return s([]);case 1:return a(t)(i($[f]));case 2:return o(a(e)(i($[f])))(i($[f+1]));case 3:return o(o(a(n)(i($[f])))(i($[f+1])))(i($[f+2]));default:var D=f+Math.floor((_-f)/4)*2;return o(a(r)(c(f,D)))(c(D,_))}}return c(0,$.length)}}}}}}();var qt=function(t){return function(e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),o=t,a=0;o!==e;)r[a++]=o,o+=n;return r[a]=o,r}},vi=function(t){return function(e){if(t<1)return[];var n=new Array(t);return n.fill(e)}},zi=function(t){return function(e){for(var n=[],r=0,o=0;o<t;o++)n[r++]=e;return n}},wo=typeof Array.prototype.fill=="function"?vi:zi,Ro=function(){function t(o,a){this.head=o,this.tail=a}var e={};function n(o){return function(a){return new t(o,a)}}function r(o){for(var a=[],s=0,i=o;i!==e;)a[s++]=i.head,i=i.tail;return a}return function(o){return function(a){return r(o(n)(e)(a))}}}();var Io=function(t){return function(e){return function(n){return function(r){return r<0||r>=n.length?e:t(n[r])}}}};var So=function(t){return function(e){return function(n){return function(r){for(var o=0,a=r.length;o<a;o++)if(n(r[o]))return t(o);return e}}}};var qo=function(t){return function(e){return function(n){return function(r){return function(o){if(n<0||n>=o.length)return e;var a=o.slice();return a[n]=r,t(a)}}}}};var rr=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],n=0,r=t.length;n<r;n++)for(var o=t[n],a=0,s=o.length;a<s;a++)e.push(o[a]);return e},Ce=function(t){return function(e){return e.filter(t)}};var Wo=function(){function t(e,n,r,o,a,s){var i,$,c,f,_,D,N;for(i=a+(s-a>>1),i-a>1&&t(e,n,o,r,a,i),s-i>1&&t(e,n,o,r,i,s),$=a,c=i,f=a;$<i&&c<s;)_=o[$],D=o[c],N=n(e(_)(D)),N>0?(r[f++]=D,++c):(r[f++]=_,++$);for(;$<i;)r[f++]=o[$++];for(;c<s;)r[f++]=o[c++]}return function(e){return function(n){return function(r){var o;return r.length<2?r:(o=r.slice(0),t(e,n,o,r.slice(0),0,r.length),o)}}}}();var oe=function(t){return function(e){return function(n){for(var r=e.length<n.length?e.length:n.length,o=new Array(r),a=0;a<r;a++)o[a]=t(e[a])(n[a]);return o}}};var vo=qo(z)(p);var Bi=t=>Wo(t)(e=>{if(e.tag==="GT")return 1;if(e.tag==="EQ")return 0;if(e.tag==="LT")return-1;u()}),or=t=>e=>Bi(n=>r=>t.compare(e(n))(e(r)));var Ve=t=>e=>(()=>{let n=er(t);return()=>{let r=n();return r.push(e),r}})()();var zo=t=>e=>{let n=e.length;return n<2?e:(()=>{let r=[];r.push(e[0]);for(let o of Ur(1,n))r.push(t),r.push(e[o]);return r})()};var Tn=Io(z)(p);var ki=So(z)(p);var Ln=t=>e=>n=>{let r=ki(o=>t.eq(o)(e))(n);if(r.tag==="Nothing")return!1;if(r.tag==="Just")return!0;u()};var ar=function(t){return function(e){return t+e}},Cn=function(t){return function(e){return t*e}};var Ut=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},de=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var Ne=isFinite;function Mn(t,e,n,r){var o=parseFloat(t);return e(o)?n(o):r}var sr=Math.ceil;var ir=Math.floor;var Bo=function(t){return function(e){return function(n){return(n|0)===n?t(n):e}}},K=function(t){return t},ko=function(t){return function(e){return function(n){var r;n<11?r="[0-"+(n-1).toString()+"]":n===11?r="[0-9a]":r="[0-9a-"+String.fromCharCode(86+n)+"]";var o=new RegExp("^[\\+\\-]?"+r+"+$","i");return function(a){if(o.test(a)){var s=parseInt(a,n);return(s|0)===s?t(s):e}else return e}}}};var Oi=ko(z)(p),Uo=Oi(10),Qi=Bo(z)(p),cr=t=>{if(!Ne(t))return 0;if(t>=K(2147483647))return 2147483647;if(t<=K(-2147483648))return-2147483648;let e=Qi(t);if(e.tag==="Nothing")return 0;if(e.tag==="Just")return e._1;u()};var lr=t=>e=>n=>{let r=n.Profunctor0().dimap;return o=>r(a=>M(t(a),s=>e(a)(s)))(a=>a._2(a._1))(n.first(o))};var Oo=t=>()=>e=>n=>Gt(t.reflectSymbol(e))(n);var Wt=t=>()=>()=>e=>n=>lr(Oo(t)()(e))(r=>o=>ue(t.reflectSymbol(e))(o)(r))(n);var Go=F(t=>t===1)([0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0]),Vo=F(t=>t===1)([0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,1,1,0,0,1,1,1,0,0]),Yo=F(t=>t===1)([0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,0]),Ko=F(t=>t===1)([0,0,1,1,0,0,0,1,0,1,0,0,0,1,0,1,1,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,0]),Zo=F(t=>t===1)([0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,1,1,1,1,1,0,1,0,0,0,1,0,1,0,0,1,1,0,0,1,1,0,0]),Xo=F(t=>t===1)([0,0,0,0,0,0,0,0,1,1,1,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,1,1,1,0,1,1,0,0,1,1,0,1,0,0,1,0,0,1,1,1,1,0]),ta=F(t=>t===1)([0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,0,1,0,1,0,0,0,1,1,1,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,1,1,0,0]),ea=F(t=>t===1)([0,0,0,1,1,0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1,1,1,1,0,0,1,0,0,0,1,0,1,1,1,1,0,0,0,0,0,0,0]),na=F(t=>t===1)([0,0,1,1,1,0,0,1,1,0,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,1,1,1,0,0]),ra=F(t=>t===1)([0,1,1,1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,1,1,0,0]),oa=F(t=>t===1)([0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,1,1,0]),aa=F(t=>t===1)([0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,1,1,1,0,0]),sa=F(t=>t===1)([0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,0,1,0,0,1,0,0,0,1,1,1,0,0,0,0,0,0,0]),ia=F(t=>t===1)([0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0]),ua=F(t=>t===1)([0,0,1,1,0,0,0,1,1,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,1,1,0,0]),ca=F(t=>t===1)([0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,0,1,0,0,1,0,0,0,1,1,0,0]),Kt=wo(54)(!1);var xe=(t,e,n)=>({tag:t,_1:e,_2:n}),Xi=(()=>no(Rt)(Le.compare))(),tu=(()=>eo(Rt)(Le.compare))(),da=xe("EditorDialog");var Ye=xe("NoDialog"),la=xe("AllNeuronsDialog"),Ke=F(F(t=>t===1))([[1,1,1,0,0,0],[1,1,0,0,0,1],[0,0,1,1,1,0],[0,1,0,1,0,1],[1,0,0,0,1,1],[0,0,0,1,1,1]]),eu={hiddenThresholds:[8,7,18,6,16,5],hiddenWeights:[[-1,1,1,0,0,0],[1,1,0,0,0,-1],[0,0,1,1,1,0],[0,1,0,-1,0,1],[1,0,0,0,1,1],[0,0,0,1,-1,1]],finalThresholds:[7,5,6,5],finalWeights:[[-1,-1,1,-1,1,1],[1,1,-1,1,-1,0],[-1,1,-1,1,1,-1],[1,1,1,-1,-1,0]],output:[],iter:0},pr=[{symbol:0,pattern:ca,selected:!0},{symbol:0,pattern:ua,selected:!0},{symbol:0,pattern:ia,selected:!0},{symbol:0,pattern:sa,selected:!0},{symbol:0,pattern:Kt,selected:!1},{symbol:0,pattern:Kt,selected:!1},{symbol:1,pattern:aa,selected:!0},{symbol:1,pattern:oa,selected:!0},{symbol:1,pattern:ra,selected:!0},{symbol:1,pattern:na,selected:!0},{symbol:1,pattern:Kt,selected:!1},{symbol:1,pattern:Kt,selected:!1},{symbol:2,pattern:ea,selected:!0},{symbol:2,pattern:ta,selected:!0},{symbol:2,pattern:Xo,selected:!0},{symbol:2,pattern:Zo,selected:!0},{symbol:2,pattern:Kt,selected:!1},{symbol:2,pattern:Kt,selected:!1},{symbol:3,pattern:Ko,selected:!0},{symbol:3,pattern:Yo,selected:!0},{symbol:3,pattern:Vo,selected:!0},{symbol:3,pattern:Go,selected:!0},{symbol:3,pattern:Kt,selected:!1},{symbol:3,pattern:Kt,selected:!1}],Nn={patterns:pr,inputs:[],states:[eu],currentState:0,currentPattern:0,selectedInput:p,dialog:Ye,editMode:!1},nu=t=>(n=>{let r=n,o=!0,a;for(;o;){let s=r;if(Ln(be)(s)(t)){r=s+1|0;continue}o=!1,a=s}return a})(0),$r=t=>e=>n=>r=>{let o=F(c=>n===1?c.hidden[r]:c.final[r])(e.output),a=Xi(o),s=(()=>{if(a.tag==="Nothing")return 0;if(a.tag==="Just")return a._1;u()})(),i=tu(o),$=(()=>{if(i.tag==="Nothing")return 0;if(i.tag==="Just")return i._1;u()})();return{zero:-s/($-s),symbols:F(c=>({y:K(c.y),symbol:c.symbol,x:c.x}))(Jt(c=>f=>{let _=f.value;return Ve(c)({symbol:f.symbol,x:_,y:nu(F(D=>D.y)(Ce(D=>_-D.x<=.049)(c)))})})([])(or(Le)(c=>c.value)(F(c=>({symbol:c.symbol,value:c.value}))(Ce(c=>c.selected)(oe(c=>{let f=c.selected,_=c.symbol;return D=>({selected:f,symbol:_,value:D})})(t)(F(c=>(c-s)/($-s))(o))))))),graduation:F(c=>({value:c,x:(K(c)-s)/($-s)}))(qt(cr(ir(s)))(cr(sr($))))}},pa=t=>{let e=Jt(r=>o=>o?r+1|0:r)(0),n=dt(r=>o=>{let a=Ut(r)(18),s=Ut(de(r)(6))(2);return t<3?o&&s===t:o&&a===(t-3|0)});return r=>e(n(r))};var Zt=(t,e,n)=>({tag:t,_1:e,_2:n});var lt=Zt("Nil");var fa=(()=>(e=>n=>{let r=e,o=n,a=!0,s;for(;a;){let i=r,$=o;if($.tag==="Nil"){a=!1,s=i;continue}if($.tag==="Cons"){r=Zt("Cons",$._1,i),o=$._2;continue}u()}return s})(lt))();var vt=(t,e)=>({tag:"CatQueue",_1:t,_2:e});var ma=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){n=!1,r=p;continue}e=vt(fa(o._2),lt);continue}if(o._1.tag==="Cons"){n=!1,r=L("Just",M(o._1._1,vt(o._1._2,o._2)));continue}u()}return r};var Xt=(t,e,n)=>({tag:t,_1:e,_2:n}),w=Xt("CatNil");var jt=t=>e=>{if(t.tag==="CatNil")return e;if(e.tag==="CatNil")return t;if(t.tag==="CatCons")return Xt("CatCons",t._1,vt(t._2._1,Zt("Cons",e,t._2._2)));u()},yu=t=>e=>n=>{let r=a=>s=>i=>{let $=a,c=s,f=i,_=!0,D;for(;_;){let N=$,J=c,C=f;if(C.tag==="Nil"){_=!1,D=J;continue}if(C.tag==="Cons"){$=N,c=N(J)(C._1),f=C._2;continue}u()}return D};return(a=>s=>{let i=a,$=s,c=!0,f;for(;c;){let _=i,D=$,N=ma(_);if(N.tag==="Nothing"){c=!1,f=r(J=>C=>C(J))(e)(D);continue}if(N.tag==="Just"){i=N._1._2,$=Zt("Cons",t(N._1._1),D);continue}u()}return f})(n)(lt)},ga=t=>{if(t.tag==="CatNil")return p;if(t.tag==="CatCons")return L("Just",M(t._1,t._2._1.tag==="Nil"&&t._2._2.tag==="Nil"?w:yu(jt)(w)(t._2)));u()};var P=(t,e)=>({tag:"Free",_1:t,_2:e}),I=(t,e,n)=>({tag:t,_1:e,_2:n});var hu=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag==="Return"){let a=ga(o._2);if(a.tag==="Nothing"){n=!1,r=I("Return",o._1._1);continue}if(a.tag==="Just"){e=(()=>{let s=a._1._1(o._1._1);return P(s._1,jt(s._2)(a._1._2))})();continue}u()}if(o._1.tag==="Bind"){n=!1,r=I("Bind",o._1._1,a=>{let s=o._1._2(a);return P(s._1,jt(s._2)(o._2))});continue}u()}return r},_a=t=>e=>{let n=e.Monad0(),r=n.Bind1().Apply0().Functor0().map,o=n.Applicative0().pure;return a=>e.tailRecM(s=>{let i=hu(s);if(i.tag==="Return")return r(lo)(o(i._1));if(i.tag==="Bind")return r(tr)(a(t.map(i._2)(i._1)));u()})};var ya={Applicative0:()=>Ee,Bind1:()=>hr},ha={map:t=>e=>hr.bind(e)(n=>Ee.pure(t(n)))},hr={bind:t=>e=>P(t._1,jt(t._2)(Xt("CatCons",e,vt(lt,lt)))),Apply0:()=>Dr},Dr={apply:t=>e=>P(t._1,jt(t._2)(Xt("CatCons",n=>P(e._1,jt(e._2)(Xt("CatCons",r=>Ee.pure(n(r)),vt(lt,lt)))),vt(lt,lt)))),Functor0:()=>ha},Ee={pure:t=>P(I("Return",t),w),Apply0:()=>Dr};var Du=t=>{let e=t.Apply0(),n=e.Functor0().map;return r=>o=>r.foldrWithIndex(a=>{let s=o(a);return i=>{let $=s(i);return c=>e.apply(n(f=>fn)($))(c)}})(t.pure())},Tr=t=>{let e=Du(t);return n=>{let r=e(n);return o=>a=>r(a)(o)}};var Lr={foldrWithIndex:t=>e=>{let n=De(o=>{let a=o._1,s=o._2;return i=>t(a)(s)(i)})(e),r=dt(Bt);return o=>n(r(o))},foldlWithIndex:t=>e=>{let n=Jt(o=>a=>t(a._1)(o)(a._2))(e),r=dt(Bt);return o=>n(r(o))},foldMapWithIndex:t=>{let e=t.Semigroup0().append,n=t.mempty;return r=>Lr.foldrWithIndex(o=>a=>s=>e(r(o)(a))(s))(n)},Foldable0:()=>Rt};var En=function(t){return!t};var ba={identity:t=>t,Semigroupoid0:()=>Vn};var Pn={dimap:t=>e=>n=>r=>e(n(t(r)))};var Mu=t=>t,it=(()=>({first:t=>e=>M(t(e._1),e._2),second:Dn.map,Profunctor0:()=>Pn}))();var Ta=t=>{let e=t.identity,n=t.Semigroupoid0(),r=t.Semigroupoid0();return o=>{let a=o.Profunctor0().dimap;return s=>i=>n.compose(r.compose(o.second(i))(o.first(s)))(a(Mu)($=>M($,$))(e))}};var Nu=Ta(ba)(it);var Ca=t=>e=>n=>r=>{let o=Nu(t)(e),a=r.Profunctor0().dimap;return s=>a(o)(i=>{if(i._2.tag==="Left")return i._2._1;if(i._2.tag==="Right")return i._1(i._2._1);u()})(n.second(r.right(s)))};function xa(t){return function(e){var n=[];for(var r in e)hasOwnProperty.call(e,r)&&n.push(t(r)(e[r]));return n}}var Im=Object.keys||xa(function(t){return function(){return t}});var Ot={ix:t=>e=>n=>Ca(r=>o=>{let a=vo(t)(o)(r);if(a.tag==="Nothing")return r;if(a.tag==="Just")return a._1;u()})(r=>{let o=Tn(r)(t);if(o.tag==="Nothing")return Z("Left",r);if(o.tag==="Just")return Z("Right",o._1);u()})(e)(n)};var Qt=(()=>({left:t=>e=>{if(e.tag==="Left")return Z("Left",t(e._1));if(e.tag==="Right")return Z("Right",e._1);u()},right:Je.map,Profunctor0:()=>Pn}))();var Pa={liftAff:t=>t,MonadEffect0:()=>uo};var pt=(t,e)=>({tag:t,_1:e});var rc=t=>({liftEffect:e=>P(I("Bind",pt("Lift",t.liftEffect(e)),n=>P(I("Return",n),w)),w),Monad0:()=>ya}),Aa=t=>{let e=rc(t.MonadEffect0());return{liftAff:n=>P(I("Bind",pt("Lift",t.liftAff(n)),r=>P(I("Return",r),w)),w),MonadEffect0:()=>e}},Fa=t=>({map:e=>n=>{if(n.tag==="State")return pt("State",r=>{let o=n._1(r);return M(e(o._1),o._2)});if(n.tag==="Lift")return pt("Lift",t.map(e)(n._1));u()}});var Fn=(t,e)=>e?-.7*Math.exp(-.7*t):.7*Math.exp(.7*t),xr=t=>({patterns:e,inputs:n})=>r=>{let{iter:o,hiddenThresholds:a,hiddenWeights:s,finalThresholds:i,finalWeights:$,output:c}=r,f=[...i],_=$.map(J=>[...J]),D=[...a],N=s.map(J=>[...J]);for(let J=0;J<24;J++){let{selected:C,symbol:U}=e[J];if(C){let{final:G,hidden:V}=c[J],yt=n[J];for(let S=0;S<4;S++)f[S]+=.001*Fn(G[S],S==U);for(let S=0;S<4;S++)for(let d=0;d<6;d++)_[S][d]-=1e-4*Fn(G[S],U==S)*V[d];for(let S=0;S<6;S++)if(V[S]>0)for(let d=0;d<4;d++)D[S]+=1e-4*Fn(G[d],U==d)*s[d][S];for(let S=0;S<6;S++)if(V[S]>0){for(let d=0;d<6;d++)if(t[S][d])for(let at=0;at<4;at++)N[S][d]-=1e-4*Fn(G[at],U==at)*$[at][S]*yt[d]}}}return{...r,iter:o+1,finalThresholds:f,finalWeights:_,hiddenThresholds:D,hiddenWeights:N}};var oc=t=>e=>{let n=Le.compare(t)(e);if(n.tag==="LT")return e;if(n.tag==="EQ"||n.tag==="GT")return t;u()},Ra=Jt(ar)(0),ac=Wt({reflectSymbol:()=>"currentState"})()()(et)(it),Pr=Wt({reflectSymbol:()=>"states"})()()(et)(it),sc=Wt({reflectSymbol:()=>"hiddenWeights"})()()(et)(it),ic=Wt({reflectSymbol:()=>"hiddenWeights"})()()(et)(it),uc=Wt({reflectSymbol:()=>"hiddenThresholds"})()()(et)(it),cc=Wt({reflectSymbol:()=>"hiddenThresholds"})()()(et)(it),Er=Wt({reflectSymbol:()=>"patterns"})()()(et)(it),dc=Wt({reflectSymbol:()=>"selected"})()()(et)(it),Ia=P(I("Bind",pt("State",t=>M(t,t)),t=>P(I("Return",t),w)),w),lc=Tr(Ee)(Lr),pc=(()=>{let t=Aa(Pa).liftAff;return e=>t(_n(At,e))})(),Ar=t=>e=>({hiddenThresholds:e.hiddenThresholds,hiddenWeights:e.hiddenWeights,finalThresholds:e.finalThresholds,finalWeights:e.finalWeights,output:F(n=>{let r=oe(o=>a=>oc(0)(Ra(oe(Cn)(n)(a))-o))(e.hiddenThresholds)(e.hiddenWeights);return{final:oe(o=>a=>Ra(oe(Cn)(r)(a))-o)(e.finalThresholds)(e.finalWeights),hidden:r}})(t),iter:e.iter}),$c=F(t=>{let e=t.pattern;return F(n=>K(pa(n)(e)))(qt(0)(5))}),ae=t=>{let e=$c(t.patterns);return{patterns:t.patterns,inputs:e,states:F(Ar(e))(t.states),currentPattern:t.currentPattern,currentState:t.currentState,selectedInput:t.selectedInput,dialog:t.dialog,editMode:t.editMode}},Sa=t=>ac(e=>0)(Pr(e=>[(()=>{let n=e[t.currentState];return{hiddenThresholds:n.hiddenThresholds,hiddenWeights:n.hiddenWeights,finalThresholds:n.finalThresholds,finalWeights:n.finalWeights,output:n.output,iter:0}})()])(t)),fc=[0,100,200,300,400,500,1e3,2e3,3e3,4e3,5e3,1e4,2e4,3e4,4e4,5e4,6e4],mc=t=>{let e=n=>r=>o=>{let a=n,s=r,i=o,$=!0,c;for(;$;){let f=a,_=s,D=i;if(f===6e4){$=!1,c=Ve(_)(D);continue}if(Ln(be)(f)(fc)){a=f+1|0,s=Ve(_)(D),i=Ar(t.inputs)(xr(Ke)(t)(D));continue}a=f+1|0,s=_,i=Ar(t.inputs)(xr(Ke)(t)(D))}return c};return{patterns:t.patterns,inputs:t.inputs,states:e(0)([])(t.states[0]),currentPattern:t.currentPattern,currentState:t.currentState,selectedInput:t.selectedInput,dialog:t.dialog,editMode:t.editMode}},qa=t=>{if(t.tag==="SelectInput"){let e=t._1;return P(I("Bind",pt("State",n=>M(void 0,{...n,selectedInput:e})),n=>P(I("Return",n),w)),w)}if(t.tag==="SelectPattern"){let e=t._1;return P(I("Bind",pt("State",n=>M(void 0,ae({patterns:n.patterns,inputs:n.inputs,states:n.states,currentPattern:e,currentState:n.currentState,selectedInput:n.selectedInput,dialog:n.dialog,editMode:n.editMode}))),n=>P(I("Return",n),w)),w)}if(t.tag==="ChangeWeight"){let e=Mn(t._4,Ne,z,p);if(e.tag==="Nothing")return P(I("Return",void 0),w);if(e.tag==="Just"){let n=e._1;return P(I("Bind",pt("State",r=>M(void 0,ae(Sa(Pr(Ot.ix(r.currentState)(it)(Qt)((t._1===1?sc:ic)(Ot.ix(t._2)(it)(Qt)(Ot.ix(t._3)(it)(Qt)(o=>n)))))(r))))),r=>P(I("Return",r),w)),w)}u()}if(t.tag==="ChangeThreshold"){let e=Mn(t._3,Ne,z,p);if(e.tag==="Nothing")return P(I("Return",void 0),w);if(e.tag==="Just"){let n=e._1;return P(I("Bind",pt("State",r=>M(void 0,ae(Sa(Pr(Ot.ix(r.currentState)(it)(Qt)((t._1===1?uc:cc)(Ot.ix(t._2)(it)(Qt)(o=>n))))(r))))),r=>P(I("Return",r),w)),w)}u()}if(t.tag==="OpenDialog"){let e=t._1;return P(I("Bind",pt("State",n=>M(void 0,{...n,dialog:e})),n=>P(I("Return",n),w)),w)}if(t.tag==="TogglePattern"){let e=Er(Ot.ix(t._1)(it)(Qt)(dc(En)));return P(I("Bind",pt("State",n=>M(void 0,e(n))),n=>P(I("Return",n),w)),w)}if(t.tag==="ChangePixel"){let e=t._1;return P(I("Bind",pt("State",n=>M(void 0,ae(Er(Ot.ix(n.currentPattern)(it)(Qt)(Wt({reflectSymbol:()=>"pattern"})()()(et)(it)(Ot.ix(e)(it)(Qt)(En))))(n)))),n=>P(I("Return",n),w)),w)}if(t.tag==="ToggleEditMode")return P(I("Bind",pt("State",e=>M(void 0,{...e,editMode:!e.editMode})),e=>P(I("Return",e),w)),w);if(t.tag==="ResetPattern")return P(I("Bind",pt("State",e=>M(void 0,ae((()=>{let n=pr[e.currentPattern];return Er(Ot.ix(e.currentPattern)(it)(Qt)(r=>n))(e)})()))),e=>P(I("Return",e),w)),w);if(t.tag==="RunLearning")return P(I("Bind",pt("State",e=>M(void 0,mc(e))),e=>P(I("Return",e),w)),w);if(t.tag==="RunSimulation")return P(Ia._1,jt(Ia._2)(Xt("CatCons",e=>lc(e.states)(n=>r=>P(I("Bind",pt("State",o=>M(void 0,{...o,currentState:n})),o=>P(I("Return",o),w)),jt(w)(Xt("CatCons",()=>pc(2e3),vt(lt,lt))))),vt(lt,lt))));if(t.tag==="ChangeCurrentState"){let e=Uo(t._1);if(e.tag==="Nothing")return P(I("Return",void 0),w);if(e.tag==="Just"){let n=e._1;return P(I("Bind",pt("State",r=>M(void 0,{...r,currentState:n})),r=>P(I("Return",r),w)),w)}u()}if(t.tag==="Reset"){let e=ae(Nn);return P(I("Bind",pt("State",n=>M(void 0,e)),n=>P(I("Return",n),w)),w)}u()};function Fr(t){return function(e){return function(n){return t.apply(n,[e])}}}var Wa=Fr(Number.prototype.toPrecision),va=Fr(Number.prototype.toFixed),za=Fr(Number.prototype.toExponential);var Ja=(t,e)=>({tag:t,_1:e}),Ha=t=>e=>n=>{let r=ce.compare(t)(n),o=(()=>{if(r.tag==="LT")return n;if(r.tag==="EQ"||r.tag==="GT")return t;u()})(),a=ce.compare(e)(o);if(a.tag==="LT"||a.tag==="EQ")return e;if(a.tag==="GT")return o;u()};var Ba=t=>{if(t.tag==="Precision")return Wa(t._1);if(t.tag==="Fixed")return va(t._1);if(t.tag==="Exponential")return za(t._1);u()};var ut=(t,e,n,r,o)=>({tag:t,_1:e,_2:n,_3:r,_4:o});var ka=t=>e=>n=>r=>ut("ChangeWeight",t,e,n,r),Ua=t=>e=>n=>ut("ChangeThreshold",t,e,n);var ja=ut("ResetPattern"),Oa=ut("ToggleEditMode"),wr=ut("RunLearning"),Qa=ut("RunSimulation"),Rr=t=>ut("ChangeCurrentState",t),Ga=ut("Reset");var hc=(t,e,n,r=!1)=>{let o={},a={style:o},s={tag:t,children:n,props:a,node:null,keyed:r},i=e.length;for(let $=0;$<i;$++){let[c,f,_]=e[$];c==1?a[f]=_:c===2?a.class=(a.class?a.class+" ":"")+f:c===3&&(o[f]=_)}return s},Q=t=>e=>n=>hc(t,e,n.map(r=>[null,r]));var Dc=t=>({tag:t,props:{},children:[],type:3});var X=t=>e=>[1,t,e],E=t=>[2,t],Ze=[-1],Dt=t=>e=>[1,"on"+t,e],gt=t=>e=>[3,t,e],$t=Dc;var Pe=$t("");var wn=Q("svg"),Xe=Q("span");var Va=Q("label");var Ct=Q("g");var k=Q("div");var Ir=Q("button"),Ya=Q("br")([])([]);var qr="text-white inline-block w-48 border text-4xl rounded-lg p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500",Za="w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600",Sr="text-white focus:ring-4 focus:outline-none font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center bg-blue-600 hover:bg-blue-700 focus:ring-blue-800",Rn=t=>e=>n=>k([E("absolute w-full h-full flex items-center justify-center bg-transp-grey inset-0 z-50")])([k([E("bg-black text-white rounded block border-2")])([k([E("p-4 min-h-8 border-b-2")])([k([E("text-4xl font-medium inline-block")])([$t(t)])]),k([E("p-6 border-b-2")])(e),k([E("p-4 text-right")])(dt(r=>o=>{let a=o.onClick;return Ir([E(r===0?Sr+"":Sr+" ml-4"),Dt("click")(s=>()=>L("Just",a))])([$t(o.name)])})(n))])]),In=t=>e=>Ir([E(Sr),Dt("click")(n=>()=>L("Just",e))])([$t(t)]);var Sn=(()=>{let t=X("y2");return e=>t(Y(e))})(),Fe=(()=>{let t=X("y1");return e=>t(Y(e))})(),we=(()=>{let t=X("y");return e=>t(Y(e))})(),tn=(()=>{let t=X("x2");return e=>t(Y(e))})(),en=(()=>{let t=X("x1");return e=>t(Y(e))})(),se=(()=>{let t=X("x");return e=>t(Y(e))})(),nn=X("width"),Wr=t=>e=>n=>r=>X("viewBox")(_t(t)+" "+_t(e)+" "+_t(n)+" "+_t(r)),rn=X("value"),Re=X("type");var on=(()=>{let t=X("stroke-width");return e=>t(Y(e))})(),Xa=X("stroke-dasharray"),pe=X("stroke");var qn=(()=>{let t=X("r");return e=>t(Y(e))})();var vr=(()=>{let t=X("min");return e=>t(_t(e))})();var zr=(()=>{let t=X("max");return e=>t(_t(e))})();var Jr=X("href");var an=X("height"),$e=X("fill");function xt(t,e,n){return t==null?e:n(t)}function Ie(t){return t.currentTarget}function ts(t){return t.type}function Wn(t,e,n,r){if(typeof window<"u"){var o=window[n];if(o!=null&&r instanceof o)return e(r)}for(var a=r;a!=null;){var s=Object.getPrototypeOf(a),i=s.constructor.name;if(i===n)return e(r);if(i==="Object")return t;a=s}return t}function ns(t){return function(){return t.checked}}function rs(t){return function(){return t.value}}var as=t=>Dt("change")(e=>{let n=xt(Ie(e),p,z),r=(()=>{if(n.tag==="Just")return Wn(p,z,"HTMLInputElement",n._1);if(n.tag==="Nothing")return p;u()})();if(r.tag==="Nothing")return()=>p;if(r.tag==="Just"){let o=ns(r._1);return()=>{let a=o();return L("Just",t(a))}}u()});var sn=t=>Dt("change")(e=>{let n=xt(Ie(e),p,z),r=(()=>{if(n.tag==="Just")return Wn(p,z,"HTMLInputElement",n._1);if(n.tag==="Nothing")return p;u()})();if(r.tag==="Nothing")return()=>p;if(r.tag==="Just"){let o=rs(r._1);return()=>{let a=o();return L("Just",t(a))}}u()});var ss=t=>k([E("inline-block w-8 h-8")])([wn([E("w-full h-full")])([Q("use")([Jr("#neuron-"+_t(t))])([])])]),Nc=t=>e=>n=>Ct([gt("transform")("translate("+Y(t*100)+"px,"+Y(25-e*5)+"px)")])([Q("rect")([se(-2.5),we(0),nn("5"),an("5"),$e((()=>n===0?"#A3E635":n===1?"#60A5FA":n===2?"#EC4899":"#FACC15")())])([]),Q("text")([se(-1),we(4.5),X("font-size")("0.3rem")])([$t(_t(n*3|0))])]),cs=t=>e=>k([E(t?"border w-[40vw]":"border w-[75vw]")])([wn([Wr(-10)(0)(120)(30)])([Q("rect")([se(-10),we(0),nn("120"),an("40"),$e("#B0FFB0")])([]),Q("rect")([se(-10),we(0),nn(Y(7.5+e.zero*100)),an("40"),$e("#FFB0B0")])([]),Ct([])(F(n=>Q("line")([en(n.x*100-2.5),tn(n.x*100-2.5),Fe(0),Fe(30),on(.2),pe("#808080"),Xa("0.5")])([]))(e.graduation)),Ct([])(F(n=>Nc(n.x)(n.y)(n.symbol))(e.symbols))])]),xc=t=>e=>n=>{let r=t.states[t.currentState],o=e===1?r.hiddenThresholds[n]:r.finalThresholds[n],a=e===1?r.hiddenWeights[n]:r.finalWeights[n];return Rn((()=>e===1?n===0?"Neurone A":n===1?"Neurone B":n===2?"Neurone C":n===3?"Neurone D":n===4?"Neurone E":n===5?"Neurone F":"Neurone jaune":e===2?n===0?"Neurone vert":n===1?"Neurone bleu":n===2?"Neurone rose":"Neurone jaune":"Neurone jaune")())([k([E("flex flex-col")])([k([E("text-4xl")])([t.editMode?Xe([])(zo(Xe([E("text-4xl mx-4")])([$t("+")]))(dt(s=>i=>Xe([])([Q("input")([E(qr),Re("number"),rn(Y(i)),sn(ka(e)(n)(s))])([]),ss(e===2?6+s|0:0+s|0)]))(a))):Xe([])(rr(dt(s=>i=>[$t((s>0&&i.weight>0?"+":"")+(()=>i.weight===1?"":i.weight===-1?"-":Ba(Ja("Fixed",Ha(0)(20)(3)))(i.weight))()),ss(e===2?6+i.index|0:0+i.index|0)])(Ce(s=>s.weight!==0)(dt(s=>i=>({index:s,weight:i}))(a))))),Ya,$t("Seuil: "),t.editMode?Q("input")([E(qr),Re("number"),rn(Y(o)),sn(Ua(e)(n))])([]):$t(Y(o))]),cs(!1)($r(t.patterns)(r)(e)(n)),k([E("text-4xl")])([$t("Nombre d'it\xE9rations: "+_t(r.iter)),t.states.length>1?Q("input")([E("h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"),Re("range"),vr(0),zr(t.states.length-1|0),rn(_t(t.currentState)),sn(Rr)])([]):Pe])])])([{name:"Editer",onClick:Oa},{name:"Apprendre",onClick:wr},{name:"Ok",onClick:ut("OpenDialog",Ye)}])},Ec=t=>e=>k([E("overflow-hidden relative border-4 border-slate-400 m-2 w-64 h-96"),Dt("click")(n=>()=>L("Just",ut("OpenDialog",da)))])(dt(n=>r=>{let o=Ut(n)(6),a=de(n)(6);return k([E("absolute pointer-events-none pattern-pixel"),r?E("black"):Ze,(()=>{let s=Ut(o)(3)+3|0,i=Ut(a)(2);return t.tag==="Just"&&s===t._1||t.tag==="Just"&&i===t._1?E("selected"):Ze})(),gt("width")("16.66666666%"),gt("height")("11.1111111111%"),gt("left")(Y(K(a)/6*100)+"%"),gt("top")(Y(K(o)/9*100)+"%")])([])})(e.pattern)),Pc=t=>Q("line")([Fe(20+20*K(t)),Sn(20+20*K(t)),en(105),tn(120),on(.5),pe("white")])([]),is=t=>Q("use")([Jr("#neuron-"+_t(t)),se(-3),we(-3),nn("6"),an("6"),E("pointer-events-none")])([]),Ac=t=>e=>n=>{let r=n.symbol;return k([E("overflow-hidden relative border-4 border-slate-400 m-2 w-24 h-36"),E(e?"border-green-500":"border-slate-400"),Dt("click")(o=>()=>L("Just",ut("SelectPattern",t)))])(dt(o=>a=>k([E((()=>a?r===0?"absolute bg-green-400":r===1?"absolute bg-blue-400":r===2?"absolute bg-pink-500":"absolute bg-yellow-400":"absolute bg-white")()),gt("width")("16.66666666%"),gt("height")("11.1111111111%"),gt("left")(Y(K(de(o)(6))/6*100)+"%"),gt("top")(Y(K(Ut(o)(6))/9*100)+"%")])([]))(n.pattern))},Fc=t=>{let e=t.currentPattern;return Rn("Modifier le motif")([k([E("flex flex-row items-center gap-8")])([(()=>{let n=Tn(t.patterns)(e);if(n.tag==="Just")return k([E("m-2 overflow-hidden relative border-4 w-64 h-96")])(dt(r=>o=>k([E("absolute pattern-pixel"),o?E("black"):Ze,gt("width")("16.66666666%"),gt("height")("11.1111111111%"),gt("left")(Y(K(de(r)(6))/6*100)+"%"),gt("top")(Y(K(Ut(r)(6))/9*100)+"%"),Dt("click")(a=>()=>L("Just",ut("ChangePixel",r)))])([]))(n._1.pattern));if(n.tag==="Nothing")return Pe;u()})(),k([E("grid grid-cols-6 gap-2")])(dt(n=>r=>k([E("flex flex-col items-center")])([Va([E("relative inline-flex items-center cursor-pointer")])([Q("input")([Re("checkbox"),X("checked")(r.selected),E("sr-only peer"),as(o=>ut("TogglePattern",n))])([]),k([E(Za)])([])]),Ac(n)(n===e)(r)]))(t.patterns))])])([{name:"R\xE9initialiser",onClick:ja},{name:"Ok",onClick:ut("OpenDialog",Ye)}])},us=t=>e=>n=>r=>Q("line")([Fe(t<=1?10+15*K(e):20+20*K(e)),Sn(n<=1?10+15*K(r):20+20*K(r)),en((()=>t===0?15:t===1?60:105)()),tn((()=>n===0?15:n===1?60:105)()),on(.5),pe("white")])([]),wc=t=>Q("line")([Fe(10+15*K(t)),Sn(10+15*K(t)),en(0),tn(15),on(.5),pe("white")])([]),Rc=t=>{let e=t.states[t.currentState];return Rn("Neurones de sortie")([k([E("flex flex-col")])([k([E("grid grid-cols-2 gap-8")])(F(n=>cs(!0)($r(t.patterns)(e)(2)(n)))([0,1,2,3])),k([E("h-24 mt-12 text-4xl grid grid-cols-2 gap-8")])([$t("Nombre d'it\xE9rations: "+_t(e.iter)),t.states.length>1?k([])([In("Lancer")(Qa),Q("input")([E("h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"),Re("range"),vr(0),zr(t.states.length-1|0),rn(_t(t.currentState)),sn(Rr)])([])]):Pe])])])([{name:"Apprendre",onClick:wr},{name:"Ok",onClick:ut("OpenDialog",Ye)}])},ds=t=>k([E("w-full min-h-full bg-black")])([k([E("flex flew-row")])([k([E("w-1/4")])([Ec(t.selectedInput)(t.patterns[t.currentPattern]),In("Afficher les r\xE9glettes")(ut("OpenDialog",la)),In("R\xE9initialiser")(Ga)]),k([E("w-3/4 relative")])([wn([Wr(0)(0)(150)(100)])([Ct([])(rr(dt(e=>dt(n=>r=>r?us(0)(n)(1)(e):Pe))(Ke))),Ct([])(je(qt(0)(5))(e=>je(qt(0)(3))(n=>[us(1)(e)(2)(n)]))),Ct([])(F(wc)(qt(0)(5))),Ct([])(F(Pc)(qt(0)(3))),Ct([])(F(e=>Ct([gt("transform")("translate(10.0%,"+Y((.1+.15*K(e))*100)+"%)")])([Q("circle")([qn(5),Dt("pointerenter")(n=>()=>L("Just",ut("SelectInput",L("Just",e)))),Dt("pointerleave")(n=>()=>L("Just",ut("SelectInput",p))),$e("white")])([]),is(e)]))(qt(0)(5))),Ct([])(F(e=>Ct([gt("transform")("translate(40.0%,"+Y((.1+.15*K(e))*100)+"%)")])([Q("circle")([qn(5),$e("white"),Dt("click")(n=>()=>L("Just",ut("OpenDialog",xe("NeuronDialog",1,e))))])([]),is(6+e|0)]))(qt(0)(5))),Ct([])(dt(e=>n=>Ct([gt("transform")("translate(70.0%,"+Y((.2+.2*K(e))*100)+"%)")])([Q("circle")([qn(5),$e((()=>e===0?"#A3E635":e===1?"#60A5FA":e===2?"#EC4899":"#FACC15")()),Dt("click")(r=>()=>L("Just",ut("OpenDialog",xe("NeuronDialog",2,e))))])([]),n>0?Q("text")([se(20),X("font-size")("0.4rem"),pe("green")])([$t("\u2713")]):Q("text")([se(20),X("font-size")("0.4rem"),pe("red")])([$t("\u2A2F")])]))(t.states[t.currentState].output[t.currentPattern].final))])])]),(()=>{if(t.dialog.tag==="NoDialog")return Pe;if(t.dialog.tag==="EditorDialog")return Fc(t);if(t.dialog.tag==="NeuronDialog")return xc(t)(t.dialog._1)(t.dialog._2);if(t.dialog.tag==="AllNeuronsDialog")return Rc(t);u()})()]);var ls=(t,e)=>Object.assign({},t,e),ps=(t,e)=>t&&e?n=>t(e(n)):t||e,$s=(t,e,n,r,o,a,s)=>{if(e==="style")for(let i in ls(n,r))n=r==null||r[i]==null?"":r[i],i[0]==="-"?t[e].setProperty(i,n):t[e][i]=n;else if(e[0]==="o"&&e[1]==="n"){let i=e.slice(2);t.actions||(t.actions={}),t.actions[i]=s&&r?s(r):r,r?n||t.addEventListener(i,o):t.removeEventListener(i,o)}else!a&&e in t?t[e]=r:r==null||r===!1||e==="class"&&!r?t.removeAttribute(e):t.setAttribute(e,r)},zn=(t,e,n,r)=>{let o=t.type===3?document.createTextNode(t.tag):(n=n||t.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),a=t.props,s=ps(r,t.mapf);for(let i in a)$s(o,i,null,a[i],e,n,s);for(let i=0,$=t.children.length;i<$;i++)o.appendChild(zn(ge(t.children[i])[1],e,n,s));return t.node=o,o},Sc=t=>t&&t[0],me=(t,e,n,r,o,a,s)=>{if(n!==r)if(n!=null&&n.type===3&&r.type===3)n.tag!==r.tag&&(e.nodeValue=r.tag);else if(n==null||n.tag!==r.tag)e=t.insertBefore(zn(r,o,a,s),e),n&&n.node&&t.removeChild(n.node);else{let i=n.props,$=r.props,c=n.children,f=r.children,_=0,D=0,N=c.length-1,J=f.length-1;s=ps(s,r.mapf),a=a||r.tag==="svg";for(let C in ls(i,$))(C==="value"||C==="selected"||C==="checked"?e[C]:i[C])!==$[C]&&$s(e,C,i[C],$[C],o,a,s);if(r.keyed){for(;D<=J&&_<=N;){let[C,U]=c[_];if(C!==f[D][0])break;let G=ge(f[D],U);me(e,U.node,U,G[1],o,a,s),D++,_++}for(;D<=J&&_<=N;){let[C,U]=c[N];if(C!==f[J][0])break;let G=ge(f[J],U);me(e,U.node,U,G[1],o,a,s),J--,N--}if(_>N)for(;D<=J;){let C=ge(f[D])[1];e.insertBefore(zn(C,o,a,s),c[_]&&c[_][1].node),D++}else if(D>J)for(;_<=N;)e.removeChild(c[_][1].node),_++;else{let C={},U={};for(let G=_;G<=N;G++)C[c[G][0]]=c[G][1];for(;D<=J;){let[G,V]=c[_],[yt,S]=ge(f[D],V);if(U[G]||yt===Sc(c[_+1])){_++;continue}if(G===yt)me(e,V.node,V,S,o,a,s),U[yt]=!0,_++;else{let d=C[yt];d!=null?(me(e,e.insertBefore(d.node,V.node),d,f[D][1],o,a,s),U[yt]=!0):me(e,V.node,null,f[D][1],o,a,s)}D++}for(let G in C)U[G]||e.removeChild(C[G].node)}}else{for(let C=0;C<=N&&C<=J;C++){let U=c[C][1],G=ge(f[C],U)[1];me(e,U.node,U,G,o,a,s)}for(let C=N+1;C<=J;C++){let U=ge(f[C],n)[1];e.appendChild(zn(U,o,a,s))}for(let C=J+1;C<=N;C++)e.removeChild(c[C][1].node)}}return r.node=e,e},qc=(t,e)=>{for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1},Wc=(t,e)=>e.reduce((n,r)=>n(r),t),ge=(t,e)=>(typeof t[1].type=="function"&&((!e||e.memo==null||qc(e.memo,t[1].memo))&&(e=Jn(Wc(t[1].type,t[1].memo)),e.memo=t[1].memo),t[1]=e),t),Jn=t=>Object.assign({},t,{children:t.children&&t.children.map(([e,n])=>[e,Jn(n)])}),fs=t=>e=>()=>t.actions[e],ms=t=>e=>n=>r=>o=>()=>me(t,e,n,r,a=>o(a)());function Hr(t){return function(e){return t===e}}var zt=function(t){return function(e){return function(){return e[t]}}};var ny=zt("baseURI"),Hc=zt("ownerDocument"),Br=zt("parentNode"),Bc=zt("parentElement");var ry=zt("childNodes"),kc=zt("firstChild"),Uc=zt("lastChild"),jc=zt("previousSibling"),Oc=zt("nextSibling"),Qc=zt("nodeValue");var oy=zt("textContent");var Hn=function(t){return function(e){return function(){return e[t]}}},Ay=Hn("children"),Vc=Hn("firstElementChild"),Yc=Hn("lastElementChild"),Fy=Hn("childElementCount");function gs(t){return function(e){return function(){return e.querySelector(t)}}}var _s=t=>{let e=gs(t);return n=>{let r=e(n);return()=>{let o=r();return xt(o,p,z)}}};var ys=function(){return window};function hs(t){return function(){return t.document}}var Ds=Kn(On),un=Ds(gn),td=Ds(Rt),ed=t=>{let e=_a(Fa(t.Bind1().Apply0().Functor0()))(co);return n=>r=>o=>{let a=n.get;return e(s=>{if(s.tag==="State")return re(ke(a))(i=>{let $=s._1(i),c=$._1;return re(ke(n.put($._2)))(()=>Be(c))});if(s.tag==="Lift")return r(s._1);u()})(o)}},nd=t=>{let e=t.init.action,n=t.selector,r=t.init.state,o=t.subscriptions;return()=>{let a=ys(),s=hs(a)(),i=_s(n)(s)();return un(i.tag==="Just"?L("Just",i._1):p)($=>()=>{let c=r,f=$,_=$t(""),D=V=>()=>{let S=Hr(c)(V);if(!S)return c=V,N(t.view(V))();S||u()},N=V=>()=>{let yt=_,S=f,d=Br(S)();return un(xt(d,p,z))(at=>{let _e=Jn(V),Bn=ms(at)(S)(yt)(_e)(J);return()=>(f=Bn(),_=_e)})()},J=V=>{let yt=ts(V);return un(xt(Ie(V),p,z))(S=>{let d=fs(S)(yt);return()=>{let at=d();return C(V)(at)()}})},C=V=>yt=>{let S=yt(V);return()=>{let d=S();return un(d)(U())()}},U=We(()=>t.update({get:()=>c,put:V=>D(V)})),G=U();return N(t.view(r))(),td(o)(V=>V(G))(),un(e)(G)()})()}};var bs=t=>{let e=ed(t);return n=>{let r=n.eval;return nd({init:n.init,view:n.view,subscriptions:n.subscriptions,selector:n.selector,update:o=>a=>{let s=Zn(ao,e(o)(r)(n.update(a)));return()=>{s().run()}}})}};var Ts=bs(yn)({init:{state:ae(Nn),action:p},eval:t=>t,view:ds,update:qa,subscriptions:[],selector:"#root"});Ts();})();
